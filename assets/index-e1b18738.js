var OI=Object.defineProperty;var II=(r,o,u)=>o in r?OI(r,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[o]=u;var N=(r,o,u)=>(II(r,typeof o!="symbol"?o+"":o,u),u);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))p(v);new MutationObserver(v=>{for(const b of v)if(b.type==="childList")for(const M of b.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&p(M)}).observe(document,{childList:!0,subtree:!0});function u(v){const b={};return v.integrity&&(b.integrity=v.integrity),v.referrerPolicy&&(b.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?b.credentials="include":v.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function p(v){if(v.ep)return;v.ep=!0;const b=u(v);fetch(v.href,b)}})();function NI(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var T2={exports:{}},Tf={},E2={exports:{}},bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lh=Symbol.for("react.element"),kI=Symbol.for("react.portal"),FI=Symbol.for("react.fragment"),UI=Symbol.for("react.strict_mode"),zI=Symbol.for("react.profiler"),BI=Symbol.for("react.provider"),jI=Symbol.for("react.context"),HI=Symbol.for("react.forward_ref"),GI=Symbol.for("react.suspense"),VI=Symbol.for("react.memo"),WI=Symbol.for("react.lazy"),X_=Symbol.iterator;function XI(r){return r===null||typeof r!="object"?null:(r=X_&&r[X_]||r["@@iterator"],typeof r=="function"?r:null)}var A2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R2=Object.assign,L2={};function uc(r,o,u){this.props=r,this.context=o,this.refs=L2,this.updater=u||A2}uc.prototype.isReactComponent={};uc.prototype.setState=function(r,o){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,o,"setState")};uc.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function P2(){}P2.prototype=uc.prototype;function E1(r,o,u){this.props=r,this.context=o,this.refs=L2,this.updater=u||A2}var A1=E1.prototype=new P2;A1.constructor=E1;R2(A1,uc.prototype);A1.isPureReactComponent=!0;var q_=Array.isArray,C2=Object.prototype.hasOwnProperty,R1={current:null},D2={key:!0,ref:!0,__self:!0,__source:!0};function O2(r,o,u){var p,v={},b=null,M=null;if(o!=null)for(p in o.ref!==void 0&&(M=o.ref),o.key!==void 0&&(b=""+o.key),o)C2.call(o,p)&&!D2.hasOwnProperty(p)&&(v[p]=o[p]);var L=arguments.length-2;if(L===1)v.children=u;else if(1<L){for(var k=Array(L),j=0;j<L;j++)k[j]=arguments[j+2];v.children=k}if(r&&r.defaultProps)for(p in L=r.defaultProps,L)v[p]===void 0&&(v[p]=L[p]);return{$$typeof:lh,type:r,key:b,ref:M,props:v,_owner:R1.current}}function qI(r,o){return{$$typeof:lh,type:r.type,key:o,ref:r.ref,props:r.props,_owner:r._owner}}function L1(r){return typeof r=="object"&&r!==null&&r.$$typeof===lh}function YI(r){var o={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(u){return o[u]})}var Y_=/\/+/g;function Yg(r,o){return typeof r=="object"&&r!==null&&r.key!=null?YI(""+r.key):o.toString(36)}function Dp(r,o,u,p,v){var b=typeof r;(b==="undefined"||b==="boolean")&&(r=null);var M=!1;if(r===null)M=!0;else switch(b){case"string":case"number":M=!0;break;case"object":switch(r.$$typeof){case lh:case kI:M=!0}}if(M)return M=r,v=v(M),r=p===""?"."+Yg(M,0):p,q_(v)?(u="",r!=null&&(u=r.replace(Y_,"$&/")+"/"),Dp(v,o,u,"",function(j){return j})):v!=null&&(L1(v)&&(v=qI(v,u+(!v.key||M&&M.key===v.key?"":(""+v.key).replace(Y_,"$&/")+"/")+r)),o.push(v)),1;if(M=0,p=p===""?".":p+":",q_(r))for(var L=0;L<r.length;L++){b=r[L];var k=p+Yg(b,L);M+=Dp(b,o,u,k,v)}else if(k=XI(r),typeof k=="function")for(r=k.call(r),L=0;!(b=r.next()).done;)b=b.value,k=p+Yg(b,L++),M+=Dp(b,o,u,k,v);else if(b==="object")throw o=String(r),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return M}function hp(r,o,u){if(r==null)return r;var p=[],v=0;return Dp(r,p,"","",function(b){return o.call(u,b,v++)}),p}function QI(r){if(r._status===-1){var o=r._result;o=o(),o.then(function(u){(r._status===0||r._status===-1)&&(r._status=1,r._result=u)},function(u){(r._status===0||r._status===-1)&&(r._status=2,r._result=u)}),r._status===-1&&(r._status=0,r._result=o)}if(r._status===1)return r._result.default;throw r._result}var mi={current:null},Op={transition:null},ZI={ReactCurrentDispatcher:mi,ReactCurrentBatchConfig:Op,ReactCurrentOwner:R1};function I2(){throw Error("act(...) is not supported in production builds of React.")}bt.Children={map:hp,forEach:function(r,o,u){hp(r,function(){o.apply(this,arguments)},u)},count:function(r){var o=0;return hp(r,function(){o++}),o},toArray:function(r){return hp(r,function(o){return o})||[]},only:function(r){if(!L1(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};bt.Component=uc;bt.Fragment=FI;bt.Profiler=zI;bt.PureComponent=E1;bt.StrictMode=UI;bt.Suspense=GI;bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZI;bt.act=I2;bt.cloneElement=function(r,o,u){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var p=R2({},r.props),v=r.key,b=r.ref,M=r._owner;if(o!=null){if(o.ref!==void 0&&(b=o.ref,M=R1.current),o.key!==void 0&&(v=""+o.key),r.type&&r.type.defaultProps)var L=r.type.defaultProps;for(k in o)C2.call(o,k)&&!D2.hasOwnProperty(k)&&(p[k]=o[k]===void 0&&L!==void 0?L[k]:o[k])}var k=arguments.length-2;if(k===1)p.children=u;else if(1<k){L=Array(k);for(var j=0;j<k;j++)L[j]=arguments[j+2];p.children=L}return{$$typeof:lh,type:r.type,key:v,ref:b,props:p,_owner:M}};bt.createContext=function(r){return r={$$typeof:jI,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:BI,_context:r},r.Consumer=r};bt.createElement=O2;bt.createFactory=function(r){var o=O2.bind(null,r);return o.type=r,o};bt.createRef=function(){return{current:null}};bt.forwardRef=function(r){return{$$typeof:HI,render:r}};bt.isValidElement=L1;bt.lazy=function(r){return{$$typeof:WI,_payload:{_status:-1,_result:r},_init:QI}};bt.memo=function(r,o){return{$$typeof:VI,type:r,compare:o===void 0?null:o}};bt.startTransition=function(r){var o=Op.transition;Op.transition={};try{r()}finally{Op.transition=o}};bt.unstable_act=I2;bt.useCallback=function(r,o){return mi.current.useCallback(r,o)};bt.useContext=function(r){return mi.current.useContext(r)};bt.useDebugValue=function(){};bt.useDeferredValue=function(r){return mi.current.useDeferredValue(r)};bt.useEffect=function(r,o){return mi.current.useEffect(r,o)};bt.useId=function(){return mi.current.useId()};bt.useImperativeHandle=function(r,o,u){return mi.current.useImperativeHandle(r,o,u)};bt.useInsertionEffect=function(r,o){return mi.current.useInsertionEffect(r,o)};bt.useLayoutEffect=function(r,o){return mi.current.useLayoutEffect(r,o)};bt.useMemo=function(r,o){return mi.current.useMemo(r,o)};bt.useReducer=function(r,o,u){return mi.current.useReducer(r,o,u)};bt.useRef=function(r){return mi.current.useRef(r)};bt.useState=function(r){return mi.current.useState(r)};bt.useSyncExternalStore=function(r,o,u){return mi.current.useSyncExternalStore(r,o,u)};bt.useTransition=function(){return mi.current.useTransition()};bt.version="18.3.1";E2.exports=bt;var An=E2.exports;const KI=NI(An);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JI=An,$I=Symbol.for("react.element"),e4=Symbol.for("react.fragment"),t4=Object.prototype.hasOwnProperty,n4=JI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i4={key:!0,ref:!0,__self:!0,__source:!0};function N2(r,o,u){var p,v={},b=null,M=null;u!==void 0&&(b=""+u),o.key!==void 0&&(b=""+o.key),o.ref!==void 0&&(M=o.ref);for(p in o)t4.call(o,p)&&!i4.hasOwnProperty(p)&&(v[p]=o[p]);if(r&&r.defaultProps)for(p in o=r.defaultProps,o)v[p]===void 0&&(v[p]=o[p]);return{$$typeof:$I,type:r,key:b,ref:M,props:v,_owner:n4.current}}Tf.Fragment=e4;Tf.jsx=N2;Tf.jsxs=N2;T2.exports=Tf;var Gt=T2.exports;var Tv={},k2={exports:{}},Vi={},F2={exports:{}},U2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function o(Ye,it){var lt=Ye.length;Ye.push(it);e:for(;0<lt;){var Zt=lt-1>>>1,cn=Ye[Zt];if(0<v(cn,it))Ye[Zt]=it,Ye[lt]=cn,lt=Zt;else break e}}function u(Ye){return Ye.length===0?null:Ye[0]}function p(Ye){if(Ye.length===0)return null;var it=Ye[0],lt=Ye.pop();if(lt!==it){Ye[0]=lt;e:for(var Zt=0,cn=Ye.length,La=cn>>>1;Zt<La;){var Dr=2*(Zt+1)-1,Pa=Ye[Dr],lr=Dr+1,Ca=Ye[lr];if(0>v(Pa,lt))lr<cn&&0>v(Ca,Pa)?(Ye[Zt]=Ca,Ye[lr]=lt,Zt=lr):(Ye[Zt]=Pa,Ye[Dr]=lt,Zt=Dr);else if(lr<cn&&0>v(Ca,lt))Ye[Zt]=Ca,Ye[lr]=lt,Zt=lr;else break e}}return it}function v(Ye,it){var lt=Ye.sortIndex-it.sortIndex;return lt!==0?lt:Ye.id-it.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;r.unstable_now=function(){return b.now()}}else{var M=Date,L=M.now();r.unstable_now=function(){return M.now()-L}}var k=[],j=[],J=1,ie=null,he=3,Ee=!1,me=!1,be=!1,ke=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ne(Ye){for(var it=u(j);it!==null;){if(it.callback===null)p(j);else if(it.startTime<=Ye)p(j),it.sortIndex=it.expirationTime,o(k,it);else break;it=u(j)}}function D(Ye){if(be=!1,ne(Ye),!me)if(u(k)!==null)me=!0,or(Q);else{var it=u(j);it!==null&&ko(D,it.startTime-Ye)}}function Q(Ye,it){me=!1,be&&(be=!1,$(Me),Me=-1),Ee=!0;var lt=he;try{for(ne(it),ie=u(k);ie!==null&&(!(ie.expirationTime>it)||Ye&&!ot());){var Zt=ie.callback;if(typeof Zt=="function"){ie.callback=null,he=ie.priorityLevel;var cn=Zt(ie.expirationTime<=it);it=r.unstable_now(),typeof cn=="function"?ie.callback=cn:ie===u(k)&&p(k),ne(it)}else p(k);ie=u(k)}if(ie!==null)var La=!0;else{var Dr=u(j);Dr!==null&&ko(D,Dr.startTime-it),La=!1}return La}finally{ie=null,he=lt,Ee=!1}}var se=!1,ye=null,Me=-1,Xe=5,Be=-1;function ot(){return!(r.unstable_now()-Be<Xe)}function xn(){if(ye!==null){var Ye=r.unstable_now();Be=Ye;var it=!0;try{it=ye(!0,Ye)}finally{it?ai():(se=!1,ye=null)}}else se=!1}var ai;if(typeof X=="function")ai=function(){X(xn)};else if(typeof MessageChannel<"u"){var ar=new MessageChannel,Ra=ar.port2;ar.port1.onmessage=xn,ai=function(){Ra.postMessage(null)}}else ai=function(){ke(xn,0)};function or(Ye){ye=Ye,se||(se=!0,ai())}function ko(Ye,it){Me=ke(function(){Ye(r.unstable_now())},it)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Ye){Ye.callback=null},r.unstable_continueExecution=function(){me||Ee||(me=!0,or(Q))},r.unstable_forceFrameRate=function(Ye){0>Ye||125<Ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Xe=0<Ye?Math.floor(1e3/Ye):5},r.unstable_getCurrentPriorityLevel=function(){return he},r.unstable_getFirstCallbackNode=function(){return u(k)},r.unstable_next=function(Ye){switch(he){case 1:case 2:case 3:var it=3;break;default:it=he}var lt=he;he=it;try{return Ye()}finally{he=lt}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Ye,it){switch(Ye){case 1:case 2:case 3:case 4:case 5:break;default:Ye=3}var lt=he;he=Ye;try{return it()}finally{he=lt}},r.unstable_scheduleCallback=function(Ye,it,lt){var Zt=r.unstable_now();switch(typeof lt=="object"&&lt!==null?(lt=lt.delay,lt=typeof lt=="number"&&0<lt?Zt+lt:Zt):lt=Zt,Ye){case 1:var cn=-1;break;case 2:cn=250;break;case 5:cn=1073741823;break;case 4:cn=1e4;break;default:cn=5e3}return cn=lt+cn,Ye={id:J++,callback:it,priorityLevel:Ye,startTime:lt,expirationTime:cn,sortIndex:-1},lt>Zt?(Ye.sortIndex=lt,o(j,Ye),u(k)===null&&Ye===u(j)&&(be?($(Me),Me=-1):be=!0,ko(D,lt-Zt))):(Ye.sortIndex=cn,o(k,Ye),me||Ee||(me=!0,or(Q))),Ye},r.unstable_shouldYield=ot,r.unstable_wrapCallback=function(Ye){var it=he;return function(){var lt=he;he=it;try{return Ye.apply(this,arguments)}finally{he=lt}}}})(U2);F2.exports=U2;var r4=F2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s4=An,Gi=r4;function Ue(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z2=new Set,Vu={};function Io(r,o){ic(r,o),ic(r+"Capture",o)}function ic(r,o){for(Vu[r]=o,r=0;r<o.length;r++)z2.add(o[r])}var As=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ev=Object.prototype.hasOwnProperty,a4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Q_={},Z_={};function o4(r){return Ev.call(Z_,r)?!0:Ev.call(Q_,r)?!1:a4.test(r)?Z_[r]=!0:(Q_[r]=!0,!1)}function l4(r,o,u,p){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return p?!1:u!==null?!u.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function c4(r,o,u,p){if(o===null||typeof o>"u"||l4(r,o,u,p))return!0;if(p)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function gi(r,o,u,p,v,b,M){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=p,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=r,this.type=o,this.sanitizeURL=b,this.removeEmptyString=M}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Vn[r]=new gi(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];Vn[o]=new gi(o,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Vn[r]=new gi(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Vn[r]=new gi(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Vn[r]=new gi(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Vn[r]=new gi(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Vn[r]=new gi(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Vn[r]=new gi(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Vn[r]=new gi(r,5,!1,r.toLowerCase(),null,!1,!1)});var P1=/[\-:]([a-z])/g;function C1(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(P1,C1);Vn[o]=new gi(o,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(P1,C1);Vn[o]=new gi(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(P1,C1);Vn[o]=new gi(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Vn[r]=new gi(r,1,!1,r.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new gi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Vn[r]=new gi(r,1,!1,r.toLowerCase(),null,!0,!0)});function D1(r,o,u,p){var v=Vn.hasOwnProperty(o)?Vn[o]:null;(v!==null?v.type!==0:p||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(c4(o,u,v,p)&&(u=null),p||v===null?o4(o)&&(u===null?r.removeAttribute(o):r.setAttribute(o,""+u)):v.mustUseProperty?r[v.propertyName]=u===null?v.type===3?!1:"":u:(o=v.attributeName,p=v.attributeNamespace,u===null?r.removeAttribute(o):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,p?r.setAttributeNS(p,o,u):r.setAttribute(o,u))))}var Cs=s4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dp=Symbol.for("react.element"),zl=Symbol.for("react.portal"),Bl=Symbol.for("react.fragment"),O1=Symbol.for("react.strict_mode"),Av=Symbol.for("react.profiler"),B2=Symbol.for("react.provider"),j2=Symbol.for("react.context"),I1=Symbol.for("react.forward_ref"),Rv=Symbol.for("react.suspense"),Lv=Symbol.for("react.suspense_list"),N1=Symbol.for("react.memo"),la=Symbol.for("react.lazy"),H2=Symbol.for("react.offscreen"),K_=Symbol.iterator;function xu(r){return r===null||typeof r!="object"?null:(r=K_&&r[K_]||r["@@iterator"],typeof r=="function"?r:null)}var sn=Object.assign,Qg;function Lu(r){if(Qg===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Qg=o&&o[1]||""}return`
`+Qg+r}var Zg=!1;function Kg(r,o){if(!r||Zg)return"";Zg=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(j){var p=j}Reflect.construct(r,[],o)}else{try{o.call()}catch(j){p=j}r.call(o.prototype)}else{try{throw Error()}catch(j){p=j}r()}}catch(j){if(j&&p&&typeof j.stack=="string"){for(var v=j.stack.split(`
`),b=p.stack.split(`
`),M=v.length-1,L=b.length-1;1<=M&&0<=L&&v[M]!==b[L];)L--;for(;1<=M&&0<=L;M--,L--)if(v[M]!==b[L]){if(M!==1||L!==1)do if(M--,L--,0>L||v[M]!==b[L]){var k=`
`+v[M].replace(" at new "," at ");return r.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",r.displayName)),k}while(1<=M&&0<=L);break}}}finally{Zg=!1,Error.prepareStackTrace=u}return(r=r?r.displayName||r.name:"")?Lu(r):""}function u4(r){switch(r.tag){case 5:return Lu(r.type);case 16:return Lu("Lazy");case 13:return Lu("Suspense");case 19:return Lu("SuspenseList");case 0:case 2:case 15:return r=Kg(r.type,!1),r;case 11:return r=Kg(r.type.render,!1),r;case 1:return r=Kg(r.type,!0),r;default:return""}}function Pv(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case Bl:return"Fragment";case zl:return"Portal";case Av:return"Profiler";case O1:return"StrictMode";case Rv:return"Suspense";case Lv:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case j2:return(r.displayName||"Context")+".Consumer";case B2:return(r._context.displayName||"Context")+".Provider";case I1:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case N1:return o=r.displayName||null,o!==null?o:Pv(r.type)||"Memo";case la:o=r._payload,r=r._init;try{return Pv(r(o))}catch{}}return null}function h4(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pv(o);case 8:return o===O1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function wa(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function G2(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function d4(r){var o=G2(r)?"checked":"value",u=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),p=""+r[o];if(!r.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,b=u.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return v.call(this)},set:function(M){p=""+M,b.call(this,M)}}),Object.defineProperty(r,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(M){p=""+M},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function pp(r){r._valueTracker||(r._valueTracker=d4(r))}function V2(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return r&&(p=G2(r)?r.checked?"true":"false":r.value),r=p,r!==u?(o.setValue(r),!0):!1}function Yp(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Cv(r,o){var u=o.checked;return sn({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??r._wrapperState.initialChecked})}function J_(r,o){var u=o.defaultValue==null?"":o.defaultValue,p=o.checked!=null?o.checked:o.defaultChecked;u=wa(o.value!=null?o.value:u),r._wrapperState={initialChecked:p,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function W2(r,o){o=o.checked,o!=null&&D1(r,"checked",o,!1)}function Dv(r,o){W2(r,o);var u=wa(o.value),p=o.type;if(u!=null)p==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+u):r.value!==""+u&&(r.value=""+u);else if(p==="submit"||p==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?Ov(r,o.type,u):o.hasOwnProperty("defaultValue")&&Ov(r,o.type,wa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function $_(r,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var p=o.type;if(!(p!=="submit"&&p!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,u||o===r.value||(r.value=o),r.defaultValue=o}u=r.name,u!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,u!==""&&(r.name=u)}function Ov(r,o,u){(o!=="number"||Yp(r.ownerDocument)!==r)&&(u==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+u&&(r.defaultValue=""+u))}var Pu=Array.isArray;function Kl(r,o,u,p){if(r=r.options,o){o={};for(var v=0;v<u.length;v++)o["$"+u[v]]=!0;for(u=0;u<r.length;u++)v=o.hasOwnProperty("$"+r[u].value),r[u].selected!==v&&(r[u].selected=v),v&&p&&(r[u].defaultSelected=!0)}else{for(u=""+wa(u),o=null,v=0;v<r.length;v++){if(r[v].value===u){r[v].selected=!0,p&&(r[v].defaultSelected=!0);return}o!==null||r[v].disabled||(o=r[v])}o!==null&&(o.selected=!0)}}function Iv(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Ue(91));return sn({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function eM(r,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(Ue(92));if(Pu(u)){if(1<u.length)throw Error(Ue(93));u=u[0]}o=u}o==null&&(o=""),u=o}r._wrapperState={initialValue:wa(u)}}function X2(r,o){var u=wa(o.value),p=wa(o.defaultValue);u!=null&&(u=""+u,u!==r.value&&(r.value=u),o.defaultValue==null&&r.defaultValue!==u&&(r.defaultValue=u)),p!=null&&(r.defaultValue=""+p)}function tM(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function q2(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nv(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?q2(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var fp,Y2=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,p,v){MSApp.execUnsafeLocalFunction(function(){return r(o,u,p,v)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(fp=fp||document.createElement("div"),fp.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=fp.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function Wu(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var Ou={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},p4=["Webkit","ms","Moz","O"];Object.keys(Ou).forEach(function(r){p4.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),Ou[o]=Ou[r]})});function Q2(r,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||Ou.hasOwnProperty(r)&&Ou[r]?(""+o).trim():o+"px"}function Z2(r,o){r=r.style;for(var u in o)if(o.hasOwnProperty(u)){var p=u.indexOf("--")===0,v=Q2(u,o[u],p);u==="float"&&(u="cssFloat"),p?r.setProperty(u,v):r[u]=v}}var f4=sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kv(r,o){if(o){if(f4[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Ue(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Ue(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Ue(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Ue(62))}}function Fv(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uv=null;function k1(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var zv=null,Jl=null,$l=null;function nM(r){if(r=hh(r)){if(typeof zv!="function")throw Error(Ue(280));var o=r.stateNode;o&&(o=Pf(o),zv(r.stateNode,r.type,o))}}function K2(r){Jl?$l?$l.push(r):$l=[r]:Jl=r}function J2(){if(Jl){var r=Jl,o=$l;if($l=Jl=null,nM(r),o)for(r=0;r<o.length;r++)nM(o[r])}}function $2(r,o){return r(o)}function eT(){}var Jg=!1;function tT(r,o,u){if(Jg)return r(o,u);Jg=!0;try{return $2(r,o,u)}finally{Jg=!1,(Jl!==null||$l!==null)&&(eT(),J2())}}function Xu(r,o){var u=r.stateNode;if(u===null)return null;var p=Pf(u);if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(r=r.type,p=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!p;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(Ue(231,o,typeof u));return u}var Bv=!1;if(As)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){Bv=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{Bv=!1}function m4(r,o,u,p,v,b,M,L,k){var j=Array.prototype.slice.call(arguments,3);try{o.apply(u,j)}catch(J){this.onError(J)}}var Iu=!1,Qp=null,Zp=!1,jv=null,g4={onError:function(r){Iu=!0,Qp=r}};function v4(r,o,u,p,v,b,M,L,k){Iu=!1,Qp=null,m4.apply(g4,arguments)}function y4(r,o,u,p,v,b,M,L,k){if(v4.apply(this,arguments),Iu){if(Iu){var j=Qp;Iu=!1,Qp=null}else throw Error(Ue(198));Zp||(Zp=!0,jv=j)}}function No(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function nT(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function iM(r){if(No(r)!==r)throw Error(Ue(188))}function x4(r){var o=r.alternate;if(!o){if(o=No(r),o===null)throw Error(Ue(188));return o!==r?null:r}for(var u=r,p=o;;){var v=u.return;if(v===null)break;var b=v.alternate;if(b===null){if(p=v.return,p!==null){u=p;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===u)return iM(v),r;if(b===p)return iM(v),o;b=b.sibling}throw Error(Ue(188))}if(u.return!==p.return)u=v,p=b;else{for(var M=!1,L=v.child;L;){if(L===u){M=!0,u=v,p=b;break}if(L===p){M=!0,p=v,u=b;break}L=L.sibling}if(!M){for(L=b.child;L;){if(L===u){M=!0,u=b,p=v;break}if(L===p){M=!0,p=b,u=v;break}L=L.sibling}if(!M)throw Error(Ue(189))}}if(u.alternate!==p)throw Error(Ue(190))}if(u.tag!==3)throw Error(Ue(188));return u.stateNode.current===u?r:o}function iT(r){return r=x4(r),r!==null?rT(r):null}function rT(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=rT(r);if(o!==null)return o;r=r.sibling}return null}var sT=Gi.unstable_scheduleCallback,rM=Gi.unstable_cancelCallback,b4=Gi.unstable_shouldYield,S4=Gi.unstable_requestPaint,pn=Gi.unstable_now,w4=Gi.unstable_getCurrentPriorityLevel,F1=Gi.unstable_ImmediatePriority,aT=Gi.unstable_UserBlockingPriority,Kp=Gi.unstable_NormalPriority,_4=Gi.unstable_LowPriority,oT=Gi.unstable_IdlePriority,Ef=null,Zr=null;function M4(r){if(Zr&&typeof Zr.onCommitFiberRoot=="function")try{Zr.onCommitFiberRoot(Ef,r,void 0,(r.current.flags&128)===128)}catch{}}var Ar=Math.clz32?Math.clz32:A4,T4=Math.log,E4=Math.LN2;function A4(r){return r>>>=0,r===0?32:31-(T4(r)/E4|0)|0}var mp=64,gp=4194304;function Cu(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Jp(r,o){var u=r.pendingLanes;if(u===0)return 0;var p=0,v=r.suspendedLanes,b=r.pingedLanes,M=u&268435455;if(M!==0){var L=M&~v;L!==0?p=Cu(L):(b&=M,b!==0&&(p=Cu(b)))}else M=u&~v,M!==0?p=Cu(M):b!==0&&(p=Cu(b));if(p===0)return 0;if(o!==0&&o!==p&&!(o&v)&&(v=p&-p,b=o&-o,v>=b||v===16&&(b&4194240)!==0))return o;if(p&4&&(p|=u&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=p;0<o;)u=31-Ar(o),v=1<<u,p|=r[u],o&=~v;return p}function R4(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L4(r,o){for(var u=r.suspendedLanes,p=r.pingedLanes,v=r.expirationTimes,b=r.pendingLanes;0<b;){var M=31-Ar(b),L=1<<M,k=v[M];k===-1?(!(L&u)||L&p)&&(v[M]=R4(L,o)):k<=o&&(r.expiredLanes|=L),b&=~L}}function Hv(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function lT(){var r=mp;return mp<<=1,!(mp&4194240)&&(mp=64),r}function $g(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function ch(r,o,u){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-Ar(o),r[o]=u}function P4(r,o){var u=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var p=r.eventTimes;for(r=r.expirationTimes;0<u;){var v=31-Ar(u),b=1<<v;o[v]=0,p[v]=-1,r[v]=-1,u&=~b}}function U1(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var p=31-Ar(u),v=1<<p;v&o|r[p]&o&&(r[p]|=o),u&=~v}}var Nt=0;function cT(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var uT,z1,hT,dT,pT,Gv=!1,vp=[],fa=null,ma=null,ga=null,qu=new Map,Yu=new Map,ua=[],C4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sM(r,o){switch(r){case"focusin":case"focusout":fa=null;break;case"dragenter":case"dragleave":ma=null;break;case"mouseover":case"mouseout":ga=null;break;case"pointerover":case"pointerout":qu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yu.delete(o.pointerId)}}function Su(r,o,u,p,v,b){return r===null||r.nativeEvent!==b?(r={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:b,targetContainers:[v]},o!==null&&(o=hh(o),o!==null&&z1(o)),r):(r.eventSystemFlags|=p,o=r.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),r)}function D4(r,o,u,p,v){switch(o){case"focusin":return fa=Su(fa,r,o,u,p,v),!0;case"dragenter":return ma=Su(ma,r,o,u,p,v),!0;case"mouseover":return ga=Su(ga,r,o,u,p,v),!0;case"pointerover":var b=v.pointerId;return qu.set(b,Su(qu.get(b)||null,r,o,u,p,v)),!0;case"gotpointercapture":return b=v.pointerId,Yu.set(b,Su(Yu.get(b)||null,r,o,u,p,v)),!0}return!1}function fT(r){var o=wo(r.target);if(o!==null){var u=No(o);if(u!==null){if(o=u.tag,o===13){if(o=nT(u),o!==null){r.blockedOn=o,pT(r.priority,function(){hT(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ip(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=Vv(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(u===null){u=r.nativeEvent;var p=new u.constructor(u.type,u);Uv=p,u.target.dispatchEvent(p),Uv=null}else return o=hh(u),o!==null&&z1(o),r.blockedOn=u,!1;o.shift()}return!0}function aM(r,o,u){Ip(r)&&u.delete(o)}function O4(){Gv=!1,fa!==null&&Ip(fa)&&(fa=null),ma!==null&&Ip(ma)&&(ma=null),ga!==null&&Ip(ga)&&(ga=null),qu.forEach(aM),Yu.forEach(aM)}function wu(r,o){r.blockedOn===o&&(r.blockedOn=null,Gv||(Gv=!0,Gi.unstable_scheduleCallback(Gi.unstable_NormalPriority,O4)))}function Qu(r){function o(v){return wu(v,r)}if(0<vp.length){wu(vp[0],r);for(var u=1;u<vp.length;u++){var p=vp[u];p.blockedOn===r&&(p.blockedOn=null)}}for(fa!==null&&wu(fa,r),ma!==null&&wu(ma,r),ga!==null&&wu(ga,r),qu.forEach(o),Yu.forEach(o),u=0;u<ua.length;u++)p=ua[u],p.blockedOn===r&&(p.blockedOn=null);for(;0<ua.length&&(u=ua[0],u.blockedOn===null);)fT(u),u.blockedOn===null&&ua.shift()}var ec=Cs.ReactCurrentBatchConfig,$p=!0;function I4(r,o,u,p){var v=Nt,b=ec.transition;ec.transition=null;try{Nt=1,B1(r,o,u,p)}finally{Nt=v,ec.transition=b}}function N4(r,o,u,p){var v=Nt,b=ec.transition;ec.transition=null;try{Nt=4,B1(r,o,u,p)}finally{Nt=v,ec.transition=b}}function B1(r,o,u,p){if($p){var v=Vv(r,o,u,p);if(v===null)cv(r,o,p,ef,u),sM(r,p);else if(D4(v,r,o,u,p))p.stopPropagation();else if(sM(r,p),o&4&&-1<C4.indexOf(r)){for(;v!==null;){var b=hh(v);if(b!==null&&uT(b),b=Vv(r,o,u,p),b===null&&cv(r,o,p,ef,u),b===v)break;v=b}v!==null&&p.stopPropagation()}else cv(r,o,p,null,u)}}var ef=null;function Vv(r,o,u,p){if(ef=null,r=k1(p),r=wo(r),r!==null)if(o=No(r),o===null)r=null;else if(u=o.tag,u===13){if(r=nT(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return ef=r,null}function mT(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(w4()){case F1:return 1;case aT:return 4;case Kp:case _4:return 16;case oT:return 536870912;default:return 16}default:return 16}}var da=null,j1=null,Np=null;function gT(){if(Np)return Np;var r,o=j1,u=o.length,p,v="value"in da?da.value:da.textContent,b=v.length;for(r=0;r<u&&o[r]===v[r];r++);var M=u-r;for(p=1;p<=M&&o[u-p]===v[b-p];p++);return Np=v.slice(r,1<p?1-p:void 0)}function kp(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function yp(){return!0}function oM(){return!1}function Wi(r){function o(u,p,v,b,M){this._reactName=u,this._targetInst=v,this.type=p,this.nativeEvent=b,this.target=M,this.currentTarget=null;for(var L in r)r.hasOwnProperty(L)&&(u=r[L],this[L]=u?u(b):b[L]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?yp:oM,this.isPropagationStopped=oM,this}return sn(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=yp)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=yp)},persist:function(){},isPersistent:yp}),o}var hc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},H1=Wi(hc),uh=sn({},hc,{view:0,detail:0}),k4=Wi(uh),ev,tv,_u,Af=sn({},uh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:G1,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==_u&&(_u&&r.type==="mousemove"?(ev=r.screenX-_u.screenX,tv=r.screenY-_u.screenY):tv=ev=0,_u=r),ev)},movementY:function(r){return"movementY"in r?r.movementY:tv}}),lM=Wi(Af),F4=sn({},Af,{dataTransfer:0}),U4=Wi(F4),z4=sn({},uh,{relatedTarget:0}),nv=Wi(z4),B4=sn({},hc,{animationName:0,elapsedTime:0,pseudoElement:0}),j4=Wi(B4),H4=sn({},hc,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),G4=Wi(H4),V4=sn({},hc,{data:0}),cM=Wi(V4),W4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},q4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Y4(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=q4[r])?!!o[r]:!1}function G1(){return Y4}var Q4=sn({},uh,{key:function(r){if(r.key){var o=W4[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=kp(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?X4[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:G1,charCode:function(r){return r.type==="keypress"?kp(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?kp(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Z4=Wi(Q4),K4=sn({},Af,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uM=Wi(K4),J4=sn({},uh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:G1}),$4=Wi(J4),eN=sn({},hc,{propertyName:0,elapsedTime:0,pseudoElement:0}),tN=Wi(eN),nN=sn({},Af,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),iN=Wi(nN),rN=[9,13,27,32],V1=As&&"CompositionEvent"in window,Nu=null;As&&"documentMode"in document&&(Nu=document.documentMode);var sN=As&&"TextEvent"in window&&!Nu,vT=As&&(!V1||Nu&&8<Nu&&11>=Nu),hM=String.fromCharCode(32),dM=!1;function yT(r,o){switch(r){case"keyup":return rN.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xT(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var jl=!1;function aN(r,o){switch(r){case"compositionend":return xT(o);case"keypress":return o.which!==32?null:(dM=!0,hM);case"textInput":return r=o.data,r===hM&&dM?null:r;default:return null}}function oN(r,o){if(jl)return r==="compositionend"||!V1&&yT(r,o)?(r=gT(),Np=j1=da=null,jl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return vT&&o.locale!=="ko"?null:o.data;default:return null}}var lN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pM(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!lN[r.type]:o==="textarea"}function bT(r,o,u,p){K2(p),o=tf(o,"onChange"),0<o.length&&(u=new H1("onChange","change",null,u,p),r.push({event:u,listeners:o}))}var ku=null,Zu=null;function cN(r){CT(r,0)}function Rf(r){var o=Vl(r);if(V2(o))return r}function uN(r,o){if(r==="change")return o}var ST=!1;if(As){var iv;if(As){var rv="oninput"in document;if(!rv){var fM=document.createElement("div");fM.setAttribute("oninput","return;"),rv=typeof fM.oninput=="function"}iv=rv}else iv=!1;ST=iv&&(!document.documentMode||9<document.documentMode)}function mM(){ku&&(ku.detachEvent("onpropertychange",wT),Zu=ku=null)}function wT(r){if(r.propertyName==="value"&&Rf(Zu)){var o=[];bT(o,Zu,r,k1(r)),tT(cN,o)}}function hN(r,o,u){r==="focusin"?(mM(),ku=o,Zu=u,ku.attachEvent("onpropertychange",wT)):r==="focusout"&&mM()}function dN(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Rf(Zu)}function pN(r,o){if(r==="click")return Rf(o)}function fN(r,o){if(r==="input"||r==="change")return Rf(o)}function mN(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Pr=typeof Object.is=="function"?Object.is:mN;function Ku(r,o){if(Pr(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var v=u[p];if(!Ev.call(o,v)||!Pr(r[v],o[v]))return!1}return!0}function gM(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function vM(r,o){var u=gM(r);r=0;for(var p;u;){if(u.nodeType===3){if(p=r+u.textContent.length,r<=o&&p>=o)return{node:u,offset:o-r};r=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=gM(u)}}function _T(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?_T(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function MT(){for(var r=window,o=Yp();o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=Yp(r.document)}return o}function W1(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function gN(r){var o=MT(),u=r.focusedElem,p=r.selectionRange;if(o!==u&&u&&u.ownerDocument&&_T(u.ownerDocument.documentElement,u)){if(p!==null&&W1(u)){if(o=p.start,r=p.end,r===void 0&&(r=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(r,u.value.length);else if(r=(o=u.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var v=u.textContent.length,b=Math.min(p.start,v);p=p.end===void 0?b:Math.min(p.end,v),!r.extend&&b>p&&(v=p,p=b,b=v),v=vM(u,b);var M=vM(u,p);v&&M&&(r.rangeCount!==1||r.anchorNode!==v.node||r.anchorOffset!==v.offset||r.focusNode!==M.node||r.focusOffset!==M.offset)&&(o=o.createRange(),o.setStart(v.node,v.offset),r.removeAllRanges(),b>p?(r.addRange(o),r.extend(M.node,M.offset)):(o.setEnd(M.node,M.offset),r.addRange(o)))}}for(o=[],r=u;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)r=o[u],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var vN=As&&"documentMode"in document&&11>=document.documentMode,Hl=null,Wv=null,Fu=null,Xv=!1;function yM(r,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Xv||Hl==null||Hl!==Yp(p)||(p=Hl,"selectionStart"in p&&W1(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Fu&&Ku(Fu,p)||(Fu=p,p=tf(Wv,"onSelect"),0<p.length&&(o=new H1("onSelect","select",null,o,u),r.push({event:o,listeners:p}),o.target=Hl)))}function xp(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var Gl={animationend:xp("Animation","AnimationEnd"),animationiteration:xp("Animation","AnimationIteration"),animationstart:xp("Animation","AnimationStart"),transitionend:xp("Transition","TransitionEnd")},sv={},TT={};As&&(TT=document.createElement("div").style,"AnimationEvent"in window||(delete Gl.animationend.animation,delete Gl.animationiteration.animation,delete Gl.animationstart.animation),"TransitionEvent"in window||delete Gl.transitionend.transition);function Lf(r){if(sv[r])return sv[r];if(!Gl[r])return r;var o=Gl[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in TT)return sv[r]=o[u];return r}var ET=Lf("animationend"),AT=Lf("animationiteration"),RT=Lf("animationstart"),LT=Lf("transitionend"),PT=new Map,xM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ma(r,o){PT.set(r,o),Io(o,[r])}for(var av=0;av<xM.length;av++){var ov=xM[av],yN=ov.toLowerCase(),xN=ov[0].toUpperCase()+ov.slice(1);Ma(yN,"on"+xN)}Ma(ET,"onAnimationEnd");Ma(AT,"onAnimationIteration");Ma(RT,"onAnimationStart");Ma("dblclick","onDoubleClick");Ma("focusin","onFocus");Ma("focusout","onBlur");Ma(LT,"onTransitionEnd");ic("onMouseEnter",["mouseout","mouseover"]);ic("onMouseLeave",["mouseout","mouseover"]);ic("onPointerEnter",["pointerout","pointerover"]);ic("onPointerLeave",["pointerout","pointerover"]);Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Io("onBeforeInput",["compositionend","keypress","textInput","paste"]);Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Du));function bM(r,o,u){var p=r.type||"unknown-event";r.currentTarget=u,y4(p,o,void 0,r),r.currentTarget=null}function CT(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var p=r[u],v=p.event;p=p.listeners;e:{var b=void 0;if(o)for(var M=p.length-1;0<=M;M--){var L=p[M],k=L.instance,j=L.currentTarget;if(L=L.listener,k!==b&&v.isPropagationStopped())break e;bM(v,L,j),b=k}else for(M=0;M<p.length;M++){if(L=p[M],k=L.instance,j=L.currentTarget,L=L.listener,k!==b&&v.isPropagationStopped())break e;bM(v,L,j),b=k}}}if(Zp)throw r=jv,Zp=!1,jv=null,r}function qt(r,o){var u=o[Kv];u===void 0&&(u=o[Kv]=new Set);var p=r+"__bubble";u.has(p)||(DT(o,r,2,!1),u.add(p))}function lv(r,o,u){var p=0;o&&(p|=4),DT(u,r,p,o)}var bp="_reactListening"+Math.random().toString(36).slice(2);function Ju(r){if(!r[bp]){r[bp]=!0,z2.forEach(function(u){u!=="selectionchange"&&(bN.has(u)||lv(u,!1,r),lv(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[bp]||(o[bp]=!0,lv("selectionchange",!1,o))}}function DT(r,o,u,p){switch(mT(o)){case 1:var v=I4;break;case 4:v=N4;break;default:v=B1}u=v.bind(null,o,u,r),v=void 0,!Bv||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?r.addEventListener(o,u,{capture:!0,passive:v}):r.addEventListener(o,u,!0):v!==void 0?r.addEventListener(o,u,{passive:v}):r.addEventListener(o,u,!1)}function cv(r,o,u,p,v){var b=p;if(!(o&1)&&!(o&2)&&p!==null)e:for(;;){if(p===null)return;var M=p.tag;if(M===3||M===4){var L=p.stateNode.containerInfo;if(L===v||L.nodeType===8&&L.parentNode===v)break;if(M===4)for(M=p.return;M!==null;){var k=M.tag;if((k===3||k===4)&&(k=M.stateNode.containerInfo,k===v||k.nodeType===8&&k.parentNode===v))return;M=M.return}for(;L!==null;){if(M=wo(L),M===null)return;if(k=M.tag,k===5||k===6){p=b=M;continue e}L=L.parentNode}}p=p.return}tT(function(){var j=b,J=k1(u),ie=[];e:{var he=PT.get(r);if(he!==void 0){var Ee=H1,me=r;switch(r){case"keypress":if(kp(u)===0)break e;case"keydown":case"keyup":Ee=Z4;break;case"focusin":me="focus",Ee=nv;break;case"focusout":me="blur",Ee=nv;break;case"beforeblur":case"afterblur":Ee=nv;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=lM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=U4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=$4;break;case ET:case AT:case RT:Ee=j4;break;case LT:Ee=tN;break;case"scroll":Ee=k4;break;case"wheel":Ee=iN;break;case"copy":case"cut":case"paste":Ee=G4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=uM}var be=(o&4)!==0,ke=!be&&r==="scroll",$=be?he!==null?he+"Capture":null:he;be=[];for(var X=j,ne;X!==null;){ne=X;var D=ne.stateNode;if(ne.tag===5&&D!==null&&(ne=D,$!==null&&(D=Xu(X,$),D!=null&&be.push($u(X,D,ne)))),ke)break;X=X.return}0<be.length&&(he=new Ee(he,me,null,u,J),ie.push({event:he,listeners:be}))}}if(!(o&7)){e:{if(he=r==="mouseover"||r==="pointerover",Ee=r==="mouseout"||r==="pointerout",he&&u!==Uv&&(me=u.relatedTarget||u.fromElement)&&(wo(me)||me[Rs]))break e;if((Ee||he)&&(he=J.window===J?J:(he=J.ownerDocument)?he.defaultView||he.parentWindow:window,Ee?(me=u.relatedTarget||u.toElement,Ee=j,me=me?wo(me):null,me!==null&&(ke=No(me),me!==ke||me.tag!==5&&me.tag!==6)&&(me=null)):(Ee=null,me=j),Ee!==me)){if(be=lM,D="onMouseLeave",$="onMouseEnter",X="mouse",(r==="pointerout"||r==="pointerover")&&(be=uM,D="onPointerLeave",$="onPointerEnter",X="pointer"),ke=Ee==null?he:Vl(Ee),ne=me==null?he:Vl(me),he=new be(D,X+"leave",Ee,u,J),he.target=ke,he.relatedTarget=ne,D=null,wo(J)===j&&(be=new be($,X+"enter",me,u,J),be.target=ne,be.relatedTarget=ke,D=be),ke=D,Ee&&me)t:{for(be=Ee,$=me,X=0,ne=be;ne;ne=Ul(ne))X++;for(ne=0,D=$;D;D=Ul(D))ne++;for(;0<X-ne;)be=Ul(be),X--;for(;0<ne-X;)$=Ul($),ne--;for(;X--;){if(be===$||$!==null&&be===$.alternate)break t;be=Ul(be),$=Ul($)}be=null}else be=null;Ee!==null&&SM(ie,he,Ee,be,!1),me!==null&&ke!==null&&SM(ie,ke,me,be,!0)}}e:{if(he=j?Vl(j):window,Ee=he.nodeName&&he.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&he.type==="file")var Q=uN;else if(pM(he))if(ST)Q=fN;else{Q=dN;var se=hN}else(Ee=he.nodeName)&&Ee.toLowerCase()==="input"&&(he.type==="checkbox"||he.type==="radio")&&(Q=pN);if(Q&&(Q=Q(r,j))){bT(ie,Q,u,J);break e}se&&se(r,he,j),r==="focusout"&&(se=he._wrapperState)&&se.controlled&&he.type==="number"&&Ov(he,"number",he.value)}switch(se=j?Vl(j):window,r){case"focusin":(pM(se)||se.contentEditable==="true")&&(Hl=se,Wv=j,Fu=null);break;case"focusout":Fu=Wv=Hl=null;break;case"mousedown":Xv=!0;break;case"contextmenu":case"mouseup":case"dragend":Xv=!1,yM(ie,u,J);break;case"selectionchange":if(vN)break;case"keydown":case"keyup":yM(ie,u,J)}var ye;if(V1)e:{switch(r){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else jl?yT(r,u)&&(Me="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Me="onCompositionStart");Me&&(vT&&u.locale!=="ko"&&(jl||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&jl&&(ye=gT()):(da=J,j1="value"in da?da.value:da.textContent,jl=!0)),se=tf(j,Me),0<se.length&&(Me=new cM(Me,r,null,u,J),ie.push({event:Me,listeners:se}),ye?Me.data=ye:(ye=xT(u),ye!==null&&(Me.data=ye)))),(ye=sN?aN(r,u):oN(r,u))&&(j=tf(j,"onBeforeInput"),0<j.length&&(J=new cM("onBeforeInput","beforeinput",null,u,J),ie.push({event:J,listeners:j}),J.data=ye))}CT(ie,o)})}function $u(r,o,u){return{instance:r,listener:o,currentTarget:u}}function tf(r,o){for(var u=o+"Capture",p=[];r!==null;){var v=r,b=v.stateNode;v.tag===5&&b!==null&&(v=b,b=Xu(r,u),b!=null&&p.unshift($u(r,b,v)),b=Xu(r,o),b!=null&&p.push($u(r,b,v))),r=r.return}return p}function Ul(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function SM(r,o,u,p,v){for(var b=o._reactName,M=[];u!==null&&u!==p;){var L=u,k=L.alternate,j=L.stateNode;if(k!==null&&k===p)break;L.tag===5&&j!==null&&(L=j,v?(k=Xu(u,b),k!=null&&M.unshift($u(u,k,L))):v||(k=Xu(u,b),k!=null&&M.push($u(u,k,L)))),u=u.return}M.length!==0&&r.push({event:o,listeners:M})}var SN=/\r\n?/g,wN=/\u0000|\uFFFD/g;function wM(r){return(typeof r=="string"?r:""+r).replace(SN,`
`).replace(wN,"")}function Sp(r,o,u){if(o=wM(o),wM(r)!==o&&u)throw Error(Ue(425))}function nf(){}var qv=null,Yv=null;function Qv(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Zv=typeof setTimeout=="function"?setTimeout:void 0,_N=typeof clearTimeout=="function"?clearTimeout:void 0,_M=typeof Promise=="function"?Promise:void 0,MN=typeof queueMicrotask=="function"?queueMicrotask:typeof _M<"u"?function(r){return _M.resolve(null).then(r).catch(TN)}:Zv;function TN(r){setTimeout(function(){throw r})}function uv(r,o){var u=o,p=0;do{var v=u.nextSibling;if(r.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(p===0){r.removeChild(v),Qu(o);return}p--}else u!=="$"&&u!=="$?"&&u!=="$!"||p++;u=v}while(u);Qu(o)}function va(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function MM(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return r;o--}else u==="/$"&&o++}r=r.previousSibling}return null}var dc=Math.random().toString(36).slice(2),Qr="__reactFiber$"+dc,eh="__reactProps$"+dc,Rs="__reactContainer$"+dc,Kv="__reactEvents$"+dc,EN="__reactListeners$"+dc,AN="__reactHandles$"+dc;function wo(r){var o=r[Qr];if(o)return o;for(var u=r.parentNode;u;){if(o=u[Rs]||u[Qr]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=MM(r);r!==null;){if(u=r[Qr])return u;r=MM(r)}return o}r=u,u=r.parentNode}return null}function hh(r){return r=r[Qr]||r[Rs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Vl(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(Ue(33))}function Pf(r){return r[eh]||null}var Jv=[],Wl=-1;function Ta(r){return{current:r}}function Qt(r){0>Wl||(r.current=Jv[Wl],Jv[Wl]=null,Wl--)}function Vt(r,o){Wl++,Jv[Wl]=r.current,r.current=o}var _a={},si=Ta(_a),Ri=Ta(!1),Ro=_a;function rc(r,o){var u=r.type.contextTypes;if(!u)return _a;var p=r.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===o)return p.__reactInternalMemoizedMaskedChildContext;var v={},b;for(b in u)v[b]=o[b];return p&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=v),v}function Li(r){return r=r.childContextTypes,r!=null}function rf(){Qt(Ri),Qt(si)}function TM(r,o,u){if(si.current!==_a)throw Error(Ue(168));Vt(si,o),Vt(Ri,u)}function OT(r,o,u){var p=r.stateNode;if(o=o.childContextTypes,typeof p.getChildContext!="function")return u;p=p.getChildContext();for(var v in p)if(!(v in o))throw Error(Ue(108,h4(r)||"Unknown",v));return sn({},u,p)}function sf(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||_a,Ro=si.current,Vt(si,r),Vt(Ri,Ri.current),!0}function EM(r,o,u){var p=r.stateNode;if(!p)throw Error(Ue(169));u?(r=OT(r,o,Ro),p.__reactInternalMemoizedMergedChildContext=r,Qt(Ri),Qt(si),Vt(si,r)):Qt(Ri),Vt(Ri,u)}var ws=null,Cf=!1,hv=!1;function IT(r){ws===null?ws=[r]:ws.push(r)}function RN(r){Cf=!0,IT(r)}function Ea(){if(!hv&&ws!==null){hv=!0;var r=0,o=Nt;try{var u=ws;for(Nt=1;r<u.length;r++){var p=u[r];do p=p(!0);while(p!==null)}ws=null,Cf=!1}catch(v){throw ws!==null&&(ws=ws.slice(r+1)),sT(F1,Ea),v}finally{Nt=o,hv=!1}}return null}var Xl=[],ql=0,af=null,of=0,er=[],tr=0,Lo=null,_s=1,Ms="";function bo(r,o){Xl[ql++]=of,Xl[ql++]=af,af=r,of=o}function NT(r,o,u){er[tr++]=_s,er[tr++]=Ms,er[tr++]=Lo,Lo=r;var p=_s;r=Ms;var v=32-Ar(p)-1;p&=~(1<<v),u+=1;var b=32-Ar(o)+v;if(30<b){var M=v-v%5;b=(p&(1<<M)-1).toString(32),p>>=M,v-=M,_s=1<<32-Ar(o)+v|u<<v|p,Ms=b+r}else _s=1<<b|u<<v|p,Ms=r}function X1(r){r.return!==null&&(bo(r,1),NT(r,1,0))}function q1(r){for(;r===af;)af=Xl[--ql],Xl[ql]=null,of=Xl[--ql],Xl[ql]=null;for(;r===Lo;)Lo=er[--tr],er[tr]=null,Ms=er[--tr],er[tr]=null,_s=er[--tr],er[tr]=null}var ji=null,Bi=null,$t=!1,Er=null;function kT(r,o){var u=nr(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=r,o=r.deletions,o===null?(r.deletions=[u],r.flags|=16):o.push(u)}function AM(r,o){switch(r.tag){case 5:var u=r.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,ji=r,Bi=va(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,ji=r,Bi=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=Lo!==null?{id:_s,overflow:Ms}:null,r.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=nr(18,null,null,0),u.stateNode=o,u.return=r,r.child=u,ji=r,Bi=null,!0):!1;default:return!1}}function $v(r){return(r.mode&1)!==0&&(r.flags&128)===0}function e1(r){if($t){var o=Bi;if(o){var u=o;if(!AM(r,o)){if($v(r))throw Error(Ue(418));o=va(u.nextSibling);var p=ji;o&&AM(r,o)?kT(p,u):(r.flags=r.flags&-4097|2,$t=!1,ji=r)}}else{if($v(r))throw Error(Ue(418));r.flags=r.flags&-4097|2,$t=!1,ji=r}}}function RM(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;ji=r}function wp(r){if(r!==ji)return!1;if(!$t)return RM(r),$t=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!Qv(r.type,r.memoizedProps)),o&&(o=Bi)){if($v(r))throw FT(),Error(Ue(418));for(;o;)kT(r,o),o=va(o.nextSibling)}if(RM(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Ue(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"){if(o===0){Bi=va(r.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}r=r.nextSibling}Bi=null}}else Bi=ji?va(r.stateNode.nextSibling):null;return!0}function FT(){for(var r=Bi;r;)r=va(r.nextSibling)}function sc(){Bi=ji=null,$t=!1}function Y1(r){Er===null?Er=[r]:Er.push(r)}var LN=Cs.ReactCurrentBatchConfig;function Mu(r,o,u){if(r=u.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(Ue(309));var p=u.stateNode}if(!p)throw Error(Ue(147,r));var v=p,b=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===b?o.ref:(o=function(M){var L=v.refs;M===null?delete L[b]:L[b]=M},o._stringRef=b,o)}if(typeof r!="string")throw Error(Ue(284));if(!u._owner)throw Error(Ue(290,r))}return r}function _p(r,o){throw r=Object.prototype.toString.call(o),Error(Ue(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function LM(r){var o=r._init;return o(r._payload)}function UT(r){function o($,X){if(r){var ne=$.deletions;ne===null?($.deletions=[X],$.flags|=16):ne.push(X)}}function u($,X){if(!r)return null;for(;X!==null;)o($,X),X=X.sibling;return null}function p($,X){for($=new Map;X!==null;)X.key!==null?$.set(X.key,X):$.set(X.index,X),X=X.sibling;return $}function v($,X){return $=Sa($,X),$.index=0,$.sibling=null,$}function b($,X,ne){return $.index=ne,r?(ne=$.alternate,ne!==null?(ne=ne.index,ne<X?($.flags|=2,X):ne):($.flags|=2,X)):($.flags|=1048576,X)}function M($){return r&&$.alternate===null&&($.flags|=2),$}function L($,X,ne,D){return X===null||X.tag!==6?(X=yv(ne,$.mode,D),X.return=$,X):(X=v(X,ne),X.return=$,X)}function k($,X,ne,D){var Q=ne.type;return Q===Bl?J($,X,ne.props.children,D,ne.key):X!==null&&(X.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===la&&LM(Q)===X.type)?(D=v(X,ne.props),D.ref=Mu($,X,ne),D.return=$,D):(D=Gp(ne.type,ne.key,ne.props,null,$.mode,D),D.ref=Mu($,X,ne),D.return=$,D)}function j($,X,ne,D){return X===null||X.tag!==4||X.stateNode.containerInfo!==ne.containerInfo||X.stateNode.implementation!==ne.implementation?(X=xv(ne,$.mode,D),X.return=$,X):(X=v(X,ne.children||[]),X.return=$,X)}function J($,X,ne,D,Q){return X===null||X.tag!==7?(X=Ao(ne,$.mode,D,Q),X.return=$,X):(X=v(X,ne),X.return=$,X)}function ie($,X,ne){if(typeof X=="string"&&X!==""||typeof X=="number")return X=yv(""+X,$.mode,ne),X.return=$,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case dp:return ne=Gp(X.type,X.key,X.props,null,$.mode,ne),ne.ref=Mu($,null,X),ne.return=$,ne;case zl:return X=xv(X,$.mode,ne),X.return=$,X;case la:var D=X._init;return ie($,D(X._payload),ne)}if(Pu(X)||xu(X))return X=Ao(X,$.mode,ne,null),X.return=$,X;_p($,X)}return null}function he($,X,ne,D){var Q=X!==null?X.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return Q!==null?null:L($,X,""+ne,D);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case dp:return ne.key===Q?k($,X,ne,D):null;case zl:return ne.key===Q?j($,X,ne,D):null;case la:return Q=ne._init,he($,X,Q(ne._payload),D)}if(Pu(ne)||xu(ne))return Q!==null?null:J($,X,ne,D,null);_p($,ne)}return null}function Ee($,X,ne,D,Q){if(typeof D=="string"&&D!==""||typeof D=="number")return $=$.get(ne)||null,L(X,$,""+D,Q);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case dp:return $=$.get(D.key===null?ne:D.key)||null,k(X,$,D,Q);case zl:return $=$.get(D.key===null?ne:D.key)||null,j(X,$,D,Q);case la:var se=D._init;return Ee($,X,ne,se(D._payload),Q)}if(Pu(D)||xu(D))return $=$.get(ne)||null,J(X,$,D,Q,null);_p(X,D)}return null}function me($,X,ne,D){for(var Q=null,se=null,ye=X,Me=X=0,Xe=null;ye!==null&&Me<ne.length;Me++){ye.index>Me?(Xe=ye,ye=null):Xe=ye.sibling;var Be=he($,ye,ne[Me],D);if(Be===null){ye===null&&(ye=Xe);break}r&&ye&&Be.alternate===null&&o($,ye),X=b(Be,X,Me),se===null?Q=Be:se.sibling=Be,se=Be,ye=Xe}if(Me===ne.length)return u($,ye),$t&&bo($,Me),Q;if(ye===null){for(;Me<ne.length;Me++)ye=ie($,ne[Me],D),ye!==null&&(X=b(ye,X,Me),se===null?Q=ye:se.sibling=ye,se=ye);return $t&&bo($,Me),Q}for(ye=p($,ye);Me<ne.length;Me++)Xe=Ee(ye,$,Me,ne[Me],D),Xe!==null&&(r&&Xe.alternate!==null&&ye.delete(Xe.key===null?Me:Xe.key),X=b(Xe,X,Me),se===null?Q=Xe:se.sibling=Xe,se=Xe);return r&&ye.forEach(function(ot){return o($,ot)}),$t&&bo($,Me),Q}function be($,X,ne,D){var Q=xu(ne);if(typeof Q!="function")throw Error(Ue(150));if(ne=Q.call(ne),ne==null)throw Error(Ue(151));for(var se=Q=null,ye=X,Me=X=0,Xe=null,Be=ne.next();ye!==null&&!Be.done;Me++,Be=ne.next()){ye.index>Me?(Xe=ye,ye=null):Xe=ye.sibling;var ot=he($,ye,Be.value,D);if(ot===null){ye===null&&(ye=Xe);break}r&&ye&&ot.alternate===null&&o($,ye),X=b(ot,X,Me),se===null?Q=ot:se.sibling=ot,se=ot,ye=Xe}if(Be.done)return u($,ye),$t&&bo($,Me),Q;if(ye===null){for(;!Be.done;Me++,Be=ne.next())Be=ie($,Be.value,D),Be!==null&&(X=b(Be,X,Me),se===null?Q=Be:se.sibling=Be,se=Be);return $t&&bo($,Me),Q}for(ye=p($,ye);!Be.done;Me++,Be=ne.next())Be=Ee(ye,$,Me,Be.value,D),Be!==null&&(r&&Be.alternate!==null&&ye.delete(Be.key===null?Me:Be.key),X=b(Be,X,Me),se===null?Q=Be:se.sibling=Be,se=Be);return r&&ye.forEach(function(xn){return o($,xn)}),$t&&bo($,Me),Q}function ke($,X,ne,D){if(typeof ne=="object"&&ne!==null&&ne.type===Bl&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case dp:e:{for(var Q=ne.key,se=X;se!==null;){if(se.key===Q){if(Q=ne.type,Q===Bl){if(se.tag===7){u($,se.sibling),X=v(se,ne.props.children),X.return=$,$=X;break e}}else if(se.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===la&&LM(Q)===se.type){u($,se.sibling),X=v(se,ne.props),X.ref=Mu($,se,ne),X.return=$,$=X;break e}u($,se);break}else o($,se);se=se.sibling}ne.type===Bl?(X=Ao(ne.props.children,$.mode,D,ne.key),X.return=$,$=X):(D=Gp(ne.type,ne.key,ne.props,null,$.mode,D),D.ref=Mu($,X,ne),D.return=$,$=D)}return M($);case zl:e:{for(se=ne.key;X!==null;){if(X.key===se)if(X.tag===4&&X.stateNode.containerInfo===ne.containerInfo&&X.stateNode.implementation===ne.implementation){u($,X.sibling),X=v(X,ne.children||[]),X.return=$,$=X;break e}else{u($,X);break}else o($,X);X=X.sibling}X=xv(ne,$.mode,D),X.return=$,$=X}return M($);case la:return se=ne._init,ke($,X,se(ne._payload),D)}if(Pu(ne))return me($,X,ne,D);if(xu(ne))return be($,X,ne,D);_p($,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,X!==null&&X.tag===6?(u($,X.sibling),X=v(X,ne),X.return=$,$=X):(u($,X),X=yv(ne,$.mode,D),X.return=$,$=X),M($)):u($,X)}return ke}var ac=UT(!0),zT=UT(!1),lf=Ta(null),cf=null,Yl=null,Q1=null;function Z1(){Q1=Yl=cf=null}function K1(r){var o=lf.current;Qt(lf),r._currentValue=o}function t1(r,o,u){for(;r!==null;){var p=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),r===u)break;r=r.return}}function tc(r,o){cf=r,Q1=Yl=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&(Ei=!0),r.firstContext=null)}function rr(r){var o=r._currentValue;if(Q1!==r)if(r={context:r,memoizedValue:o,next:null},Yl===null){if(cf===null)throw Error(Ue(308));Yl=r,cf.dependencies={lanes:0,firstContext:r}}else Yl=Yl.next=r;return o}var _o=null;function J1(r){_o===null?_o=[r]:_o.push(r)}function BT(r,o,u,p){var v=o.interleaved;return v===null?(u.next=u,J1(o)):(u.next=v.next,v.next=u),o.interleaved=u,Ls(r,p)}function Ls(r,o){r.lanes|=o;var u=r.alternate;for(u!==null&&(u.lanes|=o),u=r,r=r.return;r!==null;)r.childLanes|=o,u=r.alternate,u!==null&&(u.childLanes|=o),u=r,r=r.return;return u.tag===3?u.stateNode:null}var ca=!1;function $1(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jT(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Ts(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function ya(r,o,u){var p=r.updateQueue;if(p===null)return null;if(p=p.shared,At&2){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,Ls(r,u)}return v=p.interleaved,v===null?(o.next=o,J1(p)):(o.next=v.next,v.next=o),p.interleaved=o,Ls(r,u)}function Fp(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var p=o.lanes;p&=r.pendingLanes,u|=p,o.lanes=u,U1(r,u)}}function PM(r,o){var u=r.updateQueue,p=r.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var v=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var M={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};b===null?v=b=M:b=b.next=M,u=u.next}while(u!==null);b===null?v=b=o:b=b.next=o}else v=b=o;u={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:p.shared,effects:p.effects},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}function uf(r,o,u,p){var v=r.updateQueue;ca=!1;var b=v.firstBaseUpdate,M=v.lastBaseUpdate,L=v.shared.pending;if(L!==null){v.shared.pending=null;var k=L,j=k.next;k.next=null,M===null?b=j:M.next=j,M=k;var J=r.alternate;J!==null&&(J=J.updateQueue,L=J.lastBaseUpdate,L!==M&&(L===null?J.firstBaseUpdate=j:L.next=j,J.lastBaseUpdate=k))}if(b!==null){var ie=v.baseState;M=0,J=j=k=null,L=b;do{var he=L.lane,Ee=L.eventTime;if((p&he)===he){J!==null&&(J=J.next={eventTime:Ee,lane:0,tag:L.tag,payload:L.payload,callback:L.callback,next:null});e:{var me=r,be=L;switch(he=o,Ee=u,be.tag){case 1:if(me=be.payload,typeof me=="function"){ie=me.call(Ee,ie,he);break e}ie=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=be.payload,he=typeof me=="function"?me.call(Ee,ie,he):me,he==null)break e;ie=sn({},ie,he);break e;case 2:ca=!0}}L.callback!==null&&L.lane!==0&&(r.flags|=64,he=v.effects,he===null?v.effects=[L]:he.push(L))}else Ee={eventTime:Ee,lane:he,tag:L.tag,payload:L.payload,callback:L.callback,next:null},J===null?(j=J=Ee,k=ie):J=J.next=Ee,M|=he;if(L=L.next,L===null){if(L=v.shared.pending,L===null)break;he=L,L=he.next,he.next=null,v.lastBaseUpdate=he,v.shared.pending=null}}while(1);if(J===null&&(k=ie),v.baseState=k,v.firstBaseUpdate=j,v.lastBaseUpdate=J,o=v.shared.interleaved,o!==null){v=o;do M|=v.lane,v=v.next;while(v!==o)}else b===null&&(v.shared.lanes=0);Co|=M,r.lanes=M,r.memoizedState=ie}}function CM(r,o,u){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var p=r[o],v=p.callback;if(v!==null){if(p.callback=null,p=u,typeof v!="function")throw Error(Ue(191,v));v.call(p)}}}var dh={},Kr=Ta(dh),th=Ta(dh),nh=Ta(dh);function Mo(r){if(r===dh)throw Error(Ue(174));return r}function ey(r,o){switch(Vt(nh,o),Vt(th,r),Vt(Kr,dh),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Nv(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=Nv(o,r)}Qt(Kr),Vt(Kr,o)}function oc(){Qt(Kr),Qt(th),Qt(nh)}function HT(r){Mo(nh.current);var o=Mo(Kr.current),u=Nv(o,r.type);o!==u&&(Vt(th,r),Vt(Kr,u))}function ty(r){th.current===r&&(Qt(Kr),Qt(th))}var tn=Ta(0);function hf(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var dv=[];function ny(){for(var r=0;r<dv.length;r++)dv[r]._workInProgressVersionPrimary=null;dv.length=0}var Up=Cs.ReactCurrentDispatcher,pv=Cs.ReactCurrentBatchConfig,Po=0,rn=null,En=null,kn=null,df=!1,Uu=!1,ih=0,PN=0;function ei(){throw Error(Ue(321))}function iy(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!Pr(r[u],o[u]))return!1;return!0}function ry(r,o,u,p,v,b){if(Po=b,rn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Up.current=r===null||r.memoizedState===null?IN:NN,r=u(p,v),Uu){b=0;do{if(Uu=!1,ih=0,25<=b)throw Error(Ue(301));b+=1,kn=En=null,o.updateQueue=null,Up.current=kN,r=u(p,v)}while(Uu)}if(Up.current=pf,o=En!==null&&En.next!==null,Po=0,kn=En=rn=null,df=!1,o)throw Error(Ue(300));return r}function sy(){var r=ih!==0;return ih=0,r}function Yr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?rn.memoizedState=kn=r:kn=kn.next=r,kn}function sr(){if(En===null){var r=rn.alternate;r=r!==null?r.memoizedState:null}else r=En.next;var o=kn===null?rn.memoizedState:kn.next;if(o!==null)kn=o,En=r;else{if(r===null)throw Error(Ue(310));En=r,r={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},kn===null?rn.memoizedState=kn=r:kn=kn.next=r}return kn}function rh(r,o){return typeof o=="function"?o(r):o}function fv(r){var o=sr(),u=o.queue;if(u===null)throw Error(Ue(311));u.lastRenderedReducer=r;var p=En,v=p.baseQueue,b=u.pending;if(b!==null){if(v!==null){var M=v.next;v.next=b.next,b.next=M}p.baseQueue=v=b,u.pending=null}if(v!==null){b=v.next,p=p.baseState;var L=M=null,k=null,j=b;do{var J=j.lane;if((Po&J)===J)k!==null&&(k=k.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),p=j.hasEagerState?j.eagerState:r(p,j.action);else{var ie={lane:J,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};k===null?(L=k=ie,M=p):k=k.next=ie,rn.lanes|=J,Co|=J}j=j.next}while(j!==null&&j!==b);k===null?M=p:k.next=L,Pr(p,o.memoizedState)||(Ei=!0),o.memoizedState=p,o.baseState=M,o.baseQueue=k,u.lastRenderedState=p}if(r=u.interleaved,r!==null){v=r;do b=v.lane,rn.lanes|=b,Co|=b,v=v.next;while(v!==r)}else v===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function mv(r){var o=sr(),u=o.queue;if(u===null)throw Error(Ue(311));u.lastRenderedReducer=r;var p=u.dispatch,v=u.pending,b=o.memoizedState;if(v!==null){u.pending=null;var M=v=v.next;do b=r(b,M.action),M=M.next;while(M!==v);Pr(b,o.memoizedState)||(Ei=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),u.lastRenderedState=b}return[b,p]}function GT(){}function VT(r,o){var u=rn,p=sr(),v=o(),b=!Pr(p.memoizedState,v);if(b&&(p.memoizedState=v,Ei=!0),p=p.queue,ay(qT.bind(null,u,p,r),[r]),p.getSnapshot!==o||b||kn!==null&&kn.memoizedState.tag&1){if(u.flags|=2048,sh(9,XT.bind(null,u,p,v,o),void 0,null),Fn===null)throw Error(Ue(349));Po&30||WT(u,o,v)}return v}function WT(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=rn.updateQueue,o===null?(o={lastEffect:null,stores:null},rn.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function XT(r,o,u,p){o.value=u,o.getSnapshot=p,YT(o)&&QT(r)}function qT(r,o,u){return u(function(){YT(o)&&QT(r)})}function YT(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!Pr(r,u)}catch{return!0}}function QT(r){var o=Ls(r,1);o!==null&&Rr(o,r,1,-1)}function DM(r){var o=Yr();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rh,lastRenderedState:r},o.queue=r,r=r.dispatch=ON.bind(null,rn,r),[o.memoizedState,r]}function sh(r,o,u,p){return r={tag:r,create:o,destroy:u,deps:p,next:null},o=rn.updateQueue,o===null?(o={lastEffect:null,stores:null},rn.updateQueue=o,o.lastEffect=r.next=r):(u=o.lastEffect,u===null?o.lastEffect=r.next=r:(p=u.next,u.next=r,r.next=p,o.lastEffect=r)),r}function ZT(){return sr().memoizedState}function zp(r,o,u,p){var v=Yr();rn.flags|=r,v.memoizedState=sh(1|o,u,void 0,p===void 0?null:p)}function Df(r,o,u,p){var v=sr();p=p===void 0?null:p;var b=void 0;if(En!==null){var M=En.memoizedState;if(b=M.destroy,p!==null&&iy(p,M.deps)){v.memoizedState=sh(o,u,b,p);return}}rn.flags|=r,v.memoizedState=sh(1|o,u,b,p)}function OM(r,o){return zp(8390656,8,r,o)}function ay(r,o){return Df(2048,8,r,o)}function KT(r,o){return Df(4,2,r,o)}function JT(r,o){return Df(4,4,r,o)}function $T(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function eE(r,o,u){return u=u!=null?u.concat([r]):null,Df(4,4,$T.bind(null,o,r),u)}function oy(){}function tE(r,o){var u=sr();o=o===void 0?null:o;var p=u.memoizedState;return p!==null&&o!==null&&iy(o,p[1])?p[0]:(u.memoizedState=[r,o],r)}function nE(r,o){var u=sr();o=o===void 0?null:o;var p=u.memoizedState;return p!==null&&o!==null&&iy(o,p[1])?p[0]:(r=r(),u.memoizedState=[r,o],r)}function iE(r,o,u){return Po&21?(Pr(u,o)||(u=lT(),rn.lanes|=u,Co|=u,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,Ei=!0),r.memoizedState=u)}function CN(r,o){var u=Nt;Nt=u!==0&&4>u?u:4,r(!0);var p=pv.transition;pv.transition={};try{r(!1),o()}finally{Nt=u,pv.transition=p}}function rE(){return sr().memoizedState}function DN(r,o,u){var p=ba(r);if(u={lane:p,action:u,hasEagerState:!1,eagerState:null,next:null},sE(r))aE(o,u);else if(u=BT(r,o,u,p),u!==null){var v=fi();Rr(u,r,p,v),oE(u,o,p)}}function ON(r,o,u){var p=ba(r),v={lane:p,action:u,hasEagerState:!1,eagerState:null,next:null};if(sE(r))aE(o,v);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var M=o.lastRenderedState,L=b(M,u);if(v.hasEagerState=!0,v.eagerState=L,Pr(L,M)){var k=o.interleaved;k===null?(v.next=v,J1(o)):(v.next=k.next,k.next=v),o.interleaved=v;return}}catch{}finally{}u=BT(r,o,v,p),u!==null&&(v=fi(),Rr(u,r,p,v),oE(u,o,p))}}function sE(r){var o=r.alternate;return r===rn||o!==null&&o===rn}function aE(r,o){Uu=df=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function oE(r,o,u){if(u&4194240){var p=o.lanes;p&=r.pendingLanes,u|=p,o.lanes=u,U1(r,u)}}var pf={readContext:rr,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useInsertionEffect:ei,useLayoutEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useMutableSource:ei,useSyncExternalStore:ei,useId:ei,unstable_isNewReconciler:!1},IN={readContext:rr,useCallback:function(r,o){return Yr().memoizedState=[r,o===void 0?null:o],r},useContext:rr,useEffect:OM,useImperativeHandle:function(r,o,u){return u=u!=null?u.concat([r]):null,zp(4194308,4,$T.bind(null,o,r),u)},useLayoutEffect:function(r,o){return zp(4194308,4,r,o)},useInsertionEffect:function(r,o){return zp(4,2,r,o)},useMemo:function(r,o){var u=Yr();return o=o===void 0?null:o,r=r(),u.memoizedState=[r,o],r},useReducer:function(r,o,u){var p=Yr();return o=u!==void 0?u(o):o,p.memoizedState=p.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},p.queue=r,r=r.dispatch=DN.bind(null,rn,r),[p.memoizedState,r]},useRef:function(r){var o=Yr();return r={current:r},o.memoizedState=r},useState:DM,useDebugValue:oy,useDeferredValue:function(r){return Yr().memoizedState=r},useTransition:function(){var r=DM(!1),o=r[0];return r=CN.bind(null,r[1]),Yr().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,u){var p=rn,v=Yr();if($t){if(u===void 0)throw Error(Ue(407));u=u()}else{if(u=o(),Fn===null)throw Error(Ue(349));Po&30||WT(p,o,u)}v.memoizedState=u;var b={value:u,getSnapshot:o};return v.queue=b,OM(qT.bind(null,p,b,r),[r]),p.flags|=2048,sh(9,XT.bind(null,p,b,u,o),void 0,null),u},useId:function(){var r=Yr(),o=Fn.identifierPrefix;if($t){var u=Ms,p=_s;u=(p&~(1<<32-Ar(p)-1)).toString(32)+u,o=":"+o+"R"+u,u=ih++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=PN++,o=":"+o+"r"+u.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},NN={readContext:rr,useCallback:tE,useContext:rr,useEffect:ay,useImperativeHandle:eE,useInsertionEffect:KT,useLayoutEffect:JT,useMemo:nE,useReducer:fv,useRef:ZT,useState:function(){return fv(rh)},useDebugValue:oy,useDeferredValue:function(r){var o=sr();return iE(o,En.memoizedState,r)},useTransition:function(){var r=fv(rh)[0],o=sr().memoizedState;return[r,o]},useMutableSource:GT,useSyncExternalStore:VT,useId:rE,unstable_isNewReconciler:!1},kN={readContext:rr,useCallback:tE,useContext:rr,useEffect:ay,useImperativeHandle:eE,useInsertionEffect:KT,useLayoutEffect:JT,useMemo:nE,useReducer:mv,useRef:ZT,useState:function(){return mv(rh)},useDebugValue:oy,useDeferredValue:function(r){var o=sr();return En===null?o.memoizedState=r:iE(o,En.memoizedState,r)},useTransition:function(){var r=mv(rh)[0],o=sr().memoizedState;return[r,o]},useMutableSource:GT,useSyncExternalStore:VT,useId:rE,unstable_isNewReconciler:!1};function Mr(r,o){if(r&&r.defaultProps){o=sn({},o),r=r.defaultProps;for(var u in r)o[u]===void 0&&(o[u]=r[u]);return o}return o}function n1(r,o,u,p){o=r.memoizedState,u=u(p,o),u=u==null?o:sn({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var Of={isMounted:function(r){return(r=r._reactInternals)?No(r)===r:!1},enqueueSetState:function(r,o,u){r=r._reactInternals;var p=fi(),v=ba(r),b=Ts(p,v);b.payload=o,u!=null&&(b.callback=u),o=ya(r,b,v),o!==null&&(Rr(o,r,v,p),Fp(o,r,v))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var p=fi(),v=ba(r),b=Ts(p,v);b.tag=1,b.payload=o,u!=null&&(b.callback=u),o=ya(r,b,v),o!==null&&(Rr(o,r,v,p),Fp(o,r,v))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=fi(),p=ba(r),v=Ts(u,p);v.tag=2,o!=null&&(v.callback=o),o=ya(r,v,p),o!==null&&(Rr(o,r,p,u),Fp(o,r,p))}};function IM(r,o,u,p,v,b,M){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(p,b,M):o.prototype&&o.prototype.isPureReactComponent?!Ku(u,p)||!Ku(v,b):!0}function lE(r,o,u){var p=!1,v=_a,b=o.contextType;return typeof b=="object"&&b!==null?b=rr(b):(v=Li(o)?Ro:si.current,p=o.contextTypes,b=(p=p!=null)?rc(r,v):_a),o=new o(u,b),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Of,r.stateNode=o,o._reactInternals=r,p&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=v,r.__reactInternalMemoizedMaskedChildContext=b),o}function NM(r,o,u,p){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==r&&Of.enqueueReplaceState(o,o.state,null)}function i1(r,o,u,p){var v=r.stateNode;v.props=u,v.state=r.memoizedState,v.refs={},$1(r);var b=o.contextType;typeof b=="object"&&b!==null?v.context=rr(b):(b=Li(o)?Ro:si.current,v.context=rc(r,b)),v.state=r.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(n1(r,o,b,u),v.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(o=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),o!==v.state&&Of.enqueueReplaceState(v,v.state,null),uf(r,u,v,p),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308)}function lc(r,o){try{var u="",p=o;do u+=u4(p),p=p.return;while(p);var v=u}catch(b){v=`
Error generating stack: `+b.message+`
`+b.stack}return{value:r,source:o,stack:v,digest:null}}function gv(r,o,u){return{value:r,source:null,stack:u??null,digest:o??null}}function r1(r,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var FN=typeof WeakMap=="function"?WeakMap:Map;function cE(r,o,u){u=Ts(-1,u),u.tag=3,u.payload={element:null};var p=o.value;return u.callback=function(){mf||(mf=!0,f1=p),r1(r,o)},u}function uE(r,o,u){u=Ts(-1,u),u.tag=3;var p=r.type.getDerivedStateFromError;if(typeof p=="function"){var v=o.value;u.payload=function(){return p(v)},u.callback=function(){r1(r,o)}}var b=r.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(u.callback=function(){r1(r,o),typeof p!="function"&&(xa===null?xa=new Set([this]):xa.add(this));var M=o.stack;this.componentDidCatch(o.value,{componentStack:M!==null?M:""})}),u}function kM(r,o,u){var p=r.pingCache;if(p===null){p=r.pingCache=new FN;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(u)||(v.add(u),r=KN.bind(null,r,o,u),o.then(r,r))}function FM(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function UM(r,o,u,p,v){return r.mode&1?(r.flags|=65536,r.lanes=v,r):(r===o?r.flags|=65536:(r.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=Ts(-1,1),o.tag=2,ya(u,o,1))),u.lanes|=1),r)}var UN=Cs.ReactCurrentOwner,Ei=!1;function pi(r,o,u,p){o.child=r===null?zT(o,null,u,p):ac(o,r.child,u,p)}function zM(r,o,u,p,v){u=u.render;var b=o.ref;return tc(o,v),p=ry(r,o,u,p,b,v),u=sy(),r!==null&&!Ei?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~v,Ps(r,o,v)):($t&&u&&X1(o),o.flags|=1,pi(r,o,p,v),o.child)}function BM(r,o,u,p,v){if(r===null){var b=u.type;return typeof b=="function"&&!my(b)&&b.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=b,hE(r,o,b,p,v)):(r=Gp(u.type,null,p,o,o.mode,v),r.ref=o.ref,r.return=o,o.child=r)}if(b=r.child,!(r.lanes&v)){var M=b.memoizedProps;if(u=u.compare,u=u!==null?u:Ku,u(M,p)&&r.ref===o.ref)return Ps(r,o,v)}return o.flags|=1,r=Sa(b,p),r.ref=o.ref,r.return=o,o.child=r}function hE(r,o,u,p,v){if(r!==null){var b=r.memoizedProps;if(Ku(b,p)&&r.ref===o.ref)if(Ei=!1,o.pendingProps=p=b,(r.lanes&v)!==0)r.flags&131072&&(Ei=!0);else return o.lanes=r.lanes,Ps(r,o,v)}return s1(r,o,u,p,v)}function dE(r,o,u){var p=o.pendingProps,v=p.children,b=r!==null?r.memoizedState:null;if(p.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(Zl,zi),zi|=u;else{if(!(u&1073741824))return r=b!==null?b.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,Vt(Zl,zi),zi|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=b!==null?b.baseLanes:u,Vt(Zl,zi),zi|=p}else b!==null?(p=b.baseLanes|u,o.memoizedState=null):p=u,Vt(Zl,zi),zi|=p;return pi(r,o,v,u),o.child}function pE(r,o){var u=o.ref;(r===null&&u!==null||r!==null&&r.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function s1(r,o,u,p,v){var b=Li(u)?Ro:si.current;return b=rc(o,b),tc(o,v),u=ry(r,o,u,p,b,v),p=sy(),r!==null&&!Ei?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~v,Ps(r,o,v)):($t&&p&&X1(o),o.flags|=1,pi(r,o,u,v),o.child)}function jM(r,o,u,p,v){if(Li(u)){var b=!0;sf(o)}else b=!1;if(tc(o,v),o.stateNode===null)Bp(r,o),lE(o,u,p),i1(o,u,p,v),p=!0;else if(r===null){var M=o.stateNode,L=o.memoizedProps;M.props=L;var k=M.context,j=u.contextType;typeof j=="object"&&j!==null?j=rr(j):(j=Li(u)?Ro:si.current,j=rc(o,j));var J=u.getDerivedStateFromProps,ie=typeof J=="function"||typeof M.getSnapshotBeforeUpdate=="function";ie||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(L!==p||k!==j)&&NM(o,M,p,j),ca=!1;var he=o.memoizedState;M.state=he,uf(o,p,M,v),k=o.memoizedState,L!==p||he!==k||Ri.current||ca?(typeof J=="function"&&(n1(o,u,J,p),k=o.memoizedState),(L=ca||IM(o,u,L,p,he,k,j))?(ie||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(o.flags|=4194308)):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=k),M.props=p,M.state=k,M.context=j,p=L):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{M=o.stateNode,jT(r,o),L=o.memoizedProps,j=o.type===o.elementType?L:Mr(o.type,L),M.props=j,ie=o.pendingProps,he=M.context,k=u.contextType,typeof k=="object"&&k!==null?k=rr(k):(k=Li(u)?Ro:si.current,k=rc(o,k));var Ee=u.getDerivedStateFromProps;(J=typeof Ee=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(L!==ie||he!==k)&&NM(o,M,p,k),ca=!1,he=o.memoizedState,M.state=he,uf(o,p,M,v);var me=o.memoizedState;L!==ie||he!==me||Ri.current||ca?(typeof Ee=="function"&&(n1(o,u,Ee,p),me=o.memoizedState),(j=ca||IM(o,u,j,p,he,me,k)||!1)?(J||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(p,me,k),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(p,me,k)),typeof M.componentDidUpdate=="function"&&(o.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof M.componentDidUpdate!="function"||L===r.memoizedProps&&he===r.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&he===r.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=me),M.props=p,M.state=me,M.context=k,p=j):(typeof M.componentDidUpdate!="function"||L===r.memoizedProps&&he===r.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&he===r.memoizedState||(o.flags|=1024),p=!1)}return a1(r,o,u,p,b,v)}function a1(r,o,u,p,v,b){pE(r,o);var M=(o.flags&128)!==0;if(!p&&!M)return v&&EM(o,u,!1),Ps(r,o,b);p=o.stateNode,UN.current=o;var L=M&&typeof u.getDerivedStateFromError!="function"?null:p.render();return o.flags|=1,r!==null&&M?(o.child=ac(o,r.child,null,b),o.child=ac(o,null,L,b)):pi(r,o,L,b),o.memoizedState=p.state,v&&EM(o,u,!0),o.child}function fE(r){var o=r.stateNode;o.pendingContext?TM(r,o.pendingContext,o.pendingContext!==o.context):o.context&&TM(r,o.context,!1),ey(r,o.containerInfo)}function HM(r,o,u,p,v){return sc(),Y1(v),o.flags|=256,pi(r,o,u,p),o.child}var o1={dehydrated:null,treeContext:null,retryLane:0};function l1(r){return{baseLanes:r,cachePool:null,transitions:null}}function mE(r,o,u){var p=o.pendingProps,v=tn.current,b=!1,M=(o.flags&128)!==0,L;if((L=M)||(L=r!==null&&r.memoizedState===null?!1:(v&2)!==0),L?(b=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(v|=1),Vt(tn,v&1),r===null)return e1(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(M=p.children,r=p.fallback,b?(p=o.mode,b=o.child,M={mode:"hidden",children:M},!(p&1)&&b!==null?(b.childLanes=0,b.pendingProps=M):b=kf(M,p,0,null),r=Ao(r,p,u,null),b.return=o,r.return=o,b.sibling=r,o.child=b,o.child.memoizedState=l1(u),o.memoizedState=o1,r):ly(o,M));if(v=r.memoizedState,v!==null&&(L=v.dehydrated,L!==null))return zN(r,o,M,p,L,v,u);if(b){b=p.fallback,M=o.mode,v=r.child,L=v.sibling;var k={mode:"hidden",children:p.children};return!(M&1)&&o.child!==v?(p=o.child,p.childLanes=0,p.pendingProps=k,o.deletions=null):(p=Sa(v,k),p.subtreeFlags=v.subtreeFlags&14680064),L!==null?b=Sa(L,b):(b=Ao(b,M,u,null),b.flags|=2),b.return=o,p.return=o,p.sibling=b,o.child=p,p=b,b=o.child,M=r.child.memoizedState,M=M===null?l1(u):{baseLanes:M.baseLanes|u,cachePool:null,transitions:M.transitions},b.memoizedState=M,b.childLanes=r.childLanes&~u,o.memoizedState=o1,p}return b=r.child,r=b.sibling,p=Sa(b,{mode:"visible",children:p.children}),!(o.mode&1)&&(p.lanes=u),p.return=o,p.sibling=null,r!==null&&(u=o.deletions,u===null?(o.deletions=[r],o.flags|=16):u.push(r)),o.child=p,o.memoizedState=null,p}function ly(r,o){return o=kf({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Mp(r,o,u,p){return p!==null&&Y1(p),ac(o,r.child,null,u),r=ly(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function zN(r,o,u,p,v,b,M){if(u)return o.flags&256?(o.flags&=-257,p=gv(Error(Ue(422))),Mp(r,o,M,p)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(b=p.fallback,v=o.mode,p=kf({mode:"visible",children:p.children},v,0,null),b=Ao(b,v,M,null),b.flags|=2,p.return=o,b.return=o,p.sibling=b,o.child=p,o.mode&1&&ac(o,r.child,null,M),o.child.memoizedState=l1(M),o.memoizedState=o1,b);if(!(o.mode&1))return Mp(r,o,M,null);if(v.data==="$!"){if(p=v.nextSibling&&v.nextSibling.dataset,p)var L=p.dgst;return p=L,b=Error(Ue(419)),p=gv(b,p,void 0),Mp(r,o,M,p)}if(L=(M&r.childLanes)!==0,Ei||L){if(p=Fn,p!==null){switch(M&-M){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=v&(p.suspendedLanes|M)?0:v,v!==0&&v!==b.retryLane&&(b.retryLane=v,Ls(r,v),Rr(p,r,v,-1))}return fy(),p=gv(Error(Ue(421))),Mp(r,o,M,p)}return v.data==="$?"?(o.flags|=128,o.child=r.child,o=JN.bind(null,r),v._reactRetry=o,null):(r=b.treeContext,Bi=va(v.nextSibling),ji=o,$t=!0,Er=null,r!==null&&(er[tr++]=_s,er[tr++]=Ms,er[tr++]=Lo,_s=r.id,Ms=r.overflow,Lo=o),o=ly(o,p.children),o.flags|=4096,o)}function GM(r,o,u){r.lanes|=o;var p=r.alternate;p!==null&&(p.lanes|=o),t1(r.return,o,u)}function vv(r,o,u,p,v){var b=r.memoizedState;b===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:v}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=p,b.tail=u,b.tailMode=v)}function gE(r,o,u){var p=o.pendingProps,v=p.revealOrder,b=p.tail;if(pi(r,o,p.children,u),p=tn.current,p&2)p=p&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&GM(r,u,o);else if(r.tag===19)GM(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}p&=1}if(Vt(tn,p),!(o.mode&1))o.memoizedState=null;else switch(v){case"forwards":for(u=o.child,v=null;u!==null;)r=u.alternate,r!==null&&hf(r)===null&&(v=u),u=u.sibling;u=v,u===null?(v=o.child,o.child=null):(v=u.sibling,u.sibling=null),vv(o,!1,v,u,b);break;case"backwards":for(u=null,v=o.child,o.child=null;v!==null;){if(r=v.alternate,r!==null&&hf(r)===null){o.child=v;break}r=v.sibling,v.sibling=u,u=v,v=r}vv(o,!0,u,null,b);break;case"together":vv(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Bp(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function Ps(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Co|=o.lanes,!(u&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(Ue(153));if(o.child!==null){for(r=o.child,u=Sa(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=Sa(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function BN(r,o,u){switch(o.tag){case 3:fE(o),sc();break;case 5:HT(o);break;case 1:Li(o.type)&&sf(o);break;case 4:ey(o,o.stateNode.containerInfo);break;case 10:var p=o.type._context,v=o.memoizedProps.value;Vt(lf,p._currentValue),p._currentValue=v;break;case 13:if(p=o.memoizedState,p!==null)return p.dehydrated!==null?(Vt(tn,tn.current&1),o.flags|=128,null):u&o.child.childLanes?mE(r,o,u):(Vt(tn,tn.current&1),r=Ps(r,o,u),r!==null?r.sibling:null);Vt(tn,tn.current&1);break;case 19:if(p=(u&o.childLanes)!==0,r.flags&128){if(p)return gE(r,o,u);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Vt(tn,tn.current),p)break;return null;case 22:case 23:return o.lanes=0,dE(r,o,u)}return Ps(r,o,u)}var vE,c1,yE,xE;vE=function(r,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)r.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};c1=function(){};yE=function(r,o,u,p){var v=r.memoizedProps;if(v!==p){r=o.stateNode,Mo(Kr.current);var b=null;switch(u){case"input":v=Cv(r,v),p=Cv(r,p),b=[];break;case"select":v=sn({},v,{value:void 0}),p=sn({},p,{value:void 0}),b=[];break;case"textarea":v=Iv(r,v),p=Iv(r,p),b=[];break;default:typeof v.onClick!="function"&&typeof p.onClick=="function"&&(r.onclick=nf)}kv(u,p);var M;u=null;for(j in v)if(!p.hasOwnProperty(j)&&v.hasOwnProperty(j)&&v[j]!=null)if(j==="style"){var L=v[j];for(M in L)L.hasOwnProperty(M)&&(u||(u={}),u[M]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(Vu.hasOwnProperty(j)?b||(b=[]):(b=b||[]).push(j,null));for(j in p){var k=p[j];if(L=v!=null?v[j]:void 0,p.hasOwnProperty(j)&&k!==L&&(k!=null||L!=null))if(j==="style")if(L){for(M in L)!L.hasOwnProperty(M)||k&&k.hasOwnProperty(M)||(u||(u={}),u[M]="");for(M in k)k.hasOwnProperty(M)&&L[M]!==k[M]&&(u||(u={}),u[M]=k[M])}else u||(b||(b=[]),b.push(j,u)),u=k;else j==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,L=L?L.__html:void 0,k!=null&&L!==k&&(b=b||[]).push(j,k)):j==="children"?typeof k!="string"&&typeof k!="number"||(b=b||[]).push(j,""+k):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(Vu.hasOwnProperty(j)?(k!=null&&j==="onScroll"&&qt("scroll",r),b||L===k||(b=[])):(b=b||[]).push(j,k))}u&&(b=b||[]).push("style",u);var j=b;(o.updateQueue=j)&&(o.flags|=4)}};xE=function(r,o,u,p){u!==p&&(o.flags|=4)};function Tu(r,o){if(!$t)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:p.sibling=null}}function ti(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,p=0;if(o)for(var v=r.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags&14680064,p|=v.flags&14680064,v.return=r,v=v.sibling;else for(v=r.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=r,v=v.sibling;return r.subtreeFlags|=p,r.childLanes=u,o}function jN(r,o,u){var p=o.pendingProps;switch(q1(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ti(o),null;case 1:return Li(o.type)&&rf(),ti(o),null;case 3:return p=o.stateNode,oc(),Qt(Ri),Qt(si),ny(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(r===null||r.child===null)&&(wp(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Er!==null&&(v1(Er),Er=null))),c1(r,o),ti(o),null;case 5:ty(o);var v=Mo(nh.current);if(u=o.type,r!==null&&o.stateNode!=null)yE(r,o,u,p,v),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!p){if(o.stateNode===null)throw Error(Ue(166));return ti(o),null}if(r=Mo(Kr.current),wp(o)){p=o.stateNode,u=o.type;var b=o.memoizedProps;switch(p[Qr]=o,p[eh]=b,r=(o.mode&1)!==0,u){case"dialog":qt("cancel",p),qt("close",p);break;case"iframe":case"object":case"embed":qt("load",p);break;case"video":case"audio":for(v=0;v<Du.length;v++)qt(Du[v],p);break;case"source":qt("error",p);break;case"img":case"image":case"link":qt("error",p),qt("load",p);break;case"details":qt("toggle",p);break;case"input":J_(p,b),qt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!b.multiple},qt("invalid",p);break;case"textarea":eM(p,b),qt("invalid",p)}kv(u,b),v=null;for(var M in b)if(b.hasOwnProperty(M)){var L=b[M];M==="children"?typeof L=="string"?p.textContent!==L&&(b.suppressHydrationWarning!==!0&&Sp(p.textContent,L,r),v=["children",L]):typeof L=="number"&&p.textContent!==""+L&&(b.suppressHydrationWarning!==!0&&Sp(p.textContent,L,r),v=["children",""+L]):Vu.hasOwnProperty(M)&&L!=null&&M==="onScroll"&&qt("scroll",p)}switch(u){case"input":pp(p),$_(p,b,!0);break;case"textarea":pp(p),tM(p);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(p.onclick=nf)}p=v,o.updateQueue=p,p!==null&&(o.flags|=4)}else{M=v.nodeType===9?v:v.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=q2(u)),r==="http://www.w3.org/1999/xhtml"?u==="script"?(r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof p.is=="string"?r=M.createElement(u,{is:p.is}):(r=M.createElement(u),u==="select"&&(M=r,p.multiple?M.multiple=!0:p.size&&(M.size=p.size))):r=M.createElementNS(r,u),r[Qr]=o,r[eh]=p,vE(r,o,!1,!1),o.stateNode=r;e:{switch(M=Fv(u,p),u){case"dialog":qt("cancel",r),qt("close",r),v=p;break;case"iframe":case"object":case"embed":qt("load",r),v=p;break;case"video":case"audio":for(v=0;v<Du.length;v++)qt(Du[v],r);v=p;break;case"source":qt("error",r),v=p;break;case"img":case"image":case"link":qt("error",r),qt("load",r),v=p;break;case"details":qt("toggle",r),v=p;break;case"input":J_(r,p),v=Cv(r,p),qt("invalid",r);break;case"option":v=p;break;case"select":r._wrapperState={wasMultiple:!!p.multiple},v=sn({},p,{value:void 0}),qt("invalid",r);break;case"textarea":eM(r,p),v=Iv(r,p),qt("invalid",r);break;default:v=p}kv(u,v),L=v;for(b in L)if(L.hasOwnProperty(b)){var k=L[b];b==="style"?Z2(r,k):b==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,k!=null&&Y2(r,k)):b==="children"?typeof k=="string"?(u!=="textarea"||k!=="")&&Wu(r,k):typeof k=="number"&&Wu(r,""+k):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Vu.hasOwnProperty(b)?k!=null&&b==="onScroll"&&qt("scroll",r):k!=null&&D1(r,b,k,M))}switch(u){case"input":pp(r),$_(r,p,!1);break;case"textarea":pp(r),tM(r);break;case"option":p.value!=null&&r.setAttribute("value",""+wa(p.value));break;case"select":r.multiple=!!p.multiple,b=p.value,b!=null?Kl(r,!!p.multiple,b,!1):p.defaultValue!=null&&Kl(r,!!p.multiple,p.defaultValue,!0);break;default:typeof v.onClick=="function"&&(r.onclick=nf)}switch(u){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return ti(o),null;case 6:if(r&&o.stateNode!=null)xE(r,o,r.memoizedProps,p);else{if(typeof p!="string"&&o.stateNode===null)throw Error(Ue(166));if(u=Mo(nh.current),Mo(Kr.current),wp(o)){if(p=o.stateNode,u=o.memoizedProps,p[Qr]=o,(b=p.nodeValue!==u)&&(r=ji,r!==null))switch(r.tag){case 3:Sp(p.nodeValue,u,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Sp(p.nodeValue,u,(r.mode&1)!==0)}b&&(o.flags|=4)}else p=(u.nodeType===9?u:u.ownerDocument).createTextNode(p),p[Qr]=o,o.stateNode=p}return ti(o),null;case 13:if(Qt(tn),p=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if($t&&Bi!==null&&o.mode&1&&!(o.flags&128))FT(),sc(),o.flags|=98560,b=!1;else if(b=wp(o),p!==null&&p.dehydrated!==null){if(r===null){if(!b)throw Error(Ue(318));if(b=o.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(Ue(317));b[Qr]=o}else sc(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;ti(o),b=!1}else Er!==null&&(v1(Er),Er=null),b=!0;if(!b)return o.flags&65536?o:null}return o.flags&128?(o.lanes=u,o):(p=p!==null,p!==(r!==null&&r.memoizedState!==null)&&p&&(o.child.flags|=8192,o.mode&1&&(r===null||tn.current&1?Ln===0&&(Ln=3):fy())),o.updateQueue!==null&&(o.flags|=4),ti(o),null);case 4:return oc(),c1(r,o),r===null&&Ju(o.stateNode.containerInfo),ti(o),null;case 10:return K1(o.type._context),ti(o),null;case 17:return Li(o.type)&&rf(),ti(o),null;case 19:if(Qt(tn),b=o.memoizedState,b===null)return ti(o),null;if(p=(o.flags&128)!==0,M=b.rendering,M===null)if(p)Tu(b,!1);else{if(Ln!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(M=hf(r),M!==null){for(o.flags|=128,Tu(b,!1),p=M.updateQueue,p!==null&&(o.updateQueue=p,o.flags|=4),o.subtreeFlags=0,p=u,u=o.child;u!==null;)b=u,r=p,b.flags&=14680066,M=b.alternate,M===null?(b.childLanes=0,b.lanes=r,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=M.childLanes,b.lanes=M.lanes,b.child=M.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=M.memoizedProps,b.memoizedState=M.memoizedState,b.updateQueue=M.updateQueue,b.type=M.type,r=M.dependencies,b.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),u=u.sibling;return Vt(tn,tn.current&1|2),o.child}r=r.sibling}b.tail!==null&&pn()>cc&&(o.flags|=128,p=!0,Tu(b,!1),o.lanes=4194304)}else{if(!p)if(r=hf(M),r!==null){if(o.flags|=128,p=!0,u=r.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Tu(b,!0),b.tail===null&&b.tailMode==="hidden"&&!M.alternate&&!$t)return ti(o),null}else 2*pn()-b.renderingStartTime>cc&&u!==1073741824&&(o.flags|=128,p=!0,Tu(b,!1),o.lanes=4194304);b.isBackwards?(M.sibling=o.child,o.child=M):(u=b.last,u!==null?u.sibling=M:o.child=M,b.last=M)}return b.tail!==null?(o=b.tail,b.rendering=o,b.tail=o.sibling,b.renderingStartTime=pn(),o.sibling=null,u=tn.current,Vt(tn,p?u&1|2:u&1),o):(ti(o),null);case 22:case 23:return py(),p=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==p&&(o.flags|=8192),p&&o.mode&1?zi&1073741824&&(ti(o),o.subtreeFlags&6&&(o.flags|=8192)):ti(o),null;case 24:return null;case 25:return null}throw Error(Ue(156,o.tag))}function HN(r,o){switch(q1(o),o.tag){case 1:return Li(o.type)&&rf(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return oc(),Qt(Ri),Qt(si),ny(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return ty(o),null;case 13:if(Qt(tn),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(Ue(340));sc()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Qt(tn),null;case 4:return oc(),null;case 10:return K1(o.type._context),null;case 22:case 23:return py(),null;case 24:return null;default:return null}}var Tp=!1,ni=!1,GN=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Ql(r,o){var u=r.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(p){ln(r,o,p)}else u.current=null}function u1(r,o,u){try{u()}catch(p){ln(r,o,p)}}var VM=!1;function VN(r,o){if(qv=$p,r=MT(),W1(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var v=p.anchorOffset,b=p.focusNode;p=p.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var M=0,L=-1,k=-1,j=0,J=0,ie=r,he=null;t:for(;;){for(var Ee;ie!==u||v!==0&&ie.nodeType!==3||(L=M+v),ie!==b||p!==0&&ie.nodeType!==3||(k=M+p),ie.nodeType===3&&(M+=ie.nodeValue.length),(Ee=ie.firstChild)!==null;)he=ie,ie=Ee;for(;;){if(ie===r)break t;if(he===u&&++j===v&&(L=M),he===b&&++J===p&&(k=M),(Ee=ie.nextSibling)!==null)break;ie=he,he=ie.parentNode}ie=Ee}u=L===-1||k===-1?null:{start:L,end:k}}else u=null}u=u||{start:0,end:0}}else u=null;for(Yv={focusedElem:r,selectionRange:u},$p=!1,Qe=o;Qe!==null;)if(o=Qe,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Qe=r;else for(;Qe!==null;){o=Qe;try{var me=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(me!==null){var be=me.memoizedProps,ke=me.memoizedState,$=o.stateNode,X=$.getSnapshotBeforeUpdate(o.elementType===o.type?be:Mr(o.type,be),ke);$.__reactInternalSnapshotBeforeUpdate=X}break;case 3:var ne=o.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ue(163))}}catch(D){ln(o,o.return,D)}if(r=o.sibling,r!==null){r.return=o.return,Qe=r;break}Qe=o.return}return me=VM,VM=!1,me}function zu(r,o,u){var p=o.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var v=p=p.next;do{if((v.tag&r)===r){var b=v.destroy;v.destroy=void 0,b!==void 0&&u1(o,u,b)}v=v.next}while(v!==p)}}function If(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&r)===r){var p=u.create;u.destroy=p()}u=u.next}while(u!==o)}}function h1(r){var o=r.ref;if(o!==null){var u=r.stateNode;switch(r.tag){case 5:r=u;break;default:r=u}typeof o=="function"?o(r):o.current=r}}function bE(r){var o=r.alternate;o!==null&&(r.alternate=null,bE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[Qr],delete o[eh],delete o[Kv],delete o[EN],delete o[AN])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function SE(r){return r.tag===5||r.tag===3||r.tag===4}function WM(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||SE(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function d1(r,o,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(r,o):u.insertBefore(r,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(r,u)):(o=u,o.appendChild(r)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=nf));else if(p!==4&&(r=r.child,r!==null))for(d1(r,o,u),r=r.sibling;r!==null;)d1(r,o,u),r=r.sibling}function p1(r,o,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(p!==4&&(r=r.child,r!==null))for(p1(r,o,u),r=r.sibling;r!==null;)p1(r,o,u),r=r.sibling}var Hn=null,Tr=!1;function oa(r,o,u){for(u=u.child;u!==null;)wE(r,o,u),u=u.sibling}function wE(r,o,u){if(Zr&&typeof Zr.onCommitFiberUnmount=="function")try{Zr.onCommitFiberUnmount(Ef,u)}catch{}switch(u.tag){case 5:ni||Ql(u,o);case 6:var p=Hn,v=Tr;Hn=null,oa(r,o,u),Hn=p,Tr=v,Hn!==null&&(Tr?(r=Hn,u=u.stateNode,r.nodeType===8?r.parentNode.removeChild(u):r.removeChild(u)):Hn.removeChild(u.stateNode));break;case 18:Hn!==null&&(Tr?(r=Hn,u=u.stateNode,r.nodeType===8?uv(r.parentNode,u):r.nodeType===1&&uv(r,u),Qu(r)):uv(Hn,u.stateNode));break;case 4:p=Hn,v=Tr,Hn=u.stateNode.containerInfo,Tr=!0,oa(r,o,u),Hn=p,Tr=v;break;case 0:case 11:case 14:case 15:if(!ni&&(p=u.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){v=p=p.next;do{var b=v,M=b.destroy;b=b.tag,M!==void 0&&(b&2||b&4)&&u1(u,o,M),v=v.next}while(v!==p)}oa(r,o,u);break;case 1:if(!ni&&(Ql(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=u.memoizedProps,p.state=u.memoizedState,p.componentWillUnmount()}catch(L){ln(u,o,L)}oa(r,o,u);break;case 21:oa(r,o,u);break;case 22:u.mode&1?(ni=(p=ni)||u.memoizedState!==null,oa(r,o,u),ni=p):oa(r,o,u);break;default:oa(r,o,u)}}function XM(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var u=r.stateNode;u===null&&(u=r.stateNode=new GN),o.forEach(function(p){var v=$N.bind(null,r,p);u.has(p)||(u.add(p),p.then(v,v))})}}function _r(r,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var v=u[p];try{var b=r,M=o,L=M;e:for(;L!==null;){switch(L.tag){case 5:Hn=L.stateNode,Tr=!1;break e;case 3:Hn=L.stateNode.containerInfo,Tr=!0;break e;case 4:Hn=L.stateNode.containerInfo,Tr=!0;break e}L=L.return}if(Hn===null)throw Error(Ue(160));wE(b,M,v),Hn=null,Tr=!1;var k=v.alternate;k!==null&&(k.return=null),v.return=null}catch(j){ln(v,o,j)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)_E(o,r),o=o.sibling}function _E(r,o){var u=r.alternate,p=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(_r(o,r),Xr(r),p&4){try{zu(3,r,r.return),If(3,r)}catch(be){ln(r,r.return,be)}try{zu(5,r,r.return)}catch(be){ln(r,r.return,be)}}break;case 1:_r(o,r),Xr(r),p&512&&u!==null&&Ql(u,u.return);break;case 5:if(_r(o,r),Xr(r),p&512&&u!==null&&Ql(u,u.return),r.flags&32){var v=r.stateNode;try{Wu(v,"")}catch(be){ln(r,r.return,be)}}if(p&4&&(v=r.stateNode,v!=null)){var b=r.memoizedProps,M=u!==null?u.memoizedProps:b,L=r.type,k=r.updateQueue;if(r.updateQueue=null,k!==null)try{L==="input"&&b.type==="radio"&&b.name!=null&&W2(v,b),Fv(L,M);var j=Fv(L,b);for(M=0;M<k.length;M+=2){var J=k[M],ie=k[M+1];J==="style"?Z2(v,ie):J==="dangerouslySetInnerHTML"?Y2(v,ie):J==="children"?Wu(v,ie):D1(v,J,ie,j)}switch(L){case"input":Dv(v,b);break;case"textarea":X2(v,b);break;case"select":var he=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!b.multiple;var Ee=b.value;Ee!=null?Kl(v,!!b.multiple,Ee,!1):he!==!!b.multiple&&(b.defaultValue!=null?Kl(v,!!b.multiple,b.defaultValue,!0):Kl(v,!!b.multiple,b.multiple?[]:"",!1))}v[eh]=b}catch(be){ln(r,r.return,be)}}break;case 6:if(_r(o,r),Xr(r),p&4){if(r.stateNode===null)throw Error(Ue(162));v=r.stateNode,b=r.memoizedProps;try{v.nodeValue=b}catch(be){ln(r,r.return,be)}}break;case 3:if(_r(o,r),Xr(r),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Qu(o.containerInfo)}catch(be){ln(r,r.return,be)}break;case 4:_r(o,r),Xr(r);break;case 13:_r(o,r),Xr(r),v=r.child,v.flags&8192&&(b=v.memoizedState!==null,v.stateNode.isHidden=b,!b||v.alternate!==null&&v.alternate.memoizedState!==null||(hy=pn())),p&4&&XM(r);break;case 22:if(J=u!==null&&u.memoizedState!==null,r.mode&1?(ni=(j=ni)||J,_r(o,r),ni=j):_r(o,r),Xr(r),p&8192){if(j=r.memoizedState!==null,(r.stateNode.isHidden=j)&&!J&&r.mode&1)for(Qe=r,J=r.child;J!==null;){for(ie=Qe=J;Qe!==null;){switch(he=Qe,Ee=he.child,he.tag){case 0:case 11:case 14:case 15:zu(4,he,he.return);break;case 1:Ql(he,he.return);var me=he.stateNode;if(typeof me.componentWillUnmount=="function"){p=he,u=he.return;try{o=p,me.props=o.memoizedProps,me.state=o.memoizedState,me.componentWillUnmount()}catch(be){ln(p,u,be)}}break;case 5:Ql(he,he.return);break;case 22:if(he.memoizedState!==null){YM(ie);continue}}Ee!==null?(Ee.return=he,Qe=Ee):YM(ie)}J=J.sibling}e:for(J=null,ie=r;;){if(ie.tag===5){if(J===null){J=ie;try{v=ie.stateNode,j?(b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(L=ie.stateNode,k=ie.memoizedProps.style,M=k!=null&&k.hasOwnProperty("display")?k.display:null,L.style.display=Q2("display",M))}catch(be){ln(r,r.return,be)}}}else if(ie.tag===6){if(J===null)try{ie.stateNode.nodeValue=j?"":ie.memoizedProps}catch(be){ln(r,r.return,be)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===r)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===r)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===r)break e;J===ie&&(J=null),ie=ie.return}J===ie&&(J=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:_r(o,r),Xr(r),p&4&&XM(r);break;case 21:break;default:_r(o,r),Xr(r)}}function Xr(r){var o=r.flags;if(o&2){try{e:{for(var u=r.return;u!==null;){if(SE(u)){var p=u;break e}u=u.return}throw Error(Ue(160))}switch(p.tag){case 5:var v=p.stateNode;p.flags&32&&(Wu(v,""),p.flags&=-33);var b=WM(r);p1(r,b,v);break;case 3:case 4:var M=p.stateNode.containerInfo,L=WM(r);d1(r,L,M);break;default:throw Error(Ue(161))}}catch(k){ln(r,r.return,k)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function WN(r,o,u){Qe=r,ME(r)}function ME(r,o,u){for(var p=(r.mode&1)!==0;Qe!==null;){var v=Qe,b=v.child;if(v.tag===22&&p){var M=v.memoizedState!==null||Tp;if(!M){var L=v.alternate,k=L!==null&&L.memoizedState!==null||ni;L=Tp;var j=ni;if(Tp=M,(ni=k)&&!j)for(Qe=v;Qe!==null;)M=Qe,k=M.child,M.tag===22&&M.memoizedState!==null?QM(v):k!==null?(k.return=M,Qe=k):QM(v);for(;b!==null;)Qe=b,ME(b),b=b.sibling;Qe=v,Tp=L,ni=j}qM(r)}else v.subtreeFlags&8772&&b!==null?(b.return=v,Qe=b):qM(r)}}function qM(r){for(;Qe!==null;){var o=Qe;if(o.flags&8772){var u=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:ni||If(5,o);break;case 1:var p=o.stateNode;if(o.flags&4&&!ni)if(u===null)p.componentDidMount();else{var v=o.elementType===o.type?u.memoizedProps:Mr(o.type,u.memoizedProps);p.componentDidUpdate(v,u.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var b=o.updateQueue;b!==null&&CM(o,b,p);break;case 3:var M=o.updateQueue;if(M!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}CM(o,M,u)}break;case 5:var L=o.stateNode;if(u===null&&o.flags&4){u=L;var k=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":k.autoFocus&&u.focus();break;case"img":k.src&&(u.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var j=o.alternate;if(j!==null){var J=j.memoizedState;if(J!==null){var ie=J.dehydrated;ie!==null&&Qu(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ue(163))}ni||o.flags&512&&h1(o)}catch(he){ln(o,o.return,he)}}if(o===r){Qe=null;break}if(u=o.sibling,u!==null){u.return=o.return,Qe=u;break}Qe=o.return}}function YM(r){for(;Qe!==null;){var o=Qe;if(o===r){Qe=null;break}var u=o.sibling;if(u!==null){u.return=o.return,Qe=u;break}Qe=o.return}}function QM(r){for(;Qe!==null;){var o=Qe;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{If(4,o)}catch(k){ln(o,u,k)}break;case 1:var p=o.stateNode;if(typeof p.componentDidMount=="function"){var v=o.return;try{p.componentDidMount()}catch(k){ln(o,v,k)}}var b=o.return;try{h1(o)}catch(k){ln(o,b,k)}break;case 5:var M=o.return;try{h1(o)}catch(k){ln(o,M,k)}}}catch(k){ln(o,o.return,k)}if(o===r){Qe=null;break}var L=o.sibling;if(L!==null){L.return=o.return,Qe=L;break}Qe=o.return}}var XN=Math.ceil,ff=Cs.ReactCurrentDispatcher,cy=Cs.ReactCurrentOwner,ir=Cs.ReactCurrentBatchConfig,At=0,Fn=null,vn=null,Gn=0,zi=0,Zl=Ta(0),Ln=0,ah=null,Co=0,Nf=0,uy=0,Bu=null,Ti=null,hy=0,cc=1/0,Ss=null,mf=!1,f1=null,xa=null,Ep=!1,pa=null,gf=0,ju=0,m1=null,jp=-1,Hp=0;function fi(){return At&6?pn():jp!==-1?jp:jp=pn()}function ba(r){return r.mode&1?At&2&&Gn!==0?Gn&-Gn:LN.transition!==null?(Hp===0&&(Hp=lT()),Hp):(r=Nt,r!==0||(r=window.event,r=r===void 0?16:mT(r.type)),r):1}function Rr(r,o,u,p){if(50<ju)throw ju=0,m1=null,Error(Ue(185));ch(r,u,p),(!(At&2)||r!==Fn)&&(r===Fn&&(!(At&2)&&(Nf|=u),Ln===4&&ha(r,Gn)),Pi(r,p),u===1&&At===0&&!(o.mode&1)&&(cc=pn()+500,Cf&&Ea()))}function Pi(r,o){var u=r.callbackNode;L4(r,o);var p=Jp(r,r===Fn?Gn:0);if(p===0)u!==null&&rM(u),r.callbackNode=null,r.callbackPriority=0;else if(o=p&-p,r.callbackPriority!==o){if(u!=null&&rM(u),o===1)r.tag===0?RN(ZM.bind(null,r)):IT(ZM.bind(null,r)),MN(function(){!(At&6)&&Ea()}),u=null;else{switch(cT(p)){case 1:u=F1;break;case 4:u=aT;break;case 16:u=Kp;break;case 536870912:u=oT;break;default:u=Kp}u=DE(u,TE.bind(null,r))}r.callbackPriority=o,r.callbackNode=u}}function TE(r,o){if(jp=-1,Hp=0,At&6)throw Error(Ue(327));var u=r.callbackNode;if(nc()&&r.callbackNode!==u)return null;var p=Jp(r,r===Fn?Gn:0);if(p===0)return null;if(p&30||p&r.expiredLanes||o)o=vf(r,p);else{o=p;var v=At;At|=2;var b=AE();(Fn!==r||Gn!==o)&&(Ss=null,cc=pn()+500,Eo(r,o));do try{QN();break}catch(L){EE(r,L)}while(1);Z1(),ff.current=b,At=v,vn!==null?o=0:(Fn=null,Gn=0,o=Ln)}if(o!==0){if(o===2&&(v=Hv(r),v!==0&&(p=v,o=g1(r,v))),o===1)throw u=ah,Eo(r,0),ha(r,p),Pi(r,pn()),u;if(o===6)ha(r,p);else{if(v=r.current.alternate,!(p&30)&&!qN(v)&&(o=vf(r,p),o===2&&(b=Hv(r),b!==0&&(p=b,o=g1(r,b))),o===1))throw u=ah,Eo(r,0),ha(r,p),Pi(r,pn()),u;switch(r.finishedWork=v,r.finishedLanes=p,o){case 0:case 1:throw Error(Ue(345));case 2:So(r,Ti,Ss);break;case 3:if(ha(r,p),(p&130023424)===p&&(o=hy+500-pn(),10<o)){if(Jp(r,0)!==0)break;if(v=r.suspendedLanes,(v&p)!==p){fi(),r.pingedLanes|=r.suspendedLanes&v;break}r.timeoutHandle=Zv(So.bind(null,r,Ti,Ss),o);break}So(r,Ti,Ss);break;case 4:if(ha(r,p),(p&4194240)===p)break;for(o=r.eventTimes,v=-1;0<p;){var M=31-Ar(p);b=1<<M,M=o[M],M>v&&(v=M),p&=~b}if(p=v,p=pn()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*XN(p/1960))-p,10<p){r.timeoutHandle=Zv(So.bind(null,r,Ti,Ss),p);break}So(r,Ti,Ss);break;case 5:So(r,Ti,Ss);break;default:throw Error(Ue(329))}}}return Pi(r,pn()),r.callbackNode===u?TE.bind(null,r):null}function g1(r,o){var u=Bu;return r.current.memoizedState.isDehydrated&&(Eo(r,o).flags|=256),r=vf(r,o),r!==2&&(o=Ti,Ti=u,o!==null&&v1(o)),r}function v1(r){Ti===null?Ti=r:Ti.push.apply(Ti,r)}function qN(r){for(var o=r;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var p=0;p<u.length;p++){var v=u[p],b=v.getSnapshot;v=v.value;try{if(!Pr(b(),v))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ha(r,o){for(o&=~uy,o&=~Nf,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var u=31-Ar(o),p=1<<u;r[u]=-1,o&=~p}}function ZM(r){if(At&6)throw Error(Ue(327));nc();var o=Jp(r,0);if(!(o&1))return Pi(r,pn()),null;var u=vf(r,o);if(r.tag!==0&&u===2){var p=Hv(r);p!==0&&(o=p,u=g1(r,p))}if(u===1)throw u=ah,Eo(r,0),ha(r,o),Pi(r,pn()),u;if(u===6)throw Error(Ue(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,So(r,Ti,Ss),Pi(r,pn()),null}function dy(r,o){var u=At;At|=1;try{return r(o)}finally{At=u,At===0&&(cc=pn()+500,Cf&&Ea())}}function Do(r){pa!==null&&pa.tag===0&&!(At&6)&&nc();var o=At;At|=1;var u=ir.transition,p=Nt;try{if(ir.transition=null,Nt=1,r)return r()}finally{Nt=p,ir.transition=u,At=o,!(At&6)&&Ea()}}function py(){zi=Zl.current,Qt(Zl)}function Eo(r,o){r.finishedWork=null,r.finishedLanes=0;var u=r.timeoutHandle;if(u!==-1&&(r.timeoutHandle=-1,_N(u)),vn!==null)for(u=vn.return;u!==null;){var p=u;switch(q1(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&rf();break;case 3:oc(),Qt(Ri),Qt(si),ny();break;case 5:ty(p);break;case 4:oc();break;case 13:Qt(tn);break;case 19:Qt(tn);break;case 10:K1(p.type._context);break;case 22:case 23:py()}u=u.return}if(Fn=r,vn=r=Sa(r.current,null),Gn=zi=o,Ln=0,ah=null,uy=Nf=Co=0,Ti=Bu=null,_o!==null){for(o=0;o<_o.length;o++)if(u=_o[o],p=u.interleaved,p!==null){u.interleaved=null;var v=p.next,b=u.pending;if(b!==null){var M=b.next;b.next=v,p.next=M}u.pending=p}_o=null}return r}function EE(r,o){do{var u=vn;try{if(Z1(),Up.current=pf,df){for(var p=rn.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}df=!1}if(Po=0,kn=En=rn=null,Uu=!1,ih=0,cy.current=null,u===null||u.return===null){Ln=1,ah=o,vn=null;break}e:{var b=r,M=u.return,L=u,k=o;if(o=Gn,L.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){var j=k,J=L,ie=J.tag;if(!(J.mode&1)&&(ie===0||ie===11||ie===15)){var he=J.alternate;he?(J.updateQueue=he.updateQueue,J.memoizedState=he.memoizedState,J.lanes=he.lanes):(J.updateQueue=null,J.memoizedState=null)}var Ee=FM(M);if(Ee!==null){Ee.flags&=-257,UM(Ee,M,L,b,o),Ee.mode&1&&kM(b,j,o),o=Ee,k=j;var me=o.updateQueue;if(me===null){var be=new Set;be.add(k),o.updateQueue=be}else me.add(k);break e}else{if(!(o&1)){kM(b,j,o),fy();break e}k=Error(Ue(426))}}else if($t&&L.mode&1){var ke=FM(M);if(ke!==null){!(ke.flags&65536)&&(ke.flags|=256),UM(ke,M,L,b,o),Y1(lc(k,L));break e}}b=k=lc(k,L),Ln!==4&&(Ln=2),Bu===null?Bu=[b]:Bu.push(b),b=M;do{switch(b.tag){case 3:b.flags|=65536,o&=-o,b.lanes|=o;var $=cE(b,k,o);PM(b,$);break e;case 1:L=k;var X=b.type,ne=b.stateNode;if(!(b.flags&128)&&(typeof X.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(xa===null||!xa.has(ne)))){b.flags|=65536,o&=-o,b.lanes|=o;var D=uE(b,L,o);PM(b,D);break e}}b=b.return}while(b!==null)}LE(u)}catch(Q){o=Q,vn===u&&u!==null&&(vn=u=u.return);continue}break}while(1)}function AE(){var r=ff.current;return ff.current=pf,r===null?pf:r}function fy(){(Ln===0||Ln===3||Ln===2)&&(Ln=4),Fn===null||!(Co&268435455)&&!(Nf&268435455)||ha(Fn,Gn)}function vf(r,o){var u=At;At|=2;var p=AE();(Fn!==r||Gn!==o)&&(Ss=null,Eo(r,o));do try{YN();break}catch(v){EE(r,v)}while(1);if(Z1(),At=u,ff.current=p,vn!==null)throw Error(Ue(261));return Fn=null,Gn=0,Ln}function YN(){for(;vn!==null;)RE(vn)}function QN(){for(;vn!==null&&!b4();)RE(vn)}function RE(r){var o=CE(r.alternate,r,zi);r.memoizedProps=r.pendingProps,o===null?LE(r):vn=o,cy.current=null}function LE(r){var o=r;do{var u=o.alternate;if(r=o.return,o.flags&32768){if(u=HN(u,o),u!==null){u.flags&=32767,vn=u;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Ln=6,vn=null;return}}else if(u=jN(u,o,zi),u!==null){vn=u;return}if(o=o.sibling,o!==null){vn=o;return}vn=o=r}while(o!==null);Ln===0&&(Ln=5)}function So(r,o,u){var p=Nt,v=ir.transition;try{ir.transition=null,Nt=1,ZN(r,o,u,p)}finally{ir.transition=v,Nt=p}return null}function ZN(r,o,u,p){do nc();while(pa!==null);if(At&6)throw Error(Ue(327));u=r.finishedWork;var v=r.finishedLanes;if(u===null)return null;if(r.finishedWork=null,r.finishedLanes=0,u===r.current)throw Error(Ue(177));r.callbackNode=null,r.callbackPriority=0;var b=u.lanes|u.childLanes;if(P4(r,b),r===Fn&&(vn=Fn=null,Gn=0),!(u.subtreeFlags&2064)&&!(u.flags&2064)||Ep||(Ep=!0,DE(Kp,function(){return nc(),null})),b=(u.flags&15990)!==0,u.subtreeFlags&15990||b){b=ir.transition,ir.transition=null;var M=Nt;Nt=1;var L=At;At|=4,cy.current=null,VN(r,u),_E(u,r),gN(Yv),$p=!!qv,Yv=qv=null,r.current=u,WN(u),S4(),At=L,Nt=M,ir.transition=b}else r.current=u;if(Ep&&(Ep=!1,pa=r,gf=v),b=r.pendingLanes,b===0&&(xa=null),M4(u.stateNode),Pi(r,pn()),o!==null)for(p=r.onRecoverableError,u=0;u<o.length;u++)v=o[u],p(v.value,{componentStack:v.stack,digest:v.digest});if(mf)throw mf=!1,r=f1,f1=null,r;return gf&1&&r.tag!==0&&nc(),b=r.pendingLanes,b&1?r===m1?ju++:(ju=0,m1=r):ju=0,Ea(),null}function nc(){if(pa!==null){var r=cT(gf),o=ir.transition,u=Nt;try{if(ir.transition=null,Nt=16>r?16:r,pa===null)var p=!1;else{if(r=pa,pa=null,gf=0,At&6)throw Error(Ue(331));var v=At;for(At|=4,Qe=r.current;Qe!==null;){var b=Qe,M=b.child;if(Qe.flags&16){var L=b.deletions;if(L!==null){for(var k=0;k<L.length;k++){var j=L[k];for(Qe=j;Qe!==null;){var J=Qe;switch(J.tag){case 0:case 11:case 15:zu(8,J,b)}var ie=J.child;if(ie!==null)ie.return=J,Qe=ie;else for(;Qe!==null;){J=Qe;var he=J.sibling,Ee=J.return;if(bE(J),J===j){Qe=null;break}if(he!==null){he.return=Ee,Qe=he;break}Qe=Ee}}}var me=b.alternate;if(me!==null){var be=me.child;if(be!==null){me.child=null;do{var ke=be.sibling;be.sibling=null,be=ke}while(be!==null)}}Qe=b}}if(b.subtreeFlags&2064&&M!==null)M.return=b,Qe=M;else e:for(;Qe!==null;){if(b=Qe,b.flags&2048)switch(b.tag){case 0:case 11:case 15:zu(9,b,b.return)}var $=b.sibling;if($!==null){$.return=b.return,Qe=$;break e}Qe=b.return}}var X=r.current;for(Qe=X;Qe!==null;){M=Qe;var ne=M.child;if(M.subtreeFlags&2064&&ne!==null)ne.return=M,Qe=ne;else e:for(M=X;Qe!==null;){if(L=Qe,L.flags&2048)try{switch(L.tag){case 0:case 11:case 15:If(9,L)}}catch(Q){ln(L,L.return,Q)}if(L===M){Qe=null;break e}var D=L.sibling;if(D!==null){D.return=L.return,Qe=D;break e}Qe=L.return}}if(At=v,Ea(),Zr&&typeof Zr.onPostCommitFiberRoot=="function")try{Zr.onPostCommitFiberRoot(Ef,r)}catch{}p=!0}return p}finally{Nt=u,ir.transition=o}}return!1}function KM(r,o,u){o=lc(u,o),o=cE(r,o,1),r=ya(r,o,1),o=fi(),r!==null&&(ch(r,1,o),Pi(r,o))}function ln(r,o,u){if(r.tag===3)KM(r,r,u);else for(;o!==null;){if(o.tag===3){KM(o,r,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(xa===null||!xa.has(p))){r=lc(u,r),r=uE(o,r,1),o=ya(o,r,1),r=fi(),o!==null&&(ch(o,1,r),Pi(o,r));break}}o=o.return}}function KN(r,o,u){var p=r.pingCache;p!==null&&p.delete(o),o=fi(),r.pingedLanes|=r.suspendedLanes&u,Fn===r&&(Gn&u)===u&&(Ln===4||Ln===3&&(Gn&130023424)===Gn&&500>pn()-hy?Eo(r,0):uy|=u),Pi(r,o)}function PE(r,o){o===0&&(r.mode&1?(o=gp,gp<<=1,!(gp&130023424)&&(gp=4194304)):o=1);var u=fi();r=Ls(r,o),r!==null&&(ch(r,o,u),Pi(r,u))}function JN(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),PE(r,u)}function $N(r,o){var u=0;switch(r.tag){case 13:var p=r.stateNode,v=r.memoizedState;v!==null&&(u=v.retryLane);break;case 19:p=r.stateNode;break;default:throw Error(Ue(314))}p!==null&&p.delete(o),PE(r,u)}var CE;CE=function(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps||Ri.current)Ei=!0;else{if(!(r.lanes&u)&&!(o.flags&128))return Ei=!1,BN(r,o,u);Ei=!!(r.flags&131072)}else Ei=!1,$t&&o.flags&1048576&&NT(o,of,o.index);switch(o.lanes=0,o.tag){case 2:var p=o.type;Bp(r,o),r=o.pendingProps;var v=rc(o,si.current);tc(o,u),v=ry(null,o,p,r,v,u);var b=sy();return o.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Li(p)?(b=!0,sf(o)):b=!1,o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,$1(o),v.updater=Of,o.stateNode=v,v._reactInternals=o,i1(o,p,r,u),o=a1(null,o,p,!0,b,u)):(o.tag=0,$t&&b&&X1(o),pi(null,o,v,u),o=o.child),o;case 16:p=o.elementType;e:{switch(Bp(r,o),r=o.pendingProps,v=p._init,p=v(p._payload),o.type=p,v=o.tag=t7(p),r=Mr(p,r),v){case 0:o=s1(null,o,p,r,u);break e;case 1:o=jM(null,o,p,r,u);break e;case 11:o=zM(null,o,p,r,u);break e;case 14:o=BM(null,o,p,Mr(p.type,r),u);break e}throw Error(Ue(306,p,""))}return o;case 0:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mr(p,v),s1(r,o,p,v,u);case 1:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mr(p,v),jM(r,o,p,v,u);case 3:e:{if(fE(o),r===null)throw Error(Ue(387));p=o.pendingProps,b=o.memoizedState,v=b.element,jT(r,o),uf(o,p,null,u);var M=o.memoizedState;if(p=M.element,b.isDehydrated)if(b={element:p,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){v=lc(Error(Ue(423)),o),o=HM(r,o,p,u,v);break e}else if(p!==v){v=lc(Error(Ue(424)),o),o=HM(r,o,p,u,v);break e}else for(Bi=va(o.stateNode.containerInfo.firstChild),ji=o,$t=!0,Er=null,u=zT(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(sc(),p===v){o=Ps(r,o,u);break e}pi(r,o,p,u)}o=o.child}return o;case 5:return HT(o),r===null&&e1(o),p=o.type,v=o.pendingProps,b=r!==null?r.memoizedProps:null,M=v.children,Qv(p,v)?M=null:b!==null&&Qv(p,b)&&(o.flags|=32),pE(r,o),pi(r,o,M,u),o.child;case 6:return r===null&&e1(o),null;case 13:return mE(r,o,u);case 4:return ey(o,o.stateNode.containerInfo),p=o.pendingProps,r===null?o.child=ac(o,null,p,u):pi(r,o,p,u),o.child;case 11:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mr(p,v),zM(r,o,p,v,u);case 7:return pi(r,o,o.pendingProps,u),o.child;case 8:return pi(r,o,o.pendingProps.children,u),o.child;case 12:return pi(r,o,o.pendingProps.children,u),o.child;case 10:e:{if(p=o.type._context,v=o.pendingProps,b=o.memoizedProps,M=v.value,Vt(lf,p._currentValue),p._currentValue=M,b!==null)if(Pr(b.value,M)){if(b.children===v.children&&!Ri.current){o=Ps(r,o,u);break e}}else for(b=o.child,b!==null&&(b.return=o);b!==null;){var L=b.dependencies;if(L!==null){M=b.child;for(var k=L.firstContext;k!==null;){if(k.context===p){if(b.tag===1){k=Ts(-1,u&-u),k.tag=2;var j=b.updateQueue;if(j!==null){j=j.shared;var J=j.pending;J===null?k.next=k:(k.next=J.next,J.next=k),j.pending=k}}b.lanes|=u,k=b.alternate,k!==null&&(k.lanes|=u),t1(b.return,u,o),L.lanes|=u;break}k=k.next}}else if(b.tag===10)M=b.type===o.type?null:b.child;else if(b.tag===18){if(M=b.return,M===null)throw Error(Ue(341));M.lanes|=u,L=M.alternate,L!==null&&(L.lanes|=u),t1(M,u,o),M=b.sibling}else M=b.child;if(M!==null)M.return=b;else for(M=b;M!==null;){if(M===o){M=null;break}if(b=M.sibling,b!==null){b.return=M.return,M=b;break}M=M.return}b=M}pi(r,o,v.children,u),o=o.child}return o;case 9:return v=o.type,p=o.pendingProps.children,tc(o,u),v=rr(v),p=p(v),o.flags|=1,pi(r,o,p,u),o.child;case 14:return p=o.type,v=Mr(p,o.pendingProps),v=Mr(p.type,v),BM(r,o,p,v,u);case 15:return hE(r,o,o.type,o.pendingProps,u);case 17:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mr(p,v),Bp(r,o),o.tag=1,Li(p)?(r=!0,sf(o)):r=!1,tc(o,u),lE(o,p,v),i1(o,p,v,u),a1(null,o,p,!0,r,u);case 19:return gE(r,o,u);case 22:return dE(r,o,u)}throw Error(Ue(156,o.tag))};function DE(r,o){return sT(r,o)}function e7(r,o,u,p){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(r,o,u,p){return new e7(r,o,u,p)}function my(r){return r=r.prototype,!(!r||!r.isReactComponent)}function t7(r){if(typeof r=="function")return my(r)?1:0;if(r!=null){if(r=r.$$typeof,r===I1)return 11;if(r===N1)return 14}return 2}function Sa(r,o){var u=r.alternate;return u===null?(u=nr(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&14680064,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u}function Gp(r,o,u,p,v,b){var M=2;if(p=r,typeof r=="function")my(r)&&(M=1);else if(typeof r=="string")M=5;else e:switch(r){case Bl:return Ao(u.children,v,b,o);case O1:M=8,v|=8;break;case Av:return r=nr(12,u,o,v|2),r.elementType=Av,r.lanes=b,r;case Rv:return r=nr(13,u,o,v),r.elementType=Rv,r.lanes=b,r;case Lv:return r=nr(19,u,o,v),r.elementType=Lv,r.lanes=b,r;case H2:return kf(u,v,b,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case B2:M=10;break e;case j2:M=9;break e;case I1:M=11;break e;case N1:M=14;break e;case la:M=16,p=null;break e}throw Error(Ue(130,r==null?r:typeof r,""))}return o=nr(M,u,o,v),o.elementType=r,o.type=p,o.lanes=b,o}function Ao(r,o,u,p){return r=nr(7,r,p,o),r.lanes=u,r}function kf(r,o,u,p){return r=nr(22,r,p,o),r.elementType=H2,r.lanes=u,r.stateNode={isHidden:!1},r}function yv(r,o,u){return r=nr(6,r,null,o),r.lanes=u,r}function xv(r,o,u){return o=nr(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function n7(r,o,u,p,v){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$g(0),this.expirationTimes=$g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$g(0),this.identifierPrefix=p,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function gy(r,o,u,p,v,b,M,L,k){return r=new n7(r,o,u,L,k),o===1?(o=1,b===!0&&(o|=8)):o=0,b=nr(3,null,null,o),r.current=b,b.stateNode=r,b.memoizedState={element:p,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},$1(b),r}function i7(r,o,u){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zl,key:p==null?null:""+p,children:r,containerInfo:o,implementation:u}}function OE(r){if(!r)return _a;r=r._reactInternals;e:{if(No(r)!==r||r.tag!==1)throw Error(Ue(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Li(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Ue(171))}if(r.tag===1){var u=r.type;if(Li(u))return OT(r,u,o)}return o}function IE(r,o,u,p,v,b,M,L,k){return r=gy(u,p,!0,r,v,b,M,L,k),r.context=OE(null),u=r.current,p=fi(),v=ba(u),b=Ts(p,v),b.callback=o??null,ya(u,b,v),r.current.lanes=v,ch(r,v,p),Pi(r,p),r}function Ff(r,o,u,p){var v=o.current,b=fi(),M=ba(v);return u=OE(u),o.context===null?o.context=u:o.pendingContext=u,o=Ts(b,M),o.payload={element:r},p=p===void 0?null:p,p!==null&&(o.callback=p),r=ya(v,o,M),r!==null&&(Rr(r,v,M,b),Fp(r,v,M)),M}function yf(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function JM(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function vy(r,o){JM(r,o),(r=r.alternate)&&JM(r,o)}function r7(){return null}var NE=typeof reportError=="function"?reportError:function(r){console.error(r)};function yy(r){this._internalRoot=r}Uf.prototype.render=yy.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(Ue(409));Ff(r,o,null,null)};Uf.prototype.unmount=yy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;Do(function(){Ff(null,r,null,null)}),o[Rs]=null}};function Uf(r){this._internalRoot=r}Uf.prototype.unstable_scheduleHydration=function(r){if(r){var o=dT();r={blockedOn:null,target:r,priority:o};for(var u=0;u<ua.length&&o!==0&&o<ua[u].priority;u++);ua.splice(u,0,r),u===0&&fT(r)}};function xy(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function zf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function $M(){}function s7(r,o,u,p,v){if(v){if(typeof p=="function"){var b=p;p=function(){var j=yf(M);b.call(j)}}var M=IE(o,p,r,0,null,!1,!1,"",$M);return r._reactRootContainer=M,r[Rs]=M.current,Ju(r.nodeType===8?r.parentNode:r),Do(),M}for(;v=r.lastChild;)r.removeChild(v);if(typeof p=="function"){var L=p;p=function(){var j=yf(k);L.call(j)}}var k=gy(r,0,!1,null,null,!1,!1,"",$M);return r._reactRootContainer=k,r[Rs]=k.current,Ju(r.nodeType===8?r.parentNode:r),Do(function(){Ff(o,k,u,p)}),k}function Bf(r,o,u,p,v){var b=u._reactRootContainer;if(b){var M=b;if(typeof v=="function"){var L=v;v=function(){var k=yf(M);L.call(k)}}Ff(o,M,r,v)}else M=s7(u,o,r,v,p);return yf(M)}uT=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var u=Cu(o.pendingLanes);u!==0&&(U1(o,u|1),Pi(o,pn()),!(At&6)&&(cc=pn()+500,Ea()))}break;case 13:Do(function(){var p=Ls(r,1);if(p!==null){var v=fi();Rr(p,r,1,v)}}),vy(r,1)}};z1=function(r){if(r.tag===13){var o=Ls(r,134217728);if(o!==null){var u=fi();Rr(o,r,134217728,u)}vy(r,134217728)}};hT=function(r){if(r.tag===13){var o=ba(r),u=Ls(r,o);if(u!==null){var p=fi();Rr(u,r,o,p)}vy(r,o)}};dT=function(){return Nt};pT=function(r,o){var u=Nt;try{return Nt=r,o()}finally{Nt=u}};zv=function(r,o,u){switch(o){case"input":if(Dv(r,u),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==r&&p.form===r.form){var v=Pf(p);if(!v)throw Error(Ue(90));V2(p),Dv(p,v)}}}break;case"textarea":X2(r,u);break;case"select":o=u.value,o!=null&&Kl(r,!!u.multiple,o,!1)}};$2=dy;eT=Do;var a7={usingClientEntryPoint:!1,Events:[hh,Vl,Pf,K2,J2,dy]},Eu={findFiberByHostInstance:wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},o7={bundleType:Eu.bundleType,version:Eu.version,rendererPackageName:Eu.rendererPackageName,rendererConfig:Eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=iT(r),r===null?null:r.stateNode},findFiberByHostInstance:Eu.findFiberByHostInstance||r7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ap=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ap.isDisabled&&Ap.supportsFiber)try{Ef=Ap.inject(o7),Zr=Ap}catch{}}Vi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a7;Vi.createPortal=function(r,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xy(o))throw Error(Ue(200));return i7(r,o,null,u)};Vi.createRoot=function(r,o){if(!xy(r))throw Error(Ue(299));var u=!1,p="",v=NE;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),o=gy(r,1,!1,null,null,u,!1,p,v),r[Rs]=o.current,Ju(r.nodeType===8?r.parentNode:r),new yy(o)};Vi.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(Ue(188)):(r=Object.keys(r).join(","),Error(Ue(268,r)));return r=iT(o),r=r===null?null:r.stateNode,r};Vi.flushSync=function(r){return Do(r)};Vi.hydrate=function(r,o,u){if(!zf(o))throw Error(Ue(200));return Bf(null,r,o,!0,u)};Vi.hydrateRoot=function(r,o,u){if(!xy(r))throw Error(Ue(405));var p=u!=null&&u.hydratedSources||null,v=!1,b="",M=NE;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onRecoverableError!==void 0&&(M=u.onRecoverableError)),o=IE(o,null,r,1,u??null,v,!1,b,M),r[Rs]=o.current,Ju(r),p)for(r=0;r<p.length;r++)u=p[r],v=u._getVersion,v=v(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,v]:o.mutableSourceEagerHydrationData.push(u,v);return new Uf(o)};Vi.render=function(r,o,u){if(!zf(o))throw Error(Ue(200));return Bf(null,r,o,!1,u)};Vi.unmountComponentAtNode=function(r){if(!zf(r))throw Error(Ue(40));return r._reactRootContainer?(Do(function(){Bf(null,null,r,!1,function(){r._reactRootContainer=null,r[Rs]=null})}),!0):!1};Vi.unstable_batchedUpdates=dy;Vi.unstable_renderSubtreeIntoContainer=function(r,o,u,p){if(!zf(u))throw Error(Ue(200));if(r==null||r._reactInternals===void 0)throw Error(Ue(38));return Bf(r,o,u,!1,p)};Vi.version="18.3.1-next-f1338f8080-20240426";function kE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kE)}catch(r){console.error(r)}}kE(),k2.exports=Vi;var l7=k2.exports,e2=l7;Tv.createRoot=e2.createRoot,Tv.hydrateRoot=e2.hydrateRoot;/*! For license information please see xviewer.module.min.js.LICENSE.txt */var c7={631:(r,o,u)=>{u.r(o),u.d(o,{TweenChain:()=>v});const p=u(622);class v{constructor(M){this._object=M,this._tween=new p.Tween(M)}start(){return this._tween.start(),this}stop(){return this._tween.stop(),this}repeat(M){return this._chainedTween.repeat(M),this}union(){return this._chainedTween=this._tween=new p.Tween(this._object).union(this._tween,this._chainedTween),this}call(M){return this._chainTween().call(M),this}delay(M){return this._chainTween().delay(M),this}to(M,L,k){let j=this._chainTween().to(M,L);return k&&(k.from&&j.from(k.from),k.easing&&j.easing(k.easing),k.onStart&&j.onStart(k.onStart),k.onStop&&j.onStop(k.onStop),k.onComplete&&j.onComplete(k.onComplete),k.onUpdate&&j.onUpdate(k.onUpdate),k.onRepeat&&j.onRepeat(k.onRepeat)),this}_chainTween(){let M=this._tween;return this._chainedTween&&(M=new p.Tween(this._object),this._chainedTween.chain(M)),this._chainedTween=M,M}}},622:(r,o)=>{Object.defineProperty(o,"__esModule",{value:!0});var u,p={Linear:{None:function(D){return D}},Quadratic:{In:function(D){return D*D},Out:function(D){return D*(2-D)},InOut:function(D){return(D*=2)<1?.5*D*D:-.5*(--D*(D-2)-1)}},Cubic:{In:function(D){return D*D*D},Out:function(D){return--D*D*D+1},InOut:function(D){return(D*=2)<1?.5*D*D*D:.5*((D-=2)*D*D+2)}},Quartic:{In:function(D){return D*D*D*D},Out:function(D){return 1- --D*D*D*D},InOut:function(D){return(D*=2)<1?.5*D*D*D*D:-.5*((D-=2)*D*D*D-2)}},Quintic:{In:function(D){return D*D*D*D*D},Out:function(D){return--D*D*D*D*D+1},InOut:function(D){return(D*=2)<1?.5*D*D*D*D*D:.5*((D-=2)*D*D*D*D+2)}},Sinusoidal:{In:function(D){return 1-Math.cos(D*Math.PI/2)},Out:function(D){return Math.sin(D*Math.PI/2)},InOut:function(D){return .5*(1-Math.cos(Math.PI*D))}},Exponential:{In:function(D){return D===0?0:Math.pow(1024,D-1)},Out:function(D){return D===1?1:1-Math.pow(2,-10*D)},InOut:function(D){return D===0?0:D===1?1:(D*=2)<1?.5*Math.pow(1024,D-1):.5*(2-Math.pow(2,-10*(D-1)))}},Circular:{In:function(D){return 1-Math.sqrt(1-D*D)},Out:function(D){return Math.sqrt(1- --D*D)},InOut:function(D){return(D*=2)<1?-.5*(Math.sqrt(1-D*D)-1):.5*(Math.sqrt(1-(D-=2)*D)+1)}},Elastic:{In:function(D){return D===0?0:D===1?1:-Math.pow(2,10*(D-1))*Math.sin(5*(D-1.1)*Math.PI)},Out:function(D){return D===0?0:D===1?1:Math.pow(2,-10*D)*Math.sin(5*(D-.1)*Math.PI)+1},InOut:function(D){return D===0?0:D===1?1:(D*=2)<1?-.5*Math.pow(2,10*(D-1))*Math.sin(5*(D-1.1)*Math.PI):.5*Math.pow(2,-10*(D-1))*Math.sin(5*(D-1.1)*Math.PI)+1}},Back:{In:function(D){var Q=1.70158;return D*D*((Q+1)*D-Q)},Out:function(D){var Q=1.70158;return--D*D*((Q+1)*D+Q)+1},InOut:function(D){var Q=2.5949095;return(D*=2)<1?D*D*((Q+1)*D-Q)*.5:.5*((D-=2)*D*((Q+1)*D+Q)+2)}},Bounce:{In:function(D){return 1-p.Bounce.Out(1-D)},Out:function(D){return D<1/2.75?7.5625*D*D:D<2/2.75?7.5625*(D-=1.5/2.75)*D+.75:D<2.5/2.75?7.5625*(D-=2.25/2.75)*D+.9375:7.5625*(D-=2.625/2.75)*D+.984375},InOut:function(D){return D<.5?.5*p.Bounce.In(2*D):.5*p.Bounce.Out(2*D-1)+.5}}};function v(){return .001*u()}u=typeof self>"u"&&typeof process<"u"&&process.hrtime?function(){var D=process.hrtime();return 1e3*D[0]+D[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?self.performance.now.bind(self.performance):Date.now!==void 0?Date.now:function(){return new Date().getTime()};var b,M=function(){function D(){this._tweens={},this._tweensAddedDuringUpdate={}}return D.prototype.getAll=function(){var Q=this;return Object.keys(this._tweens).map(function(se){return Q._tweens[se]})},D.prototype.removeAll=function(){this._tweens={}},D.prototype.add=function(Q){this._tweens[Q.getId()]=Q,this._tweensAddedDuringUpdate[Q.getId()]=Q},D.prototype.remove=function(Q){delete this._tweens[Q.getId()],delete this._tweensAddedDuringUpdate[Q.getId()]},D.prototype.update=function(Q,se){Q===void 0&&(Q=v()),se===void 0&&(se=!1);var ye=Object.keys(this._tweens);if(ye.length===0)return!1;for(;ye.length>0;){this._tweensAddedDuringUpdate={};for(var Me=0;Me<ye.length;Me++){var Xe=this._tweens[ye[Me]],Be=!se;Xe&&Xe.update(Q,Be)===!1&&!se&&delete this._tweens[ye[Me]]}ye=Object.keys(this._tweensAddedDuringUpdate)}return!0},D}(),L={Linear:function(D,Q){var se=D.length-1,ye=se*Q,Me=Math.floor(ye),Xe=L.Utils.Linear;return Q<0?Xe(D[0],D[1],ye):Q>1?Xe(D[se],D[se-1],se-ye):Xe(D[Me],D[Me+1>se?se:Me+1],ye-Me)},Bezier:function(D,Q){for(var se=0,ye=D.length-1,Me=Math.pow,Xe=L.Utils.Bernstein,Be=0;Be<=ye;Be++)se+=Me(1-Q,ye-Be)*Me(Q,Be)*D[Be]*Xe(ye,Be);return se},CatmullRom:function(D,Q){var se=D.length-1,ye=se*Q,Me=Math.floor(ye),Xe=L.Utils.CatmullRom;return D[0]===D[se]?(Q<0&&(Me=Math.floor(ye=se*(1+Q))),Xe(D[(Me-1+se)%se],D[Me],D[(Me+1)%se],D[(Me+2)%se],ye-Me)):Q<0?D[0]-(Xe(D[0],D[0],D[1],D[1],-ye)-D[0]):Q>1?D[se]-(Xe(D[se],D[se],D[se-1],D[se-1],ye-se)-D[se]):Xe(D[Me?Me-1:0],D[Me],D[se<Me+1?se:Me+1],D[se<Me+2?se:Me+2],ye-Me)},Utils:{Linear:function(D,Q,se){return(Q-D)*se+D},Bernstein:function(D,Q){var se=L.Utils.Factorial;return se(D)/se(Q)/se(D-Q)},Factorial:(b=[1],function(D){var Q=1;if(b[D])return b[D];for(var se=D;se>1;se--)Q*=se;return b[D]=Q,Q}),CatmullRom:function(D,Q,se,ye,Me){var Xe=.5*(se-D),Be=.5*(ye-Q),ot=Me*Me;return(2*Q-2*se+Xe+Be)*(Me*ot)+(-3*Q+3*se-2*Xe-Be)*ot+Xe*Me+Q}}},k=function(){function D(){}return D.nextId=function(){return D._nextId++},D._nextId=0,D}(),j=new M,J=function(){function D(Q,se){se===void 0&&(se=j),this._object=Q,this._group=se,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=0,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=p.Linear.None,this._interpolationFunction=L.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=k.nextId(),this._isChainStopped=!1,this._goToEnd=!1,this._headTween=null,this._tailTween=null,this._headStart=!1}return D.prototype.getId=function(){return this._id},D.prototype.isPlaying=function(){return this._isPlaying},D.prototype.isPaused=function(){return this._isPaused},D.prototype.duration=function(Q){return this._duration=Q,this},D.prototype.start=function(Q){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var se in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(se),this._valuesStart[se]=this._valuesStartRepeat[se];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=Q!==void 0?typeof Q=="string"?v()+parseFloat(Q):Q:v(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},D.prototype._setupProperties=function(Q,se,ye,Me){for(var Xe in ye){var Be=Q[Xe],ot=Array.isArray(Be),xn=ot?"array":typeof Be,ai=!ot&&Array.isArray(ye[Xe]);if(xn!=="undefined"&&xn!=="function"){if(ai){var ar=ye[Xe];if(ar.length===0)continue;ar=ar.map(this._handleRelativeValue.bind(this,Be)),ye[Xe]=[Be].concat(ar)}if(xn!=="object"&&!ot||!Be||ai)se[Xe]===void 0&&(se[Xe]=Be),ot||(se[Xe]*=1),Me[Xe]=ai?ye[Xe].slice().reverse():se[Xe]||0;else{for(var Ra in se[Xe]=ot?[]:{},Be)se[Xe][Ra]=Be[Ra];Me[Xe]=ot?[]:{},this._setupProperties(Be,se[Xe],ye[Xe],Me[Xe])}}}},D.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},D.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},D.prototype.pause=function(Q){return Q===void 0&&(Q=v()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=Q,this._group&&this._group.remove(this)),this},D.prototype.resume=function(Q){return Q===void 0&&(Q=v()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=Q-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},D.prototype.stopChainedTweens=function(){for(var Q=0,se=this._chainedTweens.length;Q<se;Q++)this._chainedTweens[Q].stop();return this._chainedTweens=[],this},D.prototype.group=function(Q){return this._group=Q,this},D.prototype.call=function(Q){return this._onFinishCallback=Q,this},D.prototype.from=function(Q){return this._valuesStart=Object.create(Q),this},D.prototype.to=function(Q,se){return this._valuesEnd=Object.create(Q),se!==void 0&&(this._duration=se),this._chainedTween=this,this},D.prototype.delay=function(Q){return this._delayTime=Q,this},D.prototype.union=function(Q,se){return this._headTween=Q,this._tailTween=se.chain(this),this._headStart=!0,this},D.prototype.repeat=function(Q){return this._initialRepeat=Q,this._repeat=Q,this},D.prototype.repeatDelay=function(Q){return this._repeatDelayTime=Q,this},D.prototype.yoyo=function(Q){return this._yoyo=Q,this},D.prototype.easing=function(Q){return this._easingFunction=Q,this},D.prototype.interpolation=function(Q){return this._interpolationFunction=Q,this},D.prototype.chain=function(){for(var Q=[],se=0;se<arguments.length;se++)Q[se]=arguments[se];return this._chainedTweens=Q,this},D.prototype.unchain=function(){for(var Q=0;Q<arguments.length;Q++){let se=this._chainedTweens.findIndex(ye=>ye==arguments[Q]);se>-1&&this._chainedTweens.splice(se,1)}return this},D.prototype.onStart=function(Q){return this._onStartCallback=Q,this},D.prototype.onUpdate=function(Q){return this._onUpdateCallback=Q,this},D.prototype.onRepeat=function(Q){return this._onRepeatCallback=Q,this},D.prototype.onComplete=function(Q){return this._onCompleteCallback=Q,this},D.prototype.onStop=function(Q){return this._onStopCallback=Q,this},D.prototype.update=function(Q,se){if(Q===void 0&&(Q=v()),se===void 0&&(se=!0),this._isPaused)return!0;var ye,Me,Xe=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(Q>Xe)return!1;se&&this.start(Q)}if(this._goToEnd=!1,Q<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),Me=(Q-this._startTime)/this._duration,Me=this._duration===0||Me>1?1:Me;var Be=this._easingFunction(Me);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,Be),this._onUpdateCallback&&this._onUpdateCallback(this._object,Me),Me===1){if(this._onFinishCallback&&this._onFinishCallback(this._object),this._headTween&&this._headStart)return this._headTween.start(this._startTime+this._duration),this._headStart=!1,this._isPlaying=!1,!1;if(this._repeat>0){for(ye in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||typeof this._valuesEnd[ye]!="string"||(this._valuesStartRepeat[ye]=this._valuesStartRepeat[ye]+parseFloat(this._valuesEnd[ye])),this._yoyo&&this._swapEndStartRepeatValues(ye),this._valuesStart[ye]=this._valuesStartRepeat[ye];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=Q+this._repeatDelayTime:this._startTime=Q+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._headTween&&(this._headStart=!0,this._initialRepeat=this._repeat),!0}this._tailTween&&this._tailTween.unchain(this),this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var ot=0,xn=this._chainedTweens.length;ot<xn;ot++)this._chainedTweens[ot].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},D.prototype._updateProperties=function(Q,se,ye,Me){for(var Xe in ye)if(se[Xe]!==void 0){var Be=se[Xe]||0,ot=ye[Xe],xn=Array.isArray(Q[Xe]),ai=Array.isArray(ot);!xn&&ai?Q[Xe]=this._interpolationFunction(ot,Me):typeof ot=="object"&&ot?this._updateProperties(Q[Xe],Be,ot,Me):typeof(ot=this._handleRelativeValue(Be,ot))=="number"&&(Q[Xe]=Be+(ot-Be)*Me)}},D.prototype._handleRelativeValue=function(Q,se){return typeof se!="string"?se:se.charAt(0)==="+"||se.charAt(0)==="-"?Q+parseFloat(se):parseFloat(se)},D.prototype._swapEndStartRepeatValues=function(Q){var se=this._valuesStartRepeat[Q],ye=this._valuesEnd[Q];this._valuesStartRepeat[Q]=typeof ye=="string"?this._valuesStartRepeat[Q]+parseFloat(ye):this._valuesEnd[Q],this._valuesEnd[Q]=se},D}(),ie="18.6.4",he=k.nextId,Ee=j,me=Ee.getAll.bind(Ee),be=Ee.removeAll.bind(Ee),ke=Ee.add.bind(Ee),$=Ee.remove.bind(Ee),X=Ee.update.bind(Ee),ne={Easing:p,Group:M,Interpolation:L,now:v,Sequence:k,nextId:he,Tween:J,VERSION:ie,getAll:me,removeAll:be,add:ke,remove:$,update:X};o.Easing=p,o.Group=M,o.Interpolation=L,o.Sequence=k,o.Tween=J,o.VERSION=ie,o.add=ke,o.default=ne,o.getAll=me,o.nextId=he,o.now=v,o.remove=$,o.removeAll=be,o.update=X}},t2={};function Yt(r){var o=t2[r];if(o!==void 0)return o.exports;var u=t2[r]={exports:{}};return c7[r](u,u.exports,Yt),u.exports}Yt.d=(r,o)=>{for(var u in o)Yt.o(o,u)&&!Yt.o(r,u)&&Object.defineProperty(r,u,{enumerable:!0,get:o[u]})},Yt.o=(r,o)=>Object.prototype.hasOwnProperty.call(r,o),Yt.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var A={};(()=>{Yt.d(A,{J12:()=>Q0,$c:()=>GP,I_b:()=>QS,oGK:()=>Hd,$p:()=>Mt,$q:()=>XP,$r:()=>YS,i5S:()=>VP,nXV:()=>qS,bd1:()=>WP,LY2:()=>em,bGH:()=>or,NDo:()=>By,gSk:()=>Em,WMw:()=>xn,OTo:()=>Zy,Se2:()=>Jf,cum:()=>hx,Mig:()=>z0,i_9:()=>_L,m7l:()=>Za,sYA:()=>fL,Xcj:()=>NL,mzJ:()=>DL,ZZA:()=>hL,T__:()=>Rb,HkE:()=>ab,tGC:()=>JL,gOo:()=>Zs,meI:()=>Zn,BbS:()=>j0,kqm:()=>AL,Wat:()=>Zw,Hmr:()=>B0,SJI:()=>Od,rMl:()=>_O,mTL:()=>cS,y8_:()=>$L,_Li:()=>ye,z81:()=>hr,_MY:()=>X,dFZ:()=>Ig,IIx:()=>Yw,N$j:()=>ul,XO3:()=>Kw,_YM:()=>Xa,TUj:()=>jL,ZzF:()=>Ir,GQ:()=>ZL,nvb:()=>nP,DvJ:()=>cs,fQA:()=>QL,TlE:()=>tt,u9r:()=>$e,s4_:()=>sS,T95:()=>Wy,CtF:()=>qs,V1s:()=>el,Rki:()=>YL,ROQ:()=>$R,YN5:()=>iP,BVQ:()=>dl,YT8:()=>Lb,_DE:()=>A_,YGz:()=>Gy,WXy:()=>ug,max:()=>v,trn:()=>rP,zf8:()=>pl,uWy:()=>bn,SUY:()=>dS,Ilk:()=>Ie,xRS:()=>Jw,R2R:()=>I0,epp:()=>Pn,wA2:()=>Tt,Z_g:()=>JR,EB7:()=>m0,DqL:()=>mL,_3:()=>sP,b_z:()=>fl,Qrh:()=>ki,unp:()=>qw,_am:()=>Cx,fY$:()=>Ds,vxC:()=>Os,BtG:()=>Ic,cBK:()=>gL,g8_:()=>Fo,AXT:()=>b0,yj7:()=>Cb,dYG:()=>qb,tm_:()=>be,S2y:()=>ke,B02:()=>$,PeU:()=>me,Hyl:()=>Qi,Wqd:()=>Ob,Xaj:()=>Ra,dZ3:()=>Vy,m_w:()=>aP,fHI:()=>Ws,LBq:()=>BL,JUT:()=>Fm,p3g:()=>Dh,IEO:()=>Gs,yxD:()=>Jb,A5E:()=>$c,jfJ:()=>_3,T_J:()=>T3,tEQ:()=>Zb,qkB:()=>ts,HWo:()=>rp,brP:()=>Ns,$YQ:()=>Uc,iRp:()=>Dn,Ox3:()=>Rd,cBI:()=>CS,cU9:()=>Yb,ntt:()=>Rm,DT1:()=>oP,Kgo:()=>ml,ehD:()=>Me,fSK:()=>Ca,Vdb:()=>Ny,l8J:()=>z3,dj0:()=>dx,QM0:()=>k3,TOt:()=>M0,Qmf:()=>kl,JIf:()=>Vr,Ny0:()=>gd,eD:()=>vc,jwo:()=>L3,dSO:()=>Is,Bf4:()=>xc,USm:()=>Xn,pBf:()=>Xi,vpe:()=>L,$Vf:()=>lP,O7d:()=>vl,JE9:()=>mu,hH6:()=>hi,e62:()=>cA,a$l:()=>We,OM3:()=>uA,VzW:()=>Ci,ybr:()=>rd,yo9:()=>id,Wzm:()=>KR,zUS:()=>kw,Wl3:()=>se,iWj:()=>Nc,CoK:()=>Jd,ylh:()=>UL,v9Y:()=>j3,LSk:()=>Lm,XSA:()=>ep,w$m:()=>Uy,ksN:()=>$f,j4z:()=>O3,OAl:()=>C3,VLJ:()=>XL,ZAu:()=>Yn,cLu:()=>yi,vmT:()=>$b,Qpg:()=>WL,So8:()=>wL,Wjw:()=>cP,cJO:()=>yl,QRU:()=>lS,uSM:()=>i_,S3k:()=>Zc,fnl:()=>SO,PpQ:()=>Nm,ZRs:()=>w3,oqc:()=>M3,UT1:()=>jg,KQe:()=>Gg,s28:()=>Hg,uEm:()=>zg,b08:()=>Ug,yPR:()=>go,ph9:()=>Wr,llF:()=>Fg,EIF:()=>Bg,lb7:()=>Vs,L5s:()=>Cd,$TI:()=>yS,SPe:()=>hd,aVm:()=>oA,j87:()=>lA,RNb:()=>rA,Kz5:()=>qy,vpT:()=>sl,kB5:()=>ui,_C8:()=>Tl,Syv:()=>Bo,NMF:()=>Da,pIN:()=>Ah,eMJ:()=>E3,x5V:()=>Ph,tUh:()=>vr,z8B:()=>pb,GZb:()=>uP,p7y:()=>Ha,S9g:()=>Uh,Zr5:()=>vh,vCF:()=>gc,yt0:()=>P3,uXU:()=>R3,_kC:()=>Ys,lk7:()=>Ld,x12:()=>kr,Zzh:()=>HL,nls:()=>Un,g_z:()=>yd,U7:()=>Db,FT0:()=>Wb,blk:()=>d0,ejS:()=>gr,rnI:()=>ur,wem:()=>at,lfu:()=>O0,FDw:()=>x3,lRj:()=>y3,D1R:()=>cr,qyh:()=>bh,GUF:()=>jo,EoG:()=>jy,aNw:()=>Qn,Zp0:()=>Ka,lLk:()=>N0,jAl:()=>sx,uEv:()=>ox,YKA:()=>ax,cRx:()=>Jy,Y8D:()=>Ky,RsA:()=>he,F5T:()=>un,u7G:()=>Pd,M8C:()=>fn,Vkp:()=>mn,yGw:()=>Ne,Sm8:()=>lt,Kj0:()=>et,vBJ:()=>xi,lRF:()=>td,Lun:()=>o0,YBo:()=>L0,kaV:()=>Vb,RSm:()=>R0,xoR:()=>Qc,EJi:()=>ps,Qme:()=>Qw,Wid:()=>Bt,IKL:()=>Gb,r_:()=>it,OoA:()=>Uo,qhX:()=>zy,M5h:()=>ar,Ns1:()=>yc,Ue:()=>mo,RR3:()=>oI,TyD:()=>Rt,vZf:()=>v3,HTd:()=>g3,aH4:()=>zo,YLQ:()=>bc,BVF:()=>Kf,MyG:()=>A3,jFi:()=>Be,aCh:()=>ux,uL9:()=>Or,IFH:()=>Tm,bdR:()=>ot,M6v:()=>yh,RvT:()=>D3,ymC:()=>$w,dUE:()=>qa,Tme:()=>ct,Gql:()=>bL,PA7:()=>cx,REq:()=>hP,pQR:()=>Va,ghN:()=>cn,Hy8:()=>Iy,Wpd:()=>ky,LgZ:()=>lr,iWC:()=>Dr,lkL:()=>e_,iKG:()=>Hs,_iA:()=>ne,ntZ:()=>D,anP:()=>i0,HRQ:()=>yg,hpZ:()=>b,w2v:()=>On,WI2:()=>fo,y$t:()=>Wc,cPb:()=>Kt,JOQ:()=>us,BKK:()=>dP,_12:()=>hs,tJx:()=>KL,OdJ:()=>xO,SyM:()=>Kn,cek:()=>Jc,xG9:()=>ES,woe:()=>f0,UY4:()=>pd,aq0:()=>qL,ujx:()=>pP,Uol:()=>Fr,VYz:()=>gS,tSf:()=>MO,M20:()=>po,iUV:()=>gt,tf:()=>vS,ZQ6:()=>S0,mXe:()=>xd,_fP:()=>Ut,iLg:()=>fs,zbs:()=>Qb,ZTh:()=>_m,HdW:()=>rx,UZH:()=>ie,mSO:()=>Lh,wk1:()=>oi,E2K:()=>nx,FUD:()=>xm,pKu:()=>gm,GG6:()=>vm,Gih:()=>ym,iiP:()=>bm,SvJ:()=>Sm,ptH:()=>lm,jZA:()=>cm,y2t:()=>um,gi4:()=>hm,Djp:()=>dm,BG$:()=>pm,NYV:()=>fm,xJs:()=>mm,bsb:()=>Eh,ekQ:()=>om,CaW:()=>sm,eaV:()=>rm,BFQ:()=>_h,v3W:()=>Mh,ILR:()=>Th,fto:()=>ix,l0P:()=>am,vCx:()=>im,_AM:()=>nm,wuA:()=>wh,av9:()=>ex,CtA:()=>tx,FIo:()=>Hb,zHn:()=>Rc,iMs:()=>zL,T_f:()=>iS,hEm:()=>tm,D9w:()=>$y,CdI:()=>Hy,wo6:()=>Vd,TIb:()=>bO,rpg:()=>vi,ce8:()=>S3,rOj:()=>Ye,V4E:()=>fP,o8S:()=>xl,lGU:()=>Mm,vuL:()=>wm,KI_:()=>Di,iLN:()=>Og,xsS:()=>ja,b26:()=>J,w5d:()=>sp,WdD:()=>dt,Vj0:()=>mr,jyz:()=>St,Tn7:()=>jb,bnF:()=>ds,HW6:()=>mP,oa8:()=>bl,T_1:()=>eP,iDF:()=>Ur,iAb:()=>Xy,OdW:()=>hl,_YX:()=>GL,TUv:()=>cd,Hw6:()=>ka,aLr:()=>rs,Aip:()=>gP,xo$:()=>Xs,$V:()=>bS,lDi:()=>rS,gti:()=>w0,PMe:()=>Ad,FvO:()=>MS,jyi:()=>hb,xeV:()=>c0,k74:()=>Pa,RlZ:()=>Fy,KhW:()=>La,HgB:()=>U3,W2J:()=>wc,JWc:()=>N3,kP0:()=>EO,u37:()=>ML,Z6B:()=>B3,QZ1:()=>I3,Ir4:()=>F3,nE5:()=>t_,NwF:()=>Ya,Wbm:()=>ko,N4l:()=>ai,QmN:()=>Ee,wes:()=>p,IOt:()=>ks,L5g:()=>vP,H$k:()=>Sl,xEZ:()=>zt,Yin:()=>KS,dpR:()=>Ed,hmx:()=>br,Lb$:()=>R_,Cne:()=>yP,XvJ:()=>wl,XZw:()=>xP,FE5:()=>_l,CJI:()=>qi,z$h:()=>Rh,UlW:()=>Am,WwZ:()=>lx,Lcc:()=>bP,WXh:()=>Ml,VNk:()=>_w,ub3:()=>Xe,xfE:()=>xh,qlB:()=>Hh,lCJ:()=>Qm,WTc:()=>sA,rAo:()=>aA,xWb:()=>Ge,gH0:()=>FL,rBU:()=>Ve,rDY:()=>$m,ywz:()=>Sn,wJv:()=>es,JQ4:()=>$r,k0A:()=>Yy,irR:()=>Qy,LsT:()=>Sh,Oih:()=>Pw,p9U:()=>Lw,MiG:()=>Hr,JSe:()=>Cw,dwk:()=>Q,FM8:()=>de,Pa4:()=>O,Ltg:()=>Ke,yC1:()=>Qa,Lpp:()=>wO,fO1:()=>ZR,AEx:()=>gD,_9o:()=>Dw,k5T:()=>AO,b5g:()=>ob,Ywn:()=>Q3,GVz:()=>Y3,oAp:()=>Dx,kFz:()=>yx,dd2:()=>Lt,CP7:()=>nd,fQK:()=>sb,Uk6:()=>A0,_sL:()=>Sc,Pnf:()=>Oa,c8b:()=>Zt,_lf:()=>Ia,ad5:()=>b3,L_r:()=>Ch,HOT:()=>jr,$R8:()=>u,lDs:()=>YP,Oe_:()=>qP,S6$:()=>M,CbL:()=>It,knz:()=>mt});var r={};Yt.r(r),Yt.d(r,{ArcCurve:()=>Rb,CatmullRomCurve3:()=>Lb,CubicBezierCurve:()=>b0,CubicBezierCurve3:()=>Cb,EllipseCurve:()=>gd,LineCurve:()=>yd,LineCurve3:()=>Db,QuadraticBezierCurve:()=>S0,QuadraticBezierCurve3:()=>xd,SplineCurve:()=>w0});var o={};Yt.r(o),Yt.d(o,{BoxGeometry:()=>cs,CapsuleGeometry:()=>dl,CircleGeometry:()=>pl,ConeGeometry:()=>fl,CylinderGeometry:()=>Ws,DodecahedronGeometry:()=>ml,EdgesGeometry:()=>M0,ExtrudeGeometry:()=>vl,IcosahedronGeometry:()=>yl,LatheGeometry:()=>Ha,OctahedronGeometry:()=>Va,PlaneGeometry:()=>hs,PolyhedronGeometry:()=>Fr,RingGeometry:()=>xl,ShapeGeometry:()=>bl,SphereGeometry:()=>Xs,TetrahedronGeometry:()=>Sl,TorusGeometry:()=>wl,TorusKnotGeometry:()=>_l,TubeGeometry:()=>Ml,WireframeGeometry:()=>A0});var u={};Yt.r(u),Yt.d(u,{CSS2DObject:()=>wP,CSS2DRenderer:()=>_P,CSS3DObject:()=>zS,CSS3DRenderer:()=>AP,CSS3DSprite:()=>TP,Projector:()=>RP,RenderableFace:()=>jS,RenderableLine:()=>HS,RenderableObject:()=>BS,RenderableSprite:()=>GS,RenderableVertex:()=>io,SimplexNoise:()=>SP,computeMikkTSpaceTangents:()=>PP,computeMorphedAttributes:()=>kP,computeTangents:()=>LP,createMeshesFromInstancedMesh:()=>UP,createMeshesFromMultiMaterialMesh:()=>zP,createMultiMaterialObject:()=>BP,deepCloneAttribute:()=>Bd,deinterleaveAttribute:()=>jd,deinterleaveGeometry:()=>OP,estimateBytesUsed:()=>IP,interleaveAttributes:()=>DP,mergeBufferAttributes:()=>q0,mergeBufferGeometries:()=>CP,mergeGroups:()=>VS,mergeVertices:()=>NP,reduceVertices:()=>jP,sortInstancedMesh:()=>HP,toCreasedNormals:()=>FP,toTrianglesDrawMode:()=>Y0});var p={};Yt.r(p),Yt.d(p,{Easing:()=>Si.Easing,Group:()=>Si.Group,Interpolation:()=>Si.Interpolation,Sequence:()=>Si.Sequence,Tween:()=>Si.Tween,TweenChain:()=>oD.TweenChain,TweenManager:()=>ww,VERSION:()=>Si.VERSION,__esModule:()=>Si.__esModule,add:()=>Si.add,getAll:()=>Si.getAll,nextId:()=>Si.nextId,now:()=>Si.now,remove:()=>Si.remove,removeAll:()=>Si.removeAll,update:()=>Si.update});var v={};Yt.r(v),Yt.d(v,{FInterpConstantTo:()=>DD,FInterpTo:()=>CD,QInterpConstantTo:()=>PD,QInterpTo:()=>LD,Quat_exponentialDamp:()=>_D,Quat_quarticDamp:()=>MD,Quat_smoothDamp:()=>TD,VInterpConstantTo:()=>RD,VInterpTo:()=>AD,Vec3_smoothDamp:()=>ED,exponentialDamp:()=>Ew,quarticDamp:()=>Cl,smoothDamp:()=>hg});var b={};Yt.r(b),Yt.d(b,{Alpha:()=>qD,BaseRenderer:()=>Ww,Behaviour:()=>ou,Color:()=>YD,Controller:()=>jw,Emitter:()=>WD,Force:()=>Vw,GPURenderer:()=>KD,Gravity:()=>QD,Particle:()=>fg,Scale:()=>ZD,System:()=>mg,copyProperties:()=>jD,ease:()=>Dl,setPrototypeByObj:()=>Qd});var M={};Yt.r(M),Yt.d(M,{Box:()=>JD,Capsule:()=>$D,Circle:()=>eO,Cone:()=>tO,Cylinder:()=>nO,Dodecahedron:()=>iO,Edges:()=>rO,Extrude:()=>sO,Icosahedron:()=>aO,Lathe:()=>oO,Octahedron:()=>lO,Plane:()=>cO,Polyhedron:()=>uO,Ring:()=>hO,Shape:()=>dO,Sphere:()=>pO,Tetrahedron:()=>fO,Torus:()=>mO,TorusKnot:()=>gO,Tube:()=>vO,Wireframe:()=>yO});for(let l=0;l<256;l++)(l<16?"0":"")+l.toString(16);Array.prototype.remove=function(l){let e=this.indexOf(l);e>-1&&this.splice(e,1)};class L{constructor(){N(this,"_events",{})}clear(){return this._events={},this}on(e,t,n,i=!1){let s=this._events[e];if(s==null&&(s=this._events[e]=[]),!(s.findIndex(c=>c.callback===t&&(!n||c.target===n))>-1))return s.push({name:e,callback:t,target:n,once:i}),this;console.warn(`event: ${e} duplicate registered`)}off(e,t,n){let i=this._events[e];if(i){let s=i.findIndex(a=>a.callback===t&&(!n||a.target===n));this._removeEvent(i,s,e)}return this}onof(e,t,n){return n._listeners===void 0&&(n._listeners=[]),n._listeners.push({name:e,callback:t}),this.on(e,t),this}offof(e){for(let t of e._listeners)this.off(t.name,t.callback);return this}_removeEvent(e,t,n){return t>-1&&(e.splice(t,1),e.length===0&&delete this._events[n]),this}targetOff(e){for(let t in this._events){let n=this._events[t];for(let i=n.length;i--;)n[i].target===e&&this._removeEvent(n,i,t)}}emit(e,...t){let n=this._events[e];if(n)for(let i=n.length;i--;){let s=n[i];s.once&&this._removeEvent(n,i,e),s.target?s.callback.apply(s.target,t):s.callback(...t)}return this}}class k{constructor(e,t,n,i){N(this,"_target",null);N(this,"_callback",null);N(this,"_interval",0);N(this,"_repeat",0);N(this,"_elapsed",0);N(this,"_lastTime",0);N(this,"_repeatForever",!1);N(this,"_pause",!1);this._target=e,this._callback=t,this._interval=n,this._repeat=i,this._repeatForever=i===-1}get pause(){return this._pause}set pause(e){this._pause=e}get target(){return this._target}get callback(){return this._callback}get lived(){return this._repeat>0||this._repeatForever}update(e){this._pause||(this._repeat>0||this._repeatForever)&&(this._elapsed+=e,this._elapsed-this._lastTime>=this._interval&&(this._lastTime+=this._interval,this._repeat--,this.trigger(e)))}trigger(e){this._target&&this._callback&&this._callback.call(this._target,e,this._elapsed)}}class j{constructor(e,t){N(this,"_target");N(this,"_callers");this._target=e,this._callers=t}get target(){return this._target}get callers(){return this._callers}}class J{constructor(){N(this,"_callers",{});N(this,"_callersArray",[])}pause(e){let t=this._callers[e.uuid];t&&t.forEach(n=>n.pause=!0)}resume(e){let t=this._callers[e.uuid];t&&t.forEach(n=>n.pause=!1)}schedule(e,t,n,i){let s=this._callers[e.uuid];s===void 0&&(s=this._callers[e.uuid]=[],this._callersArray.push(new j(e,s))),s.push(new k(e,t,n,i))}unshedule(e,t){let n=this._callers[e.uuid];if(n){let i=n.findIndex(s=>s.callback===t);i!==-1&&n.splice(i,1)}}unscheduleAll(e){delete this._callers[e.uuid];let t=this._callersArray.findIndex(n=>n.target===e);t!==-1&&this._callersArray.splice(t,1)}update(e){let t,n=this._callersArray;for(let i=n.length;i--;){t=n[i].callers;for(let s=t.length;s--;)t[s].lived?t[s].update(e):t.splice(s,1)}}}const ie="150",he={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ee={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},me=0,be=1,ke=2,$=3,X=0,ne=1,D=2,Q=3,se=0,ye=1,Me=2,Xe=2,Be=0,ot=1,xn=2,ai=3,ar=4,Ra=5,or=100,ko=101,Ye=102,it=103,lt=104,Zt=200,cn=201,La=202,Dr=203,Pa=204,lr=205,Ca=206,Iy=207,Ny=208,ky=209,Fy=210,Kf=0,Jf=1,vh=2,gc=3,vc=4,$f=5,Uy=6,yh=7,yc=0,zy=1,By=2,Or=0,jy=1,Hy=2,Gy=3,em=4,Vy=5,xh=300,Ds=301,Os=302,Is=303,xc=304,Fo=306,vi=1e3,bn=1001,Uo=1002,Rt=1003,bc=1004,g3=1004,zo=1005,v3=1005,at=1006,bh=1007,y3=1007,cr=1008,x3=1008,Sn=1009,Wy=1010,Xy=1011,Sh=1012,qy=1013,$r=1014,Ci=1015,yi=1016,Yy=1017,Qy=1018,es=1020,Zy=1021,oi=1023,Ky=1024,Jy=1025,ts=1026,Ns=1027,tm=1028,$y=1029,ex=1030,tx=1031,nx=1033,wh=33776,_h=33777,Mh=33778,Th=33779,nm=35840,im=35841,rm=35842,sm=35843,ix=36196,am=37492,om=37496,lm=37808,cm=37809,um=37810,hm=37811,dm=37812,pm=37813,fm=37814,mm=37815,gm=37816,vm=37817,ym=37818,xm=37819,bm=37820,Sm=37821,Eh=36492,rx=36283,wm=36284,_m=36285,Mm=36286,sx=2200,ax=2201,ox=2202,Bo=2300,Da=2301,Ah=2302,Oa=2400,Ia=2401,Sc=2402,Tm=2500,Em=2501,lx=0,Am=1,Rh=2,ur=3e3,mt=3001,hr=3200,Lh=3201,ks=0,cx=1,ux="",Di="srgb",jo="srgb-linear",Rm="display-p3",b3=0,Ph=7680,S3=7681,w3=7682,_3=7683,M3=34055,T3=34056,E3=5386,A3=512,R3=513,L3=514,P3=515,C3=516,D3=517,O3=518,hx=519,wc=35044,dx=35048,I3=35040,N3=35045,k3=35049,F3=35041,U3=35046,z3=35050,B3=35042,j3="100",Lm="300 es",Ch=1035;class Xi{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const n=t.slice(0);for(let i=0,s=n.length;i<s;i++)n[i].call(this,e);e.target=null}}}const Wn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let px=1234567;const Na=Math.PI/180,_c=180/Math.PI;function Oi(){const l=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Wn[255&l]+Wn[l>>8&255]+Wn[l>>16&255]+Wn[l>>24&255]+"-"+Wn[255&e]+Wn[e>>8&255]+"-"+Wn[e>>16&15|64]+Wn[e>>24&255]+"-"+Wn[63&t|128]+Wn[t>>8&255]+"-"+Wn[t>>16&255]+Wn[t>>24&255]+Wn[255&n]+Wn[n>>8&255]+Wn[n>>16&255]+Wn[n>>24&255]).toLowerCase()}function an(l,e,t){return Math.max(e,Math.min(t,l))}function Pm(l,e){return(l%e+e)%e}function Mc(l,e,t){return(1-t)*l+t*e}function Cm(l){return(l&l-1)==0&&l!==0}function fx(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function mx(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function ns(l,e){switch(e.constructor){case Float32Array:return l;case Uint16Array:return l/65535;case Uint8Array:return l/255;case Int16Array:return Math.max(l/32767,-1);case Int8Array:return Math.max(l/127,-1);default:throw new Error("Invalid component type.")}}function Ft(l,e){switch(e.constructor){case Float32Array:return l;case Uint16Array:return Math.round(65535*l);case Uint8Array:return Math.round(255*l);case Int16Array:return Math.round(32767*l);case Int8Array:return Math.round(127*l);default:throw new Error("Invalid component type.")}}const fn={DEG2RAD:Na,RAD2DEG:_c,generateUUID:Oi,clamp:an,clamp01:function(l){return an(l,0,1)},euclideanModulo:Pm,mapLinear:function(l,e,t,n,i){return n+(l-e)*(i-n)/(t-e)},inverseLerp:function(l,e,t){return l!==e?(t-l)/(e-l):0},lerp:Mc,damp:function(l,e,t,n){return Mc(l,e,1-Math.exp(-t*n))},pingpong:function(l,e=1){return e-Math.abs(Pm(l,2*e)-e)},smoothstep:function(l,e,t){return l<=e?0:l>=t?1:(l=(l-e)/(t-e))*l*(3-2*l)},smootherstep:function(l,e,t){return l<=e?0:l>=t?1:(l=(l-e)/(t-e))*l*l*(l*(6*l-15)+10)},randInt:function(l,e){return l+Math.random()*(e-l+1)>>0},randFloat:function(l,e){return l+Math.random()*(e-l)},randFloatSpread:function(l){return l*(.5-Math.random())},seededRandom:function(l){l!==void 0&&(px=l);let e=px+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(l){return l*Na},radToDeg:function(l){return l*_c},isPowerOfTwo:Cm,ceilPowerOfTwo:fx,floorPowerOfTwo:mx,setQuaternionFromProperEuler:function(l,e,t,n,i){const s=Math.cos,a=Math.sin,c=s(t/2),h=a(t/2),d=s((e+n)/2),f=a((e+n)/2),m=s((e-n)/2),g=a((e-n)/2),y=s((n-e)/2),S=a((n-e)/2);switch(i){case"XYX":l.set(c*f,h*m,h*g,c*d);break;case"YZY":l.set(h*g,c*f,h*m,c*d);break;case"ZXZ":l.set(h*m,h*g,c*f,c*d);break;case"XZX":l.set(c*f,h*S,h*y,c*d);break;case"YXY":l.set(h*y,c*f,h*S,c*d);break;case"ZYZ":l.set(h*S,h*y,c*f,c*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:Ft,denormalize:ns};class de{constructor(e=0,t=0){de.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*i+e.x,this.y=s*i+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class mn{constructor(){mn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,i,s,a,c,h,d){const f=this.elements;return f[0]=e,f[1]=i,f[2]=c,f[3]=t,f[4]=s,f[5]=h,f[6]=n,f[7]=a,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],c=n[3],h=n[6],d=n[1],f=n[4],m=n[7],g=n[2],y=n[5],S=n[8],x=i[0],w=i[3],T=i[6],_=i[1],E=i[4],R=i[7],P=i[2],C=i[5],F=i[8];return s[0]=a*x+c*_+h*P,s[3]=a*w+c*E+h*C,s[6]=a*T+c*R+h*F,s[1]=d*x+f*_+m*P,s[4]=d*w+f*E+m*C,s[7]=d*T+f*R+m*F,s[2]=g*x+y*_+S*P,s[5]=g*w+y*E+S*C,s[8]=g*T+y*R+S*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],c=e[5],h=e[6],d=e[7],f=e[8];return t*a*f-t*c*d-n*s*f+n*c*h+i*s*d-i*a*h}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],c=e[5],h=e[6],d=e[7],f=e[8],m=f*a-c*d,g=c*h-f*s,y=d*s-a*h,S=t*m+n*g+i*y;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/S;return e[0]=m*x,e[1]=(i*d-f*n)*x,e[2]=(c*n-i*a)*x,e[3]=g*x,e[4]=(f*t-i*h)*x,e[5]=(i*s-c*t)*x,e[6]=y*x,e[7]=(n*h-d*t)*x,e[8]=(a*t-n*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,a,c){const h=Math.cos(s),d=Math.sin(s);return this.set(n*h,n*d,-n*(h*a+d*c)+a+e,-i*d,i*h,-i*(-d*a+h*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(Dm.makeScale(e,t)),this}rotate(e){return this.premultiply(Dm.makeRotation(-e)),this}translate(e,t){return this.premultiply(Dm.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,1,0,-n,0,t,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Dm=new mn;function gx(l){for(let e=l.length-1;e>=0;--e)if(l[e]>=65535)return!0;return!1}const H3={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ho(l,e){return new H3[l](e)}function Tc(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}class Ut{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,s,a,c){let h=n[i+0],d=n[i+1],f=n[i+2],m=n[i+3];const g=s[a+0],y=s[a+1],S=s[a+2],x=s[a+3];if(c===0)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=m);if(c===1)return e[t+0]=g,e[t+1]=y,e[t+2]=S,void(e[t+3]=x);if(m!==x||h!==g||d!==y||f!==S){let w=1-c;const T=h*g+d*y+f*S+m*x,_=T>=0?1:-1,E=1-T*T;if(E>Number.EPSILON){const P=Math.sqrt(E),C=Math.atan2(P,T*_);w=Math.sin(w*C)/P,c=Math.sin(c*C)/P}const R=c*_;if(h=h*w+g*R,d=d*w+y*R,f=f*w+S*R,m=m*w+x*R,w===1-c){const P=1/Math.sqrt(h*h+d*d+f*f+m*m);h*=P,d*=P,f*=P,m*=P}}e[t]=h,e[t+1]=d,e[t+2]=f,e[t+3]=m}static multiplyQuaternionsFlat(e,t,n,i,s,a){const c=n[i],h=n[i+1],d=n[i+2],f=n[i+3],m=s[a],g=s[a+1],y=s[a+2],S=s[a+3];return e[t]=c*S+f*m+h*y-d*g,e[t+1]=h*S+f*g+d*m-c*y,e[t+2]=d*S+f*y+c*g-h*m,e[t+3]=f*S-c*m-h*g-d*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,i=e._y,s=e._z,a=e._order,c=Math.cos,h=Math.sin,d=c(n/2),f=c(i/2),m=c(s/2),g=h(n/2),y=h(i/2),S=h(s/2);switch(a){case"XYZ":this._x=g*f*m+d*y*S,this._y=d*y*m-g*f*S,this._z=d*f*S+g*y*m,this._w=d*f*m-g*y*S;break;case"YXZ":this._x=g*f*m+d*y*S,this._y=d*y*m-g*f*S,this._z=d*f*S-g*y*m,this._w=d*f*m+g*y*S;break;case"ZXY":this._x=g*f*m-d*y*S,this._y=d*y*m+g*f*S,this._z=d*f*S+g*y*m,this._w=d*f*m-g*y*S;break;case"ZYX":this._x=g*f*m-d*y*S,this._y=d*y*m+g*f*S,this._z=d*f*S-g*y*m,this._w=d*f*m+g*y*S;break;case"YZX":this._x=g*f*m+d*y*S,this._y=d*y*m+g*f*S,this._z=d*f*S-g*y*m,this._w=d*f*m-g*y*S;break;case"XZY":this._x=g*f*m-d*y*S,this._y=d*y*m-g*f*S,this._z=d*f*S+g*y*m,this._w=d*f*m+g*y*S;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],a=t[1],c=t[5],h=t[9],d=t[2],f=t[6],m=t[10],g=n+c+m;if(g>0){const y=.5/Math.sqrt(g+1);this._w=.25/y,this._x=(f-h)*y,this._y=(s-d)*y,this._z=(a-i)*y}else if(n>c&&n>m){const y=2*Math.sqrt(1+n-c-m);this._w=(f-h)/y,this._x=.25*y,this._y=(i+a)/y,this._z=(s+d)/y}else if(c>m){const y=2*Math.sqrt(1+c-n-m);this._w=(s-d)/y,this._x=(i+a)/y,this._y=.25*y,this._z=(h+f)/y}else{const y=2*Math.sqrt(1+m-n-c);this._w=(a-i)/y,this._x=(s+d)/y,this._y=(h+f)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(an(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,a=e._w,c=t._x,h=t._y,d=t._z,f=t._w;return this._x=n*f+a*c+i*d-s*h,this._y=i*f+a*h+s*c-n*d,this._z=s*f+a*d+n*h-i*c,this._w=a*f-n*c-i*h-s*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,s=this._z,a=this._w;let c=a*e._w+n*e._x+i*e._y+s*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=n,this._y=i,this._z=s,this;const h=1-c*c;if(h<=Number.EPSILON){const y=1-t;return this._w=y*a+t*this._w,this._x=y*n+t*this._x,this._y=y*i+t*this._y,this._z=y*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(h),f=Math.atan2(d,c),m=Math.sin((1-t)*f)/d,g=Math.sin(t*f)/d;return this._w=a*m+this._w*g,this._x=n*m+this._x*g,this._y=i*m+this._y*g,this._z=s*m+this._z*g,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(s),n*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}const Mn=class Mn{constructor(e=0,t=0,n=0){Mn.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(vx.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vx.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,a=e.y,c=e.z,h=e.w,d=h*t+a*i-c*n,f=h*n+c*t-s*i,m=h*i+s*n-a*t,g=-s*t-a*n-c*i;return this.x=d*h+g*-s+f*-c-m*-a,this.y=f*h+g*-a+m*-s-d*-c,this.z=m*h+g*-c+d*-a-f*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,a=t.x,c=t.y,h=t.z;return this.x=i*h-s*c,this.y=s*a-n*h,this.z=n*c-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Om.copy(this).projectOnVector(e),this.sub(Om)}reflect(e){return this.sub(Om.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(an(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};N(Mn,"UNIT_X",Object.freeze(new Mn(1,0,0))),N(Mn,"UNIT_Y",Object.freeze(new Mn(0,1,0))),N(Mn,"UNIT_Z",Object.freeze(new Mn(0,0,1))),N(Mn,"RIGHT",Object.freeze(new Mn(1,0,0))),N(Mn,"UP",Object.freeze(new Mn(0,1,0))),N(Mn,"ZERO",Object.freeze(new Mn(0,0,0))),N(Mn,"ONE",Object.freeze(new Mn(1,1,1))),N(Mn,"NEG_ONE",Object.freeze(new Mn(-1,-1,-1)));let O=Mn;const Om=new O,vx=new Ut;function Go(l){return l<.04045?.0773993808*l:Math.pow(.9478672986*l+.0521327014,2.4)}function Im(l){return l<.0031308?12.92*l:1.055*Math.pow(l,.41666)-.055}const G3=new mn().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),V3=new mn().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Fs=new O,W3={[jo]:l=>l,[Di]:l=>l.convertSRGBToLinear(),[Rm]:function(l){return l.convertSRGBToLinear(),Fs.set(l.r,l.g,l.b).applyMatrix3(V3),l.setRGB(Fs.x,Fs.y,Fs.z)}},X3={[jo]:l=>l,[Di]:l=>l.convertLinearToSRGB(),[Rm]:function(l){return Fs.set(l.r,l.g,l.b).applyMatrix3(G3),l.setRGB(Fs.x,Fs.y,Fs.z).convertLinearToSRGB()}},Pn={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(l){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!l},get workingColorSpace(){return jo},set workingColorSpace(l){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(l,e,t){if(this.enabled===!1||e===t||!e||!t)return l;const n=W3[e],i=X3[t];if(n===void 0||i===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return i(n(l))},fromWorkingColorSpace:function(l,e){return this.convert(l,this.workingColorSpace,e)},toWorkingColorSpace:function(l,e){return this.convert(l,e,this.workingColorSpace)}};let Vo;class Nm{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Vo===void 0&&(Vo=Tc("canvas")),Vo.width=e.width,Vo.height=e.height;const n=Vo.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Vo}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Tc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=255*Go(s[a]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(255*Go(t[n]/255)):t[n]=Go(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class ka{constructor(e=null){this.isSource=!0,this.uuid=Oi(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,c=i.length;a<c;a++)i[a].isDataTexture?s.push(km(i[a].image)):s.push(km(i[a]))}else s=km(i);n.url=s}return t||(e.images[this.uuid]=n),n}}function km(l){return typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&l instanceof ImageBitmap?Nm.getDataURL(l):l.data?{data:Array.from(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let q3=0;class zt extends Xi{constructor(e=zt.DEFAULT_IMAGE,t=zt.DEFAULT_MAPPING,n=bn,i=bn,s=at,a=cr,c=oi,h=Sn,d=zt.DEFAULT_ANISOTROPY,f=ur){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:q3++}),this.uuid=Oi(),this.name="",this.source=new ka(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=d,this.format=c,this.internalFormat=null,this.type=h,this.offset=new de(0,0),this.repeat=new de(1,1),this.center=new de(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==xh)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case vi:e.x=e.x-Math.floor(e.x);break;case bn:e.x=e.x<0?0:1;break;case Uo:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case vi:e.y=e.y-Math.floor(e.y);break;case bn:e.y=e.y<0?0:1;break;case Uo:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}zt.DEFAULT_IMAGE=null,zt.DEFAULT_MAPPING=xh,zt.DEFAULT_ANISOTROPY=1;class Ke{constructor(e=0,t=0,n=0,i=1){Ke.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const h=e.elements,d=h[0],f=h[4],m=h[8],g=h[1],y=h[5],S=h[9],x=h[2],w=h[6],T=h[10];if(Math.abs(f-g)<.01&&Math.abs(m-x)<.01&&Math.abs(S-w)<.01){if(Math.abs(f+g)<.1&&Math.abs(m+x)<.1&&Math.abs(S+w)<.1&&Math.abs(d+y+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(d+1)/2,R=(y+1)/2,P=(T+1)/2,C=(f+g)/4,F=(m+x)/4,W=(S+w)/4;return E>R&&E>P?E<.01?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(E),i=C/n,s=F/n):R>P?R<.01?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(R),n=C/i,s=W/i):P<.01?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(P),n=F/s,i=W/s),this.set(n,i,s,t),this}let _=Math.sqrt((w-S)*(w-S)+(m-x)*(m-x)+(g-f)*(g-f));return Math.abs(_)<.001&&(_=1),this.x=(w-S)/_,this.y=(m-x)/_,this.z=(g-f)/_,this.w=Math.acos((d+y+T-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Lt extends Xi{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ke(0,0,e,t),this.scissorTest=!1,this.viewport=new Ke(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new zt(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:at,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new ka(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Dh extends zt{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Rt,this.minFilter=Rt,this.wrapR=bn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Y3 extends Lt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Dh(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Fm extends zt{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Rt,this.minFilter=Rt,this.wrapR=bn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Q3 extends Lt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Fm(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class yx extends Lt{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let a=0;a<n;a++)this.texture[a]=s.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Ir{constructor(e=new O(1/0,1/0,1/0),t=new O(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,s=-1/0,a=-1/0,c=-1/0;for(let h=0,d=e.length;h<d;h+=3){const f=e[h],m=e[h+1],g=e[h+2];f<t&&(t=f),m<n&&(n=m),g<i&&(i=g),f>s&&(s=f),m>a&&(a=m),g>c&&(c=g)}return this.min.set(t,n,i),this.max.set(s,a,c),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,s=-1/0,a=-1/0,c=-1/0;for(let h=0,d=e.count;h<d;h++){const f=e.getX(h),m=e.getY(h),g=e.getZ(h);f<t&&(t=f),m<n&&(n=m),g<i&&(i=g),f>s&&(s=f),m>a&&(a=m),g>c&&(c=g)}return this.min.set(t,n,i),this.max.set(s,a,c),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Fa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0)if(t&&n.attributes!=null&&n.attributes.position!==void 0){const s=n.attributes.position;for(let a=0,c=s.count;a<c;a++)Fa.fromBufferAttribute(s,a).applyMatrix4(e.matrixWorld),this.expandByPoint(Fa)}else n.boundingBox===null&&n.computeBoundingBox(),Um.copy(n.boundingBox),Um.applyMatrix4(e.matrixWorld),this.union(Um);const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Fa),Fa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ec),Oh.subVectors(this.max,Ec),Wo.subVectors(e.a,Ec),Xo.subVectors(e.b,Ec),qo.subVectors(e.c,Ec),Us.subVectors(Xo,Wo),zs.subVectors(qo,Xo),Ua.subVectors(Wo,qo);let t=[0,-Us.z,Us.y,0,-zs.z,zs.y,0,-Ua.z,Ua.y,Us.z,0,-Us.x,zs.z,0,-zs.x,Ua.z,0,-Ua.x,-Us.y,Us.x,0,-zs.y,zs.x,0,-Ua.y,Ua.x,0];return!!zm(t,Wo,Xo,qo,Oh)&&(t=[1,0,0,0,1,0,0,0,1],!!zm(t,Wo,Xo,qo,Oh)&&(Ih.crossVectors(Us,zs),t=[Ih.x,Ih.y,Ih.z],zm(t,Wo,Xo,qo,Oh)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Fa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Fa).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(is[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),is[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),is[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),is[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),is[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),is[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),is[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),is[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(is)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const is=[new O,new O,new O,new O,new O,new O,new O,new O],Fa=new O,Um=new Ir,Wo=new O,Xo=new O,qo=new O,Us=new O,zs=new O,Ua=new O,Ec=new O,Oh=new O,Ih=new O,za=new O;function zm(l,e,t,n,i){for(let s=0,a=l.length-3;s<=a;s+=3){za.fromArray(l,s);const c=i.x*Math.abs(za.x)+i.y*Math.abs(za.y)+i.z*Math.abs(za.z),h=e.dot(za),d=t.dot(za),f=n.dot(za);if(Math.max(-Math.max(h,d,f),Math.min(h,d,f))>c)return!1}return!0}const Z3=new Ir,Ac=new O,Bm=new O;class rs{constructor(e=new O,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):Z3.setFromPoints(e).getCenter(n);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ac.subVectors(e,this.center);const t=Ac.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=.5*(n-this.radius);this.center.addScaledVector(Ac,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Bm.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ac.copy(e.center).add(Bm)),this.expandByPoint(Ac.copy(e.center).sub(Bm))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ss=new O,jm=new O,Nh=new O,Bs=new O,Hm=new O,kh=new O,Gm=new O;class Rc{constructor(e=new O,t=new O(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ss)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ss.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ss.copy(this.origin).addScaledVector(this.direction,t),ss.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){jm.copy(e).add(t).multiplyScalar(.5),Nh.copy(t).sub(e).normalize(),Bs.copy(this.origin).sub(jm);const s=.5*e.distanceTo(t),a=-this.direction.dot(Nh),c=Bs.dot(this.direction),h=-Bs.dot(Nh),d=Bs.lengthSq(),f=Math.abs(1-a*a);let m,g,y,S;if(f>0)if(m=a*h-c,g=a*c-h,S=s*f,m>=0)if(g>=-S)if(g<=S){const x=1/f;m*=x,g*=x,y=m*(m+a*g+2*c)+g*(a*m+g+2*h)+d}else g=s,m=Math.max(0,-(a*g+c)),y=-m*m+g*(g+2*h)+d;else g=-s,m=Math.max(0,-(a*g+c)),y=-m*m+g*(g+2*h)+d;else g<=-S?(m=Math.max(0,-(-a*s+c)),g=m>0?-s:Math.min(Math.max(-s,-h),s),y=-m*m+g*(g+2*h)+d):g<=S?(m=0,g=Math.min(Math.max(-s,-h),s),y=g*(g+2*h)+d):(m=Math.max(0,-(a*s+c)),g=m>0?s:Math.min(Math.max(-s,-h),s),y=-m*m+g*(g+2*h)+d);else g=a>0?-s:s,m=Math.max(0,-(a*g+c)),y=-m*m+g*(g+2*h)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,m),i&&i.copy(jm).addScaledVector(Nh,g),y}intersectSphere(e,t){ss.subVectors(e.center,this.origin);const n=ss.dot(this.direction),i=ss.dot(ss)-n*n,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),c=n-a,h=n+a;return h<0?null:c<0?this.at(h,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0?!0:e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,a,c,h;const d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,g=this.origin;return d>=0?(n=(e.min.x-g.x)*d,i=(e.max.x-g.x)*d):(n=(e.max.x-g.x)*d,i=(e.min.x-g.x)*d),f>=0?(s=(e.min.y-g.y)*f,a=(e.max.y-g.y)*f):(s=(e.max.y-g.y)*f,a=(e.min.y-g.y)*f),n>a||s>i?null:((s>n||isNaN(n))&&(n=s),(a<i||isNaN(i))&&(i=a),m>=0?(c=(e.min.z-g.z)*m,h=(e.max.z-g.z)*m):(c=(e.max.z-g.z)*m,h=(e.min.z-g.z)*m),n>h||c>i?null:((c>n||n!=n)&&(n=c),(h<i||i!=i)&&(i=h),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return this.intersectBox(e,ss)!==null}intersectTriangle(e,t,n,i,s){Hm.subVectors(t,e),kh.subVectors(n,e),Gm.crossVectors(Hm,kh);let a,c=this.direction.dot(Gm);if(c>0){if(i)return null;a=1}else{if(!(c<0))return null;a=-1,c=-c}Bs.subVectors(this.origin,e);const h=a*this.direction.dot(kh.crossVectors(Bs,kh));if(h<0)return null;const d=a*this.direction.dot(Hm.cross(Bs));if(d<0||h+d>c)return null;const f=-a*Bs.dot(Gm);return f<0?null:this.at(f/c,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ne{constructor(){Ne.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,i,s,a,c,h,d,f,m,g,y,S,x,w){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=i,T[1]=s,T[5]=a,T[9]=c,T[13]=h,T[2]=d,T[6]=f,T[10]=m,T[14]=g,T[3]=y,T[7]=S,T[11]=x,T[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ne().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/Yo.setFromMatrixColumn(e,0).length(),s=1/Yo.setFromMatrixColumn(e,1).length(),a=1/Yo.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,s=e.z,a=Math.cos(n),c=Math.sin(n),h=Math.cos(i),d=Math.sin(i),f=Math.cos(s),m=Math.sin(s);if(e.order==="XYZ"){const g=a*f,y=a*m,S=c*f,x=c*m;t[0]=h*f,t[4]=-h*m,t[8]=d,t[1]=y+S*d,t[5]=g-x*d,t[9]=-c*h,t[2]=x-g*d,t[6]=S+y*d,t[10]=a*h}else if(e.order==="YXZ"){const g=h*f,y=h*m,S=d*f,x=d*m;t[0]=g+x*c,t[4]=S*c-y,t[8]=a*d,t[1]=a*m,t[5]=a*f,t[9]=-c,t[2]=y*c-S,t[6]=x+g*c,t[10]=a*h}else if(e.order==="ZXY"){const g=h*f,y=h*m,S=d*f,x=d*m;t[0]=g-x*c,t[4]=-a*m,t[8]=S+y*c,t[1]=y+S*c,t[5]=a*f,t[9]=x-g*c,t[2]=-a*d,t[6]=c,t[10]=a*h}else if(e.order==="ZYX"){const g=a*f,y=a*m,S=c*f,x=c*m;t[0]=h*f,t[4]=S*d-y,t[8]=g*d+x,t[1]=h*m,t[5]=x*d+g,t[9]=y*d-S,t[2]=-d,t[6]=c*h,t[10]=a*h}else if(e.order==="YZX"){const g=a*h,y=a*d,S=c*h,x=c*d;t[0]=h*f,t[4]=x-g*m,t[8]=S*m+y,t[1]=m,t[5]=a*f,t[9]=-c*f,t[2]=-d*f,t[6]=y*m+S,t[10]=g-x*m}else if(e.order==="XZY"){const g=a*h,y=a*d,S=c*h,x=c*d;t[0]=h*f,t[4]=-m,t[8]=d*f,t[1]=g*m+x,t[5]=a*f,t[9]=y*m-S,t[2]=S*m-y,t[6]=c*f,t[10]=x*m+g}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(K3,e,J3)}lookAt(e,t,n){const i=this.elements;return Ii.subVectors(e,t),Ii.lengthSq()===0&&(Ii.z=1),Ii.normalize(),js.crossVectors(n,Ii),js.lengthSq()===0&&(Math.abs(n.z)===1?Ii.x+=1e-4:Ii.z+=1e-4,Ii.normalize(),js.crossVectors(n,Ii)),js.normalize(),Fh.crossVectors(Ii,js),i[0]=js.x,i[4]=Fh.x,i[8]=Ii.x,i[1]=js.y,i[5]=Fh.y,i[9]=Ii.y,i[2]=js.z,i[6]=Fh.z,i[10]=Ii.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],c=n[4],h=n[8],d=n[12],f=n[1],m=n[5],g=n[9],y=n[13],S=n[2],x=n[6],w=n[10],T=n[14],_=n[3],E=n[7],R=n[11],P=n[15],C=i[0],F=i[4],W=i[8],B=i[12],V=i[1],U=i[5],te=i[9],ue=i[13],ce=i[2],we=i[6],ve=i[10],Re=i[14],Pe=i[3],De=i[7],fe=i[11],oe=i[15];return s[0]=a*C+c*V+h*ce+d*Pe,s[4]=a*F+c*U+h*we+d*De,s[8]=a*W+c*te+h*ve+d*fe,s[12]=a*B+c*ue+h*Re+d*oe,s[1]=f*C+m*V+g*ce+y*Pe,s[5]=f*F+m*U+g*we+y*De,s[9]=f*W+m*te+g*ve+y*fe,s[13]=f*B+m*ue+g*Re+y*oe,s[2]=S*C+x*V+w*ce+T*Pe,s[6]=S*F+x*U+w*we+T*De,s[10]=S*W+x*te+w*ve+T*fe,s[14]=S*B+x*ue+w*Re+T*oe,s[3]=_*C+E*V+R*ce+P*Pe,s[7]=_*F+E*U+R*we+P*De,s[11]=_*W+E*te+R*ve+P*fe,s[15]=_*B+E*ue+R*Re+P*oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],a=e[1],c=e[5],h=e[9],d=e[13],f=e[2],m=e[6],g=e[10],y=e[14];return e[3]*(+s*h*m-i*d*m-s*c*g+n*d*g+i*c*y-n*h*y)+e[7]*(+t*h*y-t*d*g+s*a*g-i*a*y+i*d*f-s*h*f)+e[11]*(+t*d*m-t*c*y-s*a*m+n*a*y+s*c*f-n*d*f)+e[15]*(-i*c*f-t*h*m+t*c*g+i*a*m-n*a*g+n*h*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],c=e[5],h=e[6],d=e[7],f=e[8],m=e[9],g=e[10],y=e[11],S=e[12],x=e[13],w=e[14],T=e[15],_=m*w*d-x*g*d+x*h*y-c*w*y-m*h*T+c*g*T,E=S*g*d-f*w*d-S*h*y+a*w*y+f*h*T-a*g*T,R=f*x*d-S*m*d+S*c*y-a*x*y-f*c*T+a*m*T,P=S*m*h-f*x*h-S*c*g+a*x*g+f*c*w-a*m*w,C=t*_+n*E+i*R+s*P;if(C===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const F=1/C;return e[0]=_*F,e[1]=(x*g*s-m*w*s-x*i*y+n*w*y+m*i*T-n*g*T)*F,e[2]=(c*w*s-x*h*s+x*i*d-n*w*d-c*i*T+n*h*T)*F,e[3]=(m*h*s-c*g*s-m*i*d+n*g*d+c*i*y-n*h*y)*F,e[4]=E*F,e[5]=(f*w*s-S*g*s+S*i*y-t*w*y-f*i*T+t*g*T)*F,e[6]=(S*h*s-a*w*s-S*i*d+t*w*d+a*i*T-t*h*T)*F,e[7]=(a*g*s-f*h*s+f*i*d-t*g*d-a*i*y+t*h*y)*F,e[8]=R*F,e[9]=(S*m*s-f*x*s-S*n*y+t*x*y+f*n*T-t*m*T)*F,e[10]=(a*x*s-S*c*s+S*n*d-t*x*d-a*n*T+t*c*T)*F,e[11]=(f*c*s-a*m*s-f*n*d+t*m*d+a*n*y-t*c*y)*F,e[12]=P*F,e[13]=(f*x*i-S*m*i+S*n*g-t*x*g-f*n*w+t*m*w)*F,e[14]=(S*c*i-a*x*i-S*n*h+t*x*h+a*n*w-t*c*w)*F,e[15]=(a*m*i-f*c*i+f*n*h-t*m*h-a*n*g+t*c*g)*F,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,a=e.x,c=e.y,h=e.z,d=s*a,f=s*c;return this.set(d*a+n,d*c-i*h,d*h+i*c,0,d*c+i*h,f*c+n,f*h-i*a,0,d*h-i*c,f*h+i*a,s*h*h+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,a){return this.set(1,n,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,a=t._y,c=t._z,h=t._w,d=s+s,f=a+a,m=c+c,g=s*d,y=s*f,S=s*m,x=a*f,w=a*m,T=c*m,_=h*d,E=h*f,R=h*m,P=n.x,C=n.y,F=n.z;return i[0]=(1-(x+T))*P,i[1]=(y+R)*P,i[2]=(S-E)*P,i[3]=0,i[4]=(y-R)*C,i[5]=(1-(g+T))*C,i[6]=(w+_)*C,i[7]=0,i[8]=(S+E)*F,i[9]=(w-_)*F,i[10]=(1-(g+x))*F,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=Yo.set(i[0],i[1],i[2]).length();const a=Yo.set(i[4],i[5],i[6]).length(),c=Yo.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],dr.copy(this);const h=1/s,d=1/a,f=1/c;return dr.elements[0]*=h,dr.elements[1]*=h,dr.elements[2]*=h,dr.elements[4]*=d,dr.elements[5]*=d,dr.elements[6]*=d,dr.elements[8]*=f,dr.elements[9]*=f,dr.elements[10]*=f,t.setFromRotationMatrix(dr),n.x=s,n.y=a,n.z=c,this}makePerspective(e,t,n,i,s,a){const c=this.elements,h=2*s/(t-e),d=2*s/(n-i),f=(t+e)/(t-e),m=(n+i)/(n-i),g=-(a+s)/(a-s),y=-2*a*s/(a-s);return c[0]=h,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=d,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,i,s,a){const c=this.elements,h=1/(t-e),d=1/(n-i),f=1/(a-s),m=(t+e)*h,g=(n+i)*d,y=(a+s)*f;return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-m,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-g,c[2]=0,c[6]=0,c[10]=-2*f,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Yo=new O,dr=new Ne,K3=new O(0,0,0),J3=new O(1,1,1),js=new O,Fh=new O,Ii=new O,xx=new Ne,bx=new Ut;class Xn{constructor(e=0,t=0,n=0,i=Xn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],a=i[4],c=i[8],h=i[1],d=i[5],f=i[9],m=i[2],g=i[6],y=i[10];switch(t){case"XYZ":this._y=Math.asin(an(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,y),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-an(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(c,y),this._z=Math.atan2(h,d)):(this._y=Math.atan2(-m,s),this._z=0);break;case"ZXY":this._x=Math.asin(an(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-m,y),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(h,s));break;case"ZYX":this._y=Math.asin(-an(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(g,y),this._z=Math.atan2(h,s)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(an(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-m,s)):(this._x=0,this._y=Math.atan2(c,y));break;case"XZY":this._z=Math.asin(-an(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(g,d),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-f,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return xx.makeRotationFromQuaternion(e),this.setFromRotationMatrix(xx,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return bx.setFromEuler(this),this.setFromQuaternion(bx,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Xn.DEFAULT_ORDER="XYZ";class Uh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let $3=0;const Sx=new O,Qo=new Ut,as=new Ne,zh=new O,Lc=new O,eA=new O,tA=new Ut,wx=new O(1,0,0),_x=new O(0,1,0),Mx=new O(0,0,1),nA={type:"added"},Tx={type:"removed"};class ct extends Xi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:$3++}),this.uuid=Oi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ct.DEFAULT_UP.clone();const e=new O,t=new Xn,n=new Ut,i=new O(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ne},normalMatrix:{value:new mn}}),this.matrix=new Ne,this.matrixWorld=new Ne,this.matrixAutoUpdate=ct.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ct.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Uh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={},this.uniforms={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Qo.setFromAxisAngle(e,t),this.quaternion.multiply(Qo),this}rotateOnWorldAxis(e,t){return Qo.setFromAxisAngle(e,t),this.quaternion.premultiply(Qo),this}rotateX(e){return this.rotateOnAxis(wx,e)}rotateY(e){return this.rotateOnAxis(_x,e)}rotateZ(e){return this.rotateOnAxis(Mx,e)}translateOnAxis(e,t){return Sx.copy(e).applyQuaternion(this.quaternion),this.position.add(Sx.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(wx,e)}translateY(e){return this.translateOnAxis(_x,e)}translateZ(e){return this.translateOnAxis(Mx,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(as.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?zh.copy(e):zh.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Lc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?as.lookAt(Lc,zh,this.up):as.lookAt(zh,Lc,this.up),this.quaternion.setFromRotationMatrix(as),i&&(as.extractRotation(i.matrixWorld),Qo.setFromRotationMatrix(as),this.quaternion.premultiply(Qo.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(nA)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}addObject(e){return this.add(e),e}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Tx)),this}removeObject(e){return this.remove(e),e}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Tx)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),as.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),as.multiply(e.parent.matrixWorld)),e.applyMatrix4(as),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const s=this.children[n].getObjectByProperty(e,t);if(s!==void 0)return s}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let i=0,s=this.children.length;i<s;i++){const a=this.children[i].getObjectsByProperty(e,t);a.length>0&&(n=n.concat(a))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lc,e,eA),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lc,tA,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const s=t[n];s.matrixWorldAutoUpdate!==!0&&e!==!0||s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++){const c=i[s];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function s(c,h){return c[h.uuid]===void 0&&(c[h.uuid]=h.toJSON(e)),h.uuid}if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const h=c.shapes;if(Array.isArray(h))for(let d=0,f=h.length;d<f;d++){const m=h[d];s(e.shapes,m)}else s(e.shapes,h)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let h=0,d=this.material.length;h<d;h++)c.push(s(e.materials,this.material[h]));i.material=c}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const h=this.animations[c];i.animations.push(s(e.animations,h))}}if(t){const c=a(e.geometries),h=a(e.materials),d=a(e.textures),f=a(e.images),m=a(e.shapes),g=a(e.skeletons),y=a(e.animations),S=a(e.nodes);c.length>0&&(n.geometries=c),h.length>0&&(n.materials=h),d.length>0&&(n.textures=d),f.length>0&&(n.images=f),m.length>0&&(n.shapes=m),g.length>0&&(n.skeletons=g),y.length>0&&(n.animations=y),S.length>0&&(n.nodes=S)}return n.object=i,n;function a(c){const h=[];for(const d in c){const f=c[d];delete f.metadata,h.push(f)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}ct.DEFAULT_UP=new O(0,1,0),ct.DEFAULT_MATRIX_AUTO_UPDATE=!0,ct.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const pr=new O,os=new O,Vm=new O,ls=new O,Zo=new O,Ko=new O,Ex=new O,Wm=new O,Xm=new O,qm=new O;class qi{constructor(e=new O,t=new O,n=new O){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),pr.subVectors(e,t),i.cross(pr);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){pr.subVectors(i,t),os.subVectors(n,t),Vm.subVectors(e,t);const a=pr.dot(pr),c=pr.dot(os),h=pr.dot(Vm),d=os.dot(os),f=os.dot(Vm),m=a*d-c*c;if(m===0)return s.set(-2,-1,-1);const g=1/m,y=(d*h-c*f)*g,S=(a*f-c*h)*g;return s.set(1-y-S,S,y)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,ls),ls.x>=0&&ls.y>=0&&ls.x+ls.y<=1}static getUV(e,t,n,i,s,a,c,h){return this.getBarycoord(e,t,n,i,ls),h.set(0,0),h.addScaledVector(s,ls.x),h.addScaledVector(a,ls.y),h.addScaledVector(c,ls.z),h}static isFrontFacing(e,t,n,i){return pr.subVectors(n,t),os.subVectors(e,t),pr.cross(os).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return pr.subVectors(this.c,this.b),os.subVectors(this.a,this.b),.5*pr.cross(os).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return qi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return qi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,s){return qi.getUV(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return qi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return qi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let a,c;Zo.subVectors(i,n),Ko.subVectors(s,n),Wm.subVectors(e,n);const h=Zo.dot(Wm),d=Ko.dot(Wm);if(h<=0&&d<=0)return t.copy(n);Xm.subVectors(e,i);const f=Zo.dot(Xm),m=Ko.dot(Xm);if(f>=0&&m<=f)return t.copy(i);const g=h*m-f*d;if(g<=0&&h>=0&&f<=0)return a=h/(h-f),t.copy(n).addScaledVector(Zo,a);qm.subVectors(e,s);const y=Zo.dot(qm),S=Ko.dot(qm);if(S>=0&&y<=S)return t.copy(s);const x=y*d-h*S;if(x<=0&&d>=0&&S<=0)return c=d/(d-S),t.copy(n).addScaledVector(Ko,c);const w=f*S-y*m;if(w<=0&&m-f>=0&&y-S>=0)return Ex.subVectors(s,i),c=(m-f)/(m-f+(y-S)),t.copy(i).addScaledVector(Ex,c);const T=1/(w+x+g);return a=x*T,c=g*T,t.copy(n).addScaledVector(Zo,a).addScaledVector(Ko,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let iA=0;class un extends Xi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:iA++}),this.uuid=Oi(),this.name="",this.type="Material",this.blending=ot,this.side=se,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Pa,this.blendDst=lr,this.blendEquation=or,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=gc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=hx,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ph,this.stencilZFail=Ph,this.stencilZPass=Ph,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const i=this[t];i!==void 0?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(s){const a=[];for(const c in s){const h=s[c];delete h.metadata,a.push(h)}return a}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==ot&&(n.blending=this.blending),this.side!==se&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const s=i(e.textures),a=i(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const Ax={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fr={h:0,s:0,l:0},Bh={h:0,s:0,l:0};function Ym(l,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?l+6*(e-l)*t:t<.5?e:t<2/3?l+6*(e-l)*(2/3-t):l}class Ie{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Di){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Pn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=Pn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Pn.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=Pn.workingColorSpace){if(e=Pm(e,1),t=an(t,0,1),n=an(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=Ym(a,s,e+1/3),this.g=Ym(a,s,e),this.b=Ym(a,s,e-1/3)}return Pn.toWorkingColorSpace(this,i),this}setStyle(e,t=Di){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],c=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Pn.toWorkingColorSpace(this,t),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Pn.toWorkingColorSpace(this,t),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){const h=parseFloat(s[1])/360,d=parseFloat(s[2])/100,f=parseFloat(s[3])/100;return n(s[4]),this.setHSL(h,d,f,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Pn.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Pn.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Di){const n=Ax[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Go(e.r),this.g=Go(e.g),this.b=Go(e.b),this}copyLinearToSRGB(e){return this.r=Im(e.r),this.g=Im(e.g),this.b=Im(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Di){return Pn.fromWorkingColorSpace(qn.copy(this),e),an(255*qn.r,0,255)<<16^an(255*qn.g,0,255)<<8^an(255*qn.b,0,255)<<0}getHexString(e=Di){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Pn.workingColorSpace){Pn.fromWorkingColorSpace(qn.copy(this),t);const n=qn.r,i=qn.g,s=qn.b,a=Math.max(n,i,s),c=Math.min(n,i,s);let h,d;const f=(c+a)/2;if(c===a)h=0,d=0;else{const m=a-c;switch(d=f<=.5?m/(a+c):m/(2-a-c),a){case n:h=(i-s)/m+(i<s?6:0);break;case i:h=(s-n)/m+2;break;case s:h=(n-i)/m+4}h/=6}return e.h=h,e.s=d,e.l=f,e}getRGB(e,t=Pn.workingColorSpace){return Pn.fromWorkingColorSpace(qn.copy(this),t),e.r=qn.r,e.g=qn.g,e.b=qn.b,e}getStyle(e=Di){Pn.fromWorkingColorSpace(qn.copy(this),e);const t=qn.r,n=qn.g,i=qn.b;return e!==Di?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${255*t|0},${255*n|0},${255*i|0})`}offsetHSL(e,t,n){return this.getHSL(fr),fr.h+=e,fr.s+=t,fr.l+=n,this.setHSL(fr.h,fr.s,fr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(fr),e.getHSL(Bh);const n=Mc(fr.h,Bh.h,t),i=Mc(fr.s,Bh.s,t),s=Mc(fr.l,Bh.l,t);return this.setHSL(n,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const qn=new Ie;Ie.NAMES=Ax;class xi extends un{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const gn=new O,jh=new de;class tt{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=wc,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)jh.fromBufferAttribute(this,t),jh.applyMatrix3(e),this.setXY(t,jh.x,jh.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)gn.fromBufferAttribute(this,t),gn.applyMatrix3(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)gn.fromBufferAttribute(this,t),gn.applyMatrix4(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)gn.fromBufferAttribute(this,t),gn.applyNormalMatrix(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)gn.fromBufferAttribute(this,t),gn.transformDirection(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ns(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ns(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ns(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ns(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),n=Ft(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),n=Ft(n,this.array),i=Ft(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),n=Ft(n,this.array),i=Ft(i,this.array),s=Ft(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==wc&&(e.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class rA extends tt{constructor(e,t,n){super(new Int8Array(e),t,n)}}class sA extends tt{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class aA extends tt{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class oA extends tt{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Hh extends tt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class lA extends tt{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Qm extends tt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class cA extends tt{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class We extends tt{constructor(e,t,n){super(new Float32Array(e),t,n)}}class uA extends tt{constructor(e,t,n){super(new Float64Array(e),t,n)}}let hA=0;const Yi=new Ne,Zm=new ct,Jo=new O,Ni=new Ir,Pc=new Ir,Cn=new O;class $e extends Xi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:hA++}),this.uuid=Oi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(gx(e)?Qm:Hh)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new mn().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Yi.makeRotationFromQuaternion(e),this.applyMatrix4(Yi),this}rotateX(e){return Yi.makeRotationX(e),this.applyMatrix4(Yi),this}rotateY(e){return Yi.makeRotationY(e),this.applyMatrix4(Yi),this}rotateZ(e){return Yi.makeRotationZ(e),this.applyMatrix4(Yi),this}translate(e,t,n){return Yi.makeTranslation(e,t,n),this.applyMatrix4(Yi),this}scale(e,t,n){return Yi.makeScale(e,t,n),this.applyMatrix4(Yi),this}lookAt(e){return Zm.lookAt(e),Zm.updateMatrix(),this.applyMatrix4(Zm.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Jo).negate(),this.translate(Jo.x,Jo.y,Jo.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new We(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ir);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new O(-1/0,-1/0,-1/0),new O(1/0,1/0,1/0));if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const s=t[n];Ni.setFromBufferAttribute(s),this.morphTargetsRelative?(Cn.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(Cn),Cn.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(Cn)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new rs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new O,1/0);if(e){const n=this.boundingSphere.center;if(Ni.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const c=t[s];Pc.setFromBufferAttribute(c),this.morphTargetsRelative?(Cn.addVectors(Ni.min,Pc.min),Ni.expandByPoint(Cn),Cn.addVectors(Ni.max,Pc.max),Ni.expandByPoint(Cn)):(Ni.expandByPoint(Pc.min),Ni.expandByPoint(Pc.max))}Ni.getCenter(n);let i=0;for(let s=0,a=e.count;s<a;s++)Cn.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(Cn));if(t)for(let s=0,a=t.length;s<a;s++){const c=t[s],h=this.morphTargetsRelative;for(let d=0,f=c.count;d<f;d++)Cn.fromBufferAttribute(c,d),h&&(Jo.fromBufferAttribute(e,d),Cn.add(Jo)),i=Math.max(i,n.distanceToSquared(Cn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,s=t.normal.array,a=t.uv.array,c=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new tt(new Float32Array(4*c),4));const h=this.getAttribute("tangent").array,d=[],f=[];for(let V=0;V<c;V++)d[V]=new O,f[V]=new O;const m=new O,g=new O,y=new O,S=new de,x=new de,w=new de,T=new O,_=new O;function E(V,U,te){m.fromArray(i,3*V),g.fromArray(i,3*U),y.fromArray(i,3*te),S.fromArray(a,2*V),x.fromArray(a,2*U),w.fromArray(a,2*te),g.sub(m),y.sub(m),x.sub(S),w.sub(S);const ue=1/(x.x*w.y-w.x*x.y);isFinite(ue)&&(T.copy(g).multiplyScalar(w.y).addScaledVector(y,-x.y).multiplyScalar(ue),_.copy(y).multiplyScalar(x.x).addScaledVector(g,-w.x).multiplyScalar(ue),d[V].add(T),d[U].add(T),d[te].add(T),f[V].add(_),f[U].add(_),f[te].add(_))}let R=this.groups;R.length===0&&(R=[{start:0,count:n.length}]);for(let V=0,U=R.length;V<U;++V){const te=R[V],ue=te.start;for(let ce=ue,we=ue+te.count;ce<we;ce+=3)E(n[ce+0],n[ce+1],n[ce+2])}const P=new O,C=new O,F=new O,W=new O;function B(V){F.fromArray(s,3*V),W.copy(F);const U=d[V];P.copy(U),P.sub(F.multiplyScalar(F.dot(U))).normalize(),C.crossVectors(W,U);const te=C.dot(f[V])<0?-1:1;h[4*V]=P.x,h[4*V+1]=P.y,h[4*V+2]=P.z,h[4*V+3]=te}for(let V=0,U=R.length;V<U;++V){const te=R[V],ue=te.start;for(let ce=ue,we=ue+te.count;ce<we;ce+=3)B(n[ce+0]),B(n[ce+1]),B(n[ce+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new tt(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let g=0,y=n.count;g<y;g++)n.setXYZ(g,0,0,0);const i=new O,s=new O,a=new O,c=new O,h=new O,d=new O,f=new O,m=new O;if(e)for(let g=0,y=e.count;g<y;g+=3){const S=e.getX(g+0),x=e.getX(g+1),w=e.getX(g+2);i.fromBufferAttribute(t,S),s.fromBufferAttribute(t,x),a.fromBufferAttribute(t,w),f.subVectors(a,s),m.subVectors(i,s),f.cross(m),c.fromBufferAttribute(n,S),h.fromBufferAttribute(n,x),d.fromBufferAttribute(n,w),c.add(f),h.add(f),d.add(f),n.setXYZ(S,c.x,c.y,c.z),n.setXYZ(x,h.x,h.y,h.z),n.setXYZ(w,d.x,d.y,d.z)}else for(let g=0,y=t.count;g<y;g+=3)i.fromBufferAttribute(t,g+0),s.fromBufferAttribute(t,g+1),a.fromBufferAttribute(t,g+2),f.subVectors(a,s),m.subVectors(i,s),f.cross(m),n.setXYZ(g+0,f.x,f.y,f.z),n.setXYZ(g+1,f.x,f.y,f.z),n.setXYZ(g+2,f.x,f.y,f.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Cn.fromBufferAttribute(e,t),Cn.normalize(),e.setXYZ(t,Cn.x,Cn.y,Cn.z)}toNonIndexed(){function e(c,h){const d=c.array,f=c.itemSize,m=c.normalized,g=new d.constructor(h.length*f);let y=0,S=0;for(let x=0,w=h.length;x<w;x++){y=c.isInterleavedBufferAttribute?h[x]*c.data.stride+c.offset:h[x]*f;for(let T=0;T<f;T++)g[S++]=d[y++]}return new tt(g,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new $e,n=this.index.array,i=this.attributes;for(const c in i){const h=e(i[c],n);t.setAttribute(c,h)}const s=this.morphAttributes;for(const c in s){const h=[],d=s[c];for(let f=0,m=d.length;f<m;f++){const g=e(d[f],n);h.push(g)}t.morphAttributes[c]=h}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,h=a.length;c<h;c++){const d=a[c];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const d in h)h[d]!==void 0&&(e[d]=h[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const h in n){const d=n[h];e.data.attributes[h]=d.toJSON(e.data)}const i={};let s=!1;for(const h in this.morphAttributes){const d=this.morphAttributes[h],f=[];for(let m=0,g=d.length;m<g;m++){const y=d[m];f.push(y.toJSON(e.data))}f.length>0&&(i[h]=f,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const d in i){const f=i[d];this.setAttribute(d,f.clone(t))}const s=e.morphAttributes;for(const d in s){const f=[],m=s[d];for(let g=0,y=m.length;g<y;g++)f.push(m[g].clone(t));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let d=0,f=a.length;d<f;d++){const m=a[d];this.addGroup(m.start,m.count,m.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Rx=new Ne,Nr=new Rc,Gh=new rs,Lx=new O,Cc=new O,Dc=new O,Oc=new O,Km=new O,Vh=new O,Wh=new de,Xh=new de,qh=new de,Jm=new O,Yh=new O;class et extends ct{constructor(e=new $e,t=new xi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,s=n.length;i<s;i++){const a=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const c=this.morphTargetInfluences;if(s&&c){Vh.set(0,0,0);for(let h=0,d=s.length;h<d;h++){const f=c[h],m=s[h];f!==0&&(Km.fromBufferAttribute(m,e),a?Vh.addScaledVector(Km,f):Vh.addScaledVector(Km.sub(t),f))}t.add(Vh)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Gh.copy(n.boundingSphere),Gh.applyMatrix4(s),Nr.copy(e.ray).recast(e.near),Gh.containsPoint(Nr.origin)===!1&&(Nr.intersectSphere(Gh,Lx)===null||Nr.origin.distanceToSquared(Lx)>(e.far-e.near)**2))||(Rx.copy(s).invert(),Nr.copy(e.ray).applyMatrix4(Rx),n.boundingBox!==null&&Nr.intersectsBox(n.boundingBox)===!1))return;let a;const c=n.index,h=n.attributes.position,d=n.attributes.uv,f=n.attributes.uv2,m=n.groups,g=n.drawRange;if(c!==null)if(Array.isArray(i))for(let y=0,S=m.length;y<S;y++){const x=m[y],w=i[x.materialIndex];for(let T=Math.max(x.start,g.start),_=Math.min(c.count,Math.min(x.start+x.count,g.start+g.count));T<_;T+=3){const E=c.getX(T),R=c.getX(T+1),P=c.getX(T+2);a=Qh(this,w,e,Nr,d,f,E,R,P),a&&(a.faceIndex=Math.floor(T/3),a.face.materialIndex=x.materialIndex,t.push(a))}}else for(let y=Math.max(0,g.start),S=Math.min(c.count,g.start+g.count);y<S;y+=3){const x=c.getX(y),w=c.getX(y+1),T=c.getX(y+2);a=Qh(this,i,e,Nr,d,f,x,w,T),a&&(a.faceIndex=Math.floor(y/3),t.push(a))}else if(h!==void 0)if(Array.isArray(i))for(let y=0,S=m.length;y<S;y++){const x=m[y],w=i[x.materialIndex];for(let T=Math.max(x.start,g.start),_=Math.min(h.count,Math.min(x.start+x.count,g.start+g.count));T<_;T+=3)a=Qh(this,w,e,Nr,d,f,T,T+1,T+2),a&&(a.faceIndex=Math.floor(T/3),a.face.materialIndex=x.materialIndex,t.push(a))}else for(let y=Math.max(0,g.start),S=Math.min(h.count,g.start+g.count);y<S;y+=3)a=Qh(this,i,e,Nr,d,f,y,y+1,y+2),a&&(a.faceIndex=Math.floor(y/3),t.push(a))}}function Qh(l,e,t,n,i,s,a,c,h){l.getVertexPosition(a,Cc),l.getVertexPosition(c,Dc),l.getVertexPosition(h,Oc);const d=function(f,m,g,y,S,x,w,T){let _;if(_=m.side===ye?y.intersectTriangle(w,x,S,!0,T):y.intersectTriangle(S,x,w,m.side===se,T),_===null)return null;Yh.copy(T),Yh.applyMatrix4(f.matrixWorld);const E=g.ray.origin.distanceTo(Yh);return E<g.near||E>g.far?null:{distance:E,point:Yh.clone(),object:f}}(l,e,t,n,Cc,Dc,Oc,Jm);if(d){i&&(Wh.fromBufferAttribute(i,a),Xh.fromBufferAttribute(i,c),qh.fromBufferAttribute(i,h),d.uv=qi.getUV(Jm,Cc,Dc,Oc,Wh,Xh,qh,new de)),s&&(Wh.fromBufferAttribute(s,a),Xh.fromBufferAttribute(s,c),qh.fromBufferAttribute(s,h),d.uv2=qi.getUV(Jm,Cc,Dc,Oc,Wh,Xh,qh,new de));const f={a,b:c,c:h,normal:new O,materialIndex:0};qi.getNormal(Cc,Dc,Oc,f.normal),d.face=f}return d}class cs extends $e{constructor(e=1,t=1,n=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:a};const c=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const h=[],d=[],f=[],m=[];let g=0,y=0;function S(x,w,T,_,E,R,P,C,F,W,B){const V=R/F,U=P/W,te=R/2,ue=P/2,ce=C/2,we=F+1,ve=W+1;let Re=0,Pe=0;const De=new O;for(let fe=0;fe<ve;fe++){const oe=fe*U-ue;for(let Se=0;Se<we;Se++){const Ce=Se*V-te;De[x]=Ce*_,De[w]=oe*E,De[T]=ce,d.push(De.x,De.y,De.z),De[x]=0,De[w]=0,De[T]=C>0?1:-1,f.push(De.x,De.y,De.z),m.push(Se/F),m.push(1-fe/W),Re+=1}}for(let fe=0;fe<W;fe++)for(let oe=0;oe<F;oe++){const Se=g+oe+we*fe,Ce=g+oe+we*(fe+1),Te=g+(oe+1)+we*(fe+1),ze=g+(oe+1)+we*fe;h.push(Se,Ce,ze),h.push(Ce,Te,ze),Pe+=6}c.addGroup(y,Pe,B),y+=Pe,g+=Re}S("z","y","x",-1,-1,n,t,e,a,s,0),S("z","y","x",1,-1,n,t,-e,a,s,1),S("x","z","y",1,1,e,n,t,i,a,2),S("x","z","y",1,-1,e,n,-t,i,a,3),S("x","y","z",1,-1,e,t,n,i,s,4),S("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(h),this.setAttribute("position",new We(d,3)),this.setAttribute("normal",new We(f,3)),this.setAttribute("uv",new We(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cs(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function $o(l){const e={};for(const t in l){e[t]={};for(const n in l[t]){const i=l[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function li(l){const e={};for(let t=0;t<l.length;t++){const n=$o(l[t]);for(const i in n)e[i]=n[i]}return e}function Px(l){return l.getRenderTarget()===null&&l.outputEncoding===mt?Di:jo}const $m={clone:$o,merge:li};class St extends un{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,this.fragmentShader=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=$o(e.uniforms),this.uniformsGroups=function(t){const n=[];for(let i=0;i<t.length;i++)n.push(t[i].clone());return n}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const s=this.uniforms[i].value;s&&s.isTexture?t.uniforms[i]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[i]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[i]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[i]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[i]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[i]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[i]={type:"m4",value:s.toArray()}:t.uniforms[i]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class el extends ct{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ne,this.projectionMatrix=new Ne,this.projectionMatrixInverse=new Ne}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Kt extends el{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*_c*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Na*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*_c*Math.atan(Math.tan(.5*Na*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Na*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const h=a.fullWidth,d=a.fullHeight;s+=a.offsetX*i/h,t-=a.offsetY*n/d,i*=a.width/h,n*=a.height/d}const c=this.filmOffset;c!==0&&(s+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const tl=-90;class Cx extends ct{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const i=new Kt(tl,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);const s=new Kt(tl,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const a=new Kt(tl,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);const c=new Kt(tl,1,e,t);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(0,-1,0),this.add(c);const h=new Kt(tl,1,e,t);h.layers=this.layers,h.up.set(0,1,0),h.lookAt(0,0,1),this.add(h);const d=new Kt(tl,1,e,t);d.layers=this.layers,d.up.set(0,1,0),d.lookAt(0,0,-1),this.add(d)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,s,a,c,h,d]=this.children,f=e.getRenderTarget(),m=e.toneMapping,g=e.xr.enabled;e.toneMapping=Or,e.xr.enabled=!1;const y=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,c),e.setRenderTarget(n,4),e.render(t,h),n.texture.generateMipmaps=y,e.setRenderTarget(n,5),e.render(t,d),e.setRenderTarget(f),e.toneMapping=m,e.xr.enabled=g,n.texture.needsPMREMUpdate=!0}}class Ic extends zt{constructor(e,t,n,i,s,a,c,h,d,f){super(e=e!==void 0?e:[],t=t!==void 0?t:Ds,n,i,s,a,c,h,d,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Dx extends Lt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Ic(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0&&t.generateMipmaps,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:at}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new cs(5,5,5),s=new St({name:"CubemapFromEquirect",uniforms:$o(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ye,blending:Be});s.uniforms.tEquirect.value=t;const a=new et(i,s),c=t.minFilter;return t.minFilter===cr&&(t.minFilter=at),new Cx(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,i);e.setRenderTarget(s)}}const e0=new O,dA=new O,pA=new mn;class us{constructor(e=new O(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=e0.subVectors(n,t).cross(dA.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(e0),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||pA.getNormalMatrix(e),i=this.coplanarPoint(e0).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const nl=new rs,Zh=new O;class Nc{constructor(e=new us,t=new us,n=new us,i=new us,s=new us,a=new us){this.planes=[e,t,n,i,s,a]}set(e,t,n,i,s,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(i),c[4].copy(s),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],s=n[1],a=n[2],c=n[3],h=n[4],d=n[5],f=n[6],m=n[7],g=n[8],y=n[9],S=n[10],x=n[11],w=n[12],T=n[13],_=n[14],E=n[15];return t[0].setComponents(c-i,m-h,x-g,E-w).normalize(),t[1].setComponents(c+i,m+h,x+g,E+w).normalize(),t[2].setComponents(c+s,m+d,x+y,E+T).normalize(),t[3].setComponents(c-s,m-d,x-y,E-T).normalize(),t[4].setComponents(c-a,m-f,x-S,E-_).normalize(),t[5].setComponents(c+a,m+f,x+S,E+_).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),nl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(nl)}intersectsSprite(e){return nl.center.set(0,0,0),nl.radius=.7071067811865476,nl.applyMatrix4(e.matrixWorld),this.intersectsSphere(nl)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Zh.x=i.normal.x>0?e.max.x:e.min.x,Zh.y=i.normal.y>0?e.max.y:e.min.y,Zh.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Zh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Ox(){let l=null,e=!1,t=null,n=null;function i(s,a){t(s,a),n=l.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=l.requestAnimationFrame(i),e=!0)},stop:function(){l.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){l=s}}}function fA(l,e){const t=e.isWebGL2,n=new WeakMap;return{get:function(i){return i.isInterleavedBufferAttribute&&(i=i.data),n.get(i)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);const s=n.get(i);s&&(l.deleteBuffer(s.buffer),n.delete(i))},update:function(i,s){if(i.isGLBufferAttribute){const c=n.get(i);return void((!c||c.version<i.version)&&n.set(i,{buffer:i.buffer,type:i.type,bytesPerElement:i.elementSize,version:i.version}))}i.isInterleavedBufferAttribute&&(i=i.data);const a=n.get(i);a===void 0?n.set(i,function(c,h){const d=c.array,f=c.usage,m=l.createBuffer();let g;if(l.bindBuffer(h,m),l.bufferData(h,d,f),c.onUploadCallback(),d instanceof Float32Array)g=l.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=l.HALF_FLOAT}else g=l.UNSIGNED_SHORT;else if(d instanceof Int16Array)g=l.SHORT;else if(d instanceof Uint32Array)g=l.UNSIGNED_INT;else if(d instanceof Int32Array)g=l.INT;else if(d instanceof Int8Array)g=l.BYTE;else if(d instanceof Uint8Array)g=l.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);g=l.UNSIGNED_BYTE}return{buffer:m,type:g,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(i,s)):a.version<i.version&&(function(c,h,d){const f=h.array,m=h.updateRange;l.bindBuffer(d,c),m.count===-1?l.bufferSubData(d,0,f):(t?l.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f,m.offset,m.count):l.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f.subarray(m.offset,m.offset+m.count)),m.count=-1),h.onUploadCallback()}(a.buffer,i,s),a.version=i.version)}}}class hs extends $e{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,a=t/2,c=Math.floor(n),h=Math.floor(i),d=c+1,f=h+1,m=e/c,g=t/h,y=[],S=[],x=[],w=[];for(let T=0;T<f;T++){const _=T*g-a;for(let E=0;E<d;E++){const R=E*m-s;S.push(R,-_,0),x.push(0,0,1),w.push(E/c),w.push(1-T/h)}}for(let T=0;T<h;T++)for(let _=0;_<c;_++){const E=_+d*T,R=_+d*(T+1),P=_+1+d*(T+1),C=_+1+d*T;y.push(E,R,C),y.push(R,P,C)}this.setIndex(y),this.setAttribute("position",new We(S,3)),this.setAttribute("normal",new We(x,3)),this.setAttribute("uv",new We(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hs(e.width,e.height,e.widthSegments,e.heightSegments)}}const dt={alphamap_fragment:`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`,alphamap_pars_fragment:`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,alphatest_fragment:`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`,alphatest_pars_fragment:`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`,aomap_fragment:`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`,aomap_pars_fragment:`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`,begin_vertex:`
vec3 transformed = vec3( position );
`,beginnormal_vertex:`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`,bsdfs:`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );

    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disney’s reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

#ifdef USE_IRIDESCENCE

	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {

		float alpha = pow2( roughness ); // UE4's roughness

		vec3 halfDir = normalize( lightDir + viewDir );

		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );

		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );

		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

		float D = D_GGX( alpha, dotNH );

		return F * ( V * D );

	}

#endif

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif
`,iridescence_fragment:`

#ifdef USE_IRIDESCENCE

	// XYZ to linear-sRGB color space
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);

	// Assume air interface for top
	// Note: We don't handle the case fresnel0 == 1
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {

		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );

	}

	// Conversion FO/IOR
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );

	}

	// ior is a value between 1.0 and 3.0. 1.0 is air interface
	float IorToFresnel0( float transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));

	}

	// Fresnel equations for dielectric/dielectric interfaces.
	// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html
	// Evaluation XYZ sensitivity curves in Fourier space
	vec3 evalSensitivity( float OPD, vec3 shift ) {

		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );

		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;

		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;

	}

	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {

		vec3 I;

		// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		// Evaluate the cosTheta on the base layer (Snell law)
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );

		// Handle TIR:
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {

			 return vec3( 1.0 );

		}

		float cosTheta2 = sqrt( cosTheta2Sq );

		// First interface
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;

		// Second interface
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) ); // guard against 1.0
		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;

		// Phase shift
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;

		// Compound terms
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );

		// Reflectance term for m = 0 (DC term amplitude)
		vec3 C0 = R12 + Rs;
		I = C0;

		// Reflectance term for m > 0 (pairs of diracs)
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {

			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;

		}

		// Since out of gamut colors might be produced, negative color values are clamped to 0.
		return max( I, vec3( 0.0 ) );

	}

#endif

`,bumpmap_pars_fragment:`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm; // normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`,clipping_planes_fragment:`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`,clipping_planes_pars_fragment:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`,clipping_planes_pars_vertex:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`,clipping_planes_vertex:`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`,color_fragment:`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`,color_pars_fragment:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`,color_pars_vertex:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`,color_vertex:`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`,common:`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

float luminance( const in vec3 rgb ) {

	// assumes rgb is in linear color space with sRGB primaries and D65 white point

	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );

	return dot( weights, rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}

// Mipped Bicubic Texture Filtering by N8
// https://www.shadertoy.com/view/Dl2SDW

float w0( float a ) {

	return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );

}

float w1( float a ) {

	return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );

}

float w2( float a ){

    return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );

}

float w3( float a ) {

	return ( 1.0 / 6.0 ) * ( a * a * a );

}

// g0 and g1 are the two amplitude functions
float g0( float a ) {

	return w0( a ) + w1( a );

}

float g1( float a ) {

	return w2( a ) + w3( a );

}

// h0 and h1 are the two offset functions
float h0( float a ) {

	return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );

}

float h1( float a ) {

    return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );

}

vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {

	uv = uv * texelSize.zw + 0.5;

	vec2 iuv = floor( uv );
    vec2 fuv = fract( uv );

    float g0x = g0( fuv.x );
    float g1x = g1( fuv.x );
    float h0x = h0( fuv.x );
    float h1x = h1( fuv.x );
    float h0y = h0( fuv.y );
    float h1y = h1( fuv.y );

    vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
    vec2 lodFudge = pow( 1.95, lod ) / fullSize;
#if __VERSION__ > 130
	return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
		   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
#else
	return texture2D(tex, uv); //TODO: remove
#endif
}

vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {

#if __VERSION__ > 130
	vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
	vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
	vec2 fLodSizeInv = 1.0 / fLodSize;
	vec2 cLodSizeInv = 1.0 / cLodSize;
	vec2 fullSize = vec2( textureSize( sampler, 0 ) );
	vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
	vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
	return mix( fSample, cSample, fract( lod ) );
#else
	return texture2D(sampler, uv); //TODO: remove
#endif

}
`,cube_uv_reflection_fragment:`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0; // #25071

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		uv.x += filterInt * 3.0 * cubeUV_minTileSize;

		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );

		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;

		#ifdef texture2DGradEXT

			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb; // disable anisotropic filtering

		#else

			return texture2D( envMap, uv ).rgb;

		#endif

	}

	// These defines must match with PMREMGenerator

	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= cubeUV_r1 ) {

			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;

		} else if ( roughness >= cubeUV_r4 ) {

			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;

		} else if ( roughness >= cubeUV_r5 ) {

			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;

		} else if ( roughness >= cubeUV_r6 ) {

			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`,defaultnormal_vertex:`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`,displacementmap_pars_vertex:`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`,displacementmap_vertex:`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`,emissivemap_fragment:`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`,emissivemap_pars_fragment:`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`,encodings_fragment:`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`,encodings_pars_fragment:`

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`,envmap_fragment:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`,envmap_common_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3  envRotationMatrix;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`,envmap_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`,envmap_pars_vertex:`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`,envmap_physical_pars_fragment:`
#if defined( USE_ENVMAP )

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envRotationMatrix*worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec = reflect( - viewDir, normal );

			// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envRotationMatrix*reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`,envmap_vertex:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`,fog_vertex:`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`,fog_pars_vertex:`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`,fog_fragment:`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`,fog_pars_fragment:`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`,gradientmap_pars_fragment:`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );

	#endif

}
`,lightmap_fragment:`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`,lightmap_pars_fragment:`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`,lights_lambert_fragment:`
LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;
`,lights_lambert_pars_fragment:`
varying vec3 vViewPosition;

struct LambertMaterial {

	vec3 diffuseColor;
	float specularStrength;

};

void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
`,lights_pars_begin:`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( LEGACY_LIGHTS )

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#else

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`,lights_toon_fragment:`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`,lights_toon_pars_fragment:`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
`,lights_phong_fragment:`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,lights_phong_pars_fragment:`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,lights_physical_fragment:`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	material.ior = ior;

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARCOLORMAP

			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_IRIDESCENCE

	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;

	#ifdef USE_IRIDESCENCEMAP

		material.iridescence *= texture2D( iridescenceMap, vUv ).r;

	#endif

	#ifdef USE_IRIDESCENCE_THICKNESSMAP

		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;

	#else

		material.iridescenceThickness = iridescenceThicknessMaximum;

	#endif

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEENCOLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEENROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;

	#endif

#endif
`,lights_physical_pars_fragment:`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

	#ifdef IOR
		float ior;
	#endif

	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from 
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Agüera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	#ifdef USE_IRIDESCENCE

		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );

	#else

		vec3 Fr = specularColor;

	#endif

	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );

	#endif

	#ifdef USE_IRIDESCENCE

		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );

	#else

		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );

	#endif

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	#ifdef USE_IRIDESCENCE

		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );

	#else

		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	#endif

	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`,lights_fragment_begin:`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

#ifdef USE_IRIDESCENCE

	float dotNVi = saturate( dot( normal, geometry.viewDir ) );

	if ( material.iridescenceThickness == 0.0 ) {

		material.iridescence = 0.0;

	} else {

		material.iridescence = saturate( material.iridescence );

	}

	if ( material.iridescence > 0.0 ) {

		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );

		// Iridescence F0 approximation
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );

	}

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;

	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif

		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif

		#undef SPOT_LIGHT_MAP_INDEX

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,lights_fragment_maps:`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`,lights_fragment_end:`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`,logdepthbuf_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`,logdepthbuf_pars_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`,logdepthbuf_pars_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`,logdepthbuf_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`,map_fragment:`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`,map_pars_fragment:`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`,map_particle_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`,map_particle_pars_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,metalnessmap_fragment:`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`,metalnessmap_pars_fragment:`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`,morphcolor_vertex:`
#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	vColor *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		#if defined( USE_COLOR_ALPHA )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];

		#elif defined( USE_COLOR )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];

		#endif

	}

#endif
`,morphnormal_vertex:`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`,morphtarget_pars_vertex:`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;

		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {

			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;

			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`,morphtarget_vertex:`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`,normal_fragment_begin:`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`,normal_fragment_maps:`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`,normal_pars_fragment:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_pars_vertex:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_vertex:`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`,normalmap_pars_fragment:`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`,clearcoat_normal_fragment_begin:`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`,clearcoat_normal_fragment_maps:`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`,clearcoat_pars_fragment:`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`,iridescence_pars_fragment:`

#ifdef USE_IRIDESCENCEMAP

	uniform sampler2D iridescenceMap;

#endif

#ifdef USE_IRIDESCENCE_THICKNESSMAP

	uniform sampler2D iridescenceThicknessMap;

#endif
`,output_fragment:`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`,packing:`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}

float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,premultiplied_alpha_fragment:`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`,project_vertex:`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`,dithering_fragment:`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`,dithering_pars_fragment:`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift according to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`,roughnessmap_fragment:`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`,roughnessmap_pars_fragment:`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`,shadowmap_pars_fragment:`
#if NUM_SPOT_LIGHT_COORDS > 0

	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#if NUM_SPOT_LIGHT_MAPS > 0

	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`,shadowmap_pars_vertex:`

#if NUM_SPOT_LIGHT_COORDS > 0

	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`,shadowmap_vertex:`

#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )

	// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;

#endif

#if defined( USE_SHADOWMAP )

	#if NUM_DIR_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif

// spot lights can be evaluated without active shadow mapping (when SpotLight.map is used)

#if NUM_SPOT_LIGHT_COORDS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {

		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

#endif


`,shadowmask_pars_fragment:`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`,skinbase_vertex:`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`,skinning_pars_vertex:`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;

	mat4 getBoneMatrix( const in float i ) {

		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );

		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );

		y = dy * ( y + 0.5 );

		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

		mat4 bone = mat4( v1, v2, v3, v4 );

		return bone;

	}

#endif
`,skinning_vertex:`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`,skinnormal_vertex:`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`,specularmap_fragment:`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`,specularmap_pars_fragment:`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`,tonemapping_fragment:`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`,tonemapping_pars_fragment:`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );
}

vec3 CustomToneMapping( vec3 color ) { return color; }
`,transmission_fragment:`
#ifdef USE_TRANSMISSION

	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		material.transmission *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		material.thickness *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );

	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );

#endif
`,transmission_pars_fragment:`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );

	}

	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( isinf( attenuationDistance ) ) {

			// Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`,uv_pars_fragment:`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`,uv_pars_vertex:`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`,uv_vertex:`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`,uv2_pars_fragment:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`,uv2_pars_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`,uv2_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`,worldpos_vertex:`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`,background_vert:`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,background_frag:`
uniform sampler2D t2D;
uniform float backgroundIntensity;

varying vec2 vUv;

void main() {

	vec4 texColor = texture2D( t2D, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,backgroundCube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,backgroundCube_frag:`

#ifdef ENVMAP_TYPE_CUBE

	uniform samplerCube envMap;

#elif defined( ENVMAP_TYPE_CUBE_UV )

	uniform sampler2D envMap;

#endif

uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3  envRotationMatrix;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 dir = envRotationMatrix * vWorldDirection;

	#ifdef ENVMAP_TYPE_CUBE

		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * dir.x, dir.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 texColor = textureCubeUV( envMap, dir, backgroundBlurriness );

	#else

		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,cube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,cube_frag:`
uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;

varying vec3 vWorldDirection;

void main() {

	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );

	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,depth_vert:`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,depth_frag:`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`,distanceRGBA_vert:`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,distanceRGBA_frag:`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`,equirect_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,equirect_frag:`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,linedashed_vert:`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,linedashed_frag:`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,meshbasic_vert:`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,meshbasic_frag:`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshlambert_vert:`
#define LAMBERT

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshlambert_frag:`
#define LAMBERT

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshmatcap_vert:`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,meshmatcap_frag:`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshnormal_vert:`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,meshnormal_frag:`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`,meshphong_vert:`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshphong_frag:`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshphysical_vert:`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,meshphysical_frag:`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

#if defined(DEBUG_OCCLUSION) && defined(USE_AOMAP)
	gl_FragColor.rgb = vec3(ambientOcclusion);
#endif

#if defined(DEBUG_NORMAL)
	gl_FragColor.rgb = geometry.normal * 0.5 + 0.5;
#endif

#if defined(DEBUG_ROUGHNESS)
	gl_FragColor.rgb = vec3(material.roughness);
#endif

#if defined(DEBUG_METALNESS)
	gl_FragColor.rgb = vec3(metalnessFactor);
#endif

}
`,meshtoon_vert:`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshtoon_frag:`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,points_vert:`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,points_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,shadow_vert:`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,shadow_frag:`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	#include <logdepthbuf_fragment>

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`,sprite_vert:`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,sprite_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`},Ve={common:{diffuse:{value:new Ie(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new mn},uv2Transform:{value:new mn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new de(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ie(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ie(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mn}},sprite:{diffuse:{value:new Ie(16777215)},opacity:{value:1},center:{value:new de(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mn}}},mr={basic:{uniforms:li([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.fog]),vertexShader:dt.meshbasic_vert,fragmentShader:dt.meshbasic_frag},lambert:{uniforms:li([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new Ie(0)}}]),vertexShader:dt.meshlambert_vert,fragmentShader:dt.meshlambert_frag},phong:{uniforms:li([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new Ie(0)},specular:{value:new Ie(1118481)},shininess:{value:30}}]),vertexShader:dt.meshphong_vert,fragmentShader:dt.meshphong_frag},standard:{uniforms:li([Ve.common,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.roughnessmap,Ve.metalnessmap,Ve.fog,Ve.lights,{emissive:{value:new Ie(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag},toon:{uniforms:li([Ve.common,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.gradientmap,Ve.fog,Ve.lights,{emissive:{value:new Ie(0)}}]),vertexShader:dt.meshtoon_vert,fragmentShader:dt.meshtoon_frag},matcap:{uniforms:li([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,{matcap:{value:null}}]),vertexShader:dt.meshmatcap_vert,fragmentShader:dt.meshmatcap_frag},points:{uniforms:li([Ve.points,Ve.fog]),vertexShader:dt.points_vert,fragmentShader:dt.points_frag},dashed:{uniforms:li([Ve.common,Ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dt.linedashed_vert,fragmentShader:dt.linedashed_frag},depth:{uniforms:li([Ve.common,Ve.displacementmap]),vertexShader:dt.depth_vert,fragmentShader:dt.depth_frag},normal:{uniforms:li([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,{opacity:{value:1}}]),vertexShader:dt.meshnormal_vert,fragmentShader:dt.meshnormal_frag},sprite:{uniforms:li([Ve.sprite,Ve.fog]),vertexShader:dt.sprite_vert,fragmentShader:dt.sprite_frag},background:{uniforms:{uvTransform:{value:new mn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:dt.background_vert,fragmentShader:dt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:dt.backgroundCube_vert,fragmentShader:dt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:dt.cube_vert,fragmentShader:dt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:dt.equirect_vert,fragmentShader:dt.equirect_frag},distanceRGBA:{uniforms:li([Ve.common,Ve.displacementmap,{referencePosition:{value:new O},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:dt.distanceRGBA_vert,fragmentShader:dt.distanceRGBA_frag},shadow:{uniforms:li([Ve.lights,Ve.fog,{color:{value:new Ie(0)},opacity:{value:1}}]),vertexShader:dt.shadow_vert,fragmentShader:dt.shadow_frag}};mr.physical={uniforms:li([mr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new de(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ie(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new de},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ie(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ie(1,1,1)},specularColorMap:{value:null}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag};const Kh={r:0,b:0,g:0};function mA(l,e,t,n,i,s,a){const c=new Ie(0);let h,d,f=s===!0?0:1,m=null,g=0,y=null;function S(x,w){x.getRGB(Kh,Px(l)),n.buffers.color.setClear(Kh.r,Kh.g,Kh.b,w,a)}return{getClearColor:function(){return c},setClearColor:function(x,w=1){c.set(x),f=w,S(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(x){f=x,S(c,f)},render:function(x,w){let T=!1,_=w.isScene===!0?w.background:null;_&&_.isTexture&&(_=(w.backgroundBlurriness>0?t:e).get(_));const E=l.xr,R=E.getSession&&E.getSession();R&&R.environmentBlendMode==="additive"&&(_=null),_===null?S(c,f):_&&_.isColor&&(S(_,1),T=!0),(l.autoClear||T)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Fo)?(d===void 0&&(d=new et(new cs(1,1,1),new St({name:"BackgroundCubeMaterial",uniforms:$o(mr.backgroundCube.uniforms),vertexShader:mr.backgroundCube.vertexShader,fragmentShader:mr.backgroundCube.fragmentShader,side:ye,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(P,C,F){this.matrixWorld.copyPosition(F.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(d)),d.material.uniforms.envMap.value=_,d.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,d.material.toneMapped=_.encoding!==mt,m===_&&g===_.version&&y===l.toneMapping||(d.material.needsUpdate=!0,m=_,g=_.version,y=l.toneMapping),d.layers.enableAll(),x.unshift(d,d.geometry,d.material,0,0,null)):_&&_.isTexture&&(h===void 0&&(h=new et(new hs(2,2),new St({name:"BackgroundMaterial",uniforms:$o(mr.background.uniforms),vertexShader:mr.background.vertexShader,fragmentShader:mr.background.fragmentShader,side:se,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=_,h.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,h.material.toneMapped=_.encoding!==mt,_.matrixAutoUpdate===!0&&_.updateMatrix(),h.material.uniforms.uvTransform.value.copy(_.matrix),m===_&&g===_.version&&y===l.toneMapping||(h.material.needsUpdate=!0,m=_,g=_.version,y=l.toneMapping),h.layers.enableAll(),x.unshift(h,h.geometry,h.material,0,0,null))}}}function gA(l,e,t,n){const i=l.getParameter(l.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||s!==null,c={},h=y(null);let d=h,f=!1;function m(P){return n.isWebGL2?l.bindVertexArray(P):s.bindVertexArrayOES(P)}function g(P){return n.isWebGL2?l.deleteVertexArray(P):s.deleteVertexArrayOES(P)}function y(P){const C=[],F=[],W=[];for(let B=0;B<i;B++)C[B]=0,F[B]=0,W[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:C,enabledAttributes:F,attributeDivisors:W,object:P,attributes:{},index:null}}function S(){const P=d.newAttributes;for(let C=0,F=P.length;C<F;C++)P[C]=0}function x(P){w(P,0)}function w(P,C){const F=d.newAttributes,W=d.enabledAttributes,B=d.attributeDivisors;F[P]=1,W[P]===0&&(l.enableVertexAttribArray(P),W[P]=1),B[P]!==C&&((n.isWebGL2?l:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,C),B[P]=C)}function T(){const P=d.newAttributes,C=d.enabledAttributes;for(let F=0,W=C.length;F<W;F++)C[F]!==P[F]&&(l.disableVertexAttribArray(F),C[F]=0)}function _(P,C,F,W,B,V){n.isWebGL2!==!0||F!==l.INT&&F!==l.UNSIGNED_INT?l.vertexAttribPointer(P,C,F,W,B,V):l.vertexAttribIPointer(P,C,F,B,V)}function E(){R(),f=!0,d!==h&&(d=h,m(d.object))}function R(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:function(P,C,F,W,B){let V=!1;if(a){const U=function(te,ue,ce){const we=ce.wireframe===!0;let ve=c[te.id];ve===void 0&&(ve={},c[te.id]=ve);let Re=ve[ue.id];Re===void 0&&(Re={},ve[ue.id]=Re);let Pe=Re[we];return Pe===void 0&&(Pe=y(n.isWebGL2?l.createVertexArray():s.createVertexArrayOES()),Re[we]=Pe),Pe}(W,F,C);d!==U&&(d=U,m(d.object)),V=function(te,ue,ce,we){const ve=d.attributes,Re=ue.attributes;let Pe=0;const De=ce.getAttributes();for(const fe in De)if(De[fe].location>=0){const oe=ve[fe];let Se=Re[fe];if(Se===void 0&&(fe==="instanceMatrix"&&te.instanceMatrix&&(Se=te.instanceMatrix),fe==="instanceColor"&&te.instanceColor&&(Se=te.instanceColor)),oe===void 0||oe.attribute!==Se||Se&&oe.data!==Se.data)return!0;Pe++}return d.attributesNum!==Pe||d.index!==we}(P,W,F,B),V&&function(te,ue,ce,we){const ve={},Re=ue.attributes;let Pe=0;const De=ce.getAttributes();for(const fe in De)if(De[fe].location>=0){let oe=Re[fe];oe===void 0&&(fe==="instanceMatrix"&&te.instanceMatrix&&(oe=te.instanceMatrix),fe==="instanceColor"&&te.instanceColor&&(oe=te.instanceColor));const Se={};Se.attribute=oe,oe&&oe.data&&(Se.data=oe.data),ve[fe]=Se,Pe++}d.attributes=ve,d.attributesNum=Pe,d.index=we}(P,W,F,B)}else{const U=C.wireframe===!0;d.geometry===W.id&&d.program===F.id&&d.wireframe===U||(d.geometry=W.id,d.program=F.id,d.wireframe=U,V=!0)}B!==null&&t.update(B,l.ELEMENT_ARRAY_BUFFER),(V||f)&&(f=!1,function(U,te,ue,ce){if(n.isWebGL2===!1&&(U.isInstancedMesh||ce.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const we=ce.attributes,ve=ue.getAttributes(),Re=te.defaultAttributeValues;for(const Pe in ve){const De=ve[Pe];if(De.location>=0){let fe=we[Pe];if(fe===void 0&&(Pe==="instanceMatrix"&&U.instanceMatrix&&(fe=U.instanceMatrix),Pe==="instanceColor"&&U.instanceColor&&(fe=U.instanceColor)),fe!==void 0){const oe=fe.normalized,Se=fe.itemSize,Ce=t.get(fe);if(Ce===void 0)continue;const Te=Ce.buffer,ze=Ce.type,G=Ce.bytesPerElement;if(fe.isInterleavedBufferAttribute){const z=fe.data,le=z.stride,Z=fe.offset;if(z.isInstancedInterleavedBuffer){for(let H=0;H<De.locationSize;H++)w(De.location+H,z.meshPerAttribute);U.isInstancedMesh!==!0&&ce._maxInstanceCount===void 0&&(ce._maxInstanceCount=z.meshPerAttribute*z.count)}else for(let H=0;H<De.locationSize;H++)x(De.location+H);l.bindBuffer(l.ARRAY_BUFFER,Te);for(let H=0;H<De.locationSize;H++)_(De.location+H,Se/De.locationSize,ze,oe,le*G,(Z+Se/De.locationSize*H)*G)}else{if(fe.isInstancedBufferAttribute){for(let z=0;z<De.locationSize;z++)w(De.location+z,fe.meshPerAttribute);U.isInstancedMesh!==!0&&ce._maxInstanceCount===void 0&&(ce._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let z=0;z<De.locationSize;z++)x(De.location+z);l.bindBuffer(l.ARRAY_BUFFER,Te);for(let z=0;z<De.locationSize;z++)_(De.location+z,Se/De.locationSize,ze,oe,Se*G,Se/De.locationSize*z*G)}}else if(Re!==void 0){const oe=Re[Pe];if(oe!==void 0)switch(oe.length){case 2:l.vertexAttrib2fv(De.location,oe);break;case 3:l.vertexAttrib3fv(De.location,oe);break;case 4:l.vertexAttrib4fv(De.location,oe);break;default:l.vertexAttrib1fv(De.location,oe)}}}}T()}(P,C,F,W),B!==null&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,t.get(B).buffer))},reset:E,resetDefaultState:R,dispose:function(){E();for(const P in c){const C=c[P];for(const F in C){const W=C[F];for(const B in W)g(W[B].object),delete W[B];delete C[F]}delete c[P]}},releaseStatesOfGeometry:function(P){if(c[P.id]===void 0)return;const C=c[P.id];for(const F in C){const W=C[F];for(const B in W)g(W[B].object),delete W[B];delete C[F]}delete c[P.id]},releaseStatesOfProgram:function(P){for(const C in c){const F=c[C];if(F[P.id]===void 0)continue;const W=F[P.id];for(const B in W)g(W[B].object),delete W[B];delete F[P.id]}},initAttributes:S,enableAttribute:x,disableUnusedAttributes:T}}function vA(l,e,t,n){const i=n.isWebGL2;let s;this.setMode=function(a){s=a},this.render=function(a,c){l.drawArrays(s,a,c),t.update(c,s,1)},this.renderInstances=function(a,c,h){if(h===0)return;let d,f;if(i)d=l,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,a,c,h),t.update(c,s,h)}}function yA(l,e,t){let n;function i(R){if(R==="highp"){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";R="mediump"}return R==="mediump"&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext<"u"&&l instanceof WebGL2RenderingContext;let a=t.precision!==void 0?t.precision:"highp";const c=i(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const h=s||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,f=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),m=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=l.getParameter(l.MAX_TEXTURE_SIZE),y=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),S=l.getParameter(l.MAX_VERTEX_ATTRIBS),x=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),w=l.getParameter(l.MAX_VARYING_VECTORS),T=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),_=m>0,E=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:h,getMaxAnisotropy:function(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");n=l.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:m,maxTextureSize:g,maxCubemapSize:y,maxAttributes:S,maxVertexUniforms:x,maxVaryings:w,maxFragmentUniforms:T,vertexTextures:_,floatFragmentTextures:E,floatVertexTextures:_&&E,maxSamples:s?l.getParameter(l.MAX_SAMPLES):0}}function xA(l){const e=this;let t=null,n=0,i=!1,s=!1;const a=new us,c=new mn,h={value:null,needsUpdate:!1};function d(f,m,g,y){const S=f!==null?f.length:0;let x=null;if(S!==0){if(x=h.value,y!==!0||x===null){const w=g+4*S,T=m.matrixWorldInverse;c.getNormalMatrix(T),(x===null||x.length<w)&&(x=new Float32Array(w));for(let _=0,E=g;_!==S;++_,E+=4)a.copy(f[_]).applyMatrix4(T,c),a.normal.toArray(x,E),x[E+3]=a.constant}h.value=x,h.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,x}this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(f,m){const g=f.length!==0||m||n!==0||i;return i=m,n=f.length,g},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,m){t=d(f,m,0)},this.setState=function(f,m,g){const y=f.clippingPlanes,S=f.clipIntersection,x=f.clipShadows,w=l.get(f);if(!i||y===null||y.length===0||s&&!x)s?d(null):function(){h.value!==t&&(h.value=t,h.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const T=s?0:n,_=4*T;let E=w.clippingState||null;h.value=E,E=d(y,m,_,g);for(let R=0;R!==_;++R)E[R]=t[R];w.clippingState=E,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=T}}}function bA(l){let e=new WeakMap;function t(i,s){return s===Is?i.mapping=Ds:s===xc&&(i.mapping=Os),i}function n(i){const s=i.target;s.removeEventListener("dispose",n);const a=e.get(s);a!==void 0&&(e.delete(s),a.dispose())}return{get:function(i){if(i&&i.isTexture&&i.isRenderTargetTexture===!1){const s=i.mapping;if(s===Is||s===xc){if(e.has(i))return t(e.get(i).texture,i.mapping);{const a=i.image;if(a&&a.height>0){const c=new Dx(a.height/2);return c.fromEquirectangularTexture(l,i),e.set(i,c),i.addEventListener("dispose",n),t(c.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}class Hs extends el{constructor(e=-1,t=1,n=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,a=n+e,c=i+t,h=i-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=d*this.view.offsetX,a=s+d*this.view.width,c-=f*this.view.offsetY,h=c-f*this.view.height}this.projectionMatrix.makeOrthographic(s,a,c,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Ix=[.125,.215,.35,.446,.526,.582],kc=20,t0=new Hs,Nx=new Ie;let n0=null;const Ba=(1+Math.sqrt(5))/2,il=1/Ba,kx=[new O(1,1,1),new O(-1,1,1),new O(1,1,-1),new O(-1,1,-1),new O(0,Ba,il),new O(0,Ba,-il),new O(il,0,Ba),new O(-il,0,Ba),new O(Ba,il,0),new O(-Ba,il,0)];class i0{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){n0=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=zx(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Ux(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(n0),e.scissorTest=!1,Jh(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ds||e.mapping===Os?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),n0=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:at,minFilter:at,generateMipmaps:!1,type:yi,format:oi,encoding:ur,depthBuffer:!1},i=Fx(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Fx(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(a){const c=[],h=[],d=[];let f=a;const m=a-4+1+Ix.length;for(let g=0;g<m;g++){const y=Math.pow(2,f);h.push(y);let S=1/y;g>a-4?S=Ix[g-a+4-1]:g===0&&(S=0),d.push(S);const x=1/(y-2),w=-x,T=1+x,_=[w,w,T,w,T,T,w,w,T,T,w,T],E=6,R=6,P=3,C=2,F=1,W=new Float32Array(P*R*E),B=new Float32Array(C*R*E),V=new Float32Array(F*R*E);for(let te=0;te<E;te++){const ue=te%3*2/3-1,ce=te>2?0:-1,we=[ue,ce,0,ue+2/3,ce,0,ue+2/3,ce+1,0,ue,ce,0,ue+2/3,ce+1,0,ue,ce+1,0];W.set(we,P*R*te),B.set(_,C*R*te);const ve=[te,te,te,te,te,te];V.set(ve,F*R*te)}const U=new $e;U.setAttribute("position",new tt(W,P)),U.setAttribute("uv",new tt(B,C)),U.setAttribute("faceIndex",new tt(V,F)),c.push(U),f>4&&f--}return{lodPlanes:c,sizeLods:h,sigmas:d}}(s)),this._blurMaterial=function(a,c,h){const d=new Float32Array(kc),f=new O(0,1,0);return new St({name:"SphericalGaussianBlur",defines:{n:kc,CUBEUV_TEXEL_WIDTH:1/c,CUBEUV_TEXEL_HEIGHT:1/h,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:f}},vertexShader:r0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Be,depthTest:!1,depthWrite:!1})}(s,e,t)}return i}_compileMaterial(e){const t=new et(this._lodPlanes[0],e);this._renderer.compile(t,t0)}_sceneToCubeUV(e,t,n,i){const s=new Kt(90,1,t,n),a=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,f=h.toneMapping;h.getClearColor(Nx),h.toneMapping=Or,h.autoClear=!1;const m=new xi({name:"PMREM.Background",side:ye,depthWrite:!1,depthTest:!1}),g=new et(new cs,m);let y=!1;const S=e.background;S?S.isColor&&(m.color.copy(S),e.background=null,y=!0):(m.color.copy(Nx),y=!0);for(let x=0;x<6;x++){const w=x%3;w===0?(s.up.set(0,a[x],0),s.lookAt(c[x],0,0)):w===1?(s.up.set(0,0,a[x]),s.lookAt(0,c[x],0)):(s.up.set(0,a[x],0),s.lookAt(0,0,c[x]));const T=this._cubeSize;Jh(i,w*T,x>2?T:0,T,T),h.setRenderTarget(i),y&&h.render(g,s),h.render(e,s)}g.geometry.dispose(),g.material.dispose(),h.toneMapping=f,h.autoClear=d,e.background=S}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Ds||e.mapping===Os;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=zx()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Ux());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new et(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;Jh(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(a,t0)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=kx[(i-1)%kx.length];this._blur(e,i-1,i,s,a)}t.autoClear=n}_blur(e,t,n,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,i,"latitudinal",s),this._halfBlur(a,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,a,c){const h=this._renderer,d=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=new et(this._lodPlanes[i],d),m=d.uniforms,g=this._sizeLods[n]-1,y=isFinite(s)?Math.PI/(2*g):2*Math.PI/39,S=s/y,x=isFinite(s)?1+Math.floor(3*S):kc;x>kc&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to 20`);const w=[];let T=0;for(let R=0;R<kc;++R){const P=R/S,C=Math.exp(-P*P/2);w.push(C),R===0?T+=C:R<x&&(T+=2*C)}for(let R=0;R<w.length;R++)w[R]=w[R]/T;m.envMap.value=e.texture,m.samples.value=x,m.weights.value=w,m.latitudinal.value=a==="latitudinal",c&&(m.poleAxis.value=c);const{_lodMax:_}=this;m.dTheta.value=y,m.mipInt.value=_-n;const E=this._sizeLods[i];Jh(t,3*E*(i>_-4?i-_+4:0),4*(this._cubeSize-E),3*E,2*E),h.setRenderTarget(t),h.render(f,t0)}}function Fx(l,e,t){const n=new Lt(l,e,t);return n.texture.mapping=Fo,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Jh(l,e,t,n,i){l.viewport.set(e,t,n,i),l.scissor.set(e,t,n,i)}function Ux(){return new St({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:r0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Be,depthTest:!1,depthWrite:!1})}function zx(){return new St({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:r0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Be,depthTest:!1,depthWrite:!1})}function r0(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function SA(l){let e=new WeakMap,t=null;function n(i){const s=i.target;s.removeEventListener("dispose",n);const a=e.get(s);a!==void 0&&(e.delete(s),a.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping,a=s===Is||s===xc,c=s===Ds||s===Os;if(a||c){if(i.isRenderTargetTexture&&i.needsPMREMUpdate===!0){i.needsPMREMUpdate=!1;let h=e.get(i);return t===null&&(t=new i0(l)),h=a?t.fromEquirectangular(i,h):t.fromCubemap(i,h),e.set(i,h),h.texture}if(e.has(i))return e.get(i).texture;{const h=i.image;if(a&&h&&h.height>0||c&&h&&function(d){let f=0;const m=6;for(let g=0;g<m;g++)d[g]!==void 0&&f++;return f===m}(h)){t===null&&(t=new i0(l));const d=a?t.fromEquirectangular(i):t.fromCubemap(i);return e.set(i,d),i.addEventListener("dispose",n),d.texture}return null}}}return i},dispose:function(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}}}function wA(l){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=l.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function _A(l,e,t,n){const i={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const m in d.attributes)e.remove(d.attributes[m]);d.removeEventListener("dispose",a),delete i[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function c(h){const d=[],f=h.index,m=h.attributes.position;let g=0;if(f!==null){const x=f.array;g=f.version;for(let w=0,T=x.length;w<T;w+=3){const _=x[w+0],E=x[w+1],R=x[w+2];d.push(_,E,E,R,R,_)}}else{const x=m.array;g=m.version;for(let w=0,T=x.length/3-1;w<T;w+=3){const _=w+0,E=w+1,R=w+2;d.push(_,E,E,R,R,_)}}const y=new(gx(d)?Qm:Hh)(d,1);y.version=g;const S=s.get(h);S&&e.remove(S),s.set(h,y)}return{get:function(h,d){return i[d.id]===!0||(d.addEventListener("dispose",a),i[d.id]=!0,t.memory.geometries++),d},update:function(h){const d=h.attributes;for(const m in d)e.update(d[m],l.ARRAY_BUFFER);const f=h.morphAttributes;for(const m in f){const g=f[m];for(let y=0,S=g.length;y<S;y++)e.update(g[y],l.ARRAY_BUFFER)}},getWireframeAttribute:function(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&c(h)}else c(h);return s.get(h)}}}function MA(l,e,t,n){const i=n.isWebGL2;let s,a,c;this.setMode=function(h){s=h},this.setIndex=function(h){a=h.type,c=h.bytesPerElement},this.render=function(h,d){l.drawElements(s,d,a,h*c),t.update(d,s,1)},this.renderInstances=function(h,d,f){if(f===0)return;let m,g;if(i)m=l,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[g](s,d,a,h*c,f),t.update(d,s,f)}}function TA(l){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case l.TRIANGLES:e.triangles+=i*(t/3);break;case l.LINES:e.lines+=i*(t/2);break;case l.LINE_STRIP:e.lines+=i*(t-1);break;case l.LINE_LOOP:e.lines+=i*t;break;case l.POINTS:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function EA(l,e){return l[0]-e[0]}function AA(l,e){return Math.abs(e[1])-Math.abs(l[1])}function RA(l,e,t){const n={},i=new Float32Array(8),s=new WeakMap,a=new Ke,c=[];for(let h=0;h<8;h++)c[h]=[h,0];return{update:function(h,d,f){const m=h.morphTargetInfluences;if(e.isWebGL2===!0){const g=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,y=g!==void 0?g.length:0;let S=s.get(d);if(S===void 0||S.count!==y){S!==void 0&&S.texture.dispose();const T=d.morphAttributes.position!==void 0,_=d.morphAttributes.normal!==void 0,E=d.morphAttributes.color!==void 0,R=d.morphAttributes.position||[],P=d.morphAttributes.normal||[],C=d.morphAttributes.color||[];let F=0;T===!0&&(F=1),_===!0&&(F=2),E===!0&&(F=3);let W=d.attributes.position.count*F,B=1;W>e.maxTextureSize&&(B=Math.ceil(W/e.maxTextureSize),W=e.maxTextureSize);const V=new Float32Array(W*B*4*y),U=new Dh(V,W,B,y);U.type=Ci,U.needsUpdate=!0;const te=4*F;for(let ue=0;ue<y;ue++){const ce=R[ue],we=P[ue],ve=C[ue],Re=W*B*4*ue;for(let Pe=0;Pe<ce.count;Pe++){const De=Pe*te;T===!0&&(a.fromBufferAttribute(ce,Pe),V[Re+De+0]=a.x,V[Re+De+1]=a.y,V[Re+De+2]=a.z,V[Re+De+3]=0),_===!0&&(a.fromBufferAttribute(we,Pe),V[Re+De+4]=a.x,V[Re+De+5]=a.y,V[Re+De+6]=a.z,V[Re+De+7]=0),E===!0&&(a.fromBufferAttribute(ve,Pe),V[Re+De+8]=a.x,V[Re+De+9]=a.y,V[Re+De+10]=a.z,V[Re+De+11]=ve.itemSize===4?a.w:1)}}S={count:y,texture:U,size:new de(W,B)},s.set(d,S),d.addEventListener("dispose",function ue(){U.dispose(),s.delete(d),d.removeEventListener("dispose",ue)})}let x=0;for(let T=0;T<m.length;T++)x+=m[T];const w=d.morphTargetsRelative?1:1-x;f.getUniforms().setValue(l,"morphTargetBaseInfluence",w),f.getUniforms().setValue(l,"morphTargetInfluences",m),f.getUniforms().setValue(l,"morphTargetsTexture",S.texture,t),f.getUniforms().setValue(l,"morphTargetsTextureSize",S.size)}else{const g=m===void 0?0:m.length;let y=n[d.id];if(y===void 0||y.length!==g){y=[];for(let _=0;_<g;_++)y[_]=[_,0];n[d.id]=y}for(let _=0;_<g;_++){const E=y[_];E[0]=_,E[1]=m[_]}y.sort(AA);for(let _=0;_<8;_++)_<g&&y[_][1]?(c[_][0]=y[_][0],c[_][1]=y[_][1]):(c[_][0]=Number.MAX_SAFE_INTEGER,c[_][1]=0);c.sort(EA);const S=d.morphAttributes.position,x=d.morphAttributes.normal;let w=0;for(let _=0;_<8;_++){const E=c[_],R=E[0],P=E[1];R!==Number.MAX_SAFE_INTEGER&&P?(S&&d.getAttribute("morphTarget"+_)!==S[R]&&d.setAttribute("morphTarget"+_,S[R]),x&&d.getAttribute("morphNormal"+_)!==x[R]&&d.setAttribute("morphNormal"+_,x[R]),i[_]=P,w+=P):(S&&d.hasAttribute("morphTarget"+_)===!0&&d.deleteAttribute("morphTarget"+_),x&&d.hasAttribute("morphNormal"+_)===!0&&d.deleteAttribute("morphNormal"+_),i[_]=0)}const T=d.morphTargetsRelative?1:1-w;f.getUniforms().setValue(l,"morphTargetBaseInfluence",T),f.getUniforms().setValue(l,"morphTargetInfluences",i)}}}}function LA(l,e,t,n){let i=new WeakMap;function s(a){const c=a.target;c.removeEventListener("dispose",s),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:function(a){const c=n.render.frame,h=a.geometry,d=e.get(a,h);return i.get(d)!==c&&(e.update(d),i.set(d,c)),a.isInstancedMesh&&(a.hasEventListener("dispose",s)===!1&&a.addEventListener("dispose",s),t.update(a.instanceMatrix,l.ARRAY_BUFFER),a.instanceColor!==null&&t.update(a.instanceColor,l.ARRAY_BUFFER)),d},dispose:function(){i=new WeakMap}}}const Bx=new zt,jx=new Dh,Hx=new Fm,Gx=new Ic,Vx=[],Wx=[],Xx=new Float32Array(16),qx=new Float32Array(9),Yx=new Float32Array(4);function rl(l,e,t){const n=l[0];if(n<=0||n>0)return l;const i=e*t;let s=Vx[i];if(s===void 0&&(s=new Float32Array(i),Vx[i]=s),e!==0){n.toArray(s,0);for(let a=1,c=0;a!==e;++a)c+=t,l[a].toArray(s,c)}return s}function wn(l,e){if(l.length!==e.length)return!1;for(let t=0,n=l.length;t<n;t++)if(l[t]!==e[t])return!1;return!0}function _n(l,e){for(let t=0,n=e.length;t<n;t++)l[t]=e[t]}function $h(l,e){let t=Wx[e];t===void 0&&(t=new Int32Array(e),Wx[e]=t);for(let n=0;n!==e;++n)t[n]=l.allocateTextureUnit();return t}function PA(l,e){const t=this.cache;t[0]!==e&&(l.uniform1f(this.addr,e),t[0]=e)}function CA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(l.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wn(t,e))return;l.uniform2fv(this.addr,e),_n(t,e)}}function DA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(l.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)t[0]===e.r&&t[1]===e.g&&t[2]===e.b||(l.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(wn(t,e))return;l.uniform3fv(this.addr,e),_n(t,e)}}function OA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(l.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wn(t,e))return;l.uniform4fv(this.addr,e),_n(t,e)}}function IA(l,e){const t=this.cache,n=e.elements;if(n===void 0){if(wn(t,e))return;l.uniformMatrix2fv(this.addr,!1,e),_n(t,e)}else{if(wn(t,n))return;Yx.set(n),l.uniformMatrix2fv(this.addr,!1,Yx),_n(t,n)}}function NA(l,e){const t=this.cache,n=e.elements;if(n===void 0){if(wn(t,e))return;l.uniformMatrix3fv(this.addr,!1,e),_n(t,e)}else{if(wn(t,n))return;qx.set(n),l.uniformMatrix3fv(this.addr,!1,qx),_n(t,n)}}function kA(l,e){const t=this.cache,n=e.elements;if(n===void 0){if(wn(t,e))return;l.uniformMatrix4fv(this.addr,!1,e),_n(t,e)}else{if(wn(t,n))return;Xx.set(n),l.uniformMatrix4fv(this.addr,!1,Xx),_n(t,n)}}function FA(l,e){const t=this.cache;t[0]!==e&&(l.uniform1i(this.addr,e),t[0]=e)}function UA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(l.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wn(t,e))return;l.uniform2iv(this.addr,e),_n(t,e)}}function zA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(l.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(wn(t,e))return;l.uniform3iv(this.addr,e),_n(t,e)}}function BA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(l.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wn(t,e))return;l.uniform4iv(this.addr,e),_n(t,e)}}function jA(l,e){const t=this.cache;t[0]!==e&&(l.uniform1ui(this.addr,e),t[0]=e)}function HA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(l.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wn(t,e))return;l.uniform2uiv(this.addr,e),_n(t,e)}}function GA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(l.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(wn(t,e))return;l.uniform3uiv(this.addr,e),_n(t,e)}}function VA(l,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(l.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wn(t,e))return;l.uniform4uiv(this.addr,e),_n(t,e)}}function WA(l,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(l.uniform1i(this.addr,i),n[0]=i),t.setTexture2D(e||Bx,i)}function XA(l,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(l.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||Hx,i)}function qA(l,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(l.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||Gx,i)}function YA(l,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(l.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||jx,i)}function QA(l,e){l.uniform1fv(this.addr,e)}function ZA(l,e){const t=rl(e,this.size,2);l.uniform2fv(this.addr,t)}function KA(l,e){const t=rl(e,this.size,3);l.uniform3fv(this.addr,t)}function JA(l,e){const t=rl(e,this.size,4);l.uniform4fv(this.addr,t)}function $A(l,e){const t=rl(e,this.size,4);l.uniformMatrix2fv(this.addr,!1,t)}function eR(l,e){const t=rl(e,this.size,9);l.uniformMatrix3fv(this.addr,!1,t)}function tR(l,e){const t=rl(e,this.size,16);l.uniformMatrix4fv(this.addr,!1,t)}function nR(l,e){l.uniform1iv(this.addr,e)}function iR(l,e){l.uniform2iv(this.addr,e)}function rR(l,e){l.uniform3iv(this.addr,e)}function sR(l,e){l.uniform4iv(this.addr,e)}function aR(l,e){l.uniform1uiv(this.addr,e)}function oR(l,e){l.uniform2uiv(this.addr,e)}function lR(l,e){l.uniform3uiv(this.addr,e)}function cR(l,e){l.uniform4uiv(this.addr,e)}function uR(l,e,t){const n=this.cache,i=e.length,s=$h(t,i);wn(n,s)||(l.uniform1iv(this.addr,s),_n(n,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||Bx,s[a])}function hR(l,e,t){const n=this.cache,i=e.length,s=$h(t,i);wn(n,s)||(l.uniform1iv(this.addr,s),_n(n,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||Hx,s[a])}function dR(l,e,t){const n=this.cache,i=e.length,s=$h(t,i);wn(n,s)||(l.uniform1iv(this.addr,s),_n(n,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||Gx,s[a])}function pR(l,e,t){const n=this.cache,i=e.length,s=$h(t,i);wn(n,s)||(l.uniform1iv(this.addr,s),_n(n,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||jx,s[a])}class fR{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(i){switch(i){case 5126:return PA;case 35664:return CA;case 35665:return DA;case 35666:return OA;case 35674:return IA;case 35675:return NA;case 35676:return kA;case 5124:case 35670:return FA;case 35667:case 35671:return UA;case 35668:case 35672:return zA;case 35669:case 35673:return BA;case 5125:return jA;case 36294:return HA;case 36295:return GA;case 36296:return VA;case 35678:case 36198:case 36298:case 36306:case 35682:return WA;case 35679:case 36299:case 36307:return XA;case 35680:case 36300:case 36308:case 36293:return qA;case 36289:case 36303:case 36311:case 36292:return YA}}(t.type)}}class mR{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(i){switch(i){case 5126:return QA;case 35664:return ZA;case 35665:return KA;case 35666:return JA;case 35674:return $A;case 35675:return eR;case 35676:return tR;case 5124:case 35670:return nR;case 35667:case 35671:return iR;case 35668:case 35672:return rR;case 35669:case 35673:return sR;case 5125:return aR;case 36294:return oR;case 36295:return lR;case 36296:return cR;case 35678:case 36198:case 36298:case 36306:case 35682:return uR;case 35679:case 36299:case 36307:return hR;case 35680:case 36300:case 36308:case 36293:return dR;case 36289:case 36303:case 36311:case 36292:return pR}}(t.type)}}class gR{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const c=i[s];c.setValue(e,t[c.id],n)}}}const s0=/(\w+)(\])?(\[|\.)?/g;function Qx(l,e){l.seq.push(e),l.map[e.id]=e}function vR(l,e,t){const n=l.name,i=n.length;for(s0.lastIndex=0;;){const s=s0.exec(n),a=s0.lastIndex;let c=s[1];const h=s[2]==="]",d=s[3];if(h&&(c|=0),d===void 0||d==="["&&a+2===i){Qx(t,d===void 0?new fR(c,l,e):new mR(c,l,e));break}{let f=t.map[c];f===void 0&&(f=new gR(c),Qx(t,f)),t=f}}}class ed{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const s=e.getActiveUniform(t,i);vR(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,i){const s=this.map[t];s!==void 0&&s.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let s=0,a=t.length;s!==a;++s){const c=t[s],h=n[c.id];h.needsUpdate!==!1&&c.setValue(e,h.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&n.push(a)}return n}}function Zx(l,e,t){const n=l.createShader(e);return l.shaderSource(n,t),l.compileShader(n),n}let yR=0;function Kx(l,e,t){const n=l.getShaderParameter(e,l.COMPILE_STATUS),i=l.getShaderInfoLog(e).trim();if(n&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+function(c,h){const d=c.split(`
`),f=[],m=Math.max(h-6,0),g=Math.min(h+6,d.length);for(let y=m;y<g;y++){const S=y+1;f.push(`${S===h?">":" "} ${S}: ${d[y]}`)}return f.join(`
`)}(l.getShaderSource(e),a)}return i}function xR(l,e){const t=function(n){switch(n){case ur:return["Linear","( value )"];case mt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+l+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function bR(l,e){let t;switch(e){case jy:t="Linear";break;case Hy:t="Reinhard";break;case Gy:t="OptimizedCineon";break;case em:t="ACESFilmic";break;case Vy:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+l+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Fc(l){return l!==""}function Jx(l,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return l.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function $x(l,e){return l.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const SR=/^[ \t]*#include +<([\w\d./]+)>/gm;function a0(l){return l.replace(SR,wR)}function wR(l,e){const t=dt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return a0(t)}const _R=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function eb(l){return l.replace(_R,MR)}function MR(l,e,t,n){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function tb(l){let e="precision "+l.precision+` float;
precision `+l.precision+" int;";return l.precision==="highp"?e+=`
#define HIGH_PRECISION`:l.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:l.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function TR(l,e,t,n){const i=l.getContext(),s=t.defines;let a=t.vertexShader,c=t.fragmentShader;const h=function(B){let V="SHADOWMAP_TYPE_BASIC";return B.shadowMapType===ne?V="SHADOWMAP_TYPE_PCF":B.shadowMapType===D?V="SHADOWMAP_TYPE_PCF_SOFT":B.shadowMapType===Q&&(V="SHADOWMAP_TYPE_VSM"),V}(t),d=function(B){let V="ENVMAP_TYPE_CUBE";if(B.envMap)switch(B.envMapMode){case Ds:case Os:V="ENVMAP_TYPE_CUBE";break;case Fo:V="ENVMAP_TYPE_CUBE_UV"}return V}(t),f=function(B){let V="ENVMAP_MODE_REFLECTION";return B.envMap&&B.envMapMode===Os&&(V="ENVMAP_MODE_REFRACTION"),V}(t),m=function(B){let V="ENVMAP_BLENDING_NONE";if(B.envMap)switch(B.combine){case yc:V="ENVMAP_BLENDING_MULTIPLY";break;case zy:V="ENVMAP_BLENDING_MIX";break;case By:V="ENVMAP_BLENDING_ADD"}return V}(t),g=function(B){const V=B.envMapCubeUVHeight;if(V===null)return null;const U=Math.log2(V)-2,te=1/V;return{texelWidth:1/(3*Math.max(Math.pow(2,U),112)),texelHeight:te,maxMip:U}}(t),y=t.isWebGL2?"":function(B){return[B.extensionDerivatives||B.envMapCubeUVHeight||B.bumpMap||B.tangentSpaceNormalMap||B.clearcoatNormalMap||B.flatShading||B.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(B.extensionFragDepth||B.logarithmicDepthBuffer)&&B.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",B.extensionDrawBuffers&&B.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(B.extensionShaderTextureLOD||B.envMap||B.transmission)&&B.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Fc).join(`
`)}(t),S=function(B){const V=[];for(const U in B){const te=B[U];te!==!1&&V.push("#define "+U+" "+te)}return V.join(`
`)}(s),x=i.createProgram();let w,T,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=[S].filter(Fc).join(`
`),w.length>0&&(w+=`
`),T=[y,S].filter(Fc).join(`
`),T.length>0&&(T+=`
`)):(w=[tb(t),"#define SHADER_NAME "+t.shaderName,S,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Fc).join(`
`),T=[y,tb(t),"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",t.envMap?"#define "+m:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Or?"#define TONE_MAPPING":"",t.toneMapping!==Or?dt.tonemapping_pars_fragment:"",t.toneMapping!==Or?bR("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",dt.encodings_pars_fragment,xR("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Fc).join(`
`)),a=a0(a),a=Jx(a,t),a=$x(a,t),c=a0(c),c=Jx(c,t),c=$x(c,t),a=eb(a),c=eb(c),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,w=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,T=["#define varying in",t.glslVersion===Lm?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Lm?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const E=_+w+a,R=_+T+c,P=Zx(i,i.VERTEX_SHADER,E),C=Zx(i,i.FRAGMENT_SHADER,R);if(i.attachShader(x,P),i.attachShader(x,C),t.index0AttributeName!==void 0?i.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(x,0,"position"),i.linkProgram(x),l.debug.checkShaderErrors){const B=i.getProgramInfoLog(x).trim(),V=i.getShaderInfoLog(P).trim(),U=i.getShaderInfoLog(C).trim();let te=!0,ue=!0;if(i.getProgramParameter(x,i.LINK_STATUS)===!1){te=!1;const ce=Kx(i,P,"vertex"),we=Kx(i,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(x,i.VALIDATE_STATUS)+`

Program Info Log: `+B+`
`+ce+`
`+we)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):V!==""&&U!==""||(ue=!1);ue&&(this.diagnostics={runnable:te,programLog:B,vertexShader:{log:V,prefix:w},fragmentShader:{log:U,prefix:T}})}let F,W;return i.deleteShader(P),i.deleteShader(C),this.getUniforms=function(){return F===void 0&&(F=new ed(i,x)),F},this.getAttributes=function(){return W===void 0&&(W=function(B,V){const U={},te=B.getProgramParameter(V,B.ACTIVE_ATTRIBUTES);for(let ue=0;ue<te;ue++){const ce=B.getActiveAttrib(V,ue),we=ce.name;let ve=1;ce.type===B.FLOAT_MAT2&&(ve=2),ce.type===B.FLOAT_MAT3&&(ve=3),ce.type===B.FLOAT_MAT4&&(ve=4),U[we]={type:ce.type,location:B.getAttribLocation(V,we),locationSize:ve}}return U}(i,x)),W},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(x),this.program=void 0},this.name=t.shaderName,this.id=yR++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=P,this.fragmentShader=C,this}let ER=0;class AR{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new RR(e),t.set(e,n)),n}}class RR{constructor(e){this.id=ER++,this.code=e,this.usedTimes=0}}function LR(l,e,t,n,i,s,a){const c=new Uh,h=new AR,d=[],f=i.isWebGL2,m=i.logarithmicDepthBuffer,g=i.vertexTextures;let y=i.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(x,w,T,_,E){const R=_.fog,P=E.geometry,C=x.isMeshStandardMaterial?_.environment:null,F=(x.isMeshStandardMaterial?t:e).get(x.envMap||C),W=F&&F.mapping===Fo?F.image.height:null,B=S[x.type];x.precision!==null&&(y=i.getMaxPrecision(x.precision),y!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",y,"instead."));const V=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,U=V!==void 0?V.length:0;let te,ue,ce,we,ve=0;if(P.morphAttributes.position!==void 0&&(ve=1),P.morphAttributes.normal!==void 0&&(ve=2),P.morphAttributes.color!==void 0&&(ve=3),B){const oe=mr[B];te=oe.vertexShader,ue=oe.fragmentShader}else te=x.vertexShader,ue=x.fragmentShader,h.update(x),ce=h.getVertexShaderID(x),we=h.getFragmentShaderID(x);const Re=l.getRenderTarget(),Pe=x.alphaTest>0,De=x.clearcoat>0,fe=x.iridescence>0;return{isWebGL2:f,shaderID:B,shaderName:x.type,vertexShader:te,fragmentShader:ue,defines:x.defines,customVertexShaderID:ce,customFragmentShaderID:we,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:y,instancing:E.isInstancedMesh===!0,instancingColor:E.isInstancedMesh===!0&&E.instanceColor!==null,supportsVertexTextures:g,outputEncoding:Re===null?l.outputEncoding:Re.isXRRenderTarget===!0?Re.texture.encoding:ur,map:!!x.map,matcap:!!x.matcap,envMap:!!F,envMapMode:F&&F.mapping,envMapCubeUVHeight:W,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===cx,tangentSpaceNormalMap:x.normalMapType===ks,decodeVideoTexture:!!x.map&&x.map.isVideoTexture===!0&&x.map.encoding===mt,clearcoat:De,clearcoatMap:De&&!!x.clearcoatMap,clearcoatRoughnessMap:De&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:De&&!!x.clearcoatNormalMap,iridescence:fe,iridescenceMap:fe&&!!x.iridescenceMap,iridescenceThicknessMap:fe&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:x.transparent===!1&&x.blending===ot,alphaMap:!!x.alphaMap,alphaTest:Pe,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!P.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!P.attributes.color&&P.attributes.color.itemSize===4,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!R,useFog:x.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:m,skinning:E.isSkinnedMesh===!0,morphTargets:P.morphAttributes.position!==void 0,morphNormals:P.morphAttributes.normal!==void 0,morphColors:P.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:ve,numDirLights:w.directional.length,numPointLights:w.point.length,numSpotLights:w.spot.length,numSpotLightMaps:w.spotLightMap.length,numRectAreaLights:w.rectArea.length,numHemiLights:w.hemi.length,numDirLightShadows:w.directionalShadowMap.length,numPointLightShadows:w.pointShadowMap.length,numSpotLightShadows:w.spotShadowMap.length,numSpotLightShadowsWithMaps:w.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:x.dithering,shadowMapEnabled:l.shadowMap.enabled&&T.length>0,shadowMapType:l.shadowMap.type,toneMapping:x.toneMapped?l.toneMapping:Or,useLegacyLights:l.useLegacyLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===Me,flipSided:x.side===ye,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:f||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:f||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:f||n.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function(x){const w=[];if(x.shaderID?w.push(x.shaderID):(w.push(x.customVertexShaderID),w.push(x.customFragmentShaderID)),x.defines!==void 0)for(const T in x.defines)w.push(T),w.push(x.defines[T]);return x.isRawShaderMaterial===!1&&(function(T,_){T.push(_.precision),T.push(_.outputEncoding),T.push(_.envMapMode),T.push(_.envMapCubeUVHeight),T.push(_.combine),T.push(_.vertexUvs),T.push(_.fogExp2),T.push(_.sizeAttenuation),T.push(_.morphTargetsCount),T.push(_.morphAttributeCount),T.push(_.numDirLights),T.push(_.numPointLights),T.push(_.numSpotLights),T.push(_.numSpotLightMaps),T.push(_.numHemiLights),T.push(_.numRectAreaLights),T.push(_.numDirLightShadows),T.push(_.numPointLightShadows),T.push(_.numSpotLightShadows),T.push(_.numSpotLightShadowsWithMaps),T.push(_.shadowMapType),T.push(_.toneMapping),T.push(_.numClippingPlanes),T.push(_.numClipIntersection),T.push(_.depthPacking)}(w,x),function(T,_){c.disableAll(),_.isWebGL2&&c.enable(0),_.supportsVertexTextures&&c.enable(1),_.instancing&&c.enable(2),_.instancingColor&&c.enable(3),_.map&&c.enable(4),_.matcap&&c.enable(5),_.envMap&&c.enable(6),_.lightMap&&c.enable(7),_.aoMap&&c.enable(8),_.emissiveMap&&c.enable(9),_.bumpMap&&c.enable(10),_.normalMap&&c.enable(11),_.objectSpaceNormalMap&&c.enable(12),_.tangentSpaceNormalMap&&c.enable(13),_.clearcoat&&c.enable(14),_.clearcoatMap&&c.enable(15),_.clearcoatRoughnessMap&&c.enable(16),_.clearcoatNormalMap&&c.enable(17),_.iridescence&&c.enable(18),_.iridescenceMap&&c.enable(19),_.iridescenceThicknessMap&&c.enable(20),_.displacementMap&&c.enable(21),_.specularMap&&c.enable(22),_.roughnessMap&&c.enable(23),_.metalnessMap&&c.enable(24),_.gradientMap&&c.enable(25),_.alphaMap&&c.enable(26),_.alphaTest&&c.enable(27),_.vertexColors&&c.enable(28),_.vertexAlphas&&c.enable(29),_.vertexUvs&&c.enable(30),_.vertexTangents&&c.enable(31),_.uvsVertexOnly&&c.enable(32),T.push(c.mask),c.disableAll(),_.fog&&c.enable(0),_.useFog&&c.enable(1),_.flatShading&&c.enable(2),_.logarithmicDepthBuffer&&c.enable(3),_.skinning&&c.enable(4),_.morphTargets&&c.enable(5),_.morphNormals&&c.enable(6),_.morphColors&&c.enable(7),_.premultipliedAlpha&&c.enable(8),_.shadowMapEnabled&&c.enable(9),_.useLegacyLights&&c.enable(10),_.doubleSided&&c.enable(11),_.flipSided&&c.enable(12),_.useDepthPacking&&c.enable(13),_.dithering&&c.enable(14),_.specularIntensityMap&&c.enable(15),_.specularColorMap&&c.enable(16),_.transmission&&c.enable(17),_.transmissionMap&&c.enable(18),_.thicknessMap&&c.enable(19),_.sheen&&c.enable(20),_.sheenColorMap&&c.enable(21),_.sheenRoughnessMap&&c.enable(22),_.decodeVideoTexture&&c.enable(23),_.opaque&&c.enable(24),T.push(c.mask)}(w,x),w.push(l.outputEncoding)),w.push(x.customProgramCacheKey),w.join()},getUniforms:function(x){const w=S[x.type];let T;if(w){const _=mr[w];T=$m.clone(_.uniforms)}else T=x.uniforms;return T},acquireProgram:function(x,w){let T;for(let _=0,E=d.length;_<E;_++){const R=d[_];if(R.cacheKey===w){T=R,++T.usedTimes;break}}return T===void 0&&(T=new TR(l,w,x,s),d.push(T)),T},releaseProgram:function(x){if(--x.usedTimes==0){const w=d.indexOf(x);d[w]=d[d.length-1],d.pop(),x.destroy()}},releaseShaderCache:function(x){h.remove(x)},programs:d,dispose:function(){h.dispose()}}}function PR(){let l=new WeakMap;return{get:function(e){let t=l.get(e);return t===void 0&&(t={},l.set(e,t)),t},remove:function(e){l.delete(e)},update:function(e,t,n){l.get(e)[t]=n},dispose:function(){l=new WeakMap}}}function CR(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.material.id!==e.material.id?l.material.id-e.material.id:l.z!==e.z?l.z-e.z:l.id-e.id}function nb(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.z!==e.z?e.z-l.z:l.id-e.id}function ib(){const l=[];let e=0;const t=[],n=[],i=[];function s(a,c,h,d,f,m){let g=l[e];return g===void 0?(g={id:a.id,object:a,geometry:c,material:h,groupOrder:d,renderOrder:a.renderOrder,z:f,group:m},l[e]=g):(g.id=a.id,g.object=a,g.geometry=c,g.material=h,g.groupOrder=d,g.renderOrder=a.renderOrder,g.z=f,g.group=m),e++,g}return{opaque:t,transmissive:n,transparent:i,init:function(){e=0,t.length=0,n.length=0,i.length=0},push:function(a,c,h,d,f,m){const g=s(a,c,h,d,f,m);h.transmission>0?n.push(g):h.transparent===!0?i.push(g):t.push(g)},unshift:function(a,c,h,d,f,m){const g=s(a,c,h,d,f,m);h.transmission>0?n.unshift(g):h.transparent===!0?i.unshift(g):t.unshift(g)},finish:function(){for(let a=e,c=l.length;a<c;a++){const h=l[a];if(h.id===null)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}},sort:function(a,c){t.length>1&&t.sort(a||CR),n.length>1&&n.sort(c||nb),i.length>1&&i.sort(c||nb)}}}function DR(){let l=new WeakMap;return{get:function(e,t){const n=l.get(e);let i;return n===void 0?(i=new ib,l.set(e,[i])):t>=n.length?(i=new ib,n.push(i)):i=n[t],i},dispose:function(){l=new WeakMap}}}function OR(){const l={};return{get:function(e){if(l[e.id]!==void 0)return l[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new O,color:new Ie};break;case"SpotLight":t={position:new O,direction:new O,color:new Ie,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new O,color:new Ie,distance:0,decay:0};break;case"HemisphereLight":t={direction:new O,skyColor:new Ie,groundColor:new Ie};break;case"RectAreaLight":t={color:new Ie,position:new O,halfWidth:new O,halfHeight:new O}}return l[e.id]=t,t}}}let IR=0;function NR(l,e){return(e.castShadow?2:0)-(l.castShadow?2:0)+(e.map?1:0)-(l.map?1:0)}function kR(l,e){const t=new OR,n=function(){const h={};return{get:function(d){if(h[d.id]!==void 0)return h[d.id];let f;switch(d.type){case"DirectionalLight":case"SpotLight":f={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new de};break;case"PointLight":f={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new de,shadowCameraNear:1,shadowCameraFar:1e3}}return h[d.id]=f,f}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)i.probe.push(new O);const s=new O,a=new Ne,c=new Ne;return{setup:function(h,d){let f=0,m=0,g=0;for(let B=0;B<9;B++)i.probe[B].set(0,0,0);let y=0,S=0,x=0,w=0,T=0,_=0,E=0,R=0,P=0,C=0;h.sort(NR);const F=d===!0?Math.PI:1;for(let B=0,V=h.length;B<V;B++){const U=h[B],te=U.color,ue=U.intensity,ce=U.distance,we=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)f+=te.r*ue*F,m+=te.g*ue*F,g+=te.b*ue*F;else if(U.isLightProbe)for(let ve=0;ve<9;ve++)i.probe[ve].addScaledVector(U.sh.coefficients[ve],ue);else if(U.isDirectionalLight){const ve=t.get(U);if(ve.color.copy(U.color).multiplyScalar(U.intensity*F),U.castShadow){const Re=U.shadow,Pe=n.get(U);Pe.shadowBias=Re.bias,Pe.shadowNormalBias=Re.normalBias,Pe.shadowRadius=Re.radius,Pe.shadowMapSize=Re.mapSize,i.directionalShadow[y]=Pe,i.directionalShadowMap[y]=we,i.directionalShadowMatrix[y]=U.shadow.matrix,_++}i.directional[y]=ve,y++}else if(U.isSpotLight){const ve=t.get(U);ve.position.setFromMatrixPosition(U.matrixWorld),ve.color.copy(te).multiplyScalar(ue*F),ve.distance=ce,ve.coneCos=Math.cos(U.angle),ve.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),ve.decay=U.decay,i.spot[x]=ve;const Re=U.shadow;if(U.map&&(i.spotLightMap[P]=U.map,P++,Re.updateMatrices(U),U.castShadow&&C++),i.spotLightMatrix[x]=Re.matrix,U.castShadow){const Pe=n.get(U);Pe.shadowBias=Re.bias,Pe.shadowNormalBias=Re.normalBias,Pe.shadowRadius=Re.radius,Pe.shadowMapSize=Re.mapSize,i.spotShadow[x]=Pe,i.spotShadowMap[x]=we,R++}x++}else if(U.isRectAreaLight){const ve=t.get(U);ve.color.copy(te).multiplyScalar(ue),ve.halfWidth.set(.5*U.width,0,0),ve.halfHeight.set(0,.5*U.height,0),i.rectArea[w]=ve,w++}else if(U.isPointLight){const ve=t.get(U);if(ve.color.copy(U.color).multiplyScalar(U.intensity*F),ve.distance=U.distance,ve.decay=U.decay,U.castShadow){const Re=U.shadow,Pe=n.get(U);Pe.shadowBias=Re.bias,Pe.shadowNormalBias=Re.normalBias,Pe.shadowRadius=Re.radius,Pe.shadowMapSize=Re.mapSize,Pe.shadowCameraNear=Re.camera.near,Pe.shadowCameraFar=Re.camera.far,i.pointShadow[S]=Pe,i.pointShadowMap[S]=we,i.pointShadowMatrix[S]=U.shadow.matrix,E++}i.point[S]=ve,S++}else if(U.isHemisphereLight){const ve=t.get(U);ve.skyColor.copy(U.color).multiplyScalar(ue*F),ve.groundColor.copy(U.groundColor).multiplyScalar(ue*F),i.hemi[T]=ve,T++}}w>0&&(e.isWebGL2||l.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Ve.LTC_FLOAT_1,i.rectAreaLTC2=Ve.LTC_FLOAT_2):l.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Ve.LTC_HALF_1,i.rectAreaLTC2=Ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=f,i.ambient[1]=m,i.ambient[2]=g;const W=i.hash;W.directionalLength===y&&W.pointLength===S&&W.spotLength===x&&W.rectAreaLength===w&&W.hemiLength===T&&W.numDirectionalShadows===_&&W.numPointShadows===E&&W.numSpotShadows===R&&W.numSpotMaps===P||(i.directional.length=y,i.spot.length=x,i.rectArea.length=w,i.point.length=S,i.hemi.length=T,i.directionalShadow.length=_,i.directionalShadowMap.length=_,i.pointShadow.length=E,i.pointShadowMap.length=E,i.spotShadow.length=R,i.spotShadowMap.length=R,i.directionalShadowMatrix.length=_,i.pointShadowMatrix.length=E,i.spotLightMatrix.length=R+P-C,i.spotLightMap.length=P,i.numSpotLightShadowsWithMaps=C,W.directionalLength=y,W.pointLength=S,W.spotLength=x,W.rectAreaLength=w,W.hemiLength=T,W.numDirectionalShadows=_,W.numPointShadows=E,W.numSpotShadows=R,W.numSpotMaps=P,i.version=IR++)},setupView:function(h,d){let f=0,m=0,g=0,y=0,S=0;const x=d.matrixWorldInverse;for(let w=0,T=h.length;w<T;w++){const _=h[w];if(_.isDirectionalLight){const E=i.directional[f];E.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(x),f++}else if(_.isSpotLight){const E=i.spot[g];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(x),E.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(x),g++}else if(_.isRectAreaLight){const E=i.rectArea[y];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(x),c.identity(),a.copy(_.matrixWorld),a.premultiply(x),c.extractRotation(a),E.halfWidth.set(.5*_.width,0,0),E.halfHeight.set(0,.5*_.height,0),E.halfWidth.applyMatrix4(c),E.halfHeight.applyMatrix4(c),y++}else if(_.isPointLight){const E=i.point[m];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(x),m++}else if(_.isHemisphereLight){const E=i.hemi[S];E.direction.setFromMatrixPosition(_.matrixWorld),E.direction.transformDirection(x),S++}}},state:i}}function rb(l,e){const t=new kR(l,e),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:function(s){t.setup(n,s)},setupLightsView:function(s){t.setupView(n,s)},pushLight:function(s){n.push(s)},pushShadow:function(s){i.push(s)}}}function FR(l,e){let t=new WeakMap;return{get:function(n,i=0){const s=t.get(n);let a;return s===void 0?(a=new rb(l,e),t.set(n,[a])):i>=s.length?(a=new rb(l,e),s.push(a)):a=s[i],a},dispose:function(){t=new WeakMap}}}class td extends un{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hr,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class o0 extends un{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new O,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const UR=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,zR=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function BR(l,e,t){let n=new Nc;const i=new de,s=new de,a=new Ke,c=new td({depthPacking:Lh}),h=new o0,d={},f=t.maxTextureSize,m={[se]:ye,[ye]:se,[Me]:Me},g=new St({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new de},radius:{value:4}},vertexShader:UR,fragmentShader:zR}),y=g.clone();y.defines.HORIZONTAL_PASS=1;const S=new $e;S.setAttribute("position",new tt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new et(S,g),w=this;function T(R,P){const C=e.update(x);g.defines.VSM_SAMPLES!==R.blurSamples&&(g.defines.VSM_SAMPLES=R.blurSamples,y.defines.VSM_SAMPLES=R.blurSamples,g.needsUpdate=!0,y.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Lt(i.x,i.y)),g.uniforms.shadow_pass.value=R.map.texture,g.uniforms.resolution.value=R.mapSize,g.uniforms.radius.value=R.radius,l.setRenderTarget(R.mapPass),l.clear(),l.renderBufferDirect(P,null,C,g,x,null),y.uniforms.shadow_pass.value=R.mapPass.texture,y.uniforms.resolution.value=R.mapSize,y.uniforms.radius.value=R.radius,l.setRenderTarget(R.map),l.clear(),l.renderBufferDirect(P,null,C,y,x,null)}function _(R,P,C,F,W,B){let V=null;const U=C.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(U!==void 0)V=U;else if(V=C.isPointLight===!0?h:c,l.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){const te=V.uuid,ue=P.uuid;let ce=d[te];ce===void 0&&(ce={},d[te]=ce);let we=ce[ue];we===void 0&&(we=V.clone(),ce[ue]=we),V=we}return V.visible=P.visible,V.wireframe=P.wireframe,V.side=B===Q?P.shadowSide!==null?P.shadowSide:P.side:P.shadowSide!==null?P.shadowSide:m[P.side],V.alphaMap=P.alphaMap,V.alphaTest=P.alphaTest,V.map=P.map,V.clipShadows=P.clipShadows,V.clippingPlanes=P.clippingPlanes,V.clipIntersection=P.clipIntersection,V.displacementMap=P.displacementMap,V.displacementScale=P.displacementScale,V.displacementBias=P.displacementBias,V.wireframeLinewidth=P.wireframeLinewidth,V.linewidth=P.linewidth,C.isPointLight===!0&&V.isMeshDistanceMaterial===!0&&(V.referencePosition.setFromMatrixPosition(C.matrixWorld),V.nearDistance=F,V.farDistance=W),V}function E(R,P,C,F,W){if(R.visible===!1)return;if(R.layers.test(P.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&W===Q)&&(!R.frustumCulled||n.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,R.matrixWorld);const V=e.update(R),U=R.material;if(Array.isArray(U)){const te=V.groups;for(let ue=0,ce=te.length;ue<ce;ue++){const we=te[ue],ve=U[we.materialIndex];if(ve&&ve.visible){const Re=_(R,ve,F,C.near,C.far,W);l.renderBufferDirect(C,null,V,Re,R,we)}}}else if(U.visible){const te=_(R,U,F,C.near,C.far,W);l.renderBufferDirect(C,null,V,te,R,null)}}const B=R.children;for(let V=0,U=B.length;V<U;V++)E(B[V],P,C,F,W)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ne,this.render=function(R,P,C){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||R.length===0)return;const F=l.getRenderTarget(),W=l.getActiveCubeFace(),B=l.getActiveMipmapLevel(),V=l.state;V.setBlending(Be),V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);for(let U=0,te=R.length;U<te;U++){const ue=R[U],ce=ue.shadow;if(ce===void 0){console.warn("THREE.WebGLShadowMap:",ue,"has no shadow.");continue}if(ce.autoUpdate===!1&&ce.needsUpdate===!1)continue;i.copy(ce.mapSize);const we=ce.getFrameExtents();if(i.multiply(we),s.copy(ce.mapSize),(i.x>f||i.y>f)&&(i.x>f&&(s.x=Math.floor(f/we.x),i.x=s.x*we.x,ce.mapSize.x=s.x),i.y>f&&(s.y=Math.floor(f/we.y),i.y=s.y*we.y,ce.mapSize.y=s.y)),ce.map===null){const Re=this.type!==Q?{minFilter:Rt,magFilter:Rt}:{};ce.map=new Lt(i.x,i.y,Re),ce.map.texture.name=ue.name+".shadowMap",ce.camera.updateProjectionMatrix()}l.setRenderTarget(ce.map),l.clear();const ve=ce.getViewportCount();for(let Re=0;Re<ve;Re++){const Pe=ce.getViewport(Re);a.set(s.x*Pe.x,s.y*Pe.y,s.x*Pe.z,s.y*Pe.w),V.viewport(a),ce.updateMatrices(ue,Re),n=ce.getFrustum(),E(P,C,ce.camera,ue,this.type)}ce.isPointLightShadow!==!0&&this.type===Q&&T(ce,C),ce.needsUpdate=!1}w.needsUpdate=!1,l.setRenderTarget(F,W,B)}}function jR(l,e,t){const n=t.isWebGL2,i=new function(){let I=!1;const q=new Ke;let K=null;const re=new Ke(0,0,0,0);return{setMask:function(ae){K===ae||I||(l.colorMask(ae,ae,ae,ae),K=ae)},setLocked:function(ae){I=ae},setClear:function(ae,ge,Fe,je,qe){qe===!0&&(ae*=je,ge*=je,Fe*=je),q.set(ae,ge,Fe,je),re.equals(q)===!1&&(l.clearColor(ae,ge,Fe,je),re.copy(q))},reset:function(){I=!1,K=null,re.set(-1,0,0,0)}}},s=new function(){let I=!1,q=null,K=null,re=null;return{setTest:function(ae){ae?Te(l.DEPTH_TEST):ze(l.DEPTH_TEST)},setMask:function(ae){q===ae||I||(l.depthMask(ae),q=ae)},setFunc:function(ae){if(K!==ae){switch(ae){case Kf:l.depthFunc(l.NEVER);break;case Jf:l.depthFunc(l.ALWAYS);break;case vh:l.depthFunc(l.LESS);break;case gc:l.depthFunc(l.LEQUAL);break;case vc:l.depthFunc(l.EQUAL);break;case $f:l.depthFunc(l.GEQUAL);break;case Uy:l.depthFunc(l.GREATER);break;case yh:l.depthFunc(l.NOTEQUAL);break;default:l.depthFunc(l.LEQUAL)}K=ae}},setLocked:function(ae){I=ae},setClear:function(ae){re!==ae&&(l.clearDepth(ae),re=ae)},reset:function(){I=!1,q=null,K=null,re=null}}},a=new function(){let I=!1,q=null,K=null,re=null,ae=null,ge=null,Fe=null,je=null,qe=null;return{setTest:function(He){I||(He?Te(l.STENCIL_TEST):ze(l.STENCIL_TEST))},setMask:function(He){q===He||I||(l.stencilMask(He),q=He)},setFunc:function(He,rt,ut){K===He&&re===rt&&ae===ut||(l.stencilFunc(He,rt,ut),K=He,re=rt,ae=ut)},setOp:function(He,rt,ut){ge===He&&Fe===rt&&je===ut||(l.stencilOp(He,rt,ut),ge=He,Fe=rt,je=ut)},setLocked:function(He){I=He},setClear:function(He){qe!==He&&(l.clearStencil(He),qe=He)},reset:function(){I=!1,q=null,K=null,re=null,ae=null,ge=null,Fe=null,je=null,qe=null}}},c=new WeakMap,h=new WeakMap;let d={},f={},m=new WeakMap,g=[],y=null,S=!1,x=null,w=null,T=null,_=null,E=null,R=null,P=null,C=!1,F=null,W=null,B=null,V=null,U=null;const te=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ue=!1,ce=0;const we=l.getParameter(l.VERSION);we.indexOf("WebGL")!==-1?(ce=parseFloat(/^WebGL (\d)/.exec(we)[1]),ue=ce>=1):we.indexOf("OpenGL ES")!==-1&&(ce=parseFloat(/^OpenGL ES (\d)/.exec(we)[1]),ue=ce>=2);let ve=null,Re={};const Pe=l.getParameter(l.SCISSOR_BOX),De=l.getParameter(l.VIEWPORT),fe=new Ke().fromArray(Pe),oe=new Ke().fromArray(De);function Se(I,q,K){const re=new Uint8Array(4),ae=l.createTexture();l.bindTexture(I,ae),l.texParameteri(I,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(I,l.TEXTURE_MAG_FILTER,l.NEAREST);for(let ge=0;ge<K;ge++)l.texImage2D(q+ge,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,re);return ae}const Ce={};function Te(I){d[I]!==!0&&(l.enable(I),d[I]=!0)}function ze(I){d[I]!==!1&&(l.disable(I),d[I]=!1)}Ce[l.TEXTURE_2D]=Se(l.TEXTURE_2D,l.TEXTURE_2D,1),Ce[l.TEXTURE_CUBE_MAP]=Se(l.TEXTURE_CUBE_MAP,l.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),s.setClear(1),a.setClear(0),Te(l.DEPTH_TEST),s.setFunc(gc),Z(!1),H(be),Te(l.CULL_FACE),le(Be);const G={[or]:l.FUNC_ADD,[ko]:l.FUNC_SUBTRACT,[Ye]:l.FUNC_REVERSE_SUBTRACT};if(n)G[it]=l.MIN,G[lt]=l.MAX;else{const I=e.get("EXT_blend_minmax");I!==null&&(G[it]=I.MIN_EXT,G[lt]=I.MAX_EXT)}const z={[Zt]:l.ZERO,[cn]:l.ONE,[La]:l.SRC_COLOR,[Pa]:l.SRC_ALPHA,[Fy]:l.SRC_ALPHA_SATURATE,[Ny]:l.DST_COLOR,[Ca]:l.DST_ALPHA,[Dr]:l.ONE_MINUS_SRC_COLOR,[lr]:l.ONE_MINUS_SRC_ALPHA,[ky]:l.ONE_MINUS_DST_COLOR,[Iy]:l.ONE_MINUS_DST_ALPHA};function le(I,q,K,re,ae,ge,Fe,je){if(I!==Be){if(S===!1&&(Te(l.BLEND),S=!0),I===Ra)ae=ae||q,ge=ge||K,Fe=Fe||re,q===w&&ae===E||(l.blendEquationSeparate(G[q],G[ae]),w=q,E=ae),K===T&&re===_&&ge===R&&Fe===P||(l.blendFuncSeparate(z[K],z[re],z[ge],z[Fe]),T=K,_=re,R=ge,P=Fe),x=I,C=!1;else if(I!==x||je!==C){if(w===or&&E===or||(l.blendEquation(l.FUNC_ADD),w=or,E=or),je)switch(I){case ot:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case xn:l.blendFunc(l.ONE,l.ONE);break;case ai:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case ar:l.blendFuncSeparate(l.ZERO,l.SRC_COLOR,l.ZERO,l.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",I)}else switch(I){case ot:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case xn:l.blendFunc(l.SRC_ALPHA,l.ONE);break;case ai:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case ar:l.blendFunc(l.ZERO,l.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",I)}T=null,_=null,R=null,P=null,x=I,C=je}}else S===!0&&(ze(l.BLEND),S=!1)}function Z(I){F!==I&&(I?l.frontFace(l.CW):l.frontFace(l.CCW),F=I)}function H(I){I!==me?(Te(l.CULL_FACE),I!==W&&(I===be?l.cullFace(l.BACK):I===ke?l.cullFace(l.FRONT):l.cullFace(l.FRONT_AND_BACK))):ze(l.CULL_FACE),W=I}function ee(I,q,K){I?(Te(l.POLYGON_OFFSET_FILL),V===q&&U===K||(l.polygonOffset(q,K),V=q,U=K)):ze(l.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:s,stencil:a},enable:Te,disable:ze,bindFramebuffer:function(I,q){return f[I]!==q&&(l.bindFramebuffer(I,q),f[I]=q,n&&(I===l.DRAW_FRAMEBUFFER&&(f[l.FRAMEBUFFER]=q),I===l.FRAMEBUFFER&&(f[l.DRAW_FRAMEBUFFER]=q)),!0)},drawBuffers:function(I,q){let K=g,re=!1;if(I)if(K=m.get(q),K===void 0&&(K=[],m.set(q,K)),I.isWebGLMultipleRenderTargets){const ae=I.texture;if(K.length!==ae.length||K[0]!==l.COLOR_ATTACHMENT0){for(let ge=0,Fe=ae.length;ge<Fe;ge++)K[ge]=l.COLOR_ATTACHMENT0+ge;K.length=ae.length,re=!0}}else K[0]!==l.COLOR_ATTACHMENT0&&(K[0]=l.COLOR_ATTACHMENT0,re=!0);else K[0]!==l.BACK&&(K[0]=l.BACK,re=!0);re&&(t.isWebGL2?l.drawBuffers(K):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(K))},useProgram:function(I){return y!==I&&(l.useProgram(I),y=I,!0)},setBlending:le,setMaterial:function(I,q){I.side===Me?ze(l.CULL_FACE):Te(l.CULL_FACE);let K=I.side===ye;q&&(K=!K),Z(K),I.blending===ot&&I.transparent===!1?le(Be):le(I.blending,I.blendEquation,I.blendSrc,I.blendDst,I.blendEquationAlpha,I.blendSrcAlpha,I.blendDstAlpha,I.premultipliedAlpha),s.setFunc(I.depthFunc),s.setTest(I.depthTest),s.setMask(I.depthWrite),i.setMask(I.colorWrite);const re=I.stencilWrite;a.setTest(re),re&&(a.setMask(I.stencilWriteMask),a.setFunc(I.stencilFunc,I.stencilRef,I.stencilFuncMask),a.setOp(I.stencilFail,I.stencilZFail,I.stencilZPass)),ee(I.polygonOffset,I.polygonOffsetFactor,I.polygonOffsetUnits),I.alphaToCoverage===!0?Te(l.SAMPLE_ALPHA_TO_COVERAGE):ze(l.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Z,setCullFace:H,setLineWidth:function(I){I!==B&&(ue&&l.lineWidth(I),B=I)},setPolygonOffset:ee,setScissorTest:function(I){I?Te(l.SCISSOR_TEST):ze(l.SCISSOR_TEST)},activeTexture:function(I){I===void 0&&(I=l.TEXTURE0+te-1),ve!==I&&(l.activeTexture(I),ve=I)},bindTexture:function(I,q,K){K===void 0&&(K=ve===null?l.TEXTURE0+te-1:ve);let re=Re[K];re===void 0&&(re={type:void 0,texture:void 0},Re[K]=re),re.type===I&&re.texture===q||(ve!==K&&(l.activeTexture(K),ve=K),l.bindTexture(I,q||Ce[I]),re.type=I,re.texture=q)},unbindTexture:function(){const I=Re[ve];I!==void 0&&I.type!==void 0&&(l.bindTexture(I.type,null),I.type=void 0,I.texture=void 0)},compressedTexImage2D:function(){try{l.compressedTexImage2D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexImage3D:function(){try{l.compressedTexImage3D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texImage2D:function(){try{l.texImage2D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texImage3D:function(){try{l.texImage3D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},updateUBOMapping:function(I,q){let K=h.get(q);K===void 0&&(K=new WeakMap,h.set(q,K));let re=K.get(I);re===void 0&&(re=l.getUniformBlockIndex(q,I.name),K.set(I,re))},uniformBlockBinding:function(I,q){const K=h.get(q).get(I);c.get(q)!==K&&(l.uniformBlockBinding(q,K,I.__bindingPointIndex),c.set(q,K))},texStorage2D:function(){try{l.texStorage2D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texStorage3D:function(){try{l.texStorage3D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texSubImage2D:function(){try{l.texSubImage2D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texSubImage3D:function(){try{l.texSubImage3D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexSubImage2D:function(){try{l.compressedTexSubImage2D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexSubImage3D:function(){try{l.compressedTexSubImage3D.apply(l,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},scissor:function(I){fe.equals(I)===!1&&(l.scissor(I.x,I.y,I.z,I.w),fe.copy(I))},viewport:function(I){oe.equals(I)===!1&&(l.viewport(I.x,I.y,I.z,I.w),oe.copy(I))},reset:function(){l.disable(l.BLEND),l.disable(l.CULL_FACE),l.disable(l.DEPTH_TEST),l.disable(l.POLYGON_OFFSET_FILL),l.disable(l.SCISSOR_TEST),l.disable(l.STENCIL_TEST),l.disable(l.SAMPLE_ALPHA_TO_COVERAGE),l.blendEquation(l.FUNC_ADD),l.blendFunc(l.ONE,l.ZERO),l.blendFuncSeparate(l.ONE,l.ZERO,l.ONE,l.ZERO),l.colorMask(!0,!0,!0,!0),l.clearColor(0,0,0,0),l.depthMask(!0),l.depthFunc(l.LESS),l.clearDepth(1),l.stencilMask(4294967295),l.stencilFunc(l.ALWAYS,0,4294967295),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.clearStencil(0),l.cullFace(l.BACK),l.frontFace(l.CCW),l.polygonOffset(0,0),l.activeTexture(l.TEXTURE0),l.bindFramebuffer(l.FRAMEBUFFER,null),n===!0&&(l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),l.bindFramebuffer(l.READ_FRAMEBUFFER,null)),l.useProgram(null),l.lineWidth(1),l.scissor(0,0,l.canvas.width,l.canvas.height),l.viewport(0,0,l.canvas.width,l.canvas.height),d={},ve=null,Re={},f={},m=new WeakMap,g=[],y=null,S=!1,x=null,w=null,T=null,_=null,E=null,R=null,P=null,C=!1,F=null,W=null,B=null,V=null,U=null,fe.set(0,0,l.canvas.width,l.canvas.height),oe.set(0,0,l.canvas.width,l.canvas.height),i.reset(),s.reset(),a.reset()}}}function HR(l,e,t,n,i,s,a){const c=i.isWebGL2,h=i.maxTextures,d=i.maxCubemapSize,f=i.maxTextureSize,m=i.maxSamples,g=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,y=typeof navigator<"u"&&/OculusBrowser/g.test(navigator.userAgent),S=new WeakMap;let x;const w=new WeakMap;let T=!1;try{T=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(G,z){return T?new OffscreenCanvas(G,z):Tc("canvas")}function E(G,z,le,Z){let H=1;if((G.width>Z||G.height>Z)&&(H=Z/Math.max(G.width,G.height)),H<1||z===!0){if(typeof HTMLImageElement<"u"&&G instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&G instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&G instanceof ImageBitmap){const ee=z?mx:Math.floor,I=ee(H*G.width),q=ee(H*G.height);x===void 0&&(x=_(I,q));const K=le?_(I,q):x;return K.width=I,K.height=q,K.getContext("2d").drawImage(G,0,0,I,q),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+G.width+"x"+G.height+") to ("+I+"x"+q+")."),K}return"data"in G&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+G.width+"x"+G.height+")."),G}return G}function R(G){return Cm(G.width)&&Cm(G.height)}function P(G,z){return G.generateMipmaps&&z&&G.minFilter!==Rt&&G.minFilter!==at}function C(G){l.generateMipmap(G)}function F(G,z,le,Z,H=!1){if(c===!1)return z;if(G!==null){if(l[G]!==void 0)return l[G];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+G+"'")}let ee=z;return z===l.RED&&(le===l.FLOAT&&(ee=l.R32F),le===l.HALF_FLOAT&&(ee=l.R16F),le===l.UNSIGNED_BYTE&&(ee=l.R8)),z===l.RG&&(le===l.FLOAT&&(ee=l.RG32F),le===l.HALF_FLOAT&&(ee=l.RG16F),le===l.UNSIGNED_BYTE&&(ee=l.RG8)),z===l.RGBA&&(le===l.FLOAT&&(ee=l.RGBA32F),le===l.HALF_FLOAT&&(ee=l.RGBA16F),le===l.UNSIGNED_BYTE&&(ee=Z===mt&&H===!1?l.SRGB8_ALPHA8:l.RGBA8),le===l.UNSIGNED_SHORT_4_4_4_4&&(ee=l.RGBA4),le===l.UNSIGNED_SHORT_5_5_5_1&&(ee=l.RGB5_A1)),ee!==l.R16F&&ee!==l.R32F&&ee!==l.RG16F&&ee!==l.RG32F&&ee!==l.RGBA16F&&ee!==l.RGBA32F||e.get("EXT_color_buffer_float"),ee}function W(G,z,le){return P(G,le)===!0||G.isFramebufferTexture&&G.minFilter!==Rt&&G.minFilter!==at?Math.log2(Math.max(z.width,z.height))+1:G.mipmaps!==void 0&&G.mipmaps.length>0?G.mipmaps.length:G.isCompressedTexture&&Array.isArray(G.image)?z.mipmaps.length:1}function B(G){return G===Rt||G===bc||G===zo?l.NEAREST:l.LINEAR}function V(G){const z=G.target;z.removeEventListener("dispose",V),function(le){const Z=n.get(le);if(Z.__webglInit===void 0)return;const H=le.source,ee=w.get(H);if(ee){const I=ee[Z.__cacheKey];I.usedTimes--,I.usedTimes===0&&te(le),Object.keys(ee).length===0&&w.delete(H)}n.remove(le)}(z),z.isVideoTexture&&S.delete(z)}function U(G){const z=G.target;z.removeEventListener("dispose",U),function(le){const Z=le.texture,H=n.get(le),ee=n.get(Z);if(ee.__webglTexture!==void 0&&(l.deleteTexture(ee.__webglTexture),a.memory.textures--),le.depthTexture&&le.depthTexture.dispose(),le.isWebGLCubeRenderTarget)for(let I=0;I<6;I++)l.deleteFramebuffer(H.__webglFramebuffer[I]),H.__webglDepthbuffer&&l.deleteRenderbuffer(H.__webglDepthbuffer[I]);else{if(l.deleteFramebuffer(H.__webglFramebuffer),H.__webglDepthbuffer&&l.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&l.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let I=0;I<H.__webglColorRenderbuffer.length;I++)H.__webglColorRenderbuffer[I]&&l.deleteRenderbuffer(H.__webglColorRenderbuffer[I]);H.__webglDepthRenderbuffer&&l.deleteRenderbuffer(H.__webglDepthRenderbuffer)}if(le.isWebGLMultipleRenderTargets)for(let I=0,q=Z.length;I<q;I++){const K=n.get(Z[I]);K.__webglTexture&&(l.deleteTexture(K.__webglTexture),a.memory.textures--),n.remove(Z[I])}n.remove(Z),n.remove(le)}(z)}function te(G){const z=n.get(G);l.deleteTexture(z.__webglTexture);const le=G.source;delete w.get(le)[z.__cacheKey],a.memory.textures--}let ue=0;function ce(G,z){const le=n.get(G);if(G.isVideoTexture&&function(Z){const H=a.render.frame;S.get(Z)!==H&&(S.set(Z,H),Z.update())}(G),G.isRenderTargetTexture===!1&&G.version>0&&le.__version!==G.version){const Z=G.image;if(Z===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(Z.complete!==!1)return void De(le,G,z);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(l.TEXTURE_2D,le.__webglTexture,l.TEXTURE0+z)}const we={[vi]:l.REPEAT,[bn]:l.CLAMP_TO_EDGE,[Uo]:l.MIRRORED_REPEAT},ve={[Rt]:l.NEAREST,[bc]:l.NEAREST_MIPMAP_NEAREST,[zo]:l.NEAREST_MIPMAP_LINEAR,[at]:l.LINEAR,[bh]:l.LINEAR_MIPMAP_NEAREST,[cr]:l.LINEAR_MIPMAP_LINEAR};function Re(G,z,le){if(le?(l.texParameteri(G,l.TEXTURE_WRAP_S,we[z.wrapS]),l.texParameteri(G,l.TEXTURE_WRAP_T,we[z.wrapT]),G!==l.TEXTURE_3D&&G!==l.TEXTURE_2D_ARRAY||l.texParameteri(G,l.TEXTURE_WRAP_R,we[z.wrapR]),l.texParameteri(G,l.TEXTURE_MAG_FILTER,ve[z.magFilter]),l.texParameteri(G,l.TEXTURE_MIN_FILTER,ve[z.minFilter])):(l.texParameteri(G,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(G,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),G!==l.TEXTURE_3D&&G!==l.TEXTURE_2D_ARRAY||l.texParameteri(G,l.TEXTURE_WRAP_R,l.CLAMP_TO_EDGE),z.wrapS===bn&&z.wrapT===bn||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),l.texParameteri(G,l.TEXTURE_MAG_FILTER,B(z.magFilter)),l.texParameteri(G,l.TEXTURE_MIN_FILTER,B(z.minFilter)),z.minFilter!==Rt&&z.minFilter!==at&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Z=e.get("EXT_texture_filter_anisotropic");if(z.magFilter===Rt||z.minFilter!==zo&&z.minFilter!==cr||z.type===Ci&&e.has("OES_texture_float_linear")===!1||c===!1&&z.type===yi&&e.has("OES_texture_half_float_linear")===!1)return;(z.anisotropy>1||n.get(z).__currentAnisotropy)&&(l.texParameterf(G,Z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,i.getMaxAnisotropy())),n.get(z).__currentAnisotropy=z.anisotropy)}}function Pe(G,z){let le=!1;G.__webglInit===void 0&&(G.__webglInit=!0,z.addEventListener("dispose",V));const Z=z.source;let H=w.get(Z);H===void 0&&(H={},w.set(Z,H));const ee=function(I){const q=[];return q.push(I.wrapS),q.push(I.wrapT),q.push(I.wrapR||0),q.push(I.magFilter),q.push(I.minFilter),q.push(I.anisotropy),q.push(I.internalFormat),q.push(I.format),q.push(I.type),q.push(I.generateMipmaps),q.push(I.premultiplyAlpha),q.push(I.flipY),q.push(I.unpackAlignment),q.push(I.encoding),q.join()}(z);if(ee!==G.__cacheKey){H[ee]===void 0&&(H[ee]={texture:l.createTexture(),usedTimes:0},a.memory.textures++,le=!0),H[ee].usedTimes++;const I=H[G.__cacheKey];I!==void 0&&(H[G.__cacheKey].usedTimes--,I.usedTimes===0&&te(z)),G.__cacheKey=ee,G.__webglTexture=H[ee].texture}return le}function De(G,z,le){let Z=l.TEXTURE_2D;(z.isDataArrayTexture||z.isCompressedArrayTexture)&&(Z=l.TEXTURE_2D_ARRAY),z.isData3DTexture&&(Z=l.TEXTURE_3D);const H=Pe(G,z),ee=z.source;t.bindTexture(Z,G.__webglTexture,l.TEXTURE0+le);const I=n.get(ee);if(ee.version!==I.__version||H===!0){t.activeTexture(l.TEXTURE0+le),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,z.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,z.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,l.NONE);const q=function(nt){return!c&&(nt.wrapS!==bn||nt.wrapT!==bn||nt.minFilter!==Rt&&nt.minFilter!==at)}(z)&&R(z.image)===!1;let K=E(z.image,q,!1,f);K=ze(z,K);const re=R(K)||c,ae=s.convert(z.format,z.encoding);let ge,Fe=s.convert(z.type),je=F(z.internalFormat,ae,Fe,z.encoding,z.isVideoTexture);Re(Z,z,re);const qe=z.mipmaps,He=c&&z.isVideoTexture!==!0,rt=I.__version===void 0||H===!0,ut=W(z,K,re);if(z.isDepthTexture)je=l.DEPTH_COMPONENT,c?je=z.type===Ci?l.DEPTH_COMPONENT32F:z.type===$r?l.DEPTH_COMPONENT24:z.type===es?l.DEPTH24_STENCIL8:l.DEPTH_COMPONENT16:z.type===Ci&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),z.format===ts&&je===l.DEPTH_COMPONENT&&z.type!==Sh&&z.type!==$r&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),z.type=$r,Fe=s.convert(z.type)),z.format===Ns&&je===l.DEPTH_COMPONENT&&(je=l.DEPTH_STENCIL,z.type!==es&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),z.type=es,Fe=s.convert(z.type))),rt&&(He?t.texStorage2D(l.TEXTURE_2D,1,je,K.width,K.height):t.texImage2D(l.TEXTURE_2D,0,je,K.width,K.height,0,ae,Fe,null));else if(z.isDataTexture)if(qe.length>0&&re){He&&rt&&t.texStorage2D(l.TEXTURE_2D,ut,je,qe[0].width,qe[0].height);for(let nt=0,vt=qe.length;nt<vt;nt++)ge=qe[nt],He?t.texSubImage2D(l.TEXTURE_2D,nt,0,0,ge.width,ge.height,ae,Fe,ge.data):t.texImage2D(l.TEXTURE_2D,nt,je,ge.width,ge.height,0,ae,Fe,ge.data);z.generateMipmaps=!1}else He?(rt&&t.texStorage2D(l.TEXTURE_2D,ut,je,K.width,K.height),t.texSubImage2D(l.TEXTURE_2D,0,0,0,K.width,K.height,ae,Fe,K.data)):t.texImage2D(l.TEXTURE_2D,0,je,K.width,K.height,0,ae,Fe,K.data);else if(z.isCompressedTexture)if(z.isCompressedArrayTexture){He&&rt&&t.texStorage3D(l.TEXTURE_2D_ARRAY,ut,je,qe[0].width,qe[0].height,K.depth);for(let nt=0,vt=qe.length;nt<vt;nt++)ge=qe[nt],z.format!==oi?ae!==null?He?t.compressedTexSubImage3D(l.TEXTURE_2D_ARRAY,nt,0,0,0,ge.width,ge.height,K.depth,ae,ge.data,0,0):t.compressedTexImage3D(l.TEXTURE_2D_ARRAY,nt,je,ge.width,ge.height,K.depth,0,ge.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):He?t.texSubImage3D(l.TEXTURE_2D_ARRAY,nt,0,0,0,ge.width,ge.height,K.depth,ae,Fe,ge.data):t.texImage3D(l.TEXTURE_2D_ARRAY,nt,je,ge.width,ge.height,K.depth,0,ae,Fe,ge.data)}else{He&&rt&&t.texStorage2D(l.TEXTURE_2D,ut,je,qe[0].width,qe[0].height);for(let nt=0,vt=qe.length;nt<vt;nt++)ge=qe[nt],z.format!==oi?ae!==null?He?t.compressedTexSubImage2D(l.TEXTURE_2D,nt,0,0,ge.width,ge.height,ae,ge.data):t.compressedTexImage2D(l.TEXTURE_2D,nt,je,ge.width,ge.height,0,ge.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):He?t.texSubImage2D(l.TEXTURE_2D,nt,0,0,ge.width,ge.height,ae,Fe,ge.data):t.texImage2D(l.TEXTURE_2D,nt,je,ge.width,ge.height,0,ae,Fe,ge.data)}else if(z.isDataArrayTexture)He?(rt&&t.texStorage3D(l.TEXTURE_2D_ARRAY,ut,je,K.width,K.height,K.depth),t.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,0,K.width,K.height,K.depth,ae,Fe,K.data)):t.texImage3D(l.TEXTURE_2D_ARRAY,0,je,K.width,K.height,K.depth,0,ae,Fe,K.data);else if(z.isData3DTexture)He?(rt&&t.texStorage3D(l.TEXTURE_3D,ut,je,K.width,K.height,K.depth),t.texSubImage3D(l.TEXTURE_3D,0,0,0,0,K.width,K.height,K.depth,ae,Fe,K.data)):t.texImage3D(l.TEXTURE_3D,0,je,K.width,K.height,K.depth,0,ae,Fe,K.data);else if(z.isFramebufferTexture){if(rt)if(He)t.texStorage2D(l.TEXTURE_2D,ut,je,K.width,K.height);else{let nt=K.width,vt=K.height;for(let Dt=0;Dt<ut;Dt++)t.texImage2D(l.TEXTURE_2D,Dt,je,nt,vt,0,ae,Fe,null),nt>>=1,vt>>=1}}else if(qe.length>0&&re){He&&rt&&t.texStorage2D(l.TEXTURE_2D,ut,je,qe[0].width,qe[0].height);for(let nt=0,vt=qe.length;nt<vt;nt++)ge=qe[nt],He?t.texSubImage2D(l.TEXTURE_2D,nt,0,0,ae,Fe,ge):t.texImage2D(l.TEXTURE_2D,nt,je,ae,Fe,ge);z.generateMipmaps=!1}else He?(rt&&t.texStorage2D(l.TEXTURE_2D,ut,je,K.width,K.height),t.texSubImage2D(l.TEXTURE_2D,0,0,0,ae,Fe,K)):t.texImage2D(l.TEXTURE_2D,0,je,ae,Fe,K);P(z,re)&&C(Z),I.__version=ee.version,z.onUpdate&&z.onUpdate(z)}G.__version=z.version}function fe(G,z,le,Z,H){const ee=s.convert(le.format,le.encoding),I=s.convert(le.type),q=F(le.internalFormat,ee,I,le.encoding);n.get(z).__hasExternalTextures||(H===l.TEXTURE_3D||H===l.TEXTURE_2D_ARRAY?t.texImage3D(H,0,q,z.width,z.height,z.depth,0,ee,I,null):t.texImage2D(H,0,q,z.width,z.height,0,ee,I,null)),t.bindFramebuffer(l.FRAMEBUFFER,G),Te(z)?g.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,Z,H,n.get(le).__webglTexture,0,Ce(z)):(H===l.TEXTURE_2D||H>=l.TEXTURE_CUBE_MAP_POSITIVE_X&&H<=l.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&l.framebufferTexture2D(l.FRAMEBUFFER,Z,H,n.get(le).__webglTexture,0),t.bindFramebuffer(l.FRAMEBUFFER,null)}function oe(G,z,le){if(l.bindRenderbuffer(l.RENDERBUFFER,G),z.depthBuffer&&!z.stencilBuffer){let Z=l.DEPTH_COMPONENT16;if(le||Te(z)){const H=z.depthTexture;H&&H.isDepthTexture&&(H.type===Ci?Z=l.DEPTH_COMPONENT32F:H.type===$r&&(Z=l.DEPTH_COMPONENT24));const ee=Ce(z);Te(z)?g.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,ee,Z,z.width,z.height):l.renderbufferStorageMultisample(l.RENDERBUFFER,ee,Z,z.width,z.height)}else l.renderbufferStorage(l.RENDERBUFFER,Z,z.width,z.height);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,G)}else if(z.depthBuffer&&z.stencilBuffer){const Z=Ce(z);le&&Te(z)===!1?l.renderbufferStorageMultisample(l.RENDERBUFFER,Z,l.DEPTH24_STENCIL8,z.width,z.height):Te(z)?g.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,Z,l.DEPTH24_STENCIL8,z.width,z.height):l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,z.width,z.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,G)}else{const Z=z.isWebGLMultipleRenderTargets===!0?z.texture:[z.texture];for(let H=0;H<Z.length;H++){const ee=Z[H],I=s.convert(ee.format,ee.encoding),q=s.convert(ee.type),K=F(ee.internalFormat,I,q,ee.encoding),re=Ce(z);le&&Te(z)===!1?l.renderbufferStorageMultisample(l.RENDERBUFFER,re,K,z.width,z.height):Te(z)?g.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,re,K,z.width,z.height):l.renderbufferStorage(l.RENDERBUFFER,K,z.width,z.height)}}l.bindRenderbuffer(l.RENDERBUFFER,null)}function Se(G){const z=n.get(G),le=G.isWebGLCubeRenderTarget===!0;if(G.depthTexture&&!z.__autoAllocateDepthBuffer){if(le)throw new Error("target.depthTexture not supported in Cube render targets");(function(Z,H){if(H&&H.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(l.FRAMEBUFFER,Z),!H.depthTexture||!H.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(H.depthTexture).__webglTexture&&H.depthTexture.image.width===H.width&&H.depthTexture.image.height===H.height||(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),ce(H.depthTexture,0);const ee=n.get(H.depthTexture).__webglTexture,I=Ce(H);if(H.depthTexture.format===ts)Te(H)?g.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,ee,0,I):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,ee,0);else{if(H.depthTexture.format!==Ns)throw new Error("Unknown depthTexture format");Te(H)?g.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,ee,0,I):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,ee,0)}})(z.__webglFramebuffer,G)}else if(le){z.__webglDepthbuffer=[];for(let Z=0;Z<6;Z++)t.bindFramebuffer(l.FRAMEBUFFER,z.__webglFramebuffer[Z]),z.__webglDepthbuffer[Z]=l.createRenderbuffer(),oe(z.__webglDepthbuffer[Z],G,!1)}else t.bindFramebuffer(l.FRAMEBUFFER,z.__webglFramebuffer),z.__webglDepthbuffer=l.createRenderbuffer(),oe(z.__webglDepthbuffer,G,!1);t.bindFramebuffer(l.FRAMEBUFFER,null)}function Ce(G){return Math.min(m,G.samples)}function Te(G){const z=n.get(G);return c&&G.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&z.__useRenderToTexture!==!1}function ze(G,z){const le=G.encoding,Z=G.format,H=G.type;return G.isCompressedTexture===!0||G.isVideoTexture===!0||G.format===Ch||le!==ur&&(le===mt?c===!1?e.has("EXT_sRGB")===!0&&Z===oi?(G.format=Ch,G.minFilter=at,G.generateMipmaps=!1):z=Nm.sRGBToLinear(z):Z===oi&&H===Sn||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",le)),z}this.allocateTextureUnit=function(){const G=ue;return G>=h&&console.warn("THREE.WebGLTextures: Trying to use "+G+" texture units while this GPU supports only "+h),ue+=1,G},this.resetTextureUnits=function(){ue=0},this.setTexture2D=ce,this.setTexture2DArray=function(G,z){const le=n.get(G);G.version>0&&le.__version!==G.version?De(le,G,z):t.bindTexture(l.TEXTURE_2D_ARRAY,le.__webglTexture,l.TEXTURE0+z)},this.setTexture3D=function(G,z){const le=n.get(G);G.version>0&&le.__version!==G.version?De(le,G,z):t.bindTexture(l.TEXTURE_3D,le.__webglTexture,l.TEXTURE0+z)},this.setTextureCube=function(G,z){const le=n.get(G);G.version>0&&le.__version!==G.version?function(Z,H,ee){if(H.image.length!==6)return;const I=Pe(Z,H),q=H.source;t.bindTexture(l.TEXTURE_CUBE_MAP,Z.__webglTexture,l.TEXTURE0+ee);const K=n.get(q);if(q.version!==K.__version||I===!0){t.activeTexture(l.TEXTURE0+ee),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,H.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,H.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,l.NONE);const re=H.isCompressedTexture||H.image[0].isCompressedTexture,ae=H.image[0]&&H.image[0].isDataTexture,ge=[];for(let Je=0;Je<6;Je++)ge[Je]=re||ae?ae?H.image[Je].image:H.image[Je]:E(H.image[Je],!1,!0,d),ge[Je]=ze(H,ge[Je]);const Fe=ge[0],je=R(Fe)||c,qe=s.convert(H.format,H.encoding),He=s.convert(H.type),rt=F(H.internalFormat,qe,He,H.encoding),ut=c&&H.isVideoTexture!==!0,nt=K.__version===void 0||I===!0;let vt,Dt=W(H,Fe,je);if(Re(l.TEXTURE_CUBE_MAP,H,je),re){ut&&nt&&t.texStorage2D(l.TEXTURE_CUBE_MAP,Dt,rt,Fe.width,Fe.height);for(let Je=0;Je<6;Je++){vt=ge[Je].mipmaps;for(let Ot=0;Ot<vt.length;Ot++){const pe=vt[Ot];H.format!==oi?qe!==null?ut?t.compressedTexSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot,0,0,pe.width,pe.height,qe,pe.data):t.compressedTexImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot,rt,pe.width,pe.height,0,pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ut?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot,0,0,pe.width,pe.height,qe,He,pe.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot,rt,pe.width,pe.height,0,qe,He,pe.data)}}}else{vt=H.mipmaps,ut&&nt&&(vt.length>0&&Dt++,t.texStorage2D(l.TEXTURE_CUBE_MAP,Dt,rt,ge[0].width,ge[0].height));for(let Je=0;Je<6;Je++)if(ae){ut?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,0,0,ge[Je].width,ge[Je].height,qe,He,ge[Je].data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,rt,ge[Je].width,ge[Je].height,0,qe,He,ge[Je].data);for(let Ot=0;Ot<vt.length;Ot++){const pe=vt[Ot].image[Je].image;ut?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot+1,0,0,pe.width,pe.height,qe,He,pe.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot+1,rt,pe.width,pe.height,0,qe,He,pe.data)}}else{ut?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,0,0,qe,He,ge[Je]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,rt,qe,He,ge[Je]);for(let Ot=0;Ot<vt.length;Ot++){const pe=vt[Ot];ut?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot+1,0,0,qe,He,pe.image[Je]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ot+1,rt,qe,He,pe.image[Je])}}}P(H,je)&&C(l.TEXTURE_CUBE_MAP),K.__version=q.version,H.onUpdate&&H.onUpdate(H)}Z.__version=H.version}(le,G,z):t.bindTexture(l.TEXTURE_CUBE_MAP,le.__webglTexture,l.TEXTURE0+z)},this.rebindTextures=function(G,z,le){const Z=n.get(G);z!==void 0&&fe(Z.__webglFramebuffer,G,G.texture,l.COLOR_ATTACHMENT0,l.TEXTURE_2D),le!==void 0&&Se(G)},this.setupRenderTarget=function(G){const z=G.texture,le=n.get(G),Z=n.get(z);G.addEventListener("dispose",U),G.isWebGLMultipleRenderTargets!==!0&&(Z.__webglTexture===void 0&&(Z.__webglTexture=l.createTexture()),Z.__version=z.version,a.memory.textures++);const H=G.isWebGLCubeRenderTarget===!0,ee=G.isWebGLMultipleRenderTargets===!0,I=R(G)||c;if(H){le.__webglFramebuffer=[];for(let q=0;q<6;q++)le.__webglFramebuffer[q]=l.createFramebuffer()}else{if(le.__webglFramebuffer=l.createFramebuffer(),ee)if(i.drawBuffers){const q=G.texture;for(let K=0,re=q.length;K<re;K++){const ae=n.get(q[K]);ae.__webglTexture===void 0&&(ae.__webglTexture=l.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&G.samples>0&&Te(G)===!1){const q=ee?z:[z];le.__webglMultisampledFramebuffer=l.createFramebuffer(),le.__webglColorRenderbuffer=[],t.bindFramebuffer(l.FRAMEBUFFER,le.__webglMultisampledFramebuffer);for(let K=0;K<q.length;K++){const re=q[K];le.__webglColorRenderbuffer[K]=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,le.__webglColorRenderbuffer[K]);const ae=s.convert(re.format,re.encoding),ge=s.convert(re.type),Fe=F(re.internalFormat,ae,ge,re.encoding,G.isXRRenderTarget===!0),je=Ce(G);l.renderbufferStorageMultisample(l.RENDERBUFFER,je,Fe,G.width,G.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+K,l.RENDERBUFFER,le.__webglColorRenderbuffer[K])}l.bindRenderbuffer(l.RENDERBUFFER,null),G.depthBuffer&&(le.__webglDepthRenderbuffer=l.createRenderbuffer(),oe(le.__webglDepthRenderbuffer,G,!0)),t.bindFramebuffer(l.FRAMEBUFFER,null)}}if(H){t.bindTexture(l.TEXTURE_CUBE_MAP,Z.__webglTexture),Re(l.TEXTURE_CUBE_MAP,z,I);for(let q=0;q<6;q++)fe(le.__webglFramebuffer[q],G,z,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+q);P(z,I)&&C(l.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ee){const q=G.texture;for(let K=0,re=q.length;K<re;K++){const ae=q[K],ge=n.get(ae);t.bindTexture(l.TEXTURE_2D,ge.__webglTexture),Re(l.TEXTURE_2D,ae,I),fe(le.__webglFramebuffer,G,ae,l.COLOR_ATTACHMENT0+K,l.TEXTURE_2D),P(ae,I)&&C(l.TEXTURE_2D)}t.unbindTexture()}else{let q=l.TEXTURE_2D;(G.isWebGL3DRenderTarget||G.isWebGLArrayRenderTarget)&&(c?q=G.isWebGL3DRenderTarget?l.TEXTURE_3D:l.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(q,Z.__webglTexture),Re(q,z,I),fe(le.__webglFramebuffer,G,z,l.COLOR_ATTACHMENT0,q),P(z,I)&&C(q),t.unbindTexture()}G.depthBuffer&&Se(G)},this.updateRenderTargetMipmap=function(G){const z=R(G)||c,le=G.isWebGLMultipleRenderTargets===!0?G.texture:[G.texture];for(let Z=0,H=le.length;Z<H;Z++){const ee=le[Z];if(P(ee,z)){const I=G.isWebGLCubeRenderTarget?l.TEXTURE_CUBE_MAP:l.TEXTURE_2D,q=n.get(ee).__webglTexture;t.bindTexture(I,q),C(I),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function(G){if(c&&G.samples>0&&Te(G)===!1){const z=G.isWebGLMultipleRenderTargets?G.texture:[G.texture],le=G.width,Z=G.height;let H=l.COLOR_BUFFER_BIT;const ee=[],I=G.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,q=n.get(G),K=G.isWebGLMultipleRenderTargets===!0;if(K)for(let re=0;re<z.length;re++)t.bindFramebuffer(l.FRAMEBUFFER,q.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+re,l.RENDERBUFFER,null),t.bindFramebuffer(l.FRAMEBUFFER,q.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+re,l.TEXTURE_2D,null,0);t.bindFramebuffer(l.READ_FRAMEBUFFER,q.__webglMultisampledFramebuffer),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,q.__webglFramebuffer);for(let re=0;re<z.length;re++){ee.push(l.COLOR_ATTACHMENT0+re),G.depthBuffer&&ee.push(I);const ae=q.__ignoreDepthValues!==void 0&&q.__ignoreDepthValues;if(ae===!1&&(G.depthBuffer&&(H|=l.DEPTH_BUFFER_BIT),G.stencilBuffer&&(H|=l.STENCIL_BUFFER_BIT)),K&&l.framebufferRenderbuffer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,q.__webglColorRenderbuffer[re]),ae===!0&&(l.invalidateFramebuffer(l.READ_FRAMEBUFFER,[I]),l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,[I])),K){const ge=n.get(z[re]).__webglTexture;l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,ge,0)}l.blitFramebuffer(0,0,le,Z,0,0,le,Z,H,l.NEAREST),y&&l.invalidateFramebuffer(l.READ_FRAMEBUFFER,ee)}if(t.bindFramebuffer(l.READ_FRAMEBUFFER,null),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),K)for(let re=0;re<z.length;re++){t.bindFramebuffer(l.FRAMEBUFFER,q.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+re,l.RENDERBUFFER,q.__webglColorRenderbuffer[re]);const ae=n.get(z[re]).__webglTexture;t.bindFramebuffer(l.FRAMEBUFFER,q.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+re,l.TEXTURE_2D,ae,0)}t.bindFramebuffer(l.DRAW_FRAMEBUFFER,q.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Se,this.setupFrameBufferTexture=fe,this.useMultisampledRTT=Te}function sb(l,e,t){const n=t.isWebGL2;return{convert:function(i,s=null){let a;if(i===Sn)return l.UNSIGNED_BYTE;if(i===Yy)return l.UNSIGNED_SHORT_4_4_4_4;if(i===Qy)return l.UNSIGNED_SHORT_5_5_5_1;if(i===Wy)return l.BYTE;if(i===Xy)return l.SHORT;if(i===Sh)return l.UNSIGNED_SHORT;if(i===qy)return l.INT;if(i===$r)return l.UNSIGNED_INT;if(i===Ci)return l.FLOAT;if(i===yi)return n?l.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(i===Zy)return l.ALPHA;if(i===oi)return l.RGBA;if(i===Ky)return l.LUMINANCE;if(i===Jy)return l.LUMINANCE_ALPHA;if(i===ts)return l.DEPTH_COMPONENT;if(i===Ns)return l.DEPTH_STENCIL;if(i===Ch)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(i===tm)return l.RED;if(i===$y)return l.RED_INTEGER;if(i===ex)return l.RG;if(i===tx)return l.RG_INTEGER;if(i===nx)return l.RGBA_INTEGER;if(i===wh||i===_h||i===Mh||i===Th)if(s===mt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a===null)return null;if(i===wh)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===_h)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Mh)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Th)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),a===null)return null;if(i===wh)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===_h)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Mh)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Th)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===nm||i===im||i===rm||i===sm){if(a=e.get("WEBGL_compressed_texture_pvrtc"),a===null)return null;if(i===nm)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===im)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===rm)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===sm)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===ix)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(i===am||i===om){if(a=e.get("WEBGL_compressed_texture_etc"),a===null)return null;if(i===am)return s===mt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===om)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(i===lm||i===cm||i===um||i===hm||i===dm||i===pm||i===fm||i===mm||i===gm||i===vm||i===ym||i===xm||i===bm||i===Sm){if(a=e.get("WEBGL_compressed_texture_astc"),a===null)return null;if(i===lm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===cm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===um)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===hm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===dm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===pm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===fm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===mm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===gm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===vm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===ym)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===xm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===bm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===Sm)return s===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===Eh){if(a=e.get("EXT_texture_compression_bptc"),a===null)return null;if(i===Eh)return s===mt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(i===rx||i===wm||i===_m||i===Mm){if(a=e.get("EXT_texture_compression_rgtc"),a===null)return null;if(i===Eh)return a.COMPRESSED_RED_RGTC1_EXT;if(i===wm)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===_m)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Mm)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===es?n?l.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):l[i]!==void 0?l[i]:null}}}class ab extends Kt{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Yn extends ct{constructor(){super(),this.isGroup=!0,this.type="Group"}}const GR={type:"move"};class l0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Yn,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Yn,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new O,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new O),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Yn,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new O,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new O),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,a=null;const c=this._targetRay,h=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){a=!0;for(const x of e.hand.values()){const w=t.getJointPose(x,n),T=this._getHandJoint(d,x);w!==null&&(T.matrix.fromArray(w.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.jointRadius=w.radius),T.visible=w!==null}const f=d.joints["index-finger-tip"],m=d.joints["thumb-tip"],g=f.position.distanceTo(m.position),y=.02,S=.005;d.inputState.pinching&&g>y+S?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&g<=y-S&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1));c!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&s!==null&&(i=s),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(GR)))}return c!==null&&(c.visible=i!==null),h!==null&&(h.visible=s!==null),d!==null&&(d.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Yn;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Uc extends zt{constructor(e,t,n,i,s,a,c,h,d,f){if((f=f!==void 0?f:ts)!==ts&&f!==Ns)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&f===ts&&(n=$r),n===void 0&&f===Ns&&(n=es),super(null,i,s,a,c,h,f,n,d),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:Rt,this.minFilter=h!==void 0?h:Rt,this.flipY=!1,this.generateMipmaps=!1}}class VR extends Xi{constructor(e,t){super();const n=this;let i=null,s=1,a=null,c="local-floor",h=1,d=null,f=null,m=null,g=null,y=null,S=null;const x=t.getContextAttributes();let w=null,T=null;const _=[],E=[],R=new Set,P=new Map,C=new Kt;C.layers.enable(1),C.viewport=new Ke;const F=new Kt;F.layers.enable(2),F.viewport=new Ke;const W=[C,F],B=new ab;B.layers.enable(1),B.layers.enable(2);let V=null,U=null;function te(fe){const oe=E.indexOf(fe.inputSource);if(oe===-1)return;const Se=_[oe];Se!==void 0&&Se.dispatchEvent({type:fe.type,data:fe.inputSource})}function ue(){i.removeEventListener("select",te),i.removeEventListener("selectstart",te),i.removeEventListener("selectend",te),i.removeEventListener("squeeze",te),i.removeEventListener("squeezestart",te),i.removeEventListener("squeezeend",te),i.removeEventListener("end",ue),i.removeEventListener("inputsourceschange",ce);for(let fe=0;fe<_.length;fe++){const oe=E[fe];oe!==null&&(E[fe]=null,_[fe].disconnect(oe))}V=null,U=null,e.setRenderTarget(w),y=null,g=null,m=null,i=null,T=null,De.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function ce(fe){for(let oe=0;oe<fe.removed.length;oe++){const Se=fe.removed[oe],Ce=E.indexOf(Se);Ce>=0&&(E[Ce]=null,_[Ce].disconnect(Se))}for(let oe=0;oe<fe.added.length;oe++){const Se=fe.added[oe];let Ce=E.indexOf(Se);if(Ce===-1){for(let ze=0;ze<_.length;ze++){if(ze>=E.length){E.push(Se),Ce=ze;break}if(E[ze]===null){E[ze]=Se,Ce=ze;break}}if(Ce===-1)break}const Te=_[Ce];Te&&Te.connect(Se)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(fe){let oe=_[fe];return oe===void 0&&(oe=new l0,_[fe]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(fe){let oe=_[fe];return oe===void 0&&(oe=new l0,_[fe]=oe),oe.getGripSpace()},this.getHand=function(fe){let oe=_[fe];return oe===void 0&&(oe=new l0,_[fe]=oe),oe.getHandSpace()},this.setFramebufferScaleFactor=function(fe){s=fe,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(fe){c=fe,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||a},this.setReferenceSpace=function(fe){d=fe},this.getBaseLayer=function(){return g!==null?g:y},this.getBinding=function(){return m},this.getFrame=function(){return S},this.getSession=function(){return i},this.setSession=async function(fe){if(i=fe,i!==null){if(w=e.getRenderTarget(),i.addEventListener("select",te),i.addEventListener("selectstart",te),i.addEventListener("selectend",te),i.addEventListener("squeeze",te),i.addEventListener("squeezestart",te),i.addEventListener("squeezeend",te),i.addEventListener("end",ue),i.addEventListener("inputsourceschange",ce),x.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const oe={antialias:i.renderState.layers!==void 0||x.antialias,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};y=new XRWebGLLayer(i,t,oe),i.updateRenderState({baseLayer:y}),T=new Lt(y.framebufferWidth,y.framebufferHeight,{format:oi,type:Sn,encoding:e.outputEncoding,stencilBuffer:x.stencil})}else{let oe=null,Se=null,Ce=null;x.depth&&(Ce=x.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,oe=x.stencil?Ns:ts,Se=x.stencil?es:$r);const Te={colorFormat:t.RGBA8,depthFormat:Ce,scaleFactor:s};m=new XRWebGLBinding(i,t),g=m.createProjectionLayer(Te),i.updateRenderState({layers:[g]}),T=new Lt(g.textureWidth,g.textureHeight,{format:oi,type:Sn,depthTexture:new Uc(g.textureWidth,g.textureHeight,Se,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:x.stencil,encoding:e.outputEncoding,samples:x.antialias?4:0}),e.properties.get(T).__ignoreDepthValues=g.ignoreDepthValues}T.isXRRenderTarget=!0,this.setFoveation(h),d=null,a=await i.requestReferenceSpace(c),De.setContext(i),De.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const we=new O,ve=new O;function Re(fe,oe){oe===null?fe.matrixWorld.copy(fe.matrix):fe.matrixWorld.multiplyMatrices(oe.matrixWorld,fe.matrix),fe.matrixWorldInverse.copy(fe.matrixWorld).invert()}this.updateCamera=function(fe){if(i===null)return;B.near=F.near=C.near=fe.near,B.far=F.far=C.far=fe.far,V===B.near&&U===B.far||(i.updateRenderState({depthNear:B.near,depthFar:B.far}),V=B.near,U=B.far);const oe=fe.parent,Se=B.cameras;Re(B,oe);for(let Te=0;Te<Se.length;Te++)Re(Se[Te],oe);B.matrixWorld.decompose(B.position,B.quaternion,B.scale),fe.matrix.copy(B.matrix),fe.matrix.decompose(fe.position,fe.quaternion,fe.scale);const Ce=fe.children;for(let Te=0,ze=Ce.length;Te<ze;Te++)Ce[Te].updateMatrixWorld(!0);Se.length===2?function(Te,ze,G){we.setFromMatrixPosition(ze.matrixWorld),ve.setFromMatrixPosition(G.matrixWorld);const z=we.distanceTo(ve),le=ze.projectionMatrix.elements,Z=G.projectionMatrix.elements,H=le[14]/(le[10]-1),ee=le[14]/(le[10]+1),I=(le[9]+1)/le[5],q=(le[9]-1)/le[5],K=(le[8]-1)/le[0],re=(Z[8]+1)/Z[0],ae=H*K,ge=H*re,Fe=z/(-K+re),je=Fe*-K;ze.matrixWorld.decompose(Te.position,Te.quaternion,Te.scale),Te.translateX(je),Te.translateZ(Fe),Te.matrixWorld.compose(Te.position,Te.quaternion,Te.scale),Te.matrixWorldInverse.copy(Te.matrixWorld).invert();const qe=H+Fe,He=ee+Fe,rt=ae-je,ut=ge+(z-je),nt=I*ee/He*qe,vt=q*ee/He*qe;Te.projectionMatrix.makePerspective(rt,ut,nt,vt,qe,He)}(B,C,F):B.projectionMatrix.copy(C.projectionMatrix)},this.getCamera=function(){return B},this.getFoveation=function(){if(g!==null||y!==null)return h},this.setFoveation=function(fe){h=fe,g!==null&&(g.fixedFoveation=fe),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=fe)},this.getPlanes=function(){return R};let Pe=null;const De=new Ox;De.setAnimationLoop(function(fe,oe){if(f=oe.getViewerPose(d||a),S=oe,f!==null){const Se=f.views;y!==null&&(e.setRenderTargetFramebuffer(T,y.framebuffer),e.setRenderTarget(T));let Ce=!1;Se.length!==B.cameras.length&&(B.cameras.length=0,Ce=!0);for(let Te=0;Te<Se.length;Te++){const ze=Se[Te];let G=null;if(y!==null)G=y.getViewport(ze);else{const le=m.getViewSubImage(g,ze);G=le.viewport,Te===0&&(e.setRenderTargetTextures(T,le.colorTexture,g.ignoreDepthValues?void 0:le.depthStencilTexture),e.setRenderTarget(T))}let z=W[Te];z===void 0&&(z=new Kt,z.layers.enable(Te),z.viewport=new Ke,W[Te]=z),z.matrix.fromArray(ze.transform.matrix),z.projectionMatrix.fromArray(ze.projectionMatrix),z.viewport.set(G.x,G.y,G.width,G.height),Te===0&&B.matrix.copy(z.matrix),Ce===!0&&B.cameras.push(z)}}for(let Se=0;Se<_.length;Se++){const Ce=E[Se],Te=_[Se];Ce!==null&&Te!==void 0&&Te.update(Ce,oe,d||a)}if(Pe&&Pe(fe,oe),oe.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:oe.detectedPlanes});let Se=null;for(const Ce of R)oe.detectedPlanes.has(Ce)||(Se===null&&(Se=[]),Se.push(Ce));if(Se!==null)for(const Ce of Se)R.delete(Ce),P.delete(Ce),n.dispatchEvent({type:"planeremoved",data:Ce});for(const Ce of oe.detectedPlanes)if(R.has(Ce)){const Te=P.get(Ce);Ce.lastChangedTime>Te&&(P.set(Ce,Ce.lastChangedTime),n.dispatchEvent({type:"planechanged",data:Ce}))}else R.add(Ce),P.set(Ce,oe.lastChangedTime),n.dispatchEvent({type:"planeadded",data:Ce})}S=null}),this.setAnimationLoop=function(fe){Pe=fe},this.dispose=function(){}}}function WR(l,e){function t(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,i.side===ye&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),i.side===ye&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);const s=e.get(i).envMap;if(s&&(n.envMap.value=s,n.flipEnvMap.value=s.isCubeTexture&&s.isRenderTargetTexture===!1?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;const h=l.useLegacyLights===!0?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*h}let a,c;i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?a=i.map:i.specularMap?a=i.specularMap:i.displacementMap?a=i.displacementMap:i.normalMap?a=i.normalMap:i.bumpMap?a=i.bumpMap:i.roughnessMap?a=i.roughnessMap:i.metalnessMap?a=i.metalnessMap:i.alphaMap?a=i.alphaMap:i.emissiveMap?a=i.emissiveMap:i.clearcoatMap?a=i.clearcoatMap:i.clearcoatNormalMap?a=i.clearcoatNormalMap:i.clearcoatRoughnessMap?a=i.clearcoatRoughnessMap:i.iridescenceMap?a=i.iridescenceMap:i.iridescenceThicknessMap?a=i.iridescenceThicknessMap:i.specularIntensityMap?a=i.specularIntensityMap:i.specularColorMap?a=i.specularColorMap:i.transmissionMap?a=i.transmissionMap:i.thicknessMap?a=i.thicknessMap:i.sheenColorMap?a=i.sheenColorMap:i.sheenRoughnessMap&&(a=i.sheenRoughnessMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uvTransform.value.copy(a.matrix)),i.aoMap?c=i.aoMap:i.lightMap&&(c=i.lightMap),c!==void 0&&(c.isWebGLRenderTarget&&(c=c.texture),c.matrixAutoUpdate===!0&&c.updateMatrix(),n.uv2Transform.value.copy(c.matrix))}return{refreshFogUniforms:function(n,i){i.color.getRGB(n.fogColor.value,Px(l)),i.isFog?(n.fogNear.value=i.near,n.fogFar.value=i.far):i.isFogExp2&&(n.fogDensity.value=i.density)},refreshMaterialUniforms:function(n,i,s,a,c){i.isMeshBasicMaterial||i.isMeshLambertMaterial?t(n,i):i.isMeshToonMaterial?(t(n,i),function(h,d){d.gradientMap&&(h.gradientMap.value=d.gradientMap)}(n,i)):i.isMeshPhongMaterial?(t(n,i),function(h,d){h.specular.value.copy(d.specular),h.shininess.value=Math.max(d.shininess,1e-4)}(n,i)):i.isMeshStandardMaterial?(t(n,i),function(h,d){h.roughness.value=d.roughness,h.metalness.value=d.metalness,d.roughnessMap&&(h.roughnessMap.value=d.roughnessMap),d.metalnessMap&&(h.metalnessMap.value=d.metalnessMap),e.get(d).envMap&&(h.envMapIntensity.value=d.envMapIntensity)}(n,i),i.isMeshPhysicalMaterial&&function(h,d,f){h.ior.value=d.ior,d.sheen>0&&(h.sheenColor.value.copy(d.sheenColor).multiplyScalar(d.sheen),h.sheenRoughness.value=d.sheenRoughness,d.sheenColorMap&&(h.sheenColorMap.value=d.sheenColorMap),d.sheenRoughnessMap&&(h.sheenRoughnessMap.value=d.sheenRoughnessMap)),d.clearcoat>0&&(h.clearcoat.value=d.clearcoat,h.clearcoatRoughness.value=d.clearcoatRoughness,d.clearcoatMap&&(h.clearcoatMap.value=d.clearcoatMap),d.clearcoatRoughnessMap&&(h.clearcoatRoughnessMap.value=d.clearcoatRoughnessMap),d.clearcoatNormalMap&&(h.clearcoatNormalScale.value.copy(d.clearcoatNormalScale),h.clearcoatNormalMap.value=d.clearcoatNormalMap,d.side===ye&&h.clearcoatNormalScale.value.negate())),d.iridescence>0&&(h.iridescence.value=d.iridescence,h.iridescenceIOR.value=d.iridescenceIOR,h.iridescenceThicknessMinimum.value=d.iridescenceThicknessRange[0],h.iridescenceThicknessMaximum.value=d.iridescenceThicknessRange[1],d.iridescenceMap&&(h.iridescenceMap.value=d.iridescenceMap),d.iridescenceThicknessMap&&(h.iridescenceThicknessMap.value=d.iridescenceThicknessMap)),d.transmission>0&&(h.transmission.value=d.transmission,h.transmissionSamplerMap.value=f.texture,h.transmissionSamplerSize.value.set(f.width,f.height),d.transmissionMap&&(h.transmissionMap.value=d.transmissionMap),h.thickness.value=d.thickness,d.thicknessMap&&(h.thicknessMap.value=d.thicknessMap),h.attenuationDistance.value=d.attenuationDistance,h.attenuationColor.value.copy(d.attenuationColor)),h.specularIntensity.value=d.specularIntensity,h.specularColor.value.copy(d.specularColor),d.specularIntensityMap&&(h.specularIntensityMap.value=d.specularIntensityMap),d.specularColorMap&&(h.specularColorMap.value=d.specularColorMap)}(n,i,c)):i.isMeshMatcapMaterial?(t(n,i),function(h,d){d.matcap&&(h.matcap.value=d.matcap)}(n,i)):i.isMeshDepthMaterial?t(n,i):i.isMeshDistanceMaterial?(t(n,i),function(h,d){h.referencePosition.value.copy(d.referencePosition),h.nearDistance.value=d.nearDistance,h.farDistance.value=d.farDistance}(n,i)):i.isMeshNormalMaterial?t(n,i):i.isLineBasicMaterial?(function(h,d){h.diffuse.value.copy(d.color),h.opacity.value=d.opacity}(n,i),i.isLineDashedMaterial&&function(h,d){h.dashSize.value=d.dashSize,h.totalSize.value=d.dashSize+d.gapSize,h.scale.value=d.scale}(n,i)):i.isPointsMaterial?function(h,d,f,m){h.diffuse.value.copy(d.color),h.opacity.value=d.opacity,h.size.value=d.size*f,h.scale.value=.5*m,d.map&&(h.map.value=d.map),d.alphaMap&&(h.alphaMap.value=d.alphaMap),d.alphaTest>0&&(h.alphaTest.value=d.alphaTest);let g;d.map?g=d.map:d.alphaMap&&(g=d.alphaMap),g!==void 0&&(g.matrixAutoUpdate===!0&&g.updateMatrix(),h.uvTransform.value.copy(g.matrix))}(n,i,s,a):i.isSpriteMaterial?function(h,d){h.diffuse.value.copy(d.color),h.opacity.value=d.opacity,h.rotation.value=d.rotation,d.map&&(h.map.value=d.map),d.alphaMap&&(h.alphaMap.value=d.alphaMap),d.alphaTest>0&&(h.alphaTest.value=d.alphaTest);let f;d.map?f=d.map:d.alphaMap&&(f=d.alphaMap),f!==void 0&&(f.matrixAutoUpdate===!0&&f.updateMatrix(),h.uvTransform.value.copy(f.matrix))}(n,i):i.isShadowMaterial?(n.color.value.copy(i.color),n.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function XR(l,e,t,n){let i={},s={},a=[];const c=t.isWebGL2?l.getParameter(l.MAX_UNIFORM_BUFFER_BINDINGS):0;function h(m,g,y){const S=m.value;if(y[g]===void 0){if(typeof S=="number")y[g]=S;else{const x=Array.isArray(S)?S:[S],w=[];for(let T=0;T<x.length;T++)w.push(x[T].clone());y[g]=w}return!0}if(typeof S=="number"){if(y[g]!==S)return y[g]=S,!0}else{const x=Array.isArray(y[g])?y[g]:[y[g]],w=Array.isArray(S)?S:[S];for(let T=0;T<x.length;T++){const _=x[T];if(_.equals(w[T])===!1)return _.copy(w[T]),!0}}return!1}function d(m){const g={boundary:0,storage:0};return typeof m=="number"?(g.boundary=4,g.storage=4):m.isVector2?(g.boundary=8,g.storage=8):m.isVector3||m.isColor?(g.boundary=16,g.storage=12):m.isVector4?(g.boundary=16,g.storage=16):m.isMatrix3?(g.boundary=48,g.storage=48):m.isMatrix4?(g.boundary=64,g.storage=64):m.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",m),g}function f(m){const g=m.target;g.removeEventListener("dispose",f);const y=a.indexOf(g.__bindingPointIndex);a.splice(y,1),l.deleteBuffer(i[g.id]),delete i[g.id],delete s[g.id]}return{bind:function(m,g){const y=g.program;n.uniformBlockBinding(m,y)},update:function(m,g){let y=i[m.id];y===void 0&&(function(w){const T=w.uniforms;let _=0;const E=16;let R=0;for(let P=0,C=T.length;P<C;P++){const F=T[P],W={boundary:0,storage:0},B=Array.isArray(F.value)?F.value:[F.value];for(let V=0,U=B.length;V<U;V++){const te=d(B[V]);W.boundary+=te.boundary,W.storage+=te.storage}F.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=_,P>0&&(R=_%E,R!==0&&E-R-W.boundary<0&&(_+=E-R,F.__offset=_)),_+=W.storage}R=_%E,R>0&&(_+=E-R),w.__size=_,w.__cache={}}(m),y=function(w){const T=function(){for(let P=0;P<c;P++)if(a.indexOf(P)===-1)return a.push(P),P;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();w.__bindingPointIndex=T;const _=l.createBuffer(),E=w.__size,R=w.usage;return l.bindBuffer(l.UNIFORM_BUFFER,_),l.bufferData(l.UNIFORM_BUFFER,E,R),l.bindBuffer(l.UNIFORM_BUFFER,null),l.bindBufferBase(l.UNIFORM_BUFFER,T,_),_}(m),i[m.id]=y,m.addEventListener("dispose",f));const S=g.program;n.updateUBOMapping(m,S);const x=e.render.frame;s[m.id]!==x&&(function(w){const T=i[w.id],_=w.uniforms,E=w.__cache;l.bindBuffer(l.UNIFORM_BUFFER,T);for(let R=0,P=_.length;R<P;R++){const C=_[R];if(h(C,R,E)===!0){const F=C.__offset,W=Array.isArray(C.value)?C.value:[C.value];let B=0;for(let V=0;V<W.length;V++){const U=W[V],te=d(U);typeof U=="number"?(C.__data[0]=U,l.bufferSubData(l.UNIFORM_BUFFER,F+B,C.__data)):U.isMatrix3?(C.__data[0]=U.elements[0],C.__data[1]=U.elements[1],C.__data[2]=U.elements[2],C.__data[3]=U.elements[0],C.__data[4]=U.elements[3],C.__data[5]=U.elements[4],C.__data[6]=U.elements[5],C.__data[7]=U.elements[0],C.__data[8]=U.elements[6],C.__data[9]=U.elements[7],C.__data[10]=U.elements[8],C.__data[11]=U.elements[0]):(U.toArray(C.__data,B),B+=te.storage/Float32Array.BYTES_PER_ELEMENT)}l.bufferSubData(l.UNIFORM_BUFFER,F,C.__data)}}l.bindBuffer(l.UNIFORM_BUFFER,null)}(m),s[m.id]=x)},dispose:function(){for(const m in i)l.deleteBuffer(i[m]);a=[],i={},s={}}}}function nd(l={}){this.isWebGLRenderer=!0;const e=l.canvas!==void 0?l.canvas:function(){const Y=Tc("canvas");return Y.style.display="block",Y}(),t=l.context!==void 0?l.context:null,n=l.depth===void 0||l.depth,i=l.stencil===void 0||l.stencil,s=l.antialias!==void 0&&l.antialias,a=l.premultipliedAlpha===void 0||l.premultipliedAlpha,c=l.preserveDrawingBuffer!==void 0&&l.preserveDrawingBuffer,h=l.powerPreference!==void 0?l.powerPreference:"default",d=l.failIfMajorPerformanceCaveat!==void 0&&l.failIfMajorPerformanceCaveat;let f;f=t!==null?t.getContextAttributes().alpha:l.alpha!==void 0&&l.alpha;let m=null,g=null;const y=[],S=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ur,this.useLegacyLights=!0,this.toneMapping=Or,this.toneMappingExposure=1;const x=this;let w=!1,T=0,_=0,E=null,R=-1,P=null;const C=new Ke,F=new Ke;let W=null,B=e.width,V=e.height,U=1,te=null,ue=null;const ce=new Ke(0,0,B,V),we=new Ke(0,0,B,V);let ve=!1;const Re=new Nc;let Pe=!1,De=!1,fe=null;const oe=new Ne,Se=new O,Ce={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Te(){return E===null?U:1}let ze,G,z,le,Z,H,ee,I,q,K,re,ae,ge,Fe,je,qe,He,rt,ut,nt,vt,Dt,Je,Ot,pe=t;function ra(Y,_e){for(let Le=0;Le<Y.length;Le++){const Ae=Y[Le],Oe=e.getContext(Ae,_e);if(Oe!==null)return Oe}return null}try{const Y={alpha:!0,depth:n,stencil:i,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:d};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${ie}`),e.addEventListener("webglcontextlost",O_,!1),e.addEventListener("webglcontextrestored",I_,!1),e.addEventListener("webglcontextcreationerror",N_,!1),pe===null){const _e=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&_e.shift(),pe=ra(_e,Y),pe===null)throw ra(_e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}pe.getShaderPrecisionFormat===void 0&&(pe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Y){throw console.error("THREE.WebGLRenderer: "+Y.message),Y}function sa(){ze=new wA(pe),G=new yA(pe,ze,l),ze.init(G),Dt=new sb(pe,ze,G),z=new jR(pe,ze,G),le=new TA(pe),Z=new PR,H=new HR(pe,ze,z,Z,G,Dt,le),ee=new bA(x),I=new SA(x),q=new fA(pe,G),Je=new gA(pe,ze,q,G),K=new _A(pe,q,le,Je),re=new LA(pe,K,q,le),ut=new RA(pe,G,H),qe=new xA(Z),ae=new LR(x,ee,I,ze,G,Je,qe),ge=new WR(x,Z),Fe=new DR,je=new FR(ze,G),rt=new mA(x,ee,I,z,re,f,a),He=new BR(x,re,G),Ot=new XR(pe,le,G,z),nt=new vA(pe,ze,le,G),vt=new MA(pe,ze,le,G),le.programs=ae.programs,x.capabilities=G,x.extensions=ze,x.properties=Z,x.renderLists=Fe,x.shadowMap=He,x.state=z,x.info=le}sa();const Ui=new VR(x,pe);function O_(Y){Y.preventDefault(),w=!0}function I_(){w=!1;const Y=le.autoReset,_e=He.enabled,Le=He.autoUpdate,Ae=He.needsUpdate,Oe=He.type;sa(),le.autoReset=Y,He.enabled=_e,He.autoUpdate=Le,He.needsUpdate=Ae,He.type=Oe}function N_(Y){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Y.statusMessage)}function k_(Y){const _e=Y.target;_e.removeEventListener("dispose",k_),function(Le){(function(Ae){const Oe=Z.get(Ae).programs;Oe!==void 0&&(Oe.forEach(function(Ze){ae.releaseProgram(Ze)}),Ae.isShaderMaterial&&ae.releaseShaderCache(Ae))})(Le),Z.remove(Le)}(_e)}this.xr=Ui,this.getContext=function(){return pe},this.getContextAttributes=function(){return pe.getContextAttributes()},this.forceContextLoss=function(){const Y=ze.get("WEBGL_lose_context");Y&&Y.loseContext()},this.forceContextRestore=function(){const Y=ze.get("WEBGL_lose_context");Y&&Y.restoreContext()},this.getPixelRatio=function(){return U},this.setPixelRatio=function(Y){Y!==void 0&&(U=Y,this.setSize(B,V,!1))},this.getSize=function(Y){return Y.set(B,V)},this.setSize=function(Y,_e,Le=!0){Ui.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(B=Y,V=_e,e.width=Math.floor(Y*U),e.height=Math.floor(_e*U),Le===!0&&(e.style.width=Y+"px",e.style.height=_e+"px"),this.setViewport(0,0,Y,_e))},this.getDrawingBufferSize=function(Y){return Y.set(B*U,V*U).floor()},this.setDrawingBufferSize=function(Y,_e,Le){B=Y,V=_e,U=Le,e.width=Math.floor(Y*Le),e.height=Math.floor(_e*Le),this.setViewport(0,0,Y,_e)},this.getCurrentViewport=function(Y){return Y.copy(C)},this.getViewport=function(Y){return Y.copy(ce)},this.setViewport=function(Y,_e,Le,Ae){Y.isVector4?ce.set(Y.x,Y.y,Y.z,Y.w):ce.set(Y,_e,Le,Ae),z.viewport(C.copy(ce).multiplyScalar(U).floor())},this.getScissor=function(Y){return Y.copy(we)},this.setScissor=function(Y,_e,Le,Ae){Y.isVector4?we.set(Y.x,Y.y,Y.z,Y.w):we.set(Y,_e,Le,Ae),z.scissor(F.copy(we).multiplyScalar(U).floor())},this.getScissorTest=function(){return ve},this.setScissorTest=function(Y){z.setScissorTest(ve=Y)},this.setOpaqueSort=function(Y){te=Y},this.setTransparentSort=function(Y){ue=Y},this.getClearColor=function(Y){return Y.copy(rt.getClearColor())},this.setClearColor=function(){rt.setClearColor.apply(rt,arguments)},this.getClearAlpha=function(){return rt.getClearAlpha()},this.setClearAlpha=function(){rt.setClearAlpha.apply(rt,arguments)},this.clear=function(Y=!0,_e=!0,Le=!0){let Ae=0;Y&&(Ae|=pe.COLOR_BUFFER_BIT),_e&&(Ae|=pe.DEPTH_BUFFER_BIT),Le&&(Ae|=pe.STENCIL_BUFFER_BIT),pe.clear(Ae)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",O_,!1),e.removeEventListener("webglcontextrestored",I_,!1),e.removeEventListener("webglcontextcreationerror",N_,!1),Fe.dispose(),je.dispose(),Z.dispose(),ee.dispose(),I.dispose(),re.dispose(),Je.dispose(),Ot.dispose(),ae.dispose(),Ui.dispose(),Ui.removeEventListener("sessionstart",F_),Ui.removeEventListener("sessionend",U_),fe&&(fe.dispose(),fe=null),vo.stop()},this.renderBufferDirect=function(Y,_e,Le,Ae,Oe,Ze){_e===null&&(_e=Ce);const ft=Oe.isMesh&&Oe.matrixWorld.determinant()<0,yt=function(zn,aa,wr,st,Tn){aa.isScene!==!0&&(aa=Ce),H.resetTextureUnits();const Wg=aa.fog,wI=st.isMeshStandardMaterial?aa.environment:null,_I=E===null?x.outputEncoding:E.isXRRenderTarget===!0?E.texture.encoding:ur,up=(st.isMeshStandardMaterial?I:ee).get(st.envMap||wI),MI=st.vertexColors===!0&&!!wr.attributes.color&&wr.attributes.color.itemSize===4,TI=!!st.normalMap&&!!wr.attributes.tangent,EI=!!wr.morphAttributes.position,AI=!!wr.morphAttributes.normal,RI=!!wr.morphAttributes.color,LI=st.toneMapped?x.toneMapping:Or,H_=wr.morphAttributes.position||wr.morphAttributes.normal||wr.morphAttributes.color,PI=H_!==void 0?H_.length:0,kt=Z.get(st),CI=g.state.lights;if(Pe===!0&&(De===!0||zn!==P)){const Ht=zn===P&&st.id===R;qe.setState(st,zn,Ht)}let xs=!1;st.version===kt.__version?kt.needsLights&&kt.lightsStateVersion!==CI.state.version||kt.outputEncoding!==_I||Tn.isInstancedMesh&&kt.instancing===!1?xs=!0:Tn.isInstancedMesh||kt.instancing!==!0?Tn.isSkinnedMesh&&kt.skinning===!1?xs=!0:Tn.isSkinnedMesh||kt.skinning!==!0?kt.envMap!==up||st.fog===!0&&kt.fog!==Wg?xs=!0:kt.numClippingPlanes===void 0||kt.numClippingPlanes===qe.numPlanes&&kt.numIntersection===qe.numIntersection?(kt.vertexAlphas!==MI||kt.vertexTangents!==TI||kt.morphTargets!==EI||kt.morphNormals!==AI||kt.morphColors!==RI||kt.toneMapping!==LI||G.isWebGL2===!0&&kt.morphTargetsCount!==PI)&&(xs=!0):xs=!0:xs=!0:xs=!0:(xs=!0,kt.__version=st.version);let yo=kt.currentProgram;xs===!0&&(yo=lp(st,aa,Tn));let G_=!1,yu=!1,Xg=!1;const Bn=yo.getUniforms(),xo=kt.uniforms;if(z.useProgram(yo.program)&&(G_=!0,yu=!0,Xg=!0),st.id!==R&&(R=st.id,yu=!0),G_||P!==zn){if(Bn.setValue(pe,"projectionMatrix",zn.projectionMatrix),G.logarithmicDepthBuffer&&Bn.setValue(pe,"logDepthBufFC",2/(Math.log(zn.far+1)/Math.LN2)),P!==zn&&(P=zn,yu=!0,Xg=!0),st.isShaderMaterial||st.isMeshPhongMaterial||st.isMeshToonMaterial||st.isMeshStandardMaterial||st.envMap){const Ht=Bn.map.cameraPosition;Ht!==void 0&&Ht.setValue(pe,Se.setFromMatrixPosition(zn.matrixWorld))}(st.isMeshPhongMaterial||st.isMeshToonMaterial||st.isMeshLambertMaterial||st.isMeshBasicMaterial||st.isMeshStandardMaterial||st.isShaderMaterial)&&Bn.setValue(pe,"isOrthographic",zn.isOrthographicCamera===!0),(st.isMeshPhongMaterial||st.isMeshToonMaterial||st.isMeshLambertMaterial||st.isMeshBasicMaterial||st.isMeshStandardMaterial||st.isShaderMaterial||st.isShadowMaterial||Tn.isSkinnedMesh)&&Bn.setValue(pe,"viewMatrix",zn.matrixWorldInverse)}if(Tn.isSkinnedMesh){Bn.setOptional(pe,Tn,"bindMatrix"),Bn.setOptional(pe,Tn,"bindMatrixInverse");const Ht=Tn.skeleton;Ht&&(G.floatVertexTextures?(Ht.boneTexture===null&&Ht.computeBoneTexture(),Bn.setValue(pe,"boneTexture",Ht.boneTexture,H),Bn.setValue(pe,"boneTextureSize",Ht.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const qg=wr.morphAttributes;(qg.position!==void 0||qg.normal!==void 0||qg.color!==void 0&&G.isWebGL2===!0)&&ut.update(Tn,wr,yo),(yu||kt.receiveShadow!==Tn.receiveShadow)&&(kt.receiveShadow=Tn.receiveShadow,Bn.setValue(pe,"receiveShadow",Tn.receiveShadow)),st.isMeshGouraudMaterial&&st.envMap!==null&&(xo.envMap.value=up,xo.flipEnvMap.value=up.isCubeTexture&&up.isRenderTargetTexture===!1?-1:1),yu&&(Bn.setValue(pe,"toneMappingExposure",x.toneMappingExposure),kt.needsLights&&function(Ht,Mi){Ht.ambientLightColor.needsUpdate=Mi,Ht.lightProbe.needsUpdate=Mi,Ht.directionalLights.needsUpdate=Mi,Ht.directionalLightShadows.needsUpdate=Mi,Ht.pointLights.needsUpdate=Mi,Ht.pointLightShadows.needsUpdate=Mi,Ht.spotLights.needsUpdate=Mi,Ht.spotLightShadows.needsUpdate=Mi,Ht.rectAreaLights.needsUpdate=Mi,Ht.hemisphereLights.needsUpdate=Mi}(xo,Xg),Wg&&st.fog===!0&&ge.refreshFogUniforms(xo,Wg),ge.refreshMaterialUniforms(xo,st,U,V,fe),ed.upload(pe,kt.uniformsList,xo,H)),st.isShaderMaterial&&st.uniformsNeedUpdate===!0&&(ed.upload(pe,kt.uniformsList,xo,H),st.uniformsNeedUpdate=!1),st.isSpriteMaterial&&Bn.setValue(pe,"center",Tn.center),Bn.setValue(pe,"modelViewMatrix",Tn.modelViewMatrix),Bn.setValue(pe,"normalMatrix",Tn.normalMatrix),Bn.setValue(pe,"modelMatrix",Tn.matrixWorld),Bn.setValue(pe,"envRotationMatrix",aa.envRotationMatrix);const V_=Tn.uniforms;for(let Ht in V_)Bn.setValue(pe,Ht,V_[Ht]);if(st.isShaderMaterial||st.isRawShaderMaterial){const Ht=st.uniformsGroups;for(let Mi=0,DI=Ht.length;Mi<DI;Mi++)if(G.isWebGL2){const W_=Ht[Mi];Ot.update(W_,yo),Ot.bind(W_,yo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return yo}(Y,_e,Le,Ae,Oe);z.setMaterial(Ae,ft);let Et=Le.index,jt=1;Ae.wireframe===!0&&(Et=K.getWireframeAttribute(Le),jt=2);const Ct=Le.drawRange,_t=Le.attributes.position;let $n=Ct.start*jt,Sr=(Ct.start+Ct.count)*jt;Ze!==null&&($n=Math.max($n,Ze.start*jt),Sr=Math.min(Sr,(Ze.start+Ze.count)*jt)),Et!==null?($n=Math.max($n,0),Sr=Math.min(Sr,Et.count)):_t!=null&&($n=Math.max($n,0),Sr=Math.min(Sr,_t.count));const di=Sr-$n;if(di<0||di===1/0)return;let cp;Je.setup(Oe,Ae,yt,Le,Et);let In=nt;if(Et!==null&&(cp=q.get(Et),In=vt,In.setIndex(cp)),Oe.isMesh)Ae.wireframe===!0?(z.setLineWidth(Ae.wireframeLinewidth*Te()),In.setMode(pe.LINES)):In.setMode(pe.TRIANGLES);else if(Oe.isLine){let zn=Ae.linewidth;zn===void 0&&(zn=1),z.setLineWidth(zn*Te()),Oe.isLineSegments?In.setMode(pe.LINES):Oe.isLineLoop?In.setMode(pe.LINE_LOOP):In.setMode(pe.LINE_STRIP)}else Oe.isPoints?In.setMode(pe.POINTS):Oe.isSprite&&In.setMode(pe.TRIANGLES);if(Oe.isInstancedMesh)In.renderInstances($n,di,Oe.count);else if(Le.isInstancedBufferGeometry){const zn=Le._maxInstanceCount!==void 0?Le._maxInstanceCount:1/0,aa=Math.min(Le.instanceCount,zn);In.renderInstances($n,di,aa)}else In.render($n,di)},this.compile=function(Y,_e){function Le(Ae,Oe,Ze){Ae.transparent===!0&&Ae.side===Me&&Ae.forceSinglePass===!1?(Ae.side=ye,Ae.needsUpdate=!0,lp(Ae,Oe,Ze),Ae.side=se,Ae.needsUpdate=!0,lp(Ae,Oe,Ze),Ae.side=Me):lp(Ae,Oe,Ze)}g=je.get(Y),g.init(),S.push(g),Y.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(_e.layers)&&(g.pushLight(Ae),Ae.castShadow&&g.pushShadow(Ae))}),g.setupLights(x.useLegacyLights),Y.traverse(function(Ae){const Oe=Ae.material;if(Oe)if(Array.isArray(Oe))for(let Ze=0;Ze<Oe.length;Ze++)Le(Oe[Ze],Y,Ae);else Le(Oe,Y,Ae)}),S.pop(),g=null};let Vg=null;function F_(){vo.stop()}function U_(){vo.start()}const vo=new Ox;function z_(Y,_e,Le,Ae){if(Y.visible===!1)return;if(Y.layers.test(_e.layers)){if(Y.isGroup)Le=Y.renderOrder;else if(Y.isLOD)Y.autoUpdate===!0&&Y.update(_e);else if(Y.isLight)g.pushLight(Y),Y.castShadow&&g.pushShadow(Y);else if(Y.isSprite){if(!Y.frustumCulled||Re.intersectsSprite(Y)){Ae&&Se.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(oe);const Ze=re.update(Y),ft=Y.material;ft.visible&&m.push(Y,Ze,ft,Le,Se.z,null)}}else if((Y.isMesh||Y.isLine||Y.isPoints)&&(Y.isSkinnedMesh&&Y.skeleton.frame!==le.render.frame&&(Y.skeleton.update(),Y.skeleton.frame=le.render.frame),!Y.frustumCulled||Re.intersectsObject(Y))){Ae&&Se.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(oe);const Ze=re.update(Y),ft=Y.material;if(Array.isArray(ft)){const yt=Ze.groups;for(let Et=0,jt=yt.length;Et<jt;Et++){const Ct=yt[Et],_t=ft[Ct.materialIndex];_t&&_t.visible&&m.push(Y,Ze,_t,Le,Se.z,Ct)}}else ft.visible&&m.push(Y,Ze,ft,Le,Se.z,null)}}const Oe=Y.children;for(let Ze=0,ft=Oe.length;Ze<ft;Ze++)z_(Oe[Ze],_e,Le,Ae)}function B_(Y,_e,Le,Ae){const Oe=Y.opaque,Ze=Y.transmissive,ft=Y.transparent;g.setupLightsView(Le),Pe===!0&&qe.setGlobalState(x.clippingPlanes,Le),Ze.length>0&&function(yt,Et,jt){const Ct=G.isWebGL2;fe===null&&(fe=new Lt(1024,1024,{generateMipmaps:!0,type:ze.has("EXT_color_buffer_half_float")?yi:Sn,minFilter:cr,samples:Ct&&s===!0?4:0}));const _t=x.getRenderTarget();x.setRenderTarget(fe),x.clear();const $n=x.toneMapping;x.toneMapping=Or,op(yt,Et,jt),x.toneMapping=$n,H.updateMultisampleRenderTarget(fe),H.updateRenderTargetMipmap(fe),x.setRenderTarget(_t)}(Oe,_e,Le),Ae&&z.viewport(C.copy(Ae)),Oe.length>0&&op(Oe,_e,Le),Ze.length>0&&op(Ze,_e,Le),ft.length>0&&op(ft,_e,Le),z.buffers.depth.setTest(!0),z.buffers.depth.setMask(!0),z.buffers.color.setMask(!0),z.setPolygonOffset(!1)}function op(Y,_e,Le){const Ae=_e.isScene===!0?_e.overrideMaterial:null;for(let Oe=0,Ze=Y.length;Oe<Ze;Oe++){const ft=Y[Oe],yt=ft.object,Et=ft.geometry,jt=Ae===null?ft.material:Ae,Ct=ft.group;yt.layers.test(Le.layers)&&SI(yt,_e,Le,Et,jt,Ct)}}function SI(Y,_e,Le,Ae,Oe,Ze){Y.onBeforeRender(x,_e,Le,Ae,Oe,Ze),Y.modelViewMatrix.multiplyMatrices(Le.matrixWorldInverse,Y.matrixWorld),Y.normalMatrix.getNormalMatrix(Y.modelViewMatrix),Oe.onBeforeRender(x,_e,Le,Ae,Y,Ze),Oe.transparent===!0&&Oe.side===Me&&Oe.forceSinglePass===!1?(Oe.side=ye,Oe.needsUpdate=!0,x.renderBufferDirect(Le,_e,Ae,Oe,Y,Ze),Oe.side=se,Oe.needsUpdate=!0,x.renderBufferDirect(Le,_e,Ae,Oe,Y,Ze),Oe.side=Me):x.renderBufferDirect(Le,_e,Ae,Oe,Y,Ze),Y.onAfterRender(x,_e,Le,Ae,Oe,Ze)}function lp(Y,_e,Le){_e.isScene!==!0&&(_e=Ce);const Ae=Z.get(Y),Oe=g.state.lights,Ze=g.state.shadowsArray,ft=Oe.state.version,yt=ae.getParameters(Y,Oe.state,Ze,_e,Le),Et=ae.getProgramCacheKey(yt);let jt=Ae.programs;Ae.environment=Y.isMeshStandardMaterial?_e.environment:null,Ae.fog=_e.fog,Ae.envMap=(Y.isMeshStandardMaterial?I:ee).get(Y.envMap||Ae.environment),jt===void 0&&(Y.addEventListener("dispose",k_),jt=new Map,Ae.programs=jt);let Ct=jt.get(Et);if(Ct!==void 0){if(Ae.currentProgram===Ct&&Ae.lightsStateVersion===ft)return j_(Y,yt),Ct}else yt.uniforms=ae.getUniforms(Y),Y.onBuild(Le,yt,x),Y.onBeforeCompile(yt,x),Ct=ae.acquireProgram(yt,Et),jt.set(Et,Ct),Ae.uniforms=yt.uniforms;const _t=Ae.uniforms;(Y.isShaderMaterial||Y.isRawShaderMaterial)&&Y.clipping!==!0||(_t.clippingPlanes=qe.uniform),j_(Y,yt),Ae.needsLights=function(di){return di.isMeshLambertMaterial||di.isMeshToonMaterial||di.isMeshPhongMaterial||di.isMeshStandardMaterial||di.isShadowMaterial||di.isShaderMaterial&&di.lights===!0}(Y),Ae.lightsStateVersion=ft,Ae.needsLights&&(_t.ambientLightColor.value=Oe.state.ambient,_t.lightProbe.value=Oe.state.probe,_t.directionalLights.value=Oe.state.directional,_t.directionalLightShadows.value=Oe.state.directionalShadow,_t.spotLights.value=Oe.state.spot,_t.spotLightShadows.value=Oe.state.spotShadow,_t.rectAreaLights.value=Oe.state.rectArea,_t.ltc_1.value=Oe.state.rectAreaLTC1,_t.ltc_2.value=Oe.state.rectAreaLTC2,_t.pointLights.value=Oe.state.point,_t.pointLightShadows.value=Oe.state.pointShadow,_t.hemisphereLights.value=Oe.state.hemi,_t.directionalShadowMap.value=Oe.state.directionalShadowMap,_t.directionalShadowMatrix.value=Oe.state.directionalShadowMatrix,_t.spotShadowMap.value=Oe.state.spotShadowMap,_t.spotLightMatrix.value=Oe.state.spotLightMatrix,_t.spotLightMap.value=Oe.state.spotLightMap,_t.pointShadowMap.value=Oe.state.pointShadowMap,_t.pointShadowMatrix.value=Oe.state.pointShadowMatrix);const $n=Ct.getUniforms(),Sr=ed.seqWithValue($n.seq,_t);return Ae.currentProgram=Ct,Ae.uniformsList=Sr,Ct}function j_(Y,_e){const Le=Z.get(Y);Le.outputEncoding=_e.outputEncoding,Le.instancing=_e.instancing,Le.skinning=_e.skinning,Le.morphTargets=_e.morphTargets,Le.morphNormals=_e.morphNormals,Le.morphColors=_e.morphColors,Le.morphTargetsCount=_e.morphTargetsCount,Le.numClippingPlanes=_e.numClippingPlanes,Le.numIntersection=_e.numClipIntersection,Le.vertexAlphas=_e.vertexAlphas,Le.vertexTangents=_e.vertexTangents,Le.toneMapping=_e.toneMapping}vo.setAnimationLoop(function(Y){Vg&&Vg(Y)}),typeof self<"u"&&vo.setContext(self),this.setAnimationLoop=function(Y){Vg=Y,Ui.setAnimationLoop(Y),Y===null?vo.stop():vo.start()},Ui.addEventListener("sessionstart",F_),Ui.addEventListener("sessionend",U_),this.render=function(Y,_e){if(_e!==void 0&&_e.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(w===!0)return;Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),_e.parent===null&&_e.matrixWorldAutoUpdate===!0&&_e.updateMatrixWorld(),Ui.enabled===!0&&Ui.isPresenting===!0&&(Ui.cameraAutoUpdate===!0&&Ui.updateCamera(_e),_e=Ui.getCamera()),Y.isScene===!0&&Y.onBeforeRender(x,Y,_e,E),g=je.get(Y,S.length),g.init(),S.push(g),oe.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),Re.setFromProjectionMatrix(oe),De=this.localClippingEnabled,Pe=qe.init(this.clippingPlanes,De),m=Fe.get(Y,y.length),m.init(),y.push(m),z_(Y,_e,0,x.sortObjects),m.finish(),x.sortObjects===!0&&m.sort(te,ue),Pe===!0&&qe.beginShadows();const Le=g.state.shadowsArray;if(He.render(Le,Y,_e),Pe===!0&&qe.endShadows(),this.info.autoReset===!0&&this.info.reset(),rt.render(m,Y),g.setupLights(x.useLegacyLights),_e.isArrayCamera){const Ae=_e.cameras;for(let Oe=0,Ze=Ae.length;Oe<Ze;Oe++){const ft=Ae[Oe];B_(m,Y,ft,ft.viewport)}}else B_(m,Y,_e);E!==null&&(H.updateMultisampleRenderTarget(E),H.updateRenderTargetMipmap(E)),Y.isScene===!0&&Y.onAfterRender(x,Y,_e),Je.resetDefaultState(),R=-1,P=null,S.pop(),g=S.length>0?S[S.length-1]:null,y.pop(),m=y.length>0?y[y.length-1]:null},this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return E},this.setRenderTargetTextures=function(Y,_e,Le){Z.get(Y.texture).__webglTexture=_e,Z.get(Y.depthTexture).__webglTexture=Le;const Ae=Z.get(Y);Ae.__hasExternalTextures=!0,Ae.__hasExternalTextures&&(Ae.__autoAllocateDepthBuffer=Le===void 0,Ae.__autoAllocateDepthBuffer||ze.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ae.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Y,_e){const Le=Z.get(Y);Le.__webglFramebuffer=_e,Le.__useDefaultFramebuffer=_e===void 0},this.setRenderTarget=function(Y,_e=0,Le=0){E=Y,T=_e,_=Le;let Ae=!0,Oe=null,Ze=!1,ft=!1;if(Y){const yt=Z.get(Y);yt.__useDefaultFramebuffer!==void 0?(z.bindFramebuffer(pe.FRAMEBUFFER,null),Ae=!1):yt.__webglFramebuffer===void 0?H.setupRenderTarget(Y):yt.__hasExternalTextures&&H.rebindTextures(Y,Z.get(Y.texture).__webglTexture,Z.get(Y.depthTexture).__webglTexture);const Et=Y.texture;(Et.isData3DTexture||Et.isDataArrayTexture||Et.isCompressedArrayTexture)&&(ft=!0);const jt=Z.get(Y).__webglFramebuffer;Y.isWebGLCubeRenderTarget?(Oe=jt[_e],Ze=!0):Oe=G.isWebGL2&&Y.samples>0&&H.useMultisampledRTT(Y)===!1?Z.get(Y).__webglMultisampledFramebuffer:jt,C.copy(Y.viewport),F.copy(Y.scissor),W=Y.scissorTest}else C.copy(ce).multiplyScalar(U).floor(),F.copy(we).multiplyScalar(U).floor(),W=ve;if(z.bindFramebuffer(pe.FRAMEBUFFER,Oe)&&G.drawBuffers&&Ae&&z.drawBuffers(Y,Oe),z.viewport(C),z.scissor(F),z.setScissorTest(W),Ze){const yt=Z.get(Y.texture);pe.framebufferTexture2D(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_CUBE_MAP_POSITIVE_X+_e,yt.__webglTexture,Le)}else if(ft){const yt=Z.get(Y.texture),Et=_e||0;pe.framebufferTextureLayer(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,yt.__webglTexture,Le||0,Et)}R=-1},this.readRenderTargetPixels=function(Y,_e,Le,Ae,Oe,Ze,ft){if(!Y||!Y.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let yt=Z.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&ft!==void 0&&(yt=yt[ft]),yt){z.bindFramebuffer(pe.FRAMEBUFFER,yt);try{const Et=Y.texture,jt=Et.format,Ct=Et.type;if(jt!==oi&&Dt.convert(jt)!==pe.getParameter(pe.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const _t=Ct===yi&&(ze.has("EXT_color_buffer_half_float")||G.isWebGL2&&ze.has("EXT_color_buffer_float"));if(!(Ct===Sn||Dt.convert(Ct)===pe.getParameter(pe.IMPLEMENTATION_COLOR_READ_TYPE)||Ct===Ci&&(G.isWebGL2||ze.has("OES_texture_float")||ze.has("WEBGL_color_buffer_float"))||_t))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");_e>=0&&_e<=Y.width-Ae&&Le>=0&&Le<=Y.height-Oe&&pe.readPixels(_e,Le,Ae,Oe,Dt.convert(jt),Dt.convert(Ct),Ze)}finally{const Et=E!==null?Z.get(E).__webglFramebuffer:null;z.bindFramebuffer(pe.FRAMEBUFFER,Et)}}},this.copyFramebufferToTexture=function(Y,_e,Le=0){const Ae=Math.pow(2,-Le),Oe=Math.floor(_e.image.width*Ae),Ze=Math.floor(_e.image.height*Ae);H.setTexture2D(_e,0),pe.copyTexSubImage2D(pe.TEXTURE_2D,Le,0,0,Y.x,Y.y,Oe,Ze),z.unbindTexture()},this.copyTextureToTexture=function(Y,_e,Le,Ae=0){const Oe=_e.image.width,Ze=_e.image.height,ft=Dt.convert(Le.format),yt=Dt.convert(Le.type);H.setTexture2D(Le,0),pe.pixelStorei(pe.UNPACK_FLIP_Y_WEBGL,Le.flipY),pe.pixelStorei(pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Le.premultiplyAlpha),pe.pixelStorei(pe.UNPACK_ALIGNMENT,Le.unpackAlignment),_e.isDataTexture?pe.texSubImage2D(pe.TEXTURE_2D,Ae,Y.x,Y.y,Oe,Ze,ft,yt,_e.image.data):_e.isCompressedTexture?pe.compressedTexSubImage2D(pe.TEXTURE_2D,Ae,Y.x,Y.y,_e.mipmaps[0].width,_e.mipmaps[0].height,ft,_e.mipmaps[0].data):pe.texSubImage2D(pe.TEXTURE_2D,Ae,Y.x,Y.y,ft,yt,_e.image),Ae===0&&Le.generateMipmaps&&pe.generateMipmap(pe.TEXTURE_2D),z.unbindTexture()},this.copyTextureToTexture3D=function(Y,_e,Le,Ae,Oe=0){if(x.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ze=Y.max.x-Y.min.x+1,ft=Y.max.y-Y.min.y+1,yt=Y.max.z-Y.min.z+1,Et=Dt.convert(Ae.format),jt=Dt.convert(Ae.type);let Ct;if(Ae.isData3DTexture)H.setTexture3D(Ae,0),Ct=pe.TEXTURE_3D;else{if(!Ae.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");H.setTexture2DArray(Ae,0),Ct=pe.TEXTURE_2D_ARRAY}pe.pixelStorei(pe.UNPACK_FLIP_Y_WEBGL,Ae.flipY),pe.pixelStorei(pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ae.premultiplyAlpha),pe.pixelStorei(pe.UNPACK_ALIGNMENT,Ae.unpackAlignment);const _t=pe.getParameter(pe.UNPACK_ROW_LENGTH),$n=pe.getParameter(pe.UNPACK_IMAGE_HEIGHT),Sr=pe.getParameter(pe.UNPACK_SKIP_PIXELS),di=pe.getParameter(pe.UNPACK_SKIP_ROWS),cp=pe.getParameter(pe.UNPACK_SKIP_IMAGES),In=Le.isCompressedTexture?Le.mipmaps[0]:Le.image;pe.pixelStorei(pe.UNPACK_ROW_LENGTH,In.width),pe.pixelStorei(pe.UNPACK_IMAGE_HEIGHT,In.height),pe.pixelStorei(pe.UNPACK_SKIP_PIXELS,Y.min.x),pe.pixelStorei(pe.UNPACK_SKIP_ROWS,Y.min.y),pe.pixelStorei(pe.UNPACK_SKIP_IMAGES,Y.min.z),Le.isDataTexture||Le.isData3DTexture?pe.texSubImage3D(Ct,Oe,_e.x,_e.y,_e.z,Ze,ft,yt,Et,jt,In.data):Le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),pe.compressedTexSubImage3D(Ct,Oe,_e.x,_e.y,_e.z,Ze,ft,yt,Et,In.data)):pe.texSubImage3D(Ct,Oe,_e.x,_e.y,_e.z,Ze,ft,yt,Et,jt,In),pe.pixelStorei(pe.UNPACK_ROW_LENGTH,_t),pe.pixelStorei(pe.UNPACK_IMAGE_HEIGHT,$n),pe.pixelStorei(pe.UNPACK_SKIP_PIXELS,Sr),pe.pixelStorei(pe.UNPACK_SKIP_ROWS,di),pe.pixelStorei(pe.UNPACK_SKIP_IMAGES,cp),Oe===0&&Ae.generateMipmaps&&pe.generateMipmap(Ct),z.unbindTexture()},this.initTexture=function(Y){Y.isCubeTexture?H.setTextureCube(Y,0):Y.isData3DTexture?H.setTexture3D(Y,0):Y.isDataArrayTexture||Y.isCompressedArrayTexture?H.setTexture2DArray(Y,0):H.setTexture2D(Y,0),z.unbindTexture()},this.resetState=function(){T=0,_=0,E=null,z.reset(),Je.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(nd.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(l){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!l}}});class ob extends nd{}ob.prototype.isWebGL1Renderer=!0;class id{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ie(e),this.density=t}clone(){return new id(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class rd{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ie(e),this.near=t,this.far=n}clone(){return new rd(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ja extends ct{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.envRotationMatrix=new mn,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.envRotationMatrix!==null&&(this.envRotationMatrix=e.envRotationMatrix.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class sl{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=wc,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Oi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Oi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Oi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ci=new O;class ui{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ci.fromBufferAttribute(this,t),ci.applyMatrix4(e),this.setXYZ(t,ci.x,ci.y,ci.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ci.fromBufferAttribute(this,t),ci.applyNormalMatrix(e),this.setXYZ(t,ci.x,ci.y,ci.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ci.fromBufferAttribute(this,t),ci.transformDirection(e),this.setXYZ(t,ci.x,ci.y,ci.z);return this}setX(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ns(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ns(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ns(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ns(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ft(t,this.array),n=Ft(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ft(t,this.array),n=Ft(n,this.array),i=Ft(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ft(t,this.array),n=Ft(n,this.array),i=Ft(i,this.array),s=Ft(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new tt(new this.array.constructor(t),this.itemSize,this.normalized)}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ui(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class c0 extends un{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ie(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let al;const zc=new O,ol=new O,ll=new O,cl=new de,Bc=new de,lb=new Ne,sd=new O,jc=new O,ad=new O,cb=new de,u0=new de,ub=new de;class hb extends ct{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",al===void 0){al=new $e;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new sl(t,5);al.setIndex([0,1,2,0,2,3]),al.setAttribute("position",new ui(n,3,0,!1)),al.setAttribute("uv",new ui(n,2,3,!1))}this.geometry=al,this.material=e!==void 0?e:new c0,this.center=new de(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ol.setFromMatrixScale(this.matrixWorld),lb.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ll.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ol.multiplyScalar(-ll.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const a=this.center;od(sd.set(-.5,-.5,0),ll,a,ol,i,s),od(jc.set(.5,-.5,0),ll,a,ol,i,s),od(ad.set(.5,.5,0),ll,a,ol,i,s),cb.set(0,0),u0.set(1,0),ub.set(1,1);let c=e.ray.intersectTriangle(sd,jc,ad,!1,zc);if(c===null&&(od(jc.set(-.5,.5,0),ll,a,ol,i,s),u0.set(0,1),c=e.ray.intersectTriangle(sd,ad,jc,!1,zc),c===null))return;const h=e.ray.origin.distanceTo(zc);h<e.near||h>e.far||t.push({distance:h,point:zc.clone(),uv:qi.getUV(zc,sd,jc,ad,cb,u0,ub,new de),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function od(l,e,t,n,i,s){cl.subVectors(l,t).addScalar(.5).multiply(n),i!==void 0?(Bc.x=s*cl.x-i*cl.y,Bc.y=i*cl.x+s*cl.y):Bc.copy(cl),l.copy(e),l.x+=Bc.x,l.y+=Bc.y,l.applyMatrix4(lb)}const ld=new O,db=new O;class pb extends ct{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ld.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(ld);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ld.setFromMatrixPosition(e.matrixWorld),db.setFromMatrixPosition(this.matrixWorld);const n=ld.distanceTo(db)/e.zoom;let i,s;for(t[0].object.visible=!0,i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),!(n>=a))break;t[i-1].object.visible=!1,t[i].object.visible=!0}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,s=n.length;i<s;i++){const a=n[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const fb=new O,mb=new Ke,gb=new Ke,qR=new O,vb=new Ne;class cd extends et{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ne,this.bindMatrixInverse=new Ne}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ke,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;mb.fromBufferAttribute(i.attributes.skinIndex,e),gb.fromBufferAttribute(i.attributes.skinWeight,e),fb.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=gb.getComponent(s);if(a!==0){const c=mb.getComponent(s);vb.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(qR.copy(fb).applyMatrix4(vb),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class ul extends ct{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Gs extends zt{constructor(e=null,t=1,n=1,i,s,a,c,h,d=Rt,f=Rt,m,g){super(null,a,c,h,d,f,i,s,m,g),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const yb=new Ne,YR=new Ne;class hl{constructor(e=[],t=[]){this.uuid=Oi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Ne)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Ne;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const c=e[s]?e[s].matrixWorld:YR;yb.multiplyMatrices(c,t[s]),yb.toArray(n,16*s)}i!==null&&(i.needsUpdate=!0)}clone(){return new hl(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=fx(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Gs(t,e,e,oi,Ci);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const s=e.bones[n];let a=t[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new ul),this.bones.push(a),this.boneInverses.push(new Ne().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const c=n[i];e.boneInverses.push(c.toArray())}return e}}class Vs extends tt{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const xb=new Ne,bb=new Ne,ud=[],QR=new Ne,Hc=new et;class hd extends et{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vs(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let i=0;i<n;i++)this.setMatrixAt(i,QR)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Hc.geometry=this.geometry,Hc.material=this.material,Hc.material!==void 0)for(let s=0;s<i;s++){this.getMatrixAt(s,xb),bb.multiplyMatrices(n,xb),Hc.matrixWorld=bb,Hc.raycast(e,ud);for(let a=0,c=ud.length;a<c;a++){const h=ud[a];h.instanceId=s,h.object=this,t.push(h)}ud.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Vs(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Un extends un{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ie(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Sb=new O,wb=new O,_b=new Ne,h0=new Rc,dd=new rs;class kr extends ct{constructor(e=new $e,t=new Un){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,s=t.count;i<s;i++)Sb.fromBufferAttribute(t,i-1),wb.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Sb.distanceTo(wb);e.setAttribute("lineDistance",new We(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),dd.copy(n.boundingSphere),dd.applyMatrix4(i),dd.radius+=s,e.ray.intersectsSphere(dd)===!1)return;_b.copy(i).invert(),h0.copy(e.ray).applyMatrix4(_b);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,d=new O,f=new O,m=new O,g=new O,y=this.isLineSegments?2:1,S=n.index,x=n.attributes.position;if(S!==null)for(let w=Math.max(0,a.start),T=Math.min(S.count,a.start+a.count)-1;w<T;w+=y){const _=S.getX(w),E=S.getX(w+1);if(d.fromBufferAttribute(x,_),f.fromBufferAttribute(x,E),h0.distanceSqToSegment(d,f,g,m)>h)continue;g.applyMatrix4(this.matrixWorld);const R=e.ray.origin.distanceTo(g);R<e.near||R>e.far||t.push({distance:R,point:m.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}else for(let w=Math.max(0,a.start),T=Math.min(x.count,a.start+a.count)-1;w<T;w+=y){if(d.fromBufferAttribute(x,w),f.fromBufferAttribute(x,w+1),h0.distanceSqToSegment(d,f,g,m)>h)continue;g.applyMatrix4(this.matrixWorld);const _=e.ray.origin.distanceTo(g);_<e.near||_>e.far||t.push({distance:_,point:m.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,s=n.length;i<s;i++){const a=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}}const Mb=new O,Tb=new O;class gr extends kr{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,s=t.count;i<s;i+=2)Mb.fromBufferAttribute(t,i),Tb.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Mb.distanceTo(Tb);e.setAttribute("lineDistance",new We(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class d0 extends kr{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class pd extends un{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ie(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Eb=new Ne,p0=new Rc,fd=new rs,md=new O;class f0 extends ct{constructor(e=new $e,t=new pd){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),fd.copy(n.boundingSphere),fd.applyMatrix4(i),fd.radius+=s,e.ray.intersectsSphere(fd)===!1)return;Eb.copy(i).invert(),p0.copy(e.ray).applyMatrix4(Eb);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,d=n.index,f=n.attributes.position;if(d!==null)for(let m=Math.max(0,a.start),g=Math.min(d.count,a.start+a.count);m<g;m++){const y=d.getX(m);md.fromBufferAttribute(f,y),Ab(md,y,h,i,e,t,this)}else for(let m=Math.max(0,a.start),g=Math.min(f.count,a.start+a.count);m<g;m++)md.fromBufferAttribute(f,m),Ab(md,m,h,i,e,t,this)}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,s=n.length;i<s;i++){const a=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}}function Ab(l,e,t,n,i,s,a){const c=p0.distanceSqToPoint(l);if(c<t){const h=new O;p0.closestPointToPoint(l,h),h.applyMatrix4(n);const d=i.ray.origin.distanceTo(h);if(d<i.near||d>i.far)return;s.push({distance:d,distanceToRay:Math.sqrt(c),point:h,index:e,face:null,object:a})}}class ZR extends zt{constructor(e,t,n,i,s,a,c,h,d){super(e,t,n,i,s,a,c,h,d),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:at,this.magFilter=s!==void 0?s:at,this.generateMipmaps=!1;const f=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function m(){f.needsUpdate=!0,e.requestVideoFrameCallback(m)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class KR extends zt{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=Rt,this.minFilter=Rt,this.generateMipmaps=!1,this.needsUpdate=!0}}class m0 extends zt{constructor(e,t,n,i,s,a,c,h,d,f,m,g){super(null,a,c,h,d,f,i,s,m,g),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class JR extends m0{constructor(e,t,n,i,s,a){super(e,t,n,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=bn}}class $R extends zt{constructor(e,t,n,i,s,a,c,h,d){super(e,t,n,i,s,a,c,h,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Qi{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const s=n.length;let a;a=t||e*n[s-1];let c,h=0,d=s-1;for(;h<=d;)if(i=Math.floor(h+(d-h)/2),c=n[i]-a,c<0)h=i+1;else{if(!(c>0)){d=i;break}d=i-1}if(i=d,n[i]===a)return i/(s-1);const f=n[i];return(i+(a-f)/(n[i+1]-f))/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),c=this.getPoint(s),h=t||(a.isVector2?new de:new O);return h.copy(c).sub(a).normalize(),h}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new O,i=[],s=[],a=[],c=new O,h=new Ne;for(let y=0;y<=e;y++){const S=y/e;i[y]=this.getTangentAt(S,new O)}s[0]=new O,a[0]=new O;let d=Number.MAX_VALUE;const f=Math.abs(i[0].x),m=Math.abs(i[0].y),g=Math.abs(i[0].z);f<=d&&(d=f,n.set(1,0,0)),m<=d&&(d=m,n.set(0,1,0)),g<=d&&n.set(0,0,1),c.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],c),a[0].crossVectors(i[0],s[0]);for(let y=1;y<=e;y++){if(s[y]=s[y-1].clone(),a[y]=a[y-1].clone(),c.crossVectors(i[y-1],i[y]),c.length()>Number.EPSILON){c.normalize();const S=Math.acos(an(i[y-1].dot(i[y]),-1,1));s[y].applyMatrix4(h.makeRotationAxis(c,S))}a[y].crossVectors(i[y],s[y])}if(t===!0){let y=Math.acos(an(s[0].dot(s[e]),-1,1));y/=e,i[0].dot(c.crossVectors(s[0],s[e]))>0&&(y=-y);for(let S=1;S<=e;S++)s[S].applyMatrix4(h.makeRotationAxis(i[S],y*S)),a[S].crossVectors(i[S],s[S])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class gd extends Qi{constructor(e=0,t=0,n=1,i=1,s=0,a=2*Math.PI,c=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=c,this.aRotation=h}getPoint(e,t){const n=t||new de,i=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(s=a?0:i),this.aClockwise!==!0||a||(s===i?s=-i:s-=i);const c=this.aStartAngle+e*s;let h=this.aX+this.xRadius*Math.cos(c),d=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const f=Math.cos(this.aRotation),m=Math.sin(this.aRotation),g=h-this.aX,y=d-this.aY;h=g*f-y*m+this.aX,d=g*m+y*f+this.aY}return n.set(h,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Rb extends gd{constructor(e,t,n,i,s,a){super(e,t,n,n,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function g0(){let l=0,e=0,t=0,n=0;function i(s,a,c,h){l=s,e=c,t=-3*s+3*a-2*c-h,n=2*s-2*a+c+h}return{initCatmullRom:function(s,a,c,h,d){i(a,c,d*(c-s),d*(h-a))},initNonuniformCatmullRom:function(s,a,c,h,d,f,m){let g=(a-s)/d-(c-s)/(d+f)+(c-a)/f,y=(c-a)/f-(h-a)/(f+m)+(h-c)/m;g*=f,y*=f,i(a,c,g,y)},calc:function(s){const a=s*s;return l+e*s+t*a+n*(a*s)}}}const vd=new O,v0=new g0,y0=new g0,x0=new g0;class Lb extends Qi{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new O){const n=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let c,h,d=Math.floor(a),f=a-d;this.closed?d+=d>0?0:(Math.floor(Math.abs(d)/s)+1)*s:f===0&&d===s-1&&(d=s-2,f=1),this.closed||d>0?c=i[(d-1)%s]:(vd.subVectors(i[0],i[1]).add(i[0]),c=vd);const m=i[d%s],g=i[(d+1)%s];if(this.closed||d+2<s?h=i[(d+2)%s]:(vd.subVectors(i[s-1],i[s-2]).add(i[s-1]),h=vd),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let S=Math.pow(c.distanceToSquared(m),y),x=Math.pow(m.distanceToSquared(g),y),w=Math.pow(g.distanceToSquared(h),y);x<1e-4&&(x=1),S<1e-4&&(S=x),w<1e-4&&(w=x),v0.initNonuniformCatmullRom(c.x,m.x,g.x,h.x,S,x,w),y0.initNonuniformCatmullRom(c.y,m.y,g.y,h.y,S,x,w),x0.initNonuniformCatmullRom(c.z,m.z,g.z,h.z,S,x,w)}else this.curveType==="catmullrom"&&(v0.initCatmullRom(c.x,m.x,g.x,h.x,this.tension),y0.initCatmullRom(c.y,m.y,g.y,h.y,this.tension),x0.initCatmullRom(c.z,m.z,g.z,h.z,this.tension));return n.set(v0.calc(f),y0.calc(f),x0.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new O().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Pb(l,e,t,n,i){const s=.5*(n-e),a=.5*(i-t),c=l*l;return(2*t-2*n+s+a)*(l*c)+(-3*t+3*n-2*s-a)*c+s*l+t}function Gc(l,e,t,n){return function(i,s){const a=1-i;return a*a*s}(l,e)+function(i,s){return 2*(1-i)*i*s}(l,t)+function(i,s){return i*i*s}(l,n)}function Vc(l,e,t,n,i){return function(s,a){const c=1-s;return c*c*c*a}(l,e)+function(s,a){const c=1-s;return 3*c*c*s*a}(l,t)+function(s,a){return 3*(1-s)*s*s*a}(l,n)+function(s,a){return s*s*s*a}(l,i)}class b0 extends Qi{constructor(e=new de,t=new de,n=new de,i=new de){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new de){const n=t,i=this.v0,s=this.v1,a=this.v2,c=this.v3;return n.set(Vc(e,i.x,s.x,a.x,c.x),Vc(e,i.y,s.y,a.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Cb extends Qi{constructor(e=new O,t=new O,n=new O,i=new O){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new O){const n=t,i=this.v0,s=this.v1,a=this.v2,c=this.v3;return n.set(Vc(e,i.x,s.x,a.x,c.x),Vc(e,i.y,s.y,a.y,c.y),Vc(e,i.z,s.z,a.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class yd extends Qi{constructor(e=new de,t=new de){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new de){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new de){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Db extends Qi{constructor(e=new O,t=new O){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new O){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new O){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class S0 extends Qi{constructor(e=new de,t=new de,n=new de){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new de){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(Gc(e,i.x,s.x,a.x),Gc(e,i.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xd extends Qi{constructor(e=new O,t=new O,n=new O){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new O){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(Gc(e,i.x,s.x,a.x),Gc(e,i.y,s.y,a.y),Gc(e,i.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class w0 extends Qi{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new de){const n=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),c=s-a,h=i[a===0?a:a-1],d=i[a],f=i[a>i.length-2?i.length-1:a+1],m=i[a>i.length-3?i.length-1:a+2];return n.set(Pb(c,h.x,d.x,f.x,m.x),Pb(c,h.y,d.y,f.y,m.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new de().fromArray(i))}return this}}class Ob extends Qi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new yd(t,e))}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const a=i[s]-n,c=this.curves[s],h=c.getLength(),d=h===0?0:1-a/h;return c.getPointAt(d,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],c=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,h=a.getPoints(c);for(let d=0;d<h.length;d++){const f=h[d];n&&n.equals(f)||(t.push(f),n=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new r[i.type]().fromJSON(i))}return this}}class Wc extends Ob{constructor(e){super(),this.type="Path",this.currentPoint=new de,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new yd(this.currentPoint.clone(),new de(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new S0(this.currentPoint.clone(),new de(e,t),new de(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,a){const c=new b0(this.currentPoint.clone(),new de(e,t),new de(n,i),new de(s,a));return this.curves.push(c),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new w0(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,a){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+c,t+h,n,i,s,a),this}absarc(e,t,n,i,s,a){return this.absellipse(e,t,n,n,i,s,a),this}ellipse(e,t,n,i,s,a,c,h){const d=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+d,t+f,n,i,s,a,c,h),this}absellipse(e,t,n,i,s,a,c,h){const d=new gd(e,t,n,i,s,a,c,h);if(this.curves.length>0){const m=d.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(d);const f=d.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ha extends $e{constructor(e=[new de(0,-.5),new de(.5,0),new de(0,.5)],t=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=an(i,0,2*Math.PI);const s=[],a=[],c=[],h=[],d=[],f=1/t,m=new O,g=new de,y=new O,S=new O,x=new O;let w=0,T=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:w=e[_+1].x-e[_].x,T=e[_+1].y-e[_].y,y.x=1*T,y.y=-w,y.z=0*T,x.copy(y),y.normalize(),h.push(y.x,y.y,y.z);break;case e.length-1:h.push(x.x,x.y,x.z);break;default:w=e[_+1].x-e[_].x,T=e[_+1].y-e[_].y,y.x=1*T,y.y=-w,y.z=0*T,S.copy(y),y.x+=x.x,y.y+=x.y,y.z+=x.z,y.normalize(),h.push(y.x,y.y,y.z),x.copy(S)}for(let _=0;_<=t;_++){const E=n+_*f*i,R=Math.sin(E),P=Math.cos(E);for(let C=0;C<=e.length-1;C++){m.x=e[C].x*R,m.y=e[C].y,m.z=e[C].x*P,a.push(m.x,m.y,m.z),g.x=_/t,g.y=C/(e.length-1),c.push(g.x,g.y);const F=h[3*C+0]*R,W=h[3*C+1],B=h[3*C+0]*P;d.push(F,W,B)}}for(let _=0;_<t;_++)for(let E=0;E<e.length-1;E++){const R=E+_*e.length,P=R,C=R+e.length,F=R+e.length+1,W=R+1;s.push(P,C,W),s.push(F,W,C)}this.setIndex(s),this.setAttribute("position",new We(a,3)),this.setAttribute("uv",new We(c,2)),this.setAttribute("normal",new We(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ha(e.points,e.segments,e.phiStart,e.phiLength)}}class dl extends Ha{constructor(e=1,t=1,n=4,i=8){const s=new Wc;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new dl(e.radius,e.length,e.capSegments,e.radialSegments)}}class pl extends $e{constructor(e=1,t=32,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const s=[],a=[],c=[],h=[],d=new O,f=new de;a.push(0,0,0),c.push(0,0,1),h.push(.5,.5);for(let m=0,g=3;m<=t;m++,g+=3){const y=n+m/t*i;d.x=e*Math.cos(y),d.y=e*Math.sin(y),a.push(d.x,d.y,d.z),c.push(0,0,1),f.x=(a[g]/e+1)/2,f.y=(a[g+1]/e+1)/2,h.push(f.x,f.y)}for(let m=1;m<=t;m++)s.push(m,m+1,0);this.setIndex(s),this.setAttribute("position",new We(a,3)),this.setAttribute("normal",new We(c,3)),this.setAttribute("uv",new We(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pl(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ws extends $e{constructor(e=1,t=1,n=1,i=32,s=1,a=!1,c=0,h=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:c,thetaLength:h};const d=this;i=Math.floor(i),s=Math.floor(s);const f=[],m=[],g=[],y=[];let S=0;const x=[],w=n/2;let T=0;function _(E){const R=S,P=new de,C=new O;let F=0;const W=E===!0?e:t,B=E===!0?1:-1;for(let U=1;U<=i;U++)m.push(0,w*B,0),g.push(0,B,0),y.push(.5,.5),S++;const V=S;for(let U=0;U<=i;U++){const te=U/i*h+c,ue=Math.cos(te),ce=Math.sin(te);C.x=W*ce,C.y=w*B,C.z=W*ue,m.push(C.x,C.y,C.z),g.push(0,B,0),P.x=.5*ue+.5,P.y=.5*ce*B+.5,y.push(P.x,P.y),S++}for(let U=0;U<i;U++){const te=R+U,ue=V+U;E===!0?f.push(ue,ue+1,te):f.push(ue+1,ue,te),F+=3}d.addGroup(T,F,E===!0?1:2),T+=F}(function(){const E=new O,R=new O;let P=0;const C=(t-e)/n;for(let F=0;F<=s;F++){const W=[],B=F/s,V=B*(t-e)+e;for(let U=0;U<=i;U++){const te=U/i,ue=te*h+c,ce=Math.sin(ue),we=Math.cos(ue);R.x=V*ce,R.y=-B*n+w,R.z=V*we,m.push(R.x,R.y,R.z),E.set(ce,C,we).normalize(),g.push(E.x,E.y,E.z),y.push(te,1-B),W.push(S++)}x.push(W)}for(let F=0;F<i;F++)for(let W=0;W<s;W++){const B=x[W][F],V=x[W+1][F],U=x[W+1][F+1],te=x[W][F+1];f.push(B,V,te),f.push(V,U,te),P+=6}d.addGroup(T,P,0),T+=P})(),a===!1&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(f),this.setAttribute("position",new We(m,3)),this.setAttribute("normal",new We(g,3)),this.setAttribute("uv",new We(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ws(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class fl extends Ws{constructor(e=1,t=1,n=32,i=1,s=!1,a=0,c=2*Math.PI){super(0,e,t,n,i,s,a,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:c}}static fromJSON(e){return new fl(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Fr extends $e{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const s=[],a=[];function c(g,y,S,x){const w=x+1,T=[];for(let _=0;_<=w;_++){T[_]=[];const E=g.clone().lerp(S,_/w),R=y.clone().lerp(S,_/w),P=w-_;for(let C=0;C<=P;C++)T[_][C]=C===0&&_===w?E:E.clone().lerp(R,C/P)}for(let _=0;_<w;_++)for(let E=0;E<2*(w-_)-1;E++){const R=Math.floor(E/2);E%2==0?(h(T[_][R+1]),h(T[_+1][R]),h(T[_][R])):(h(T[_][R+1]),h(T[_+1][R+1]),h(T[_+1][R]))}}function h(g){s.push(g.x,g.y,g.z)}function d(g,y){const S=3*g;y.x=e[S+0],y.y=e[S+1],y.z=e[S+2]}function f(g,y,S,x){x<0&&g.x===1&&(a[y]=g.x-1),S.x===0&&S.z===0&&(a[y]=x/2/Math.PI+.5)}function m(g){return Math.atan2(g.z,-g.x)}(function(g){const y=new O,S=new O,x=new O;for(let w=0;w<t.length;w+=3)d(t[w+0],y),d(t[w+1],S),d(t[w+2],x),c(y,S,x,g)})(i),function(g){const y=new O;for(let S=0;S<s.length;S+=3)y.x=s[S+0],y.y=s[S+1],y.z=s[S+2],y.normalize().multiplyScalar(g),s[S+0]=y.x,s[S+1]=y.y,s[S+2]=y.z}(n),function(){const g=new O;for(let S=0;S<s.length;S+=3){g.x=s[S+0],g.y=s[S+1],g.z=s[S+2];const x=m(g)/2/Math.PI+.5,w=(y=g,Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))/Math.PI+.5);a.push(x,1-w)}var y;(function(){const S=new O,x=new O,w=new O,T=new O,_=new de,E=new de,R=new de;for(let P=0,C=0;P<s.length;P+=9,C+=6){S.set(s[P+0],s[P+1],s[P+2]),x.set(s[P+3],s[P+4],s[P+5]),w.set(s[P+6],s[P+7],s[P+8]),_.set(a[C+0],a[C+1]),E.set(a[C+2],a[C+3]),R.set(a[C+4],a[C+5]),T.copy(S).add(x).add(w).divideScalar(3);const F=m(T);f(_,C+0,S,F),f(E,C+2,x,F),f(R,C+4,w,F)}})(),function(){for(let S=0;S<a.length;S+=6){const x=a[S+0],w=a[S+2],T=a[S+4],_=Math.max(x,w,T),E=Math.min(x,w,T);_>.9&&E<.1&&(x<.2&&(a[S+0]+=1),w<.2&&(a[S+2]+=1),T<.2&&(a[S+4]+=1))}}()}(),this.setAttribute("position",new We(s,3)),this.setAttribute("normal",new We(s.slice(),3)),this.setAttribute("uv",new We(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fr(e.vertices,e.indices,e.radius,e.details)}}class ml extends Fr{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ml(e.radius,e.detail)}}const bd=new O,Sd=new O,_0=new O,wd=new qi;class M0 extends $e{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Na*t),a=e.getIndex(),c=e.getAttribute("position"),h=a?a.count:c.count,d=[0,0,0],f=["a","b","c"],m=new Array(3),g={},y=[];for(let S=0;S<h;S+=3){a?(d[0]=a.getX(S),d[1]=a.getX(S+1),d[2]=a.getX(S+2)):(d[0]=S,d[1]=S+1,d[2]=S+2);const{a:x,b:w,c:T}=wd;if(x.fromBufferAttribute(c,d[0]),w.fromBufferAttribute(c,d[1]),T.fromBufferAttribute(c,d[2]),wd.getNormal(_0),m[0]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,m[1]=`${Math.round(w.x*i)},${Math.round(w.y*i)},${Math.round(w.z*i)}`,m[2]=`${Math.round(T.x*i)},${Math.round(T.y*i)},${Math.round(T.z*i)}`,m[0]!==m[1]&&m[1]!==m[2]&&m[2]!==m[0])for(let _=0;_<3;_++){const E=(_+1)%3,R=m[_],P=m[E],C=wd[f[_]],F=wd[f[E]],W=`${R}_${P}`,B=`${P}_${R}`;B in g&&g[B]?(_0.dot(g[B].normal)<=s&&(y.push(C.x,C.y,C.z),y.push(F.x,F.y,F.z)),g[B]=null):W in g||(g[W]={index0:d[_],index1:d[E],normal:_0.clone()})}}for(const S in g)if(g[S]){const{index0:x,index1:w}=g[S];bd.fromBufferAttribute(c,x),Sd.fromBufferAttribute(c,w),y.push(bd.x,bd.y,bd.z),y.push(Sd.x,Sd.y,Sd.z)}this.setAttribute("position",new We(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ds extends Wc{constructor(e){super(e),this.uuid=Oi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new Wc().fromJSON(i))}return this}}const eL=function(l,e,t=2){const n=e&&e.length,i=n?e[0]*t:l.length;let s=Ib(l,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let c,h,d,f,m,g,y;if(n&&(s=function(S,x,w,T){const _=[];let E,R,P,C,F;for(E=0,R=x.length;E<R;E++)P=x[E]*T,C=E<R-1?x[E+1]*T:S.length,F=Ib(S,P,C,T,!1),F===F.next&&(F.steiner=!0),_.push(lL(F));for(_.sort(sL),E=0;E<_.length;E++)w=aL(_[E],w);return w}(l,e,s,t)),l.length>80*t){c=d=l[0],h=f=l[1];for(let S=t;S<i;S+=t)m=l[S],g=l[S+1],m<c&&(c=m),g<h&&(h=g),m>d&&(d=m),g>f&&(f=g);y=Math.max(d-c,f-h),y=y!==0?32767/y:0}return Xc(s,a,t,c,h,y,0),a};function Ib(l,e,t,n,i){let s,a;if(i===function(c,h,d,f){let m=0;for(let g=h,y=d-f;g<d;g+=f)m+=(c[y]-c[g])*(c[g+1]+c[y+1]),y=g;return m}(l,e,t,n)>0)for(s=e;s<t;s+=n)a=Fb(s,l[s],l[s+1],a);else for(s=t-n;s>=e;s-=n)a=Fb(s,l[s],l[s+1],a);return a&&_d(a,a.next)&&(Yc(a),a=a.next),a}function Ga(l,e){if(!l)return l;e||(e=l);let t,n=l;do if(t=!1,n.steiner||!_d(n,n.next)&&en(n.prev,n,n.next)!==0)n=n.next;else{if(Yc(n),n=e=n.prev,n===n.next)break;t=!0}while(t||n!==e);return e}function Xc(l,e,t,n,i,s,a){if(!l)return;!a&&s&&function(f,m,g,y){let S=f;do S.z===0&&(S.z=T0(S.x,S.y,m,g,y)),S.prevZ=S.prev,S.nextZ=S.next,S=S.next;while(S!==f);S.prevZ.nextZ=null,S.prevZ=null,function(x){let w,T,_,E,R,P,C,F,W=1;do{for(T=x,x=null,R=null,P=0;T;){for(P++,_=T,C=0,w=0;w<W&&(C++,_=_.nextZ,_);w++);for(F=W;C>0||F>0&&_;)C!==0&&(F===0||!_||T.z<=_.z)?(E=T,T=T.nextZ,C--):(E=_,_=_.nextZ,F--),R?R.nextZ=E:x=E,E.prevZ=R,R=E;T=_}R.nextZ=null,W*=2}while(P>1)}(S)}(l,n,i,s);let c,h,d=l;for(;l.prev!==l.next;)if(c=l.prev,h=l.next,s?nL(l,n,i,s):tL(l))e.push(c.i/t|0),e.push(l.i/t|0),e.push(h.i/t|0),Yc(l),l=h.next,d=h.next;else if((l=h)===d){a?a===1?Xc(l=iL(Ga(l),e,t),e,t,n,i,s,2):a===2&&rL(l,e,t,n,i,s):Xc(Ga(l),e,t,n,i,s,1);break}}function tL(l){const e=l.prev,t=l,n=l.next;if(en(e,t,n)>=0)return!1;const i=e.x,s=t.x,a=n.x,c=e.y,h=t.y,d=n.y,f=i<s?i<a?i:a:s<a?s:a,m=c<h?c<d?c:d:h<d?h:d,g=i>s?i>a?i:a:s>a?s:a,y=c>h?c>d?c:d:h>d?h:d;let S=n.next;for(;S!==e;){if(S.x>=f&&S.x<=g&&S.y>=m&&S.y<=y&&gl(i,c,s,h,a,d,S.x,S.y)&&en(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function nL(l,e,t,n){const i=l.prev,s=l,a=l.next;if(en(i,s,a)>=0)return!1;const c=i.x,h=s.x,d=a.x,f=i.y,m=s.y,g=a.y,y=c<h?c<d?c:d:h<d?h:d,S=f<m?f<g?f:g:m<g?m:g,x=c>h?c>d?c:d:h>d?h:d,w=f>m?f>g?f:g:m>g?m:g,T=T0(y,S,e,t,n),_=T0(x,w,e,t,n);let E=l.prevZ,R=l.nextZ;for(;E&&E.z>=T&&R&&R.z<=_;){if(E.x>=y&&E.x<=x&&E.y>=S&&E.y<=w&&E!==i&&E!==a&&gl(c,f,h,m,d,g,E.x,E.y)&&en(E.prev,E,E.next)>=0||(E=E.prevZ,R.x>=y&&R.x<=x&&R.y>=S&&R.y<=w&&R!==i&&R!==a&&gl(c,f,h,m,d,g,R.x,R.y)&&en(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;E&&E.z>=T;){if(E.x>=y&&E.x<=x&&E.y>=S&&E.y<=w&&E!==i&&E!==a&&gl(c,f,h,m,d,g,E.x,E.y)&&en(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;R&&R.z<=_;){if(R.x>=y&&R.x<=x&&R.y>=S&&R.y<=w&&R!==i&&R!==a&&gl(c,f,h,m,d,g,R.x,R.y)&&en(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function iL(l,e,t){let n=l;do{const i=n.prev,s=n.next.next;!_d(i,s)&&Nb(i,n,n.next,s)&&qc(i,s)&&qc(s,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Yc(n),Yc(n.next),n=l=s),n=n.next}while(n!==l);return Ga(n)}function rL(l,e,t,n,i,s){let a=l;do{let c=a.next.next;for(;c!==a.prev;){if(a.i!==c.i&&cL(a,c)){let h=kb(a,c);return a=Ga(a,a.next),h=Ga(h,h.next),Xc(a,e,t,n,i,s,0),void Xc(h,e,t,n,i,s,0)}c=c.next}a=a.next}while(a!==l)}function sL(l,e){return l.x-e.x}function aL(l,e){const t=function(i,s){let a,c=s,h=-1/0;const d=i.x,f=i.y;do{if(f<=c.y&&f>=c.next.y&&c.next.y!==c.y){const w=c.x+(f-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(w<=d&&w>h&&(h=w,a=c.x<c.next.x?c:c.next,w===d))return a}c=c.next}while(c!==s);if(!a)return null;const m=a,g=a.x,y=a.y;let S,x=1/0;c=a;do d>=c.x&&c.x>=g&&d!==c.x&&gl(f<y?d:h,f,g,y,f<y?h:d,f,c.x,c.y)&&(S=Math.abs(f-c.y)/(d-c.x),qc(c,i)&&(S<x||S===x&&(c.x>a.x||c.x===a.x&&oL(a,c)))&&(a=c,x=S)),c=c.next;while(c!==m);return a}(l,e);if(!t)return e;const n=kb(t,l);return Ga(n,n.next),Ga(t,t.next)}function oL(l,e){return en(l.prev,l,e.prev)<0&&en(e.next,l,l.next)<0}function T0(l,e,t,n,i){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-t)*i|0)|l<<8))|l<<4))|l<<2))|l<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function lL(l){let e=l,t=l;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==l);return t}function gl(l,e,t,n,i,s,a,c){return(i-a)*(e-c)>=(l-a)*(s-c)&&(l-a)*(n-c)>=(t-a)*(e-c)&&(t-a)*(s-c)>=(i-a)*(n-c)}function cL(l,e){return l.next.i!==e.i&&l.prev.i!==e.i&&!function(t,n){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==n.i&&i.next.i!==n.i&&Nb(i,i.next,t,n))return!0;i=i.next}while(i!==t);return!1}(l,e)&&(qc(l,e)&&qc(e,l)&&function(t,n){let i=t,s=!1;const a=(t.x+n.x)/2,c=(t.y+n.y)/2;do i.y>c!=i.next.y>c&&i.next.y!==i.y&&a<(i.next.x-i.x)*(c-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next;while(i!==t);return s}(l,e)&&(en(l.prev,l,e.prev)||en(l,e.prev,e))||_d(l,e)&&en(l.prev,l,l.next)>0&&en(e.prev,e,e.next)>0)}function en(l,e,t){return(e.y-l.y)*(t.x-e.x)-(e.x-l.x)*(t.y-e.y)}function _d(l,e){return l.x===e.x&&l.y===e.y}function Nb(l,e,t,n){const i=Td(en(l,e,t)),s=Td(en(l,e,n)),a=Td(en(t,n,l)),c=Td(en(t,n,e));return i!==s&&a!==c||!(i!==0||!Md(l,t,e))||!(s!==0||!Md(l,n,e))||!(a!==0||!Md(t,l,n))||!(c!==0||!Md(t,e,n))}function Md(l,e,t){return e.x<=Math.max(l.x,t.x)&&e.x>=Math.min(l.x,t.x)&&e.y<=Math.max(l.y,t.y)&&e.y>=Math.min(l.y,t.y)}function Td(l){return l>0?1:l<0?-1:0}function qc(l,e){return en(l.prev,l,l.next)<0?en(l,e,l.next)>=0&&en(l,l.prev,e)>=0:en(l,e,l.prev)<0||en(l,l.next,e)<0}function kb(l,e){const t=new E0(l.i,l.x,l.y),n=new E0(e.i,e.x,e.y),i=l.next,s=e.prev;return l.next=e,e.prev=l,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function Fb(l,e,t,n){const i=new E0(l,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Yc(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function E0(l,e,t){this.i=l,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ur{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return .5*n}static isClockWise(e){return Ur.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];Ub(e),zb(n,e);let a=e.length;t.forEach(Ub);for(let h=0;h<t.length;h++)i.push(a),a+=t[h].length,zb(n,t[h]);const c=eL(n,i);for(let h=0;h<c.length;h+=3)s.push(c.slice(h,h+3));return s}}function Ub(l){const e=l.length;e>2&&l[e-1].equals(l[0])&&l.pop()}function zb(l,e){for(let t=0;t<e.length;t++)l.push(e[t].x),l.push(e[t].y)}class vl extends $e{constructor(e=new ds([new de(.5,.5),new de(-.5,.5),new de(-.5,-.5),new de(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let c=0,h=e.length;c<h;c++)a(e[c]);function a(c){const h=[],d=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,m=t.depth!==void 0?t.depth:1;let g=t.bevelEnabled===void 0||t.bevelEnabled,y=t.bevelThickness!==void 0?t.bevelThickness:.2,S=t.bevelSize!==void 0?t.bevelSize:y-.1,x=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:uL;let E,R,P,C,F,W=!1;T&&(E=T.getSpacedPoints(f),W=!0,g=!1,R=T.computeFrenetFrames(f,!1),P=new O,C=new O,F=new O),g||(w=0,y=0,S=0,x=0);const B=c.extractPoints(d);let V=B.shape;const U=B.holes;if(!Ur.isClockWise(V)){V=V.reverse();for(let Z=0,H=U.length;Z<H;Z++){const ee=U[Z];Ur.isClockWise(ee)&&(U[Z]=ee.reverse())}}const te=Ur.triangulateShape(V,U),ue=V;for(let Z=0,H=U.length;Z<H;Z++){const ee=U[Z];V=V.concat(ee)}function ce(Z,H,ee){return H||console.error("THREE.ExtrudeGeometry: vec does not exist"),Z.clone().addScaledVector(H,ee)}const we=V.length,ve=te.length;function Re(Z,H,ee){let I,q,K;const re=Z.x-H.x,ae=Z.y-H.y,ge=ee.x-Z.x,Fe=ee.y-Z.y,je=re*re+ae*ae,qe=re*Fe-ae*ge;if(Math.abs(qe)>Number.EPSILON){const He=Math.sqrt(je),rt=Math.sqrt(ge*ge+Fe*Fe),ut=H.x-ae/He,nt=H.y+re/He,vt=((ee.x-Fe/rt-ut)*Fe-(ee.y+ge/rt-nt)*ge)/(re*Fe-ae*ge);I=ut+re*vt-Z.x,q=nt+ae*vt-Z.y;const Dt=I*I+q*q;if(Dt<=2)return new de(I,q);K=Math.sqrt(Dt/2)}else{let He=!1;re>Number.EPSILON?ge>Number.EPSILON&&(He=!0):re<-Number.EPSILON?ge<-Number.EPSILON&&(He=!0):Math.sign(ae)===Math.sign(Fe)&&(He=!0),He?(I=-ae,q=re,K=Math.sqrt(je)):(I=re,q=ae,K=Math.sqrt(je/2))}return new de(I/K,q/K)}const Pe=[];for(let Z=0,H=ue.length,ee=H-1,I=Z+1;Z<H;Z++,ee++,I++)ee===H&&(ee=0),I===H&&(I=0),Pe[Z]=Re(ue[Z],ue[ee],ue[I]);const De=[];let fe,oe=Pe.concat();for(let Z=0,H=U.length;Z<H;Z++){const ee=U[Z];fe=[];for(let I=0,q=ee.length,K=q-1,re=I+1;I<q;I++,K++,re++)K===q&&(K=0),re===q&&(re=0),fe[I]=Re(ee[I],ee[K],ee[re]);De.push(fe),oe=oe.concat(fe)}for(let Z=0;Z<w;Z++){const H=Z/w,ee=y*Math.cos(H*Math.PI/2),I=S*Math.sin(H*Math.PI/2)+x;for(let q=0,K=ue.length;q<K;q++){const re=ce(ue[q],Pe[q],I);Te(re.x,re.y,-ee)}for(let q=0,K=U.length;q<K;q++){const re=U[q];fe=De[q];for(let ae=0,ge=re.length;ae<ge;ae++){const Fe=ce(re[ae],fe[ae],I);Te(Fe.x,Fe.y,-ee)}}}const Se=S+x;for(let Z=0;Z<we;Z++){const H=g?ce(V[Z],oe[Z],Se):V[Z];W?(C.copy(R.normals[0]).multiplyScalar(H.x),P.copy(R.binormals[0]).multiplyScalar(H.y),F.copy(E[0]).add(C).add(P),Te(F.x,F.y,F.z)):Te(H.x,H.y,0)}for(let Z=1;Z<=f;Z++)for(let H=0;H<we;H++){const ee=g?ce(V[H],oe[H],Se):V[H];W?(C.copy(R.normals[Z]).multiplyScalar(ee.x),P.copy(R.binormals[Z]).multiplyScalar(ee.y),F.copy(E[Z]).add(C).add(P),Te(F.x,F.y,F.z)):Te(ee.x,ee.y,m/f*Z)}for(let Z=w-1;Z>=0;Z--){const H=Z/w,ee=y*Math.cos(H*Math.PI/2),I=S*Math.sin(H*Math.PI/2)+x;for(let q=0,K=ue.length;q<K;q++){const re=ce(ue[q],Pe[q],I);Te(re.x,re.y,m+ee)}for(let q=0,K=U.length;q<K;q++){const re=U[q];fe=De[q];for(let ae=0,ge=re.length;ae<ge;ae++){const Fe=ce(re[ae],fe[ae],I);W?Te(Fe.x,Fe.y+E[f-1].y,E[f-1].x+ee):Te(Fe.x,Fe.y,m+ee)}}}function Ce(Z,H){let ee=Z.length;for(;--ee>=0;){const I=ee;let q=ee-1;q<0&&(q=Z.length-1);for(let K=0,re=f+2*w;K<re;K++){const ae=we*K,ge=we*(K+1);G(H+I+ae,H+q+ae,H+q+ge,H+I+ge)}}}function Te(Z,H,ee){h.push(Z),h.push(H),h.push(ee)}function ze(Z,H,ee){z(Z),z(H),z(ee);const I=i.length/3,q=_.generateTopUV(n,i,I-3,I-2,I-1);le(q[0]),le(q[1]),le(q[2])}function G(Z,H,ee,I){z(Z),z(H),z(I),z(H),z(ee),z(I);const q=i.length/3,K=_.generateSideWallUV(n,i,q-6,q-3,q-2,q-1);le(K[0]),le(K[1]),le(K[3]),le(K[1]),le(K[2]),le(K[3])}function z(Z){i.push(h[3*Z+0]),i.push(h[3*Z+1]),i.push(h[3*Z+2])}function le(Z){s.push(Z.x),s.push(Z.y)}(function(){const Z=i.length/3;if(g){let H=0,ee=we*H;for(let I=0;I<ve;I++){const q=te[I];ze(q[2]+ee,q[1]+ee,q[0]+ee)}H=f+2*w,ee=we*H;for(let I=0;I<ve;I++){const q=te[I];ze(q[0]+ee,q[1]+ee,q[2]+ee)}}else{for(let H=0;H<ve;H++){const ee=te[H];ze(ee[2],ee[1],ee[0])}for(let H=0;H<ve;H++){const ee=te[H];ze(ee[0]+we*f,ee[1]+we*f,ee[2]+we*f)}}n.addGroup(Z,i.length/3-Z,0)})(),function(){const Z=i.length/3;let H=0;Ce(ue,H),H+=ue.length;for(let ee=0,I=U.length;ee<I;ee++){const q=U[ee];Ce(q,H),H+=q.length}n.addGroup(Z,i.length/3-Z,1)}()}this.setAttribute("position",new We(i,3)),this.setAttribute("uv",new We(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(t,n,i){if(i.shapes=[],Array.isArray(t))for(let s=0,a=t.length;s<a;s++){const c=t[s];i.shapes.push(c.uuid)}else i.shapes.push(t.uuid);return i.options=Object.assign({},n),n.extrudePath!==void 0&&(i.options.extrudePath=n.extrudePath.toJSON()),i}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const c=t[e.shapes[s]];n.push(c)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new r[i.type]().fromJSON(i)),new vl(n,e.options)}}const uL={generateTopUV:function(l,e,t,n,i){const s=e[3*t],a=e[3*t+1],c=e[3*n],h=e[3*n+1],d=e[3*i],f=e[3*i+1];return[new de(s,a),new de(c,h),new de(d,f)]},generateSideWallUV:function(l,e,t,n,i,s){const a=e[3*t],c=e[3*t+1],h=e[3*t+2],d=e[3*n],f=e[3*n+1],m=e[3*n+2],g=e[3*i],y=e[3*i+1],S=e[3*i+2],x=e[3*s],w=e[3*s+1],T=e[3*s+2];return Math.abs(c-f)<Math.abs(a-d)?[new de(a,1-h),new de(d,1-m),new de(g,1-S),new de(x,1-T)]:[new de(c,1-h),new de(f,1-m),new de(y,1-S),new de(w,1-T)]}};class yl extends Fr{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new yl(e.radius,e.detail)}}class Va extends Fr{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Va(e.radius,e.detail)}}class xl extends $e{constructor(e=.5,t=1,n=32,i=1,s=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:s,thetaLength:a},n=Math.max(3,n);const c=[],h=[],d=[],f=[];let m=e;const g=(t-e)/(i=Math.max(1,i)),y=new O,S=new de;for(let x=0;x<=i;x++){for(let w=0;w<=n;w++){const T=s+w/n*a;y.x=m*Math.cos(T),y.y=m*Math.sin(T),h.push(y.x,y.y,y.z),d.push(0,0,1),S.x=(y.x/t+1)/2,S.y=(y.y/t+1)/2,f.push(S.x,S.y)}m+=g}for(let x=0;x<i;x++){const w=x*(n+1);for(let T=0;T<n;T++){const _=T+w,E=_,R=_+n+1,P=_+n+2,C=_+1;c.push(E,R,C),c.push(R,P,C)}}this.setIndex(c),this.setAttribute("position",new We(h,3)),this.setAttribute("normal",new We(d,3)),this.setAttribute("uv",new We(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xl(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class bl extends $e{constructor(e=new ds([new de(0,.5),new de(-.5,-.5),new de(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],a=[];let c=0,h=0;if(Array.isArray(e)===!1)d(e);else for(let f=0;f<e.length;f++)d(e[f]),this.addGroup(c,h,f),c+=h,h=0;function d(f){const m=i.length/3,g=f.extractPoints(t);let y=g.shape;const S=g.holes;Ur.isClockWise(y)===!1&&(y=y.reverse());for(let w=0,T=S.length;w<T;w++){const _=S[w];Ur.isClockWise(_)===!0&&(S[w]=_.reverse())}const x=Ur.triangulateShape(y,S);for(let w=0,T=S.length;w<T;w++){const _=S[w];y=y.concat(_)}for(let w=0,T=y.length;w<T;w++){const _=y[w];i.push(_.x,_.y,0),s.push(0,0,1),a.push(_.x,_.y)}for(let w=0,T=x.length;w<T;w++){const _=x[w],E=_[0]+m,R=_[1]+m,P=_[2]+m;n.push(E,R,P),h+=3}}this.setIndex(n),this.setAttribute("position",new We(i,3)),this.setAttribute("normal",new We(s,3)),this.setAttribute("uv",new We(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(t,n){if(n.shapes=[],Array.isArray(t))for(let i=0,s=t.length;i<s;i++){const a=t[i];n.shapes.push(a.uuid)}else n.shapes.push(t.uuid);return n}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];n.push(a)}return new bl(n,e.curveSegments)}}class Xs extends $e{constructor(e=1,t=32,n=16,i=0,s=2*Math.PI,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const h=Math.min(a+c,Math.PI);let d=0;const f=[],m=new O,g=new O,y=[],S=[],x=[],w=[];for(let T=0;T<=n;T++){const _=[],E=T/n;let R=0;T==0&&a==0?R=.5/t:T==n&&h==Math.PI&&(R=-.5/t);for(let P=0;P<=t;P++){const C=P/t;m.x=-e*Math.cos(i+C*s)*Math.sin(a+E*c),m.y=e*Math.cos(a+E*c),m.z=e*Math.sin(i+C*s)*Math.sin(a+E*c),S.push(m.x,m.y,m.z),g.copy(m).normalize(),x.push(g.x,g.y,g.z),w.push(C+R,1-E),_.push(d++)}f.push(_)}for(let T=0;T<n;T++)for(let _=0;_<t;_++){const E=f[T][_+1],R=f[T][_],P=f[T+1][_],C=f[T+1][_+1];(T!==0||a>0)&&y.push(E,R,C),(T!==n-1||h<Math.PI)&&y.push(R,P,C)}this.setIndex(y),this.setAttribute("position",new We(S,3)),this.setAttribute("normal",new We(x,3)),this.setAttribute("uv",new We(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xs(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Sl extends Fr{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Sl(e.radius,e.detail)}}class wl extends $e{constructor(e=1,t=.4,n=12,i=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:s},n=Math.floor(n),i=Math.floor(i);const a=[],c=[],h=[],d=[],f=new O,m=new O,g=new O;for(let y=0;y<=n;y++)for(let S=0;S<=i;S++){const x=S/i*s,w=y/n*Math.PI*2;m.x=(e+t*Math.cos(w))*Math.cos(x),m.y=(e+t*Math.cos(w))*Math.sin(x),m.z=t*Math.sin(w),c.push(m.x,m.y,m.z),f.x=e*Math.cos(x),f.y=e*Math.sin(x),g.subVectors(m,f).normalize(),h.push(g.x,g.y,g.z),d.push(S/i),d.push(y/n)}for(let y=1;y<=n;y++)for(let S=1;S<=i;S++){const x=(i+1)*y+S-1,w=(i+1)*(y-1)+S-1,T=(i+1)*(y-1)+S,_=(i+1)*y+S;a.push(x,w,_),a.push(w,T,_)}this.setIndex(a),this.setAttribute("position",new We(c,3)),this.setAttribute("normal",new We(h,3)),this.setAttribute("uv",new We(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wl(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class _l extends $e{constructor(e=1,t=.4,n=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:s,q:a},n=Math.floor(n),i=Math.floor(i);const c=[],h=[],d=[],f=[],m=new O,g=new O,y=new O,S=new O,x=new O,w=new O,T=new O;for(let E=0;E<=n;++E){const R=E/n*s*Math.PI*2;_(R,s,a,e,y),_(R+.01,s,a,e,S),w.subVectors(S,y),T.addVectors(S,y),x.crossVectors(w,T),T.crossVectors(x,w),x.normalize(),T.normalize();for(let P=0;P<=i;++P){const C=P/i*Math.PI*2,F=-t*Math.cos(C),W=t*Math.sin(C);m.x=y.x+(F*T.x+W*x.x),m.y=y.y+(F*T.y+W*x.y),m.z=y.z+(F*T.z+W*x.z),h.push(m.x,m.y,m.z),g.subVectors(m,y).normalize(),d.push(g.x,g.y,g.z),f.push(E/n),f.push(P/i)}}for(let E=1;E<=n;E++)for(let R=1;R<=i;R++){const P=(i+1)*(E-1)+(R-1),C=(i+1)*E+(R-1),F=(i+1)*E+R,W=(i+1)*(E-1)+R;c.push(P,C,W),c.push(C,F,W)}function _(E,R,P,C,F){const W=Math.cos(E),B=Math.sin(E),V=P/R*E,U=Math.cos(V);F.x=C*(2+U)*.5*W,F.y=C*(2+U)*B*.5,F.z=C*Math.sin(V)*.5}this.setIndex(c),this.setAttribute("position",new We(h,3)),this.setAttribute("normal",new We(d,3)),this.setAttribute("uv",new We(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _l(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Ml extends $e{constructor(e=new xd(new O(-1,-1,0),new O(-1,1,0),new O(1,1,0)),t=64,n=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const c=new O,h=new O,d=new de;let f=new O;const m=[],g=[],y=[],S=[];function x(w){f=e.getPointAt(w/t,f);const T=a.normals[w],_=a.binormals[w];for(let E=0;E<=i;E++){const R=E/i*Math.PI*2,P=Math.sin(R),C=-Math.cos(R);h.x=C*T.x+P*_.x,h.y=C*T.y+P*_.y,h.z=C*T.z+P*_.z,h.normalize(),g.push(h.x,h.y,h.z),c.x=f.x+n*h.x,c.y=f.y+n*h.y,c.z=f.z+n*h.z,m.push(c.x,c.y,c.z)}}(function(){for(let w=0;w<t;w++)x(w);x(s===!1?t:0),function(){for(let w=0;w<=t;w++)for(let T=0;T<=i;T++)d.x=w/t,d.y=T/i,y.push(d.x,d.y)}(),function(){for(let w=1;w<=t;w++)for(let T=1;T<=i;T++){const _=(i+1)*(w-1)+(T-1),E=(i+1)*w+(T-1),R=(i+1)*w+T,P=(i+1)*(w-1)+T;S.push(_,E,P),S.push(E,R,P)}}()})(),this.setIndex(S),this.setAttribute("position",new We(m,3)),this.setAttribute("normal",new We(g,3)),this.setAttribute("uv",new We(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Ml(new r[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class A0 extends $e{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new O,s=new O;if(e.index!==null){const a=e.attributes.position,c=e.index;let h=e.groups;h.length===0&&(h=[{start:0,count:c.count,materialIndex:0}]);for(let d=0,f=h.length;d<f;++d){const m=h[d],g=m.start;for(let y=g,S=g+m.count;y<S;y+=3)for(let x=0;x<3;x++){const w=c.getX(y+x),T=c.getX(y+(x+1)%3);i.fromBufferAttribute(a,w),s.fromBufferAttribute(a,T),Bb(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let c=0,h=a.count/3;c<h;c++)for(let d=0;d<3;d++){const f=3*c+d,m=3*c+(d+1)%3;i.fromBufferAttribute(a,f),s.fromBufferAttribute(a,m),Bb(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new We(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Bb(l,e,t){const n=`${l.x},${l.y},${l.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${l.x},${l.y},${l.z}`;return t.has(n)!==!0&&t.has(i)!==!0&&(t.add(n),t.add(i),!0)}class jb extends un{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ie(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Hb extends St{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Bt extends un{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ie(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ps extends Bt{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new de(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return an(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ie(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ie(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ie(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Qc extends un{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ie(16777215),this.specular=new Ie(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Gb extends un{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ie(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class R0 extends un{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class L0 extends un{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Vb extends un{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ie(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Wb extends Un{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Zi(l,e,t){return P0(l)?new l.constructor(l.subarray(e,t!==void 0?t:l.length)):l.slice(e,t)}function Wa(l,e,t){return!l||!t&&l.constructor===e?l:typeof e.BYTES_PER_ELEMENT=="number"?new e(l):Array.prototype.slice.call(l)}function P0(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}function Xb(l){const e=l.length,t=new Array(e);for(let n=0;n!==e;++n)t[n]=n;return t.sort(function(n,i){return l[n]-l[i]}),t}function C0(l,e,t){const n=l.length,i=new l.constructor(n);for(let s=0,a=0;a!==n;++s){const c=t[s]*e;for(let h=0;h!==e;++h)i[a++]=l[c+h]}return i}function D0(l,e,t,n){let i=1,s=l[0];for(;s!==void 0&&s[n]===void 0;)s=l[i++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push.apply(t,a)),s=l[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=l[i++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=l[i++];while(s!==void 0)}const hL={arraySlice:Zi,convertArray:Wa,isTypedArray:P0,getKeyframeOrder:Xb,sortedArray:C0,flattenJSON:D0,subclip:function(l,e,t,n,i=30){const s=l.clone();s.name=e;const a=[];for(let h=0;h<s.tracks.length;++h){const d=s.tracks[h],f=d.getValueSize(),m=[],g=[];for(let y=0;y<d.times.length;++y){const S=d.times[y]*i;if(!(S<t||S>=n)){m.push(d.times[y]);for(let x=0;x<f;++x)g.push(d.values[y*f+x])}}m.length!==0&&(d.times=Wa(m,d.times.constructor),d.values=Wa(g,d.values.constructor),a.push(d))}s.tracks=a;let c=1/0;for(let h=0;h<s.tracks.length;++h)c>s.tracks[h].times[0]&&(c=s.tracks[h].times[0]);for(let h=0;h<s.tracks.length;++h)s.tracks[h].shift(-1*c);return s.resetDuration(),s},makeClipAdditive:function(l,e=0,t=l,n=30){n<=0&&(n=30);const i=t.tracks.length,s=e/n;for(let a=0;a<i;++a){const c=t.tracks[a],h=c.ValueTypeName;if(h==="bool"||h==="string")continue;const d=l.tracks.find(function(T){return T.name===c.name&&T.ValueTypeName===h});if(d===void 0)continue;let f=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=m/3);let g=0;const y=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=y/3);const S=c.times.length-1;let x;if(s<=c.times[0]){const T=f,_=m-f;x=Zi(c.values,T,_)}else if(s>=c.times[S]){const T=S*m+f,_=T+m-f;x=Zi(c.values,T,_)}else{const T=c.createInterpolant(),_=f,E=m-f;T.evaluate(s),x=Zi(T.resultBuffer,_,E)}h==="quaternion"&&new Ut().fromArray(x).normalize().conjugate().toArray(x);const w=d.times.length;for(let T=0;T<w;++T){const _=T*y+g;if(h==="quaternion")Ut.multiplyQuaternionsFlat(d.values,_,x,0,d.values,_);else{const E=y-2*g;for(let R=0;R<E;++R)d.values[_+R]-=x[R]}}}return l.blendMode=Em,l}};class Tl{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<i)){for(let c=n+2;;){if(i===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(s=i,i=t[++n],e<i)break t}a=t.length;break n}if(e>=s)break e;{const c=t[1];e<c&&(n=2,s=c);for(let h=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===h)break;if(i=s,s=t[--n-1],e>=s)break t}a=n,n=0}}for(;n<a;){const c=n+a>>>1;e<t[c]?a=c:n=c+1}if(i=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class qb extends Tl{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Oa,endingEnd:Oa}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,a=e+1,c=i[s],h=i[a];if(c===void 0)switch(this.getSettings_().endingStart){case Ia:s=e,c=2*t-n;break;case Sc:s=i.length-2,c=t+i[s]-i[s+1];break;default:s=e,c=n}if(h===void 0)switch(this.getSettings_().endingEnd){case Ia:a=e,h=2*n-t;break;case Sc:a=1,h=n+i[1]-i[0];break;default:a=e-1,h=t}const d=.5*(n-t),f=this.valueSize;this._weightPrev=d/(t-c),this._weightNext=d/(h-n),this._offsetPrev=s*f,this._offsetNext=a*f}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=e*c,d=h-c,f=this._offsetPrev,m=this._offsetNext,g=this._weightPrev,y=this._weightNext,S=(n-t)/(i-t),x=S*S,w=x*S,T=-g*w+2*g*x-g*S,_=(1+g)*w+(-1.5-2*g)*x+(-.5+g)*S+1,E=(-1-y)*w+(1.5+y)*x+.5*S,R=y*w-y*x;for(let P=0;P!==c;++P)s[P]=T*a[f+P]+_*a[d+P]+E*a[h+P]+R*a[m+P];return s}}class O0 extends Tl{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=e*c,d=h-c,f=(n-t)/(i-t),m=1-f;for(let g=0;g!==c;++g)s[g]=a[d+g]*m+a[h+g]*f;return s}}class Yb extends Tl{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class vr{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Wa(t,this.TimeBufferType),this.values=Wa(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Wa(e.times,Array),values:Wa(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Yb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new O0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new qb(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Bo:t=this.InterpolantFactoryMethodDiscrete;break;case Da:t=this.InterpolantFactoryMethodLinear;break;case Ah:t=this.InterpolantFactoryMethodSmooth}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Bo;case this.InterpolantFactoryMethodLinear:return Da;case this.InterpolantFactoryMethodSmooth:return Ah}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,a=i-1;for(;s!==i&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const c=this.getValueSize();this.times=Zi(n,s,a),this.values=Zi(this.values,s*c,a*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let c=0;c!==s;c++){const h=n[c];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,h),e=!1;break}if(a!==null&&a>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,h,a),e=!1;break}a=h}if(i!==void 0&&P0(i))for(let c=0,h=i.length;c!==h;++c){const d=i[c];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,d),e=!1;break}}return e}optimize(){const e=Zi(this.times),t=Zi(this.values),n=this.getValueSize(),i=this.getInterpolation()===Ah,s=e.length-1;let a=1;for(let c=1;c<s;++c){let h=!1;const d=e[c];if(d!==e[c+1]&&(c!==1||d!==e[0]))if(i)h=!0;else{const f=c*n,m=f-n,g=f+n;for(let y=0;y!==n;++y){const S=t[f+y];if(S!==t[m+y]||S!==t[g+y]){h=!0;break}}}if(h){if(c!==a){e[a]=e[c];const f=c*n,m=a*n;for(let g=0;g!==n;++g)t[m+g]=t[f+g]}++a}}if(s>0){e[a]=e[s];for(let c=s*n,h=a*n,d=0;d!==n;++d)t[h+d]=t[c+d];++a}return a!==e.length?(this.times=Zi(e,0,a),this.values=Zi(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=Zi(this.times,0),t=Zi(this.values,0),n=new this.constructor(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}vr.prototype.TimeBufferType=Float32Array,vr.prototype.ValueBufferType=Float32Array,vr.prototype.DefaultInterpolation=Da;class Xa extends vr{}Xa.prototype.ValueTypeName="bool",Xa.prototype.ValueBufferType=Array,Xa.prototype.DefaultInterpolation=Bo,Xa.prototype.InterpolantFactoryMethodLinear=void 0,Xa.prototype.InterpolantFactoryMethodSmooth=void 0;class I0 extends vr{}I0.prototype.ValueTypeName="color";class qa extends vr{}qa.prototype.ValueTypeName="number";class Qb extends Tl{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=(n-t)/(i-t);let d=e*c;for(let f=d+c;d!==f;d+=4)Ut.slerpFlat(s,0,a,d-c,a,d,h);return s}}class fs extends vr{InterpolantFactoryMethodLinear(e){return new Qb(this.times,this.values,this.getValueSize(),e)}}fs.prototype.ValueTypeName="quaternion",fs.prototype.DefaultInterpolation=Da,fs.prototype.InterpolantFactoryMethodSmooth=void 0;class Ya extends vr{}Ya.prototype.ValueTypeName="string",Ya.prototype.ValueBufferType=Array,Ya.prototype.DefaultInterpolation=Bo,Ya.prototype.InterpolantFactoryMethodLinear=void 0,Ya.prototype.InterpolantFactoryMethodSmooth=void 0;class Qa extends vr{}Qa.prototype.ValueTypeName="vector";class Za{constructor(e,t=-1,n,i=Tm){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Oi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let a=0,c=n.length;a!==c;++a)t.push(dL(n[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=n.length;s!==a;++s)t.push(vr.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,a=[];for(let c=0;c<s;c++){let h=[],d=[];h.push((c+s-1)%s,c,(c+1)%s),d.push(0,1,0);const f=Xb(h);h=C0(h,1,f),d=C0(d,1,f),i||h[0]!==0||(h.push(s),d.push(d[0])),a.push(new qa(".morphTargetInfluences["+t[c].name+"]",h,d).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let c=0,h=e.length;c<h;c++){const d=e[c],f=d.name.match(s);if(f&&f.length>1){const m=f[1];let g=i[m];g||(i[m]=g=[]),g.push(d)}}const a=[];for(const c in i)a.push(this.CreateFromMorphTargetSequence(c,i[c],t,n));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(f,m,g,y,S){if(g.length!==0){const x=[],w=[];D0(g,x,w,y),x.length!==0&&S.push(new f(m,x,w))}},i=[],s=e.name||"default",a=e.fps||30,c=e.blendMode;let h=e.length||-1;const d=e.hierarchy||[];for(let f=0;f<d.length;f++){const m=d[f].keys;if(m&&m.length!==0)if(m[0].morphTargets){const g={};let y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let S=0;S<m[y].morphTargets.length;S++)g[m[y].morphTargets[S]]=-1;for(const S in g){const x=[],w=[];for(let T=0;T!==m[y].morphTargets.length;++T){const _=m[y];x.push(_.time),w.push(_.morphTarget===S?1:0)}i.push(new qa(".morphTargetInfluence["+S+"]",x,w))}h=g.length*a}else{const g=".bones["+t[f].name+"]";n(Qa,g+".position",m,"pos",i),n(fs,g+".quaternion",m,"rot",i),n(Qa,g+".scale",m,"scl",i)}}return i.length===0?null:new this(s,h,i,c)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function dL(l){if(l.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return qa;case"vector":case"vector2":case"vector3":case"vector4":return Qa;case"color":return I0;case"quaternion":return fs;case"bool":case"boolean":return Xa;case"string":return Ya}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(l.type);if(l.times===void 0){const t=[],n=[];D0(l.keys,t,n,"value"),l.times=t,l.values=n}return e.parse!==void 0?e.parse(l):new e(l.name,l.times,l.values,l.interpolation)}const qs={enabled:!1,files:{},add:function(l,e){this.enabled!==!1&&(this.files[l]=e)},get:function(l){if(this.enabled!==!1)return this.files[l]},remove:function(l){delete this.files[l]},clear:function(){this.files={}}};class N0{constructor(e,t,n){const i=this;let s,a=!1,c=0,h=0;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(f){h++,a===!1&&i.onStart!==void 0&&i.onStart(f,c,h),a=!0},this.itemEnd=function(f){c++,i.onProgress!==void 0&&i.onProgress(f,c,h),c===h&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(f){i.onError!==void 0&&i.onError(f)},this.resolveURL=function(f){return s?s(f):f},this.setURLModifier=function(f){return s=f,this},this.addHandler=function(f,m){return d.push(f,m),this},this.removeHandler=function(f){const m=d.indexOf(f);return m!==-1&&d.splice(m,2),this},this.getHandler=function(f){for(let m=0,g=d.length;m<g;m+=2){const y=d[m],S=d[m+1];if(y.global&&(y.lastIndex=0),y.test(f))return S}return null}}}const Zb=new N0;class Qn{constructor(e){this.manager=e!==void 0?e:Zb,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,s){n.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}async function Kb(l){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(l)})}const ms={};class pL extends Error{constructor(e,t){super(e),this.response=t}}class hi extends Qn{constructor(e){super(e)}load(e,t,n,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=qs.get(e);if(a===void 0&&s)return this.manager.itemStart(e),void(this.responseType==="arraybuffer"?async function(f){return new Promise((m,g)=>{const y=new FileReader;y.onload=()=>m(y.result),y.onerror=g,y.readAsArrayBuffer(f)})}(s):async function(f){return new Promise((m,g)=>{const y=new FileReader;y.onload=()=>m(y.result),y.onerror=g,y.readAsText(f)})}(s)).then(f=>{qs.add(e,f),t&&t(f),this.manager.itemEnd(e)});if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(ms[e]!==void 0)return void ms[e].push({onLoad:t,onProgress:n,onError:i});ms[e]=[],ms[e].push({onLoad:t,onProgress:n,onError:i});const c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),h=this.mimeType,d=this.responseType;fetch(c).then(f=>{if(f.status===200||f.status===0){if(f.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||f.body===void 0||f.body.getReader===void 0)return f;const m=ms[e],g=f.body.getReader(),y=f.headers.get("Content-Length")||f.headers.get("X-File-Size"),S=y?parseInt(y):0,x=S!==0;let w=0;const T=new ReadableStream({start(_){(function E(){g.read().then(({done:R,value:P})=>{if(R)_.close();else{w+=P.byteLength;const C=new ProgressEvent("progress",{lengthComputable:x,loaded:w,total:S});for(let F=0,W=m.length;F<W;F++){const B=m[F];B.onProgress&&B.onProgress(C)}_.enqueue(P),E()}})})()}});return new Response(T)}throw new pL(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`,f)}).then(f=>{switch(d){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(m=>new DOMParser().parseFromString(m,h));case"json":return f.json();default:if(h===void 0)return f.text();{const m=/charset="?([^;"\s]*)"?/i.exec(h),g=m&&m[1]?m[1].toLowerCase():void 0,y=new TextDecoder(g);return f.arrayBuffer().then(S=>y.decode(S))}}}).then(f=>{qs.add(e,f);const m=ms[e];delete ms[e];for(let g=0,y=m.length;g<y;g++){const S=m[g];S.onLoad&&S.onLoad(f)}}).catch(f=>{const m=ms[e];if(m===void 0)throw this.manager.itemError(e),f;delete ms[e];for(let g=0,y=m.length;g<y;g++){const S=m[g];S.onError&&S.onError(f)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class fL extends Qn{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new hi(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(h){i?i(h):console.error(h),s.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Za.parse(e[n]);t.push(i)}return t}}class mL extends Qn{constructor(e){super(e)}load(e,t,n,i){const s=this,a=[],c=new m0,h=new hi(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(s.withCredentials);let d=0;function f(m){h.load(e[m],function(g){const y=s.parse(g,!0);a[m]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},d+=1,d===6&&(y.mipmapCount===1&&(c.minFilter=at),c.image=a,c.format=y.format,c.needsUpdate=!0,t&&t(c))},n,i)}if(Array.isArray(e))for(let m=0,g=e.length;m<g;++m)f(m);else h.load(e,function(m){const g=s.parse(m,!0);if(g.isCubemap){const y=g.mipmaps.length/g.mipmapCount;for(let S=0;S<y;S++){a[S]={mipmaps:[]};for(let x=0;x<g.mipmapCount;x++)a[S].mipmaps.push(g.mipmaps[S*g.mipmapCount+x]),a[S].format=g.format,a[S].width=g.width,a[S].height=g.height}c.image=a}else c.image.width=g.width,c.image.height=g.height,c.mipmaps=g.mipmaps;g.mipmapCount===1&&(c.minFilter=at),c.format=g.format,c.needsUpdate=!0,t&&t(c)},n,i);return c}}class Zc extends Qn{constructor(e){super(e)}load(e,t,n,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=qs.get(e);if(c!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c;const h=Tc("img");function d(){m(),qs.add(e,this),t&&t(this),a.manager.itemEnd(e)}function f(g){m(),i&&i(g),a.manager.itemError(e),a.manager.itemEnd(e)}function m(){h.removeEventListener("load",d,!1),h.removeEventListener("error",f,!1)}return h.addEventListener("load",d,!1),h.addEventListener("error",f,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(h.crossOrigin=this.crossOrigin),a.manager.itemStart(e),s?Kb(s).then(g=>{h.src=g}):h.src=e,h}}class gL extends Qn{constructor(e){super(e)}load(e,t,n,i){const s=new Ic,a=new Zc(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let c=0;function h(d){a.load(e[d],function(f){s.images[d]=f,c++,c===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let d=0;d<e.length;++d)h(d);return s}}class Jb extends Qn{constructor(e){super(e)}load(e,t,n,i,s){const a=this,c=new Gs,h=new hi(this.manager);return h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setPath(this.path),h.setWithCredentials(a.withCredentials),h.load(e,function(d){const f=a.parse(d);f&&(f.image!==void 0?c.image=f.image:f.data!==void 0&&(c.image.width=f.width,c.image.height=f.height,c.image.data=f.data),c.wrapS=f.wrapS!==void 0?f.wrapS:bn,c.wrapT=f.wrapT!==void 0?f.wrapT:bn,c.magFilter=f.magFilter!==void 0?f.magFilter:at,c.minFilter=f.minFilter!==void 0?f.minFilter:at,c.anisotropy=f.anisotropy!==void 0?f.anisotropy:1,f.encoding!==void 0&&(c.encoding=f.encoding),f.flipY!==void 0&&(c.flipY=f.flipY),f.format!==void 0&&(c.format=f.format),f.type!==void 0&&(c.type=f.type),f.mipmaps!==void 0&&(c.mipmaps=f.mipmaps,c.minFilter=cr),f.mipmapCount===1&&(c.minFilter=at),f.generateMipmaps!==void 0&&(c.generateMipmaps=f.generateMipmaps),c.needsUpdate=!0,t&&t(c,f))},n,i,s),c}}class Ed extends Qn{constructor(e){super(e)}load(e,t,n,i,s){const a=new zt,c=new Zc(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(h){a.image=h,a.needsUpdate=!0,t!==void 0&&t(a)},n,i,s),a}}class Ys extends ct{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ie(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class $b extends Ys{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ct.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ie(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const k0=new Ne,eS=new O,tS=new O;class F0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new de(512,512),this.map=null,this.mapPass=null,this.matrix=new Ne,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Nc,this._frameExtents=new de(1,1),this._viewportCount=1,this._viewports=[new Ke(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;eS.setFromMatrixPosition(e.matrixWorld),t.position.copy(eS),tS.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(tS),t.updateMatrixWorld(),k0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(k0),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(k0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class vL extends F0{constructor(){super(new Kt(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*_c*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;n===t.fov&&i===t.aspect&&s===t.far||(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Ad extends Ys{constructor(e,t,n=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ct.DEFAULT_UP),this.updateMatrix(),this.target=new ct,this.distance=n,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new vL}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const nS=new Ne,Kc=new O,U0=new O;class yL extends F0{constructor(){super(new Kt(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new de(4,2),this._viewportCount=6,this._viewports=[new Ke(2,1,1,1),new Ke(0,1,1,1),new Ke(3,1,1,1),new Ke(1,1,1,1),new Ke(3,0,1,1),new Ke(1,0,1,1)],this._cubeDirections=[new O(1,0,0),new O(-1,0,0),new O(0,0,1),new O(0,0,-1),new O(0,1,0),new O(0,-1,0)],this._cubeUps=[new O(0,1,0),new O(0,1,0),new O(0,1,0),new O(0,1,0),new O(0,0,1),new O(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Kc.setFromMatrixPosition(e.matrixWorld),n.position.copy(Kc),U0.copy(n.position),U0.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(U0),n.updateMatrixWorld(),i.makeTranslation(-Kc.x,-Kc.y,-Kc.z),nS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(nS)}}class Jc extends Ys{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new yL}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class xL extends F0{constructor(){super(new Hs(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Rd extends Ys{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ct.DEFAULT_UP),this.updateMatrix(),this.target=new ct,this.shadow=new xL}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class z0 extends Ys{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class iS extends Ys{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class rS{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new O)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*i*1.092548),t.addScaledVector(a[5],i*s*1.092548),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],n*s*1.092548),t.addScaledVector(a[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*i),t.addScaledVector(a[2],1.023328*s),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*i),t.addScaledVector(a[5],.858086*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],.858086*n*s),t.addScaledVector(a[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}class Ld extends Ys{constructor(e=new rS,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Pd extends Qn{constructor(e){super(e),this.textures={}}load(e,t,n,i){const s=this,a=new hi(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(h){i?i(h):console.error(h),s.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=Pd.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Ie().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=n(a.value);break;case"c":i.uniforms[s].value=new Ie().setHex(a.value);break;case"v2":i.uniforms[s].value=new de().fromArray(a.value);break;case"v3":i.uniforms[s].value=new O().fromArray(a.value);break;case"v4":i.uniforms[s].value=new Ke().fromArray(a.value);break;case"m3":i.uniforms[s].value=new mn().fromArray(a.value);break;case"m4":i.uniforms[s].value=new Ne().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new de().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new de().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:jb,SpriteMaterial:c0,RawShaderMaterial:Hb,ShaderMaterial:St,PointsMaterial:pd,MeshPhysicalMaterial:ps,MeshStandardMaterial:Bt,MeshPhongMaterial:Qc,MeshToonMaterial:Gb,MeshNormalMaterial:R0,MeshLambertMaterial:L0,MeshDepthMaterial:td,MeshDistanceMaterial:o0,MeshBasicMaterial:xi,MeshMatcapMaterial:Vb,LineDashedMaterial:Wb,LineBasicMaterial:Un,Material:un}[e]}}class Ka{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Cd extends $e{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class sS extends Qn{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new hi(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(h){i?i(h):console.error(h),s.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(m,g){if(t[g]!==void 0)return t[g];const y=m.interleavedBuffers[g],S=function(T,_){if(n[_]!==void 0)return n[_];const E=T.arrayBuffers,R=E[_],P=new Uint32Array(R).buffer;return n[_]=P,P}(m,y.buffer),x=Ho(y.type,S),w=new sl(x,y.stride);return w.uuid=y.uuid,t[g]=w,w}const s=e.isInstancedBufferGeometry?new Cd:new $e,a=e.data.index;if(a!==void 0){const m=Ho(a.type,a.array);s.setIndex(new tt(m,1))}const c=e.data.attributes;for(const m in c){const g=c[m];let y;if(g.isInterleavedBufferAttribute){const S=i(e.data,g.data);y=new ui(S,g.itemSize,g.offset,g.normalized)}else{const S=Ho(g.type,g.array);y=new(g.isInstancedBufferAttribute?Vs:tt)(S,g.itemSize,g.normalized)}g.name!==void 0&&(y.name=g.name),g.usage!==void 0&&y.setUsage(g.usage),g.updateRange!==void 0&&(y.updateRange.offset=g.updateRange.offset,y.updateRange.count=g.updateRange.count),s.setAttribute(m,y)}const h=e.data.morphAttributes;if(h)for(const m in h){const g=h[m],y=[];for(let S=0,x=g.length;S<x;S++){const w=g[S];let T;if(w.isInterleavedBufferAttribute){const _=i(e.data,w.data);T=new ui(_,w.itemSize,w.offset,w.normalized)}else{const _=Ho(w.type,w.array);T=new tt(_,w.itemSize,w.normalized)}w.name!==void 0&&(T.name=w.name),y.push(T)}s.morphAttributes[m]=y}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let m=0,g=d.length;m!==g;++m){const y=d[m];s.addGroup(y.start,y.count,y.materialIndex)}const f=e.data.boundingSphere;if(f!==void 0){const m=new O;f.center!==void 0&&m.fromArray(f.center),s.boundingSphere=new rs(m,f.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}}class bL extends Qn{constructor(e){super(e)}load(e,t,n,i){const s=this,a=this.path===""?Ka.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const c=new hi(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(h){let d=null;try{d=JSON.parse(h)}catch(m){return i!==void 0&&i(m),void console.error("THREE:ObjectLoader: Can't parse "+e+".",m.message)}const f=d.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")return i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(d,t)},n,i)}async loadAsync(e,t){const n=this.path===""?Ka.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new hi(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const s=await i.loadAsync(e,t),a=JSON.parse(s),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(d)}),c=this.parseTextures(e.textures,a),h=this.parseMaterials(e.materials,c),d=this.parseObject(e.object,s,h,c,n),f=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,f),t!==void 0){let m=!1;for(const g in a)if(a[g].data instanceof HTMLImageElement){m=!0;break}m===!1&&t(d)}return d}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),c=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,i,c,a,t),d=this.parseSkeletons(e.skeletons,h);return this.bindSkeletons(h,d),h}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const s=new ds().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const c=new hl().fromJSON(e[s],i);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new sS;for(let s=0,a=e.length;s<a;s++){let c;const h=e[s];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":c=i.parse(h);break;default:h.type in o?c=o[h.type].fromJSON(h,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${h.type}"`)}c.uuid=h.uuid,h.name!==void 0&&(c.name=h.name),h.userData!==void 0&&(c.userData=h.userData),n[h.uuid]=c}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const s=new Pd;s.setTextures(t);for(let a=0,c=e.length;a<c;a++){const h=e[a];n[h.uuid]===void 0&&(n[h.uuid]=s.parse(h)),i[h.uuid]=n[h.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],s=Za.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const n=this,i={};let s;function a(c){if(typeof c=="string"){const h=c;return function(d){return n.manager.itemStart(d),s.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h)}return c.data?{data:Ho(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new N0(t);s=new Zc(c),s.setCrossOrigin(this.crossOrigin);for(let h=0,d=e.length;h<d;h++){const f=e[h],m=f.url;if(Array.isArray(m)){const g=[];for(let y=0,S=m.length;y<S;y++){const x=a(m[y]);x!==null&&(x instanceof HTMLImageElement?g.push(x):g.push(new Gs(x.data,x.width,x.height)))}i[f.uuid]=new ka(g)}else{const g=a(f.url);i[f.uuid]=new ka(g)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function s(a){if(typeof a=="string"){const c=a,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await i.loadAsync(h)}return a.data?{data:Ho(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new Zc(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,c=e.length;a<c;a++){const h=e[a],d=h.url;if(Array.isArray(d)){const f=[];for(let m=0,g=d.length;m<g;m++){const y=d[m],S=await s(y);S!==null&&(S instanceof HTMLImageElement?f.push(S):f.push(new Gs(S.data,S.width,S.height)))}n[h.uuid]=new ka(f)}else{const f=await s(h.url);n[h.uuid]=new ka(f)}}}return n}parseTextures(e,t){function n(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const c=e[s];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const h=t[c.image],d=h.data;let f;Array.isArray(d)?(f=new Ic,d.length===6&&(f.needsUpdate=!0)):(f=d&&d.data?new Gs:new zt,d&&(f.needsUpdate=!0)),f.source=h,f.uuid=c.uuid,c.name!==void 0&&(f.name=c.name),c.mapping!==void 0&&(f.mapping=n(c.mapping,SL)),c.offset!==void 0&&f.offset.fromArray(c.offset),c.repeat!==void 0&&f.repeat.fromArray(c.repeat),c.center!==void 0&&f.center.fromArray(c.center),c.rotation!==void 0&&(f.rotation=c.rotation),c.wrap!==void 0&&(f.wrapS=n(c.wrap[0],aS),f.wrapT=n(c.wrap[1],aS)),c.format!==void 0&&(f.format=c.format),c.internalFormat!==void 0&&(f.internalFormat=c.internalFormat),c.type!==void 0&&(f.type=c.type),c.encoding!==void 0&&(f.encoding=c.encoding),c.minFilter!==void 0&&(f.minFilter=n(c.minFilter,oS)),c.magFilter!==void 0&&(f.magFilter=n(c.magFilter,oS)),c.anisotropy!==void 0&&(f.anisotropy=c.anisotropy),c.flipY!==void 0&&(f.flipY=c.flipY),c.generateMipmaps!==void 0&&(f.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(f.unpackAlignment=c.unpackAlignment),c.userData!==void 0&&(f.userData=c.userData),i[c.uuid]=f}return i}parseObject(e,t,n,i,s){let a,c,h;function d(g){return t[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",g),t[g]}function f(g){if(g!==void 0){if(Array.isArray(g)){const y=[];for(let S=0,x=g.length;S<x;S++){const w=g[S];n[w]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",w),y.push(n[w])}return y}return n[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),n[g]}}function m(g){return i[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",g),i[g]}switch(e.type){case"Scene":a=new ja,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Ie(e.background):a.background=m(e.background)),e.environment!==void 0&&(a.environment=m(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new rd(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new id(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new Kt(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Hs(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new z0(e.color,e.intensity);break;case"DirectionalLight":a=new Rd(e.color,e.intensity);break;case"PointLight":a=new Jc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new iS(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Ad(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new $b(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new Ld().fromJSON(e);break;case"SkinnedMesh":c=d(e.geometry),h=f(e.material),a=new cd(c,h),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":c=d(e.geometry),h=f(e.material),a=new et(c,h);break;case"InstancedMesh":c=d(e.geometry),h=f(e.material);const g=e.count,y=e.instanceMatrix,S=e.instanceColor;a=new hd(c,h,g),a.instanceMatrix=new Vs(new Float32Array(y.array),16),S!==void 0&&(a.instanceColor=new Vs(new Float32Array(S.array),S.itemSize));break;case"LOD":a=new pb;break;case"Line":a=new kr(d(e.geometry),f(e.material));break;case"LineLoop":a=new d0(d(e.geometry),f(e.material));break;case"LineSegments":a=new gr(d(e.geometry),f(e.material));break;case"PointCloud":case"Points":a=new f0(d(e.geometry),f(e.material));break;case"Sprite":a=new hb(f(e.material));break;case"Group":a=new Yn;break;case"Bone":a=new ul;break;default:a=new ct}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const g=e.children;for(let y=0;y<g.length;y++)a.add(this.parseObject(g[y],t,n,i,s))}if(e.animations!==void 0){const g=e.animations;for(let y=0;y<g.length;y++){const S=g[y];a.animations.push(s[S])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const g=e.levels;for(let y=0;y<g.length;y++){const S=g[y],x=a.getObjectByProperty("uuid",S.object);x!==void 0&&a.addLevel(x,S.distance,S.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}}const SL={UVMapping:xh,CubeReflectionMapping:Ds,CubeRefractionMapping:Os,EquirectangularReflectionMapping:Is,EquirectangularRefractionMapping:xc,CubeUVReflectionMapping:Fo},aS={RepeatWrapping:vi,ClampToEdgeWrapping:bn,MirroredRepeatWrapping:Uo},oS={NearestFilter:Rt,NearestMipmapNearestFilter:bc,NearestMipmapLinearFilter:zo,LinearFilter:at,LinearMipmapNearestFilter:bh,LinearMipmapLinearFilter:cr};class lS extends Qn{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=qs.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,fetch(e,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){qs.add(e,h),t&&t(h),s.manager.itemEnd(e)}).catch(function(h){i&&i(h),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Dd;class B0{static getContext(){return Dd===void 0&&(Dd=new(window.AudioContext||window.webkitAudioContext)),Dd}static setContext(e){Dd=e}}class cS extends Qn{constructor(e){super(e)}load(e,t,n,i,s){const a=this,c=new hi(this.manager);c.setResponseType("arraybuffer"),c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(h){try{const d=h.slice(0);B0.getContext().decodeAudioData(d,function(f){t(f)})}catch(d){i?i(d):console.error(d),a.manager.itemError(e)}},n,i,s==null?void 0:s.mainFile)}}class wL extends Ld{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const i=new Ie().set(e),s=new Ie().set(t),a=new O(i.r,i.g,i.b),c=new O(s.r,s.g,s.b),h=Math.sqrt(Math.PI),d=h*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(c).multiplyScalar(h),this.sh.coefficients[1].copy(a).sub(c).multiplyScalar(d)}}class _L extends Ld{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=new Ie().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const uS=new Ne,hS=new Ne,Ja=new Ne;class ML{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Kt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Kt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Ja.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,s=t.near*Math.tan(Na*t.fov*.5)/t.zoom;let a,c;hS.elements[12]=-n,uS.elements[12]=n,a=-s*t.aspect+i,c=s*t.aspect+i,Ja.elements[0]=2*t.near/(c-a),Ja.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(Ja),a=-s*t.aspect-i,c=s*t.aspect-i,Ja.elements[0]=2*t.near/(c-a),Ja.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(Ja)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hS),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(uS)}}class dS{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=pS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=pS();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function pS(){return(typeof performance>"u"?Date:performance).now()}const $a=new O,fS=new Ut,TL=new O,eo=new O;class Od extends ct{constructor(){super(),this.type="AudioListener",this.context=B0.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dS}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose($a,fS,TL),eo.set(0,0,-1).applyQuaternion(fS),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime($a.x,i),t.positionY.linearRampToValueAtTime($a.y,i),t.positionZ.linearRampToValueAtTime($a.z,i),t.forwardX.linearRampToValueAtTime(eo.x,i),t.forwardY.linearRampToValueAtTime(eo.y,i),t.forwardZ.linearRampToValueAtTime(eo.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition($a.x,$a.y,$a.z),t.setOrientation(eo.x,eo.y,eo.z,n.x,n.y,n.z)}}class j0 extends ct{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl!==!1)return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl!==!1)return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const to=new O,mS=new Ut,EL=new O,no=new O;class gS extends j0{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(to,mS,EL),no.set(0,0,1).applyQuaternion(mS);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(to.x,n),t.positionY.linearRampToValueAtTime(to.y,n),t.positionZ.linearRampToValueAtTime(to.z,n),t.orientationX.linearRampToValueAtTime(no.x,n),t.orientationY.linearRampToValueAtTime(no.y,n),t.orientationZ.linearRampToValueAtTime(no.z,n)}else t.setPosition(to.x,to.y,to.z),t.setOrientation(no.x,no.y,no.z)}}class AL{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class vS{constructor(e,t,n){let i,s,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let c=0;c!==i;++c)n[s+c]=n[c];a=t}else{a+=t;const c=t/a;this._mixBufferRegion(n,s,0,c,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const h=t*this._origIndex;this._mixBufferRegion(n,i,h,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let h=t,d=t+t;h!==d;++h)if(n[h]!==n[h+t]){c.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let s=n,a=i;s!==a;++s)t[s]=t[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,i){Ut.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const a=this._workIndex*s;Ut.multiplyQuaternionsFlat(e,a,e,t,e,n),Ut.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,n,i,s){const a=1-i;for(let c=0;c!==s;++c){const h=t+c;e[h]=e[h]*a+e[n+c]*i}}_lerpAdditive(e,t,n,i,s){for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]+e[n+a]*i}}}const H0="\\[\\]\\.:\\/",RL=new RegExp("["+H0+"]","g"),G0="[^"+H0+"]",LL="[^"+H0.replace("\\.","")+"]",PL=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",G0)+/(WCOD+)?/.source.replace("WCOD",LL)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",G0)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",G0)+"$"),CL=["material","materials","bones","map"];class gt{constructor(e,t,n){this.path=t,this.parsedPath=n||gt.parseTrackName(t),this.node=gt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new gt.Composite(e,t,n):new gt(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(RL,"")}static parseTrackName(e){const t=PL.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);CL.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const c=s[a];if(c.name===t||c.uuid===t)return c;const h=n(c.children);if(h)return h}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=gt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let d=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===d){d=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(e[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(d!==void 0){if(e[d]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[d]}}const a=e[i];if(a===void 0){const d=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+i+" but it wasn't found.",e)}let c=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}h=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(h=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}gt.Composite=class{constructor(l,e,t){const n=t||gt.parseTrackName(e);this._targetGroup=l,this._bindings=l.subscribe_(e,n)}getValue(l,e){this.bind();const t=this._targetGroup.nCachedObjects_,n=this._bindings[t];n!==void 0&&n.getValue(l,e)}setValue(l,e){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=t.length;n!==i;++n)t[n].setValue(l,e)}bind(){const l=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=l.length;e!==t;++e)l[e].bind()}unbind(){const l=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=l.length;e!==t;++e)l[e].unbind()}},gt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},gt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},gt.prototype.GetterByBindingType=[gt.prototype._getValue_direct,gt.prototype._getValue_array,gt.prototype._getValue_arrayElement,gt.prototype._getValue_toArray],gt.prototype.SetterByBindingTypeAndVersioning=[[gt.prototype._setValue_direct,gt.prototype._setValue_direct_setNeedsUpdate,gt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[gt.prototype._setValue_array,gt.prototype._setValue_array_setNeedsUpdate,gt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[gt.prototype._setValue_arrayElement,gt.prototype._setValue_arrayElement_setNeedsUpdate,gt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[gt.prototype._setValue_fromArray,gt.prototype._setValue_fromArray_setNeedsUpdate,gt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class DL{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Oi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let c,h=e.length,d=this.nCachedObjects_;for(let f=0,m=arguments.length;f!==m;++f){const g=arguments[f],y=g.uuid;let S=t[y];if(S===void 0){S=h++,t[y]=S,e.push(g);for(let x=0,w=a;x!==w;++x)s[x].push(new gt(g,n[x],i[x]))}else if(S<d){c=e[S];const x=--d,w=e[x];t[w.uuid]=S,e[S]=w,t[y]=x,e[x]=g;for(let T=0,_=a;T!==_;++T){const E=s[T],R=E[x];let P=E[S];E[S]=R,P===void 0&&(P=new gt(g,n[T],i[T])),E[x]=P}}else e[S]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_;for(let a=0,c=arguments.length;a!==c;++a){const h=arguments[a],d=h.uuid,f=t[d];if(f!==void 0&&f>=s){const m=s++,g=e[m];t[g.uuid]=f,e[f]=g,t[d]=m,e[m]=h;for(let y=0,S=i;y!==S;++y){const x=n[y],w=x[m],T=x[f];x[f]=w,x[m]=T}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_,a=e.length;for(let c=0,h=arguments.length;c!==h;++c){const d=arguments[c].uuid,f=t[d];if(f!==void 0)if(delete t[d],f<s){const m=--s,g=e[m],y=--a,S=e[y];t[g.uuid]=f,e[f]=g,t[S.uuid]=m,e[m]=S,e.pop();for(let x=0,w=i;x!==w;++x){const T=n[x],_=T[m],E=T[y];T[f]=_,T[m]=E,T.pop()}}else{const m=--a,g=e[m];m>0&&(t[g.uuid]=f),e[f]=g,e.pop();for(let y=0,S=i;y!==S;++y){const x=n[y];x[f]=x[m],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,c=this._parsedPaths,h=this._objects,d=h.length,f=this.nCachedObjects_,m=new Array(d);i=s.length,n[e]=i,a.push(e),c.push(t),s.push(m);for(let g=f,y=h.length;g!==y;++g){const S=h[g];m[g]=new gt(S,e,t)}return m}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,c=a.length-1,h=a[c];t[e[c]]=n,a[n]=h,a.pop(),s[n]=s[c],s.pop(),i[n]=i[c],i.pop()}}}class OL{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,a=s.length,c=new Array(a),h={endingStart:Oa,endingEnd:Oa};for(let d=0;d!==a;++d){const f=s[d].createInterpolant(null);c[d]=f,f.settings=h}this._interpolantSettings=h,this._interpolants=c,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ax,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,s=e._clip.duration,a=s/i,c=i/s;e.warp(1,a,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,a=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=i._lendControlInterpolant(),this._timeScaleInterpolant=c);const h=c.parameterPositions,d=c.sampleValues;return h[0]=s,h[1]=s+n,d[0]=e/a,d[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(s!==null){const h=(e-s)*n;h<0||n===0?t=0:(this._startTime=null,t=n*h)}t*=this._updateTimeScale(e);const a=this._updateTime(t),c=this._updateWeight(e);if(c>0){const h=this._interpolants,d=this._propertyBindings;if(this.blendMode===Em)for(let f=0,m=h.length;f!==m;++f)h[f].evaluate(a),d[f].accumulateAdditive(c);else for(let f=0,m=h.length;f!==m;++f)h[f].evaluate(a),d[f].accumulate(i,c)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const a=n===ox;if(e===0)return s===-1?i:a&&(1&s)==1?t-i:i;if(n===sx){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const c=Math.floor(i/t);i-=t*c,s+=Math.abs(c);const h=this.repetitions-s;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const d=e<0;this._setEndings(d,!d,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=i;if(a&&(1&s)==1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Ia,i.endingEnd=Ia):(i.endingStart=e?this.zeroSlopeAtStart?Ia:Oa:Sc,i.endingEnd=t?this.zeroSlopeAtEnd?Ia:Oa:Sc)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const c=a.parameterPositions,h=a.sampleValues;return c[0]=s,h[0]=t,c[1]=s+e,h[1]=n,this}}const IL=new Float32Array(1);class NL extends Xi{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,c=e._interpolants,h=n.uuid,d=this._bindingsByRootAndName;let f=d[h];f===void 0&&(f={},d[h]=f);for(let m=0;m!==s;++m){const g=i[m],y=g.name;let S=f[y];if(S!==void 0)++S.referenceCount,a[m]=S;else{if(S=a[m],S!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,h,y));continue}const x=t&&t._propertyBindings[m].binding.parsedPath;S=new vS(gt.create(n,y,x),g.ValueTypeName,g.getValueSize()),++S.referenceCount,this._addInactiveBinding(S,h,y),a[m]=S}c[m].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];s.useCount++==0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.useCount==0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const c=a.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,c=a[s],h=c.knownActions,d=h[h.length-1],f=e._byClipCacheIndex;d._byClipCacheIndex=f,h[f]=d,h.pop(),e._byClipCacheIndex=null,delete c.actionByRoot[(e._localRoot||this._root).uuid],h.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.referenceCount==0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,c=a[i],h=t[t.length-1],d=e._cacheIndex;h._cacheIndex=d,t[d]=h,t.pop(),delete c[s],Object.keys(c).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new O0(new Float32Array(2),new Float32Array(2),1,IL),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?Za.findByName(i,e):e;const c=a!==null?a.uuid:e,h=this._actionsByClip[c];let d=null;if(n===void 0&&(n=a!==null?a.blendMode:Tm),h!==void 0){const m=h.actionByRoot[s];if(m!==void 0&&m.blendMode===n)return m;d=h.knownActions[0],a===null&&(a=d._clip)}if(a===null)return null;const f=new OL(this,a,t,n);return this._bindAction(f,d),this._addInactiveAction(f,c,s),f}existingAction(e,t){const n=t||this._root,i=n.uuid,s=typeof e=="string"?Za.findByName(n,e):e,a=s?s.uuid:e,c=this._actionsByClip[a];return c!==void 0&&c.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let d=0;d!==n;++d)t[d]._update(i,e,s,a);const c=this._bindings,h=this._nActiveBindings;for(let d=0;d!==h;++d)c[d].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const a=s.knownActions;for(let c=0,h=a.length;c!==h;++c){const d=a[c];this._deactivateAction(d);const f=d._cacheIndex,m=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,m._cacheIndex=f,t[f]=m,t.pop(),this._removeInactiveBindingsForAction(d)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const s in n){const a=n[s].actionByRoot[t];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}const i=this._bindingsByRootAndName[t];if(i!==void 0)for(const s in i){const a=i[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Ge{constructor(e){this.value=e}clone(){return new Ge(this.value.clone===void 0?this.value:this.value.clone())}}let kL=0;class FL extends Xi{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:kL++}),this.name="",this.usage=wc,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++)this.uniforms.push(t[n].clone());return this}clone(){return new this.constructor().copy(this)}}class yS extends sl{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class UL{constructor(e,t,n,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class zL{constructor(e,t,n=0,i=1/0){this.ray=new Rc(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Uh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return V0(e,this,n,t),n.sort(xS),n}intersectObjects(e,t=!0,n=[]){for(let i=0,s=e.length;i<s;i++)V0(e[i],this,n,t);return n.sort(xS),n}}function xS(l,e){return l.distance-e.distance}function V0(l,e,t,n){if(l.layers.test(e.layers)&&l.raycast(e,t),n===!0){const i=l.children;for(let s=0,a=i.length;s<a;s++)V0(i[s],e,t,!0)}}class bS{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(an(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class BL{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const SS=new de;class jL{constructor(e=new de(1/0,1/0),t=new de(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=SS.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,SS).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wS=new O,Id=new O;class HL{constructor(e=new O,t=new O){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){wS.subVectors(e,this.start),Id.subVectors(this.end,this.start);const n=Id.dot(Id);let i=Id.dot(wS)/n;return t&&(i=an(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _S=new O;class MS extends ct{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new $e,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,c=1,h=32;a<h;a++,c++){const d=a/h*Math.PI*2,f=c/h*Math.PI*2;i.push(Math.cos(d),Math.sin(d),1,Math.cos(f),Math.sin(f),1)}n.setAttribute("position",new We(i,3));const s=new Un({fog:!1,toneMapped:!1});this.cone=new gr(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),_S.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_S),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Qs=new O,Nd=new Ne,W0=new Ne;class GL extends gr{constructor(e){const t=TS(e),n=new $e,i=[],s=[],a=new Ie(0,0,1),c=new Ie(0,1,0);for(let h=0;h<t.length;h++){const d=t[h];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(c.r,c.g,c.b))}n.setAttribute("position",new We(i,3)),n.setAttribute("color",new We(s,3)),super(n,new Un({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");W0.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const c=t[s];c.parent&&c.parent.isBone&&(Nd.multiplyMatrices(W0,c.matrixWorld),Qs.setFromMatrixPosition(Nd),i.setXYZ(a,Qs.x,Qs.y,Qs.z),Nd.multiplyMatrices(W0,c.parent.matrixWorld),Qs.setFromMatrixPosition(Nd),i.setXYZ(a+1,Qs.x,Qs.y,Qs.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function TS(l){const e=[];l.isBone===!0&&e.push(l);for(let t=0;t<l.children.length;t++)e.push.apply(e,TS(l.children[t]));return e}class ES extends et{constructor(e,t,n){super(new Xs(t,4,2),new xi({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const VL=new O,AS=new Ie,RS=new Ie;class WL extends ct{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Va(t);i.rotateY(.5*Math.PI),this.material=new xi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(3*s.count);i.setAttribute("color",new tt(a,3)),this.add(new et(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");AS.copy(this.light.color),RS.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const s=n<i/2?AS:RS;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(VL.setFromMatrixPosition(this.light.matrixWorld).negate())}}class XL extends gr{constructor(e=10,t=10,n=4473924,i=8947848){n=new Ie(n),i=new Ie(i);const s=t/2,a=e/t,c=e/2,h=[],d=[];for(let m=0,g=0,y=-c;m<=t;m++,y+=a){h.push(-c,0,y,c,0,y),h.push(y,0,-c,y,0,c);const S=m===s?n:i;S.toArray(d,g),g+=3,S.toArray(d,g),g+=3,S.toArray(d,g),g+=3,S.toArray(d,g),g+=3}const f=new $e;f.setAttribute("position",new We(h,3)),f.setAttribute("color",new We(d,3)),super(f,new Un({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class qL extends gr{constructor(e=10,t=16,n=8,i=64,s=4473924,a=8947848){s=new Ie(s),a=new Ie(a);const c=[],h=[];if(t>1)for(let f=0;f<t;f++){const m=f/t*(2*Math.PI),g=Math.sin(m)*e,y=Math.cos(m)*e;c.push(0,0,0),c.push(g,0,y);const S=1&f?s:a;h.push(S.r,S.g,S.b),h.push(S.r,S.g,S.b)}for(let f=0;f<n;f++){const m=1&f?s:a,g=e-e/n*f;for(let y=0;y<i;y++){let S=y/i*(2*Math.PI),x=Math.sin(S)*g,w=Math.cos(S)*g;c.push(x,0,w),h.push(m.r,m.g,m.b),S=(y+1)/i*(2*Math.PI),x=Math.sin(S)*g,w=Math.cos(S)*g,c.push(x,0,w),h.push(m.r,m.g,m.b)}}const d=new $e;d.setAttribute("position",new We(c,3)),d.setAttribute("color",new We(h,3)),super(d,new Un({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const LS=new O,kd=new O,PS=new O;class CS extends ct{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new $e;i.setAttribute("position",new We([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Un({fog:!1,toneMapped:!1});this.lightPlane=new kr(i,s),this.add(this.lightPlane),i=new $e,i.setAttribute("position",new We([0,0,0,0,0,1],3)),this.targetLine=new kr(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),LS.setFromMatrixPosition(this.light.matrixWorld),kd.setFromMatrixPosition(this.light.target.matrixWorld),PS.subVectors(kd,LS),this.lightPlane.lookAt(kd),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(kd),this.targetLine.scale.z=PS.length()}}const Fd=new O,on=new el;class YL extends gr{constructor(e){const t=new $e,n=new Un({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};function c(S,x){h(S),h(x)}function h(S){i.push(0,0,0),s.push(0,0,0),a[S]===void 0&&(a[S]=[]),a[S].push(i.length/3-1)}c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4"),t.setAttribute("position",new We(i,3)),t.setAttribute("color",new We(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const d=new Ie(16755200),f=new Ie(16711680),m=new Ie(43775),g=new Ie(16777215),y=new Ie(3355443);this.setColors(d,f,m,g,y)}setColors(e,t,n,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;on.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),hn("c",t,e,on,0,0,-1),hn("t",t,e,on,0,0,1),hn("n1",t,e,on,-1,-1,-1),hn("n2",t,e,on,1,-1,-1),hn("n3",t,e,on,-1,1,-1),hn("n4",t,e,on,1,1,-1),hn("f1",t,e,on,-1,-1,1),hn("f2",t,e,on,1,-1,1),hn("f3",t,e,on,-1,1,1),hn("f4",t,e,on,1,1,1),hn("u1",t,e,on,.7,1.1,-1),hn("u2",t,e,on,-.7,1.1,-1),hn("u3",t,e,on,0,2,-1),hn("cf1",t,e,on,-1,0,1),hn("cf2",t,e,on,1,0,1),hn("cf3",t,e,on,0,-1,1),hn("cf4",t,e,on,0,1,1),hn("cn1",t,e,on,-1,0,-1),hn("cn2",t,e,on,1,0,-1),hn("cn3",t,e,on,0,-1,-1),hn("cn4",t,e,on,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function hn(l,e,t,n,i,s,a){Fd.set(i,s,a).unproject(n);const c=e[l];if(c!==void 0){const h=t.getAttribute("position");for(let d=0,f=c.length;d<f;d++)h.setXYZ(c[d],Fd.x,Fd.y,Fd.z)}}const Ud=new Ir;class QL extends gr{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),s=new $e;s.setIndex(new tt(n,1)),s.setAttribute("position",new tt(i,3)),super(s,new Un({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Ud.setFromObject(this.object),Ud.isEmpty())return;const t=Ud.min,n=Ud.max,i=this.geometry.attributes.position,s=i.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ZL extends gr{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new $e;i.setIndex(new tt(n,1)),i.setAttribute("position",new We([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new Un({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class KL extends kr{constructor(e,t=1,n=16776960){const i=n,s=new $e;s.setAttribute("position",new We([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),s.computeBoundingSphere(),super(s,new Un({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=new $e;a.setAttribute("position",new We([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),a.computeBoundingSphere(),this.add(new et(a,new xi({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const DS=new O;let zd,X0;class JL extends ct{constructor(e=new O(0,0,1),t=new O(0,0,0),n=1,i=16776960,s=.2*n,a=.2*s){super(),this.type="ArrowHelper",zd===void 0&&(zd=new $e,zd.setAttribute("position",new We([0,0,0,0,1,0],3)),X0=new Ws(0,.5,1,5,1),X0.translate(0,-.5,0)),this.position.copy(t),this.line=new kr(zd,new Un({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new et(X0,new xi({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{DS.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(DS,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class $L extends gr{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new $e;n.setAttribute("position",new We(t,3)),n.setAttribute("color",new We([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new Un({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new Ie,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class eP{constructor(){this.type="ShapePath",this.color=new Ie,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Wc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,s,a){return this.currentPath.bezierCurveTo(e,t,n,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(w,T){const _=T.length;let E=!1;for(let R=_-1,P=0;P<_;R=P++){let C=T[R],F=T[P],W=F.x-C.x,B=F.y-C.y;if(Math.abs(B)>Number.EPSILON){if(B<0&&(C=T[P],W=-W,F=T[R],B=-B),w.y<C.y||w.y>F.y)continue;if(w.y===C.y){if(w.x===C.x)return!0}else{const V=B*(w.x-C.x)-W*(w.y-C.y);if(V===0)return!0;if(V<0)continue;E=!E}}else{if(w.y!==C.y)continue;if(F.x<=w.x&&w.x<=C.x||C.x<=w.x&&w.x<=F.x)return!0}}return E}const n=Ur.isClockWise,i=this.subPaths;if(i.length===0)return[];let s,a,c;const h=[];if(i.length===1)return a=i[0],c=new ds,c.curves=a.curves,h.push(c),h;let d=!n(i[0].getPoints());d=e?!d:d;const f=[],m=[];let g,y,S=[],x=0;m[x]=void 0,S[x]=[];for(let w=0,T=i.length;w<T;w++)a=i[w],g=a.getPoints(),s=n(g),s=e?!s:s,s?(!d&&m[x]&&x++,m[x]={s:new ds,p:g},m[x].s.curves=a.curves,d&&x++,S[x]=[]):S[x].push({h:a,p:g[0]});if(!m[0])return function(w){const T=[];for(let _=0,E=w.length;_<E;_++){const R=w[_],P=new ds;P.curves=R.curves,T.push(P)}return T}(i);if(m.length>1){let w=!1,T=0;for(let _=0,E=m.length;_<E;_++)f[_]=[];for(let _=0,E=m.length;_<E;_++){const R=S[_];for(let P=0;P<R.length;P++){const C=R[P];let F=!0;for(let W=0;W<m.length;W++)t(C.p,m[W].p)&&(_!==W&&T++,F?(F=!1,f[W].push(C)):w=!0);F&&f[_].push(C)}}T>0&&w===!1&&(S=f)}for(let w=0,T=m.length;w<T;w++){c=m[w].s,h.push(c),y=S[w];for(let _=0,E=y.length;_<E;_++)c.holes.push(y[_].h)}return h}}const gs=tP();function tP(){const l=new ArrayBuffer(4),e=new Float32Array(l),t=new Uint32Array(l),n=new Uint32Array(512),i=new Uint32Array(512);for(let h=0;h<256;++h){const d=h-127;d<-27?(n[h]=0,n[256|h]=32768,i[h]=24,i[256|h]=24):d<-14?(n[h]=1024>>-d-14,n[256|h]=1024>>-d-14|32768,i[h]=-d-1,i[256|h]=-d-1):d<=15?(n[h]=d+15<<10,n[256|h]=d+15<<10|32768,i[h]=13,i[256|h]=13):d<128?(n[h]=31744,n[256|h]=64512,i[h]=24,i[256|h]=24):(n[h]=31744,n[256|h]=64512,i[h]=13,i[256|h]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let h=1;h<1024;++h){let d=h<<13,f=0;for(;!(8388608&d);)d<<=1,f-=8388608;d&=-8388609,f+=947912704,s[h]=d|f}for(let h=1024;h<2048;++h)s[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)a[h]=h<<23;a[31]=1199570944,a[32]=2147483648;for(let h=33;h<63;++h)a[h]=2147483648+(h-32<<23);a[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(c[h]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:c}}const $c={toHalfFloat:function(l){Math.abs(l)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),l=an(l,-65504,65504),gs.floatView[0]=l;const e=gs.uint32View[0],t=e>>23&511;return gs.baseTable[t]+((8388607&e)>>gs.shiftTable[t])},fromHalfFloat:function(l){const e=l>>10;return gs.uint32View[0]=gs.mantissaTable[gs.offsetTable[e]+(1023&l)]+gs.exponentTable[e],gs.floatView[0]}};class nP extends cs{constructor(e,t,n,i,s,a){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,i,s,a)}}class iP extends dl{constructor(e,t,n,i){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,i)}}class rP extends pl{constructor(e,t,n,i){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,i)}}class sP extends fl{constructor(e,t,n,i,s,a,c){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,i,s,a,c)}}class aP extends Ws{constructor(e,t,n,i,s,a,c,h){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,i,s,a,c,h)}}class oP extends ml{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class lP extends vl{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class cP extends yl{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class uP extends Ha{constructor(e,t,n,i){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,i)}}class hP extends Va{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class dP extends hs{constructor(e,t,n,i){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,i)}}class pP extends Fr{constructor(e,t,n,i){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,i)}}class fP extends xl{constructor(e,t,n,i,s,a){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,i,s,a)}}class mP extends bl{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class gP extends Xs{constructor(e,t,n,i,s,a,c){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,i,s,a,c)}}class vP extends Sl{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class yP extends wl{constructor(e,t,n,i,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,i,s)}}class xP extends _l{constructor(e,t,n,i,s,a){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,i,s,a)}}class bP extends Ml{constructor(e,t,n,i,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,i,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ie}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ie);class SP{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,i){return e[0]*t+e[1]*n+e[2]*i}dot4(e,t,n,i,s){return e[0]*t+e[1]*n+e[2]*i+e[3]*s}noise(e,t){let n,i,s;const a=(e+t)*(.5*(Math.sqrt(3)-1)),c=Math.floor(e+a),h=Math.floor(t+a),d=(3-Math.sqrt(3))/6,f=(c+h)*d,m=e-(c-f),g=t-(h-f);let y,S;m>g?(y=1,S=0):(y=0,S=1);const x=m-y+d,w=g-S+d,T=m-1+2*d,_=g-1+2*d,E=255&c,R=255&h,P=this.perm[E+this.perm[R]]%12,C=this.perm[E+y+this.perm[R+S]]%12,F=this.perm[E+1+this.perm[R+1]]%12;let W=.5-m*m-g*g;W<0?n=0:(W*=W,n=W*W*this.dot(this.grad3[P],m,g));let B=.5-x*x-w*w;B<0?i=0:(B*=B,i=B*B*this.dot(this.grad3[C],x,w));let V=.5-T*T-_*_;return V<0?s=0:(V*=V,s=V*V*this.dot(this.grad3[F],T,_)),70*(n+i+s)}noise3d(e,t,n){let i,s,a,c;const h=(e+t+n)*.3333333333333333,d=Math.floor(e+h),f=Math.floor(t+h),m=Math.floor(n+h),g=1/6,y=(d+f+m)*g,S=e-(d-y),x=t-(f-y),w=n-(m-y);let T,_,E,R,P,C;S>=x?x>=w?(T=1,_=0,E=0,R=1,P=1,C=0):S>=w?(T=1,_=0,E=0,R=1,P=0,C=1):(T=0,_=0,E=1,R=1,P=0,C=1):x<w?(T=0,_=0,E=1,R=0,P=1,C=1):S<w?(T=0,_=1,E=0,R=0,P=1,C=1):(T=0,_=1,E=0,R=1,P=1,C=0);const F=S-T+g,W=x-_+g,B=w-E+g,V=S-R+2*g,U=x-P+2*g,te=w-C+2*g,ue=S-1+.5,ce=x-1+.5,we=w-1+.5,ve=255&d,Re=255&f,Pe=255&m,De=this.perm[ve+this.perm[Re+this.perm[Pe]]]%12,fe=this.perm[ve+T+this.perm[Re+_+this.perm[Pe+E]]]%12,oe=this.perm[ve+R+this.perm[Re+P+this.perm[Pe+C]]]%12,Se=this.perm[ve+1+this.perm[Re+1+this.perm[Pe+1]]]%12;let Ce=.6-S*S-x*x-w*w;Ce<0?i=0:(Ce*=Ce,i=Ce*Ce*this.dot3(this.grad3[De],S,x,w));let Te=.6-F*F-W*W-B*B;Te<0?s=0:(Te*=Te,s=Te*Te*this.dot3(this.grad3[fe],F,W,B));let ze=.6-V*V-U*U-te*te;ze<0?a=0:(ze*=ze,a=ze*ze*this.dot3(this.grad3[oe],V,U,te));let G=.6-ue*ue-ce*ce-we*we;return G<0?c=0:(G*=G,c=G*G*this.dot3(this.grad3[Se],ue,ce,we)),32*(i+s+a+c)}noise4d(e,t,n,i){const s=this.grad4,a=this.simplex,c=this.perm,h=(Math.sqrt(5)-1)/4,d=(5-Math.sqrt(5))/20;let f,m,g,y,S;const x=(e+t+n+i)*h,w=Math.floor(e+x),T=Math.floor(t+x),_=Math.floor(n+x),E=Math.floor(i+x),R=(w+T+_+E)*d,P=e-(w-R),C=t-(T-R),F=n-(_-R),W=i-(E-R),B=(P>C?32:0)+(P>F?16:0)+(C>F?8:0)+(P>W?4:0)+(C>W?2:0)+(F>W?1:0),V=a[B][0]>=3?1:0,U=a[B][1]>=3?1:0,te=a[B][2]>=3?1:0,ue=a[B][3]>=3?1:0,ce=a[B][0]>=2?1:0,we=a[B][1]>=2?1:0,ve=a[B][2]>=2?1:0,Re=a[B][3]>=2?1:0,Pe=a[B][0]>=1?1:0,De=a[B][1]>=1?1:0,fe=a[B][2]>=1?1:0,oe=a[B][3]>=1?1:0,Se=P-V+d,Ce=C-U+d,Te=F-te+d,ze=W-ue+d,G=P-ce+2*d,z=C-we+2*d,le=F-ve+2*d,Z=W-Re+2*d,H=P-Pe+3*d,ee=C-De+3*d,I=F-fe+3*d,q=W-oe+3*d,K=P-1+4*d,re=C-1+4*d,ae=F-1+4*d,ge=W-1+4*d,Fe=255&w,je=255&T,qe=255&_,He=255&E,rt=c[Fe+c[je+c[qe+c[He]]]]%32,ut=c[Fe+V+c[je+U+c[qe+te+c[He+ue]]]]%32,nt=c[Fe+ce+c[je+we+c[qe+ve+c[He+Re]]]]%32,vt=c[Fe+Pe+c[je+De+c[qe+fe+c[He+oe]]]]%32,Dt=c[Fe+1+c[je+1+c[qe+1+c[He+1]]]]%32;let Je=.6-P*P-C*C-F*F-W*W;Je<0?f=0:(Je*=Je,f=Je*Je*this.dot4(s[rt],P,C,F,W));let Ot=.6-Se*Se-Ce*Ce-Te*Te-ze*ze;Ot<0?m=0:(Ot*=Ot,m=Ot*Ot*this.dot4(s[ut],Se,Ce,Te,ze));let pe=.6-G*G-z*z-le*le-Z*Z;pe<0?g=0:(pe*=pe,g=pe*pe*this.dot4(s[nt],G,z,le,Z));let ra=.6-H*H-ee*ee-I*I-q*q;ra<0?y=0:(ra*=ra,y=ra*ra*this.dot4(s[vt],H,ee,I,q));let sa=.6-K*K-re*re-ae*ae-ge*ge;return sa<0?S=0:(sa*=sa,S=sa*sa*this.dot4(s[Dt],K,re,ae,ge)),27*(f+m+g+y+S)}}class wP extends ct{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const El=new O,OS=new Ne,IS=new Ne,NS=new O,kS=new O;class _P{constructor(e={}){const t=this;let n,i,s,a;const c={objects:new WeakMap},h=e.element!==void 0?e.element:document.createElement("div");function d(m,g,y){if(m.isCSS2DObject){El.setFromMatrixPosition(m.matrixWorld),El.applyMatrix4(IS);const S=m.visible===!0&&El.z>=-1&&El.z<=1&&m.layers.test(y.layers)===!0;if(m.element.style.display=S===!0?"":"none",S===!0){m.onBeforeRender(t,g,y);const w=m.element;w.style.transform="translate(-50%,-50%) translate("+(El.x*s+s)+"px,"+(-El.y*a+a)+"px)",w.parentNode!==h&&h.appendChild(w),m.onAfterRender(t,g,y)}const x={distanceToCameraSquared:f(y,m)};c.objects.set(m,x)}for(let S=0,x=m.children.length;S<x;S++)d(m.children[S],g,y)}function f(m,g){return NS.setFromMatrixPosition(m.matrixWorld),kS.setFromMatrixPosition(g.matrixWorld),NS.distanceToSquared(kS)}h.style.overflow="hidden",this.domElement=h,this.getSize=function(){return{width:n,height:i}},this.render=function(m,g){m.matrixWorldAutoUpdate===!0&&m.updateMatrixWorld(),g.parent===null&&g.matrixWorldAutoUpdate===!0&&g.updateMatrixWorld(),OS.copy(g.matrixWorldInverse),IS.multiplyMatrices(g.projectionMatrix,OS),d(m,m,g),function(y){const S=function(w){const T=[];return w.traverse(function(_){_.isCSS2DObject&&T.push(_)}),T}(y).sort(function(w,T){return w.renderOrder!==T.renderOrder?T.renderOrder-w.renderOrder:c.objects.get(w).distanceToCameraSquared-c.objects.get(T).distanceToCameraSquared}),x=S.length;for(let w=0,T=S.length;w<T;w++)S[w].element.style.zIndex=x-w}(m)},this.setSize=function(m,g){n=m,i=g,s=n/2,a=i/2,h.style.width=m+"px",h.style.height=g+"px"}}}const FS=new O,MP=new Ut,US=new O;class zS extends ct{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}class TP extends zS{constructor(e){super(e),this.isCSS3DSprite=!0,this.rotation2D=0}copy(e,t){return super.copy(e,t),this.rotation2D=e.rotation2D,this}}const zr=new Ne,EP=new Ne;class AP{constructor(e={}){const t=this;let n,i,s,a;const c={camera:{fov:0,style:""},objects:new WeakMap},h=e.element!==void 0?e.element:document.createElement("div");h.style.overflow="hidden",this.domElement=h;const d=document.createElement("div");d.style.transformOrigin="0 0",d.style.pointerEvents="none",h.appendChild(d);const f=document.createElement("div");function m(x){return Math.abs(x)<1e-10?0:x}function g(x){const w=x.elements;return"matrix3d("+m(w[0])+","+m(-w[1])+","+m(w[2])+","+m(w[3])+","+m(w[4])+","+m(-w[5])+","+m(w[6])+","+m(w[7])+","+m(w[8])+","+m(-w[9])+","+m(w[10])+","+m(w[11])+","+m(w[12])+","+m(-w[13])+","+m(w[14])+","+m(w[15])+")"}function y(x){const w=x.elements;return"translate(-50%,-50%)"+("matrix3d("+m(w[0])+","+m(w[1])+","+m(w[2])+","+m(w[3])+","+m(-w[4])+","+m(-w[5])+","+m(-w[6])+","+m(-w[7])+","+m(w[8])+","+m(w[9])+","+m(w[10])+","+m(w[11])+","+m(w[12])+","+m(w[13])+","+m(w[14])+","+m(w[15])+")")}function S(x,w,T,_){if(x.isCSS3DObject){const E=x.visible===!0&&x.layers.test(T.layers)===!0;if(x.element.style.display=E===!0?"":"none",E===!0){let R;x.onBeforeRender(t,w,T),x.isCSS3DSprite?(zr.copy(T.matrixWorldInverse),zr.transpose(),x.rotation2D!==0&&zr.multiply(EP.makeRotationZ(x.rotation2D)),x.matrixWorld.decompose(FS,MP,US),zr.setPosition(FS),zr.scale(US),zr.elements[3]=0,zr.elements[7]=0,zr.elements[11]=0,zr.elements[15]=1,R=y(zr)):R=y(x.matrixWorld);const P=x.element,C=c.objects.get(x);if(C===void 0||C.style!==R){P.style.transform=R;const F={style:R};c.objects.set(x,F)}P.parentNode!==f&&f.appendChild(P),x.onAfterRender(t,w,T)}}for(let E=0,R=x.children.length;E<R;E++)S(x.children[E],w,T)}f.style.transformStyle="preserve-3d",d.appendChild(f),this.getSize=function(){return{width:n,height:i}},this.render=function(x,w){const T=w.projectionMatrix.elements[5]*a;let _,E;c.camera.fov!==T&&(d.style.perspective=w.isPerspectiveCamera?T+"px":"",c.camera.fov=T),w.view&&w.view.enabled?(d.style.transform=`translate( ${-w.view.offsetX*(n/w.view.width)}px, ${-w.view.offsetY*(i/w.view.height)}px )`,d.style.transform+=`scale( ${w.view.fullWidth/w.view.width}, ${w.view.fullHeight/w.view.height} )`):d.style.transform="",x.matrixWorldAutoUpdate===!0&&x.updateMatrixWorld(),w.parent===null&&w.matrixWorldAutoUpdate===!0&&w.updateMatrixWorld(),w.isOrthographicCamera&&(_=-(w.right+w.left)/2,E=(w.top+w.bottom)/2);const R=w.view&&w.view.enabled?w.view.height/w.view.fullHeight:1,P=w.isOrthographicCamera?`scale( ${R} )scale(`+T+")translate("+m(_)+"px,"+m(E)+"px)"+g(w.matrixWorldInverse):`scale( ${R} )translateZ(`+T+"px)"+g(w.matrixWorldInverse),C=P+"translate("+s+"px,"+a+"px)";c.camera.style!==C&&(f.style.transform=C,c.camera.style=C),S(x,x,w)},this.setSize=function(x,w){n=x,i=w,s=n/2,a=i/2,h.style.width=x+"px",h.style.height=w+"px",d.style.width=x+"px",d.style.height=w+"px",f.style.width=x+"px",f.style.height=w+"px"}}}class BS{constructor(){this.id=0,this.object=null,this.z=0,this.renderOrder=0}}class jS{constructor(){this.id=0,this.v1=new io,this.v2=new io,this.v3=new io,this.normalModel=new O,this.vertexNormalsModel=[new O,new O,new O],this.vertexNormalsLength=0,this.color=new Ie,this.material=null,this.uvs=[new de,new de,new de],this.z=0,this.renderOrder=0}}class io{constructor(){this.position=new O,this.positionWorld=new O,this.positionScreen=new Ke,this.visible=!0}copy(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)}}class HS{constructor(){this.id=0,this.v1=new io,this.v2=new io,this.vertexColors=[new Ie,new Ie],this.material=null,this.z=0,this.renderOrder=0}}class GS{constructor(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new de,this.material=null,this.renderOrder=0}}class RP{constructor(){let e,t,n,i,s,a,c,h,d,f,m,g=0,y=0,S=0,x=0,w=0;const T={objects:[],lights:[],elements:[]},_=new O,E=new Ke,R=new Ir(new O(-1,-1,-1),new O(1,1,1)),P=new Ir,C=new Array(3),F=new Ne,W=new Ne,B=new Ne,V=new Nc,U=[],te=[],ue=[],ce=[],we=[],ve=new function(){const oe=[],Se=[],Ce=[];let Te=null;const ze=new mn;function G(Z){const H=Z.position,ee=Z.positionWorld,I=Z.positionScreen;ee.copy(H).applyMatrix4(m),I.copy(ee).applyMatrix4(W);const q=1/I.w;I.x*=q,I.y*=q,I.z*=q,Z.visible=I.x>=-1&&I.x<=1&&I.y>=-1&&I.y<=1&&I.z>=-1&&I.z<=1}function z(Z,H,ee){return Z.visible===!0||H.visible===!0||ee.visible===!0||(C[0]=Z.positionScreen,C[1]=H.positionScreen,C[2]=ee.positionScreen,R.intersectsBox(P.setFromPoints(C)))}function le(Z,H,ee){return(ee.positionScreen.x-Z.positionScreen.x)*(H.positionScreen.y-Z.positionScreen.y)-(ee.positionScreen.y-Z.positionScreen.y)*(H.positionScreen.x-Z.positionScreen.x)<0}return{setObject:function(Z){Te=Z,ze.getNormalMatrix(Te.matrixWorld),oe.length=0,Se.length=0,Ce.length=0},projectVertex:G,checkTriangleVisibility:z,checkBackfaceCulling:le,pushVertex:function(Z,H,ee){n=function(){if(i===y){const I=new io;return te.push(I),y++,i++,I}return te[i++]}(),n.position.set(Z,H,ee),G(n)},pushNormal:function(Z,H,ee){oe.push(Z,H,ee)},pushColor:function(Z,H,ee){Se.push(Z,H,ee)},pushUv:function(Z,H){Ce.push(Z,H)},pushLine:function(Z,H){const ee=te[Z],I=te[H];ee.positionScreen.copy(ee.position).applyMatrix4(B),I.positionScreen.copy(I.position).applyMatrix4(B),function(q,K){let re=0,ae=1;const ge=q.z+q.w,Fe=K.z+K.w,je=-q.z+q.w,qe=-K.z+K.w;return ge>=0&&Fe>=0&&je>=0&&qe>=0||!(ge<0&&Fe<0||je<0&&qe<0)&&(ge<0?re=Math.max(re,ge/(ge-Fe)):Fe<0&&(ae=Math.min(ae,ge/(ge-Fe))),je<0?re=Math.max(re,je/(je-qe)):qe<0&&(ae=Math.min(ae,je/(je-qe))),!(ae<re)&&(q.lerp(K,re),K.lerp(q,1-ae),!0))}(ee.positionScreen,I.positionScreen)===!0&&(ee.positionScreen.multiplyScalar(1/ee.positionScreen.w),I.positionScreen.multiplyScalar(1/I.positionScreen.w),c=function(){if(h===x){const q=new HS;return ce.push(q),x++,h++,q}return ce[h++]}(),c.id=Te.id,c.v1.copy(ee),c.v2.copy(I),c.z=Math.max(ee.positionScreen.z,I.positionScreen.z),c.renderOrder=Te.renderOrder,c.material=Te.material,Te.material.vertexColors&&(c.vertexColors[0].fromArray(Se,3*Z),c.vertexColors[1].fromArray(Se,3*H)),T.elements.push(c))},pushTriangle:function(Z,H,ee,I){const q=te[Z],K=te[H],re=te[ee];if(z(q,K,re)!==!1&&(I.side===Me||le(q,K,re)===!0)){s=function(){if(a===S){const ae=new jS;return ue.push(ae),S++,a++,ae}return ue[a++]}(),s.id=Te.id,s.v1.copy(q),s.v2.copy(K),s.v3.copy(re),s.z=(q.positionScreen.z+K.positionScreen.z+re.positionScreen.z)/3,s.renderOrder=Te.renderOrder,_.subVectors(re.position,K.position),E.subVectors(q.position,K.position),_.cross(E),s.normalModel.copy(_),s.normalModel.applyMatrix3(ze).normalize();for(let ae=0;ae<3;ae++){const ge=s.vertexNormalsModel[ae];ge.fromArray(oe,3*arguments[ae]),ge.applyMatrix3(ze).normalize(),s.uvs[ae].fromArray(Ce,2*arguments[ae])}s.vertexNormalsLength=3,s.material=I,I.vertexColors&&s.color.fromArray(Se,3*Z),T.elements.push(s)}}}};function Re(oe){if(oe.visible===!1)return;if(oe.isLight)T.lights.push(oe);else if(oe.isMesh||oe.isLine||oe.isPoints){if(oe.material.visible===!1||oe.frustumCulled===!0&&V.intersectsObject(oe)===!1)return;Pe(oe)}else if(oe.isSprite){if(oe.material.visible===!1||oe.frustumCulled===!0&&V.intersectsSprite(oe)===!1)return;Pe(oe)}const Se=oe.children;for(let Ce=0,Te=Se.length;Ce<Te;Ce++)Re(Se[Ce])}function Pe(oe){e=function(){if(t===g){const Se=new BS;return U.push(Se),g++,t++,Se}return U[t++]}(),e.id=oe.id,e.object=oe,_.setFromMatrixPosition(oe.matrixWorld),_.applyMatrix4(W),e.z=_.z,e.renderOrder=oe.renderOrder,T.objects.push(e)}function De(oe,Se,Ce){const Te=1/oe.w;oe.z*=Te,oe.z>=-1&&oe.z<=1&&(d=function(){if(f===w){const ze=new GS;return we.push(ze),w++,f++,ze}return we[f++]}(),d.id=Se.id,d.x=oe.x*Te,d.y=oe.y*Te,d.z=oe.z,d.renderOrder=Se.renderOrder,d.object=Se,d.rotation=Se.rotation,d.scale.x=Se.scale.x*Math.abs(d.x-(oe.x+Ce.projectionMatrix.elements[0])/(oe.w+Ce.projectionMatrix.elements[12])),d.scale.y=Se.scale.y*Math.abs(d.y-(oe.y+Ce.projectionMatrix.elements[5])/(oe.w+Ce.projectionMatrix.elements[13])),d.material=Se.material,T.elements.push(d))}function fe(oe,Se){return oe.renderOrder!==Se.renderOrder?oe.renderOrder-Se.renderOrder:oe.z!==Se.z?Se.z-oe.z:oe.id!==Se.id?oe.id-Se.id:0}this.projectScene=function(oe,Se,Ce,Te){a=0,h=0,f=0,T.elements.length=0,oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),Se.parent===null&&Se.matrixWorldAutoUpdate===!0&&Se.updateMatrixWorld(),F.copy(Se.matrixWorldInverse),W.multiplyMatrices(Se.projectionMatrix,F),V.setFromProjectionMatrix(W),t=0,T.objects.length=0,T.lights.length=0,Re(oe),Ce===!0&&T.objects.sort(fe);const ze=T.objects;for(let G=0,z=ze.length;G<z;G++){const le=ze[G].object,Z=le.geometry;if(ve.setObject(le),m=le.matrixWorld,i=0,le.isMesh){let H=le.material;const ee=Array.isArray(H),I=Z.attributes,q=Z.groups;if(I.position===void 0)continue;const K=I.position.array;for(let re=0,ae=K.length;re<ae;re+=3){let ge=K[re],Fe=K[re+1],je=K[re+2];const qe=Z.morphAttributes.position;if(qe!==void 0){const He=Z.morphTargetsRelative,rt=le.morphTargetInfluences;for(let ut=0,nt=qe.length;ut<nt;ut++){const vt=rt[ut];if(vt===0)continue;const Dt=qe[ut];He?(ge+=Dt.getX(re/3)*vt,Fe+=Dt.getY(re/3)*vt,je+=Dt.getZ(re/3)*vt):(ge+=(Dt.getX(re/3)-K[re])*vt,Fe+=(Dt.getY(re/3)-K[re+1])*vt,je+=(Dt.getZ(re/3)-K[re+2])*vt)}}ve.pushVertex(ge,Fe,je)}if(I.normal!==void 0){const re=I.normal.array;for(let ae=0,ge=re.length;ae<ge;ae+=3)ve.pushNormal(re[ae],re[ae+1],re[ae+2])}if(I.color!==void 0){const re=I.color.array;for(let ae=0,ge=re.length;ae<ge;ae+=3)ve.pushColor(re[ae],re[ae+1],re[ae+2])}if(I.uv!==void 0){const re=I.uv.array;for(let ae=0,ge=re.length;ae<ge;ae+=2)ve.pushUv(re[ae],re[ae+1])}if(Z.index!==null){const re=Z.index.array;if(q.length>0)for(let ae=0;ae<q.length;ae++){const ge=q[ae];if(H=ee===!0?le.material[ge.materialIndex]:le.material,H!==void 0)for(let Fe=ge.start,je=ge.start+ge.count;Fe<je;Fe+=3)ve.pushTriangle(re[Fe],re[Fe+1],re[Fe+2],H)}else for(let ae=0,ge=re.length;ae<ge;ae+=3)ve.pushTriangle(re[ae],re[ae+1],re[ae+2],H)}else if(q.length>0)for(let re=0;re<q.length;re++){const ae=q[re];if(H=ee===!0?le.material[ae.materialIndex]:le.material,H!==void 0)for(let ge=ae.start,Fe=ae.start+ae.count;ge<Fe;ge+=3)ve.pushTriangle(ge,ge+1,ge+2,H)}else for(let re=0,ae=K.length/3;re<ae;re+=3)ve.pushTriangle(re,re+1,re+2,H)}else if(le.isLine){B.multiplyMatrices(W,m);const H=Z.attributes;if(H.position!==void 0){const ee=H.position.array;for(let I=0,q=ee.length;I<q;I+=3)ve.pushVertex(ee[I],ee[I+1],ee[I+2]);if(H.color!==void 0){const I=H.color.array;for(let q=0,K=I.length;q<K;q+=3)ve.pushColor(I[q],I[q+1],I[q+2])}if(Z.index!==null){const I=Z.index.array;for(let q=0,K=I.length;q<K;q+=2)ve.pushLine(I[q],I[q+1])}else{const I=le.isLineSegments?2:1;for(let q=0,K=ee.length/3-1;q<K;q+=I)ve.pushLine(q,q+1)}}}else if(le.isPoints){B.multiplyMatrices(W,m);const H=Z.attributes;if(H.position!==void 0){const ee=H.position.array;for(let I=0,q=ee.length;I<q;I+=3)E.set(ee[I],ee[I+1],ee[I+2],1),E.applyMatrix4(B),De(E,le,Se)}}else le.isSprite&&(le.modelViewMatrix.multiplyMatrices(Se.matrixWorldInverse,le.matrixWorld),E.set(m.elements[12],m.elements[13],m.elements[14],1),E.applyMatrix4(W),De(E,le,Se))}return Te===!0&&T.elements.sort(fe),T}}}function LP(){throw new Error("BufferGeometryUtils: computeTangents renamed to computeMikkTSpaceTangents.")}function PP(l,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!l.hasAttribute("position")||!l.hasAttribute("normal")||!l.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function n(a){if(a.normalized||a.isInterleavedBufferAttribute){const c=new Float32Array(a.getCount()*a.itemSize);for(let h=0,d=0;h<a.getCount();h++)c[d++]=a.getX(h),c[d++]=a.getY(h),a.itemSize>2&&(c[d++]=a.getZ(h));return c}return a.array instanceof Float32Array?a.array:new Float32Array(a.array)}const i=l.index?l.toNonIndexed():l,s=e.generateTangents(n(i.attributes.position),n(i.attributes.normal),n(i.attributes.uv));if(t)for(let a=3;a<s.length;a+=4)s[a]*=-1;return i.setAttribute("tangent",new tt(s,4)),l!==i&&l.copy(i),l}function CP(l,e=!1){const t=l[0].index!==null,n=new Set(Object.keys(l[0].attributes)),i=new Set(Object.keys(l[0].morphAttributes)),s={},a={},c=l[0].morphTargetsRelative,h=new $e;let d=0;for(let f=0;f<l.length;++f){const m=l[f];let g=0;if(t!==(m.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const y in m.attributes){if(!n.has(y))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+y+'" attribute exists among all geometries, or in none of them.'),null;s[y]===void 0&&(s[y]=[]),s[y].push(m.attributes[y]),g++}if(g!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(c!==m.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const y in m.morphAttributes){if(!i.has(y))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;a[y]===void 0&&(a[y]=[]),a[y].push(m.morphAttributes[y])}if(e){let y;if(t)y=m.index.count;else{if(m.attributes.position===void 0)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;y=m.attributes.position.count}h.addGroup(d,y,f),d+=y}}if(t){let f=0;const m=[];for(let g=0;g<l.length;++g){const y=l[g].index;for(let S=0;S<y.count;++S)m.push(y.getX(S)+f);f+=l[g].attributes.position.count}h.setIndex(m)}for(const f in s){const m=q0(s[f]);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+f+" attribute."),null;h.setAttribute(f,m)}for(const f in a){const m=a[f][0].length;if(m===0)break;h.morphAttributes=h.morphAttributes||{},h.morphAttributes[f]=[];for(let g=0;g<m;++g){const y=[];for(let x=0;x<a[f].length;++x)y.push(a[f][x][g]);const S=q0(y);if(!S)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+f+" morphAttribute."),null;h.morphAttributes[f].push(S)}}return h}function q0(l){let e,t,n,i=0;for(let c=0;c<l.length;++c){const h=l[c];if(h.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=h.array.constructor),e!==h.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=h.itemSize),t!==h.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=h.normalized),n!==h.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=h.array.length}const s=new e(i);let a=0;for(let c=0;c<l.length;++c)s.set(l[c].array,a),a+=l[c].array.length;return new tt(s,t,n)}function Bd(l){return l.isInstancedInterleavedBufferAttribute||l.isInterleavedBufferAttribute?jd(l):l.isInstancedBufferAttribute?new Vs().copy(l):new tt().copy(l)}function DP(l){let e,t=0,n=0;for(let d=0,f=l.length;d<f;++d){const m=l[d];if(e===void 0&&(e=m.array.constructor),e!==m.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=m.array.length,n+=m.itemSize}const i=new sl(new e(t),n);let s=0;const a=[],c=["getX","getY","getZ","getW"],h=["setX","setY","setZ","setW"];for(let d=0,f=l.length;d<f;d++){const m=l[d],g=m.itemSize,y=m.count,S=new ui(i,g,s,m.normalized);a.push(S),s+=g;for(let x=0;x<y;x++)for(let w=0;w<g;w++)S[h[w]](x,m[c[w]](x))}return a}function jd(l){const e=l.data.array.constructor,t=l.count,n=l.itemSize,i=l.normalized,s=new e(t*n);let a;a=l.isInstancedInterleavedBufferAttribute?new Vs(s,n,i,l.meshPerAttribute):new tt(s,n,i);for(let c=0;c<t;c++)a.setX(c,l.getX(c)),n>=2&&a.setY(c,l.getY(c)),n>=3&&a.setZ(c,l.getZ(c)),n>=4&&a.setW(c,l.getW(c));return a}function OP(l){const e=l.attributes,t=l.morphTargets,n=new Map;for(const i in e){const s=e[i];s.isInterleavedBufferAttribute&&(n.has(s)||n.set(s,jd(s)),e[i]=n.get(s))}for(const i in t){const s=t[i];s.isInterleavedBufferAttribute&&(n.has(s)||n.set(s,jd(s)),t[i]=n.get(s))}}function IP(l){let e=0;for(const n in l.attributes){const i=l.getAttribute(n);e+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}const t=l.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function NP(l,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},n=l.getIndex(),i=l.getAttribute("position"),s=n?n.count:i.count;let a=0;const c=Object.keys(l.attributes),h={},d={},f=[],m=["getX","getY","getZ","getW"],g=["setX","setY","setZ","setW"];for(let w=0,T=c.length;w<T;w++){const _=c[w],E=l.attributes[_];h[_]=new tt(new E.array.constructor(E.count*E.itemSize),E.itemSize,E.normalized);const R=l.morphAttributes[_];R&&(d[_]=new tt(new R.array.constructor(R.count*R.itemSize),R.itemSize,R.normalized))}const y=Math.log10(1/e),S=Math.pow(10,y);for(let w=0;w<s;w++){const T=n?n.getX(w):w;let _="";for(let E=0,R=c.length;E<R;E++){const P=c[E],C=l.getAttribute(P),F=C.itemSize;for(let W=0;W<F;W++)_+=~~(C[m[W]](T)*S)+","}if(_ in t)f.push(t[_]);else{for(let E=0,R=c.length;E<R;E++){const P=c[E],C=l.getAttribute(P),F=l.morphAttributes[P],W=C.itemSize,B=h[P],V=d[P];for(let U=0;U<W;U++){const te=m[U],ue=g[U];if(B[ue](a,C[te](T)),F)for(let ce=0,we=F.length;ce<we;ce++)V[ce][ue](a,F[ce][te](T))}}t[_]=a,f.push(a),a++}}const x=l.clone();for(const w in l.attributes){const T=h[w];if(x.setAttribute(w,new tt(T.array.slice(0,a*T.itemSize),T.itemSize,T.normalized)),w in d)for(let _=0;_<d[w].length;_++){const E=d[w][_];x.morphAttributes[w][_]=new tt(E.array.slice(0,a*E.itemSize),E.itemSize,E.normalized)}}return x.setIndex(f),x}function Y0(l,e){if(e===lx)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),l;if(e===Rh||e===Am){let t=l.getIndex();if(t===null){const a=[],c=l.getAttribute("position");if(c===void 0)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),l;for(let h=0;h<c.count;h++)a.push(h);l.setIndex(a),t=l.getIndex()}const n=t.count-2,i=[];if(e===Rh)for(let a=1;a<=n;a++)i.push(t.getX(0)),i.push(t.getX(a)),i.push(t.getX(a+1));else for(let a=0;a<n;a++)a%2==0?(i.push(t.getX(a)),i.push(t.getX(a+1)),i.push(t.getX(a+2))):(i.push(t.getX(a+2)),i.push(t.getX(a+1)),i.push(t.getX(a)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=l.clone();return s.setIndex(i),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),l}function kP(l){const e=new O,t=new O,n=new O,i=new O,s=new O,a=new O,c=new O,h=new O,d=new O;function f(Re,Pe,De,fe,oe,Se,Ce,Te){e.fromBufferAttribute(Pe,oe),t.fromBufferAttribute(Pe,Se),n.fromBufferAttribute(Pe,Ce);const ze=Re.morphTargetInfluences;if(De&&ze){c.set(0,0,0),h.set(0,0,0),d.set(0,0,0);for(let G=0,z=De.length;G<z;G++){const le=ze[G],Z=De[G];le!==0&&(i.fromBufferAttribute(Z,oe),s.fromBufferAttribute(Z,Se),a.fromBufferAttribute(Z,Ce),fe?(c.addScaledVector(i,le),h.addScaledVector(s,le),d.addScaledVector(a,le)):(c.addScaledVector(i.sub(e),le),h.addScaledVector(s.sub(t),le),d.addScaledVector(a.sub(n),le)))}e.add(c),t.add(h),n.add(d)}Re.isSkinnedMesh&&(Re.boneTransform(oe,e),Re.boneTransform(Se,t),Re.boneTransform(Ce,n)),Te[3*oe+0]=e.x,Te[3*oe+1]=e.y,Te[3*oe+2]=e.z,Te[3*Se+0]=t.x,Te[3*Se+1]=t.y,Te[3*Se+2]=t.z,Te[3*Ce+0]=n.x,Te[3*Ce+1]=n.y,Te[3*Ce+2]=n.z}const m=l.geometry,g=l.material;let y,S,x;const w=m.index,T=m.attributes.position,_=m.morphAttributes.position,E=m.morphTargetsRelative,R=m.attributes.normal,P=m.morphAttributes.position,C=m.groups,F=m.drawRange;let W,B,V,U,te,ue,ce;const we=new Float32Array(T.count*T.itemSize),ve=new Float32Array(R.count*R.itemSize);if(w!==null)if(Array.isArray(g))for(W=0,V=C.length;W<V;W++)for(te=C[W],ue=Math.max(te.start,F.start),ce=Math.min(te.start+te.count,F.start+F.count),B=ue,U=ce;B<U;B+=3)y=w.getX(B),S=w.getX(B+1),x=w.getX(B+2),f(l,T,_,E,y,S,x,we),f(l,R,P,E,y,S,x,ve);else for(ue=Math.max(0,F.start),ce=Math.min(w.count,F.start+F.count),W=ue,V=ce;W<V;W+=3)y=w.getX(W),S=w.getX(W+1),x=w.getX(W+2),f(l,T,_,E,y,S,x,we),f(l,R,P,E,y,S,x,ve);else if(Array.isArray(g))for(W=0,V=C.length;W<V;W++)for(te=C[W],ue=Math.max(te.start,F.start),ce=Math.min(te.start+te.count,F.start+F.count),B=ue,U=ce;B<U;B+=3)y=B,S=B+1,x=B+2,f(l,T,_,E,y,S,x,we),f(l,R,P,E,y,S,x,ve);else for(ue=Math.max(0,F.start),ce=Math.min(T.count,F.start+F.count),W=ue,V=ce;W<V;W+=3)y=W,S=W+1,x=W+2,f(l,T,_,E,y,S,x,we),f(l,R,P,E,y,S,x,ve);return{positionAttribute:T,normalAttribute:R,morphedPositionAttribute:new We(we,3),morphedNormalAttribute:new We(ve,3)}}function VS(l){if(l.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),l;let e=l.groups;if(e=e.sort((a,c)=>a.materialIndex!==c.materialIndex?a.materialIndex-c.materialIndex:a.start-c.start),l.getIndex()===null){const a=l.getAttribute("position"),c=[];for(let h=0;h<a.count;h+=3)c.push(h,h+1,h+2);l.setIndex(c)}const t=l.getIndex(),n=[];for(let a=0;a<e.length;a++){const c=e[a],h=c.start,d=h+c.count;for(let f=h;f<d;f++)n.push(t.getX(f))}l.dispose(),l.setIndex(n);let i=0;for(let a=0;a<e.length;a++){const c=e[a];c.start=i,i+=c.count}let s=e[0];l.groups=[s];for(let a=1;a<e.length;a++){const c=e[a];s.materialIndex===c.materialIndex?s.count+=c.count:(s=c,l.groups.push(s))}return l}function FP(l,e=Math.PI/3){const t=Math.cos(e),n=100*(1+1e-10),i=[new O,new O,new O],s=new O,a=new O,c=new O,h=new O;function d(x){return`${~~(x.x*n)},${~~(x.y*n)},${~~(x.z*n)}`}const f=l.toNonIndexed(),m=f.attributes.position,g={};for(let x=0,w=m.count/3;x<w;x++){const T=3*x,_=i[0].fromBufferAttribute(m,T+0),E=i[1].fromBufferAttribute(m,T+1),R=i[2].fromBufferAttribute(m,T+2);s.subVectors(R,E),a.subVectors(_,E);const P=new O().crossVectors(s,a).normalize();for(let C=0;C<3;C++){const F=d(i[C]);F in g||(g[F]=[]),g[F].push(P)}}const y=new Float32Array(3*m.count),S=new tt(y,3,!1);for(let x=0,w=m.count/3;x<w;x++){const T=3*x,_=i[0].fromBufferAttribute(m,T+0),E=i[1].fromBufferAttribute(m,T+1),R=i[2].fromBufferAttribute(m,T+2);s.subVectors(R,E),a.subVectors(_,E),c.crossVectors(s,a).normalize();for(let P=0;P<3;P++){const C=g[d(i[P])];h.set(0,0,0);for(let F=0,W=C.length;F<W;F++){const B=C[F];c.dot(B)>t&&h.add(B)}h.normalize(),S.setXYZ(T+P,h.x,h.y,h.z)}}return f.setAttribute("normal",S),f}const WS=new Ie,XS=new Ne;function UP(l){const e=new Yn,t=l.count,n=l.geometry,i=l.material;for(let s=0;s<t;s++){const a=new et(n,i);l.getMatrixAt(s,a.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),e.add(a)}return e.copy(l),e.updateMatrixWorld(),e}function zP(l){if(Array.isArray(l.material)===!1)return console.warn("THREE.SceneUtils.createMeshesFromMultiMaterialMesh(): The given mesh has no multiple materials."),l;const e=new Yn;e.copy(l);const t=VS(l.geometry),n=t.index,i=t.groups,s=Object.keys(t.attributes);for(let a=0;a<i.length;a++){const c=i[a],h=c.start,d=h+c.count,f=new $e,m=l.material[c.materialIndex];for(let y=0;y<s.length;y++){const S=s[y],x=t.attributes[S],w=x.itemSize,T=c.count*w,_=new x.array.constructor(T),E=new tt(_,w);for(let R=h,P=0;R<d;R++,P++){const C=n.getX(R);w>=1&&E.setX(P,x.getX(C)),w>=2&&E.setY(P,x.getY(C)),w>=3&&E.setZ(P,x.getZ(C)),w>=4&&E.setW(P,x.getW(C))}f.setAttribute(S,E)}const g=new et(f,m);e.add(g)}return e}function BP(l,e){const t=new Yn;for(let n=0,i=e.length;n<i;n++)t.add(new et(l,e[n]));return t}function jP(l,e,t){let n=t;const i=new O;return l.updateWorldMatrix(!0,!0),l.traverseVisible(s=>{const{geometry:a}=s;if(a!==void 0){const{position:c}=a.attributes;if(c!==void 0)for(let h=0,d=c.count;h<d;h++)s.isMesh?s.getVertexPosition(h,i):i.fromBufferAttribute(c,h),s.isSkinnedMesh||i.applyMatrix4(s.matrixWorld),n=e(n,i)}}),n}function HP(l,e){const t=Bd(l.instanceMatrix),n=l.instanceColor?Bd(l.instanceColor):null,i=new Map;for(const a in l.geometry.attributes){const c=l.geometry.attributes[a];c.isInstancedBufferAttribute&&i.set(c,Bd(c))}const s=[];for(let a=0;a<l.count;a++)s.push(a);s.sort(e);for(let a=0;a<s.length;a++){const c=s[a];XS.fromArray(t.array,c*l.instanceMatrix.itemSize),XS.toArray(l.instanceMatrix.array,a*l.instanceMatrix.itemSize),l.instanceColor&&(WS.fromArray(n.array,c*l.instanceColor.itemSize),WS.toArray(l.instanceColor.array,a*l.instanceColor.itemSize));for(const h in l.geometry.attributes){const d=l.geometry.attributes[h];if(d.isInstancedBufferAttribute){const f=i.get(d);d.setX(a,f.getX(c)),d.itemSize>1&&d.setY(a,f.getY(c)),d.itemSize>2&&d.setZ(a,f.getZ(c)),d.itemSize>3&&d.setW(a,f.getW(c))}}}}function Mt(l,e,t=!1){for(let n in e){let i=e[n];if(i===void 0)continue;let s=n.split("-"),a=l,c=a;for(let h=0,d=s.length;h<d;h++)(t||c.hasOwnProperty(s[h]))&&(a=c[s[h]],h==d-1&&(a&&a.copy?a.copy(i):a instanceof Object?Object.assign(a,i):c[s[h]]=i),c=a)}return l}function GP(...l){let e=new Ie;return l.length===1?e.set(l[0]):l.length===3&&e.setRGB(l[0],l[1],l[2]),e}function VP(l,e){return new de(l,e??l)}function qS(l,e,t){return new O(l,e??l,t??l)}function WP(l,e,t,n){return new Ke(l,e??l,t??l,n??l)}function YS(l,e,t){return new Xn(l,e,t)}function XP(l,e,t,n){return new Ut(l,e,t,n)}function qP(l,e,t){let n={};l.traverse(a=>{var c;if(a.visible&&a.isMesh&&a.geometry){if(t&&t(a))return;let h=a.geometry.uuid+((c=a.material)==null?void 0:c.name);n[h]==null&&(n[h]={geometry:a.geometry,material:a.material,group:[]}),n[h].group.push(a)}});let i=0,s=new Yn;for(let a in n){let c=n[a],{geometry:h,material:d,group:f}=c,m=new hd(h,d,f.length);for(let g=f.length;g--;)f[g].updateWorldMatrix(!0,!1),m.setMatrixAt(g,f[g].matrixWorld);Mt(m,e),s.add(m),i+=f.length}return s}function Hd(l){let e=l.split(".");return e.length>1?e.pop():""}function QS(l){let e=l.lastIndexOf("/");return e!==-1?l.substring(0,e):""}function Q0(l,e){let t=l.split("/").pop();return e?t.replace(e,"").replace(".",""):t}function YP(){let l=new $e;return l.setAttribute("position",new We([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new We([0,2,0,0,2,0],2)),l}class ZS{constructor(e,t,n){N(this,"texture");N(this,"texCoords");N(this,"meshCoords");this.texture=e,this.texCoords=t,this.meshCoords=n}}const QP={x:.5,y:.5};class KS{constructor(e,t){N(this,"json");N(this,"texture");N(this,"_spriteFrames",{});N(this,"_animations",{});this.json=e,this.texture=t;let n=e.meta.size,i=e.meta.scale/Math.max(n.w,n.h),s=e.frames;for(let a in s){let{frame:c,sourceSize:h,spriteSourceSize:d,anchor:f}=s[a],m=c.x/n.w,g=c.y/n.h,y=c.w/n.w,S=c.h/n.h,x=h,w=d,T=f||QP,_=i;this._spriteFrames[a]=new ZS(t,new Ke(m,1-(g+S),y,S),new Ke(w.x+.5*w.w-x.w*T.x,-(w.y+.5*w.h-x.h*T.y),w.w,w.h).multiplyScalar(_))}for(let a in e.animations)this._animations[a]=e.animations[a].map(c=>this._spriteFrames[c])}getAnimation(e){return this._animations[e]}getSpriteFrame(e){return this._spriteFrames[e]}}class Zs{constructor(){N(this,"name","")}}class JS extends Zs{constructor(){super(...arguments);N(this,"extensions",["json"])}load({url:t,file:n,onLoad:i,onProgress:s,onError:a}){return new hi().load(t,c=>i(JSON.parse(c)),s,a,n)}}class $S extends Zs{constructor(){super(...arguments);N(this,"extensions",["png","jpg","webp","avif"])}load({url:t,file:n,onLoad:i,onProgress:s,onError:a,settings:c}){new Ed().load(t,h=>i(Object.assign(h,c)),s,a,n)}}var ew=function(l){return URL.createObjectURL(new Blob([l],{type:"text/javascript"}))};try{URL.revokeObjectURL(ew(""))}catch{ew=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var Ki=Uint8Array,Ks=Uint16Array,Z0=Uint32Array,tw=new Ki([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nw=new Ki([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ZP=new Ki([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iw=function(l,e){for(var t=new Ks(31),n=0;n<31;++n)t[n]=e+=1<<l[n-1];var i=new Z0(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)i[s]=s-t[n]<<5|n;return[t,i]},rw=iw(tw,2),sw=rw[0],KP=rw[1];sw[28]=258,KP[258]=28;for(var aw=iw(nw,0),JP=aw[0],K0=(aw[1],new Ks(32768)),Wt=0;Wt<32768;++Wt){var ro=(43690&Wt)>>>1|(21845&Wt)<<1;ro=(61680&(ro=(52428&ro)>>>2|(13107&ro)<<2))>>>4|(3855&ro)<<4,K0[Wt]=((65280&ro)>>>8|(255&ro)<<8)>>>1}var eu=function(l,e,t){for(var n=l.length,i=0,s=new Ks(e);i<n;++i)++s[l[i]-1];var a,c=new Ks(e);for(i=0;i<e;++i)c[i]=c[i-1]+s[i-1]<<1;if(t){a=new Ks(1<<e);var h=15-e;for(i=0;i<n;++i)if(l[i])for(var d=i<<4|l[i],f=e-l[i],m=c[l[i]-1]++<<f,g=m|(1<<f)-1;m<=g;++m)a[K0[m]>>>h]=d}else for(a=new Ks(n),i=0;i<n;++i)l[i]&&(a[i]=K0[c[l[i]-1]++]>>>15-l[i]);return a},tu=new Ki(288);for(Wt=0;Wt<144;++Wt)tu[Wt]=8;for(Wt=144;Wt<256;++Wt)tu[Wt]=9;for(Wt=256;Wt<280;++Wt)tu[Wt]=7;for(Wt=280;Wt<288;++Wt)tu[Wt]=8;var ow=new Ki(32);for(Wt=0;Wt<32;++Wt)ow[Wt]=5;var $P=eu(tu,9,1),eC=eu(ow,5,1),J0=function(l){for(var e=l[0],t=1;t<l.length;++t)l[t]>e&&(e=l[t]);return e},yr=function(l,e,t){var n=e/8|0;return(l[n]|l[n+1]<<8)>>(7&e)&t},$0=function(l,e){var t=e/8|0;return(l[t]|l[t+1]<<8|l[t+2]<<16)>>(7&e)},tC=function(l){return(l/8|0)+(7&l&&1)},nC=function(l,e,t){(e==null||e<0)&&(e=0),(t==null||t>l.length)&&(t=l.length);var n=new(l instanceof Ks?Ks:l instanceof Z0?Z0:Ki)(t-e);return n.set(l.subarray(e,t)),n},iC=function(l,e,t){var n=l.length;if(!n||t&&!t.l&&n<5)return e||new Ki(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new Ki(3*n));var a=function(G){var z=e.length;if(G>z){var le=new Ki(Math.max(2*z,G));le.set(e),e=le}},c=t.f||0,h=t.p||0,d=t.b||0,f=t.l,m=t.d,g=t.m,y=t.n,S=8*n;do{if(!f){t.f=c=yr(l,h,1);var x=yr(l,h+1,3);if(h+=3,!x){var w=l[(U=tC(h)+4)-4]|l[U-3]<<8,T=U+w;if(T>n){if(s)throw"unexpected EOF";break}i&&a(d+w),e.set(l.subarray(U,T),d),t.b=d+=w,t.p=h=8*T;continue}if(x==1)f=$P,m=eC,g=9,y=5;else{if(x!=2)throw"invalid block type";var _=yr(l,h,31)+257,E=yr(l,h+10,15)+4,R=_+yr(l,h+5,31)+1;h+=14;for(var P=new Ki(R),C=new Ki(19),F=0;F<E;++F)C[ZP[F]]=yr(l,h+3*F,7);h+=3*E;var W=J0(C),B=(1<<W)-1,V=eu(C,W,1);for(F=0;F<R;){var U,te=V[yr(l,h,B)];if(h+=15&te,(U=te>>>4)<16)P[F++]=U;else{var ue=0,ce=0;for(U==16?(ce=3+yr(l,h,3),h+=2,ue=P[F-1]):U==17?(ce=3+yr(l,h,7),h+=3):U==18&&(ce=11+yr(l,h,127),h+=7);ce--;)P[F++]=ue}}var we=P.subarray(0,_),ve=P.subarray(_);g=J0(we),y=J0(ve),f=eu(we,g,1),m=eu(ve,y,1)}if(h>S){if(s)throw"unexpected EOF";break}}i&&a(d+131072);for(var Re=(1<<g)-1,Pe=(1<<y)-1,De=h;;De=h){var fe=(ue=f[$0(l,h)&Re])>>>4;if((h+=15&ue)>S){if(s)throw"unexpected EOF";break}if(!ue)throw"invalid length/literal";if(fe<256)e[d++]=fe;else{if(fe==256){De=h,f=null;break}var oe=fe-254;if(fe>264){var Se=tw[F=fe-257];oe=yr(l,h,(1<<Se)-1)+sw[F],h+=Se}var Ce=m[$0(l,h)&Pe],Te=Ce>>>4;if(!Ce)throw"invalid distance";if(h+=15&Ce,ve=JP[Te],Te>3&&(Se=nw[Te],ve+=$0(l,h)&(1<<Se)-1,h+=Se),h>S){if(s)throw"unexpected EOF";break}i&&a(d+131072);for(var ze=d+oe;d<ze;d+=4)e[d]=e[d-ve],e[d+1]=e[d+1-ve],e[d+2]=e[d+2-ve],e[d+3]=e[d+3-ve];d=ze}}t.l=f,t.p=De,t.b=d,f&&(c=1,t.m=g,t.d=m,t.n=y)}while(!c);return d==e.length?e:nC(e,0,d)},rC=new Ki(0),sC=function(l){if((15&l[0])!=8||l[0]>>>4>7||(l[0]<<8|l[1])%31)throw"invalid zlib data";if(32&l[1])throw"invalid zlib data: preset dictionaries not supported"};function aC(l,e){return iC((sC(l),l.subarray(2,-4)),e)}var oC=typeof TextDecoder<"u"&&new TextDecoder;try{oC.decode(rC,{stream:!0})}catch{}function lw(l,e,t){const n=t.length-l-1;if(e>=t[n])return n-1;if(e<=t[l])return l;let i=l,s=n,a=Math.floor((i+s)/2);for(;e<t[a]||e>=t[a+1];)e<t[a]?s=a:i=a,a=Math.floor((i+s)/2);return a}function lC(l,e,t,n){const i=[],s=[],a=[];i[0]=1;for(let c=1;c<=t;++c){s[c]=e-n[l+1-c],a[c]=n[l+c]-e;let h=0;for(let d=0;d<c;++d){const f=a[d+1],m=s[c-d],g=i[d]/(f+m);i[d]=h+f*g,h=m*g}i[c]=h}return i}function cC(l,e){let t=1;for(let i=2;i<=l;++i)t*=i;let n=1;for(let i=2;i<=e;++i)n*=i;for(let i=2;i<=l-e;++i)n*=i;return t/n}function uC(l,e,t,n,i){const s=function(a,c,h,d,f){const m=f<a?f:a,g=[],y=lw(a,d,c),S=function(w,T,_,E,R){const P=[];for(let U=0;U<=_;++U)P[U]=0;const C=[];for(let U=0;U<=E;++U)C[U]=P.slice(0);const F=[];for(let U=0;U<=_;++U)F[U]=P.slice(0);F[0][0]=1;const W=P.slice(0),B=P.slice(0);for(let U=1;U<=_;++U){W[U]=T-R[w+1-U],B[U]=R[w+U]-T;let te=0;for(let ue=0;ue<U;++ue){const ce=B[ue+1],we=W[U-ue];F[U][ue]=ce+we;const ve=F[ue][U-1]/F[U][ue];F[ue][U]=te+ce*ve,te=we*ve}F[U][U]=te}for(let U=0;U<=_;++U)C[0][U]=F[U][_];for(let U=0;U<=_;++U){let te=0,ue=1;const ce=[];for(let we=0;we<=_;++we)ce[we]=P.slice(0);ce[0][0]=1;for(let we=1;we<=E;++we){let ve=0;const Re=U-we,Pe=_-we;U>=we&&(ce[ue][0]=ce[te][0]/F[Pe+1][Re],ve=ce[ue][0]*F[Re][Pe]);const De=U-1<=Pe?we-1:_-U;for(let oe=Re>=-1?1:-Re;oe<=De;++oe)ce[ue][oe]=(ce[te][oe]-ce[te][oe-1])/F[Pe+1][Re+oe],ve+=ce[ue][oe]*F[Re+oe][Pe];U<=Pe&&(ce[ue][we]=-ce[te][we-1]/F[Pe+1][U],ve+=ce[ue][we]*F[U][Pe]),C[we][U]=ve;const fe=te;te=ue,ue=fe}}let V=_;for(let U=1;U<=E;++U){for(let te=0;te<=_;++te)C[U][te]*=V;V*=_-U}return C}(y,d,a,m,c),x=[];for(let w=0;w<h.length;++w){const T=h[w].clone(),_=T.w;T.x*=_,T.y*=_,T.z*=_,x[w]=T}for(let w=0;w<=m;++w){const T=x[y-a].clone().multiplyScalar(S[w][0]);for(let _=1;_<=a;++_)T.add(x[y-a+_].clone().multiplyScalar(S[w][_]));g[w]=T}for(let w=m+1;w<=f+1;++w)g[w]=new Ke(0,0,0);return g}(l,e,t,n,i);return function(a){const c=a.length,h=[],d=[];for(let m=0;m<c;++m){const g=a[m];h[m]=new O(g.x,g.y,g.z),d[m]=g.w}const f=[];for(let m=0;m<c;++m){const g=h[m].clone();for(let y=1;y<=m;++y)g.sub(f[m-y].clone().multiplyScalar(cC(m,y)*d[y]));f[m]=g.divideScalar(d[0])}return f}(s)}class hC extends Qi{constructor(e,t,n,i,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=i||0,this.endKnot=s||this.knots.length-1;for(let a=0;a<n.length;++a){const c=n[a];this.controlPoints[a]=new Ke(c.x,c.y,c.z,c.w)}}getPoint(e,t=new O){const n=t,i=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=function(a,c,h,d){const f=lw(a,d,c),m=lC(f,d,a,c),g=new Ke(0,0,0,0);for(let y=0;y<=a;++y){const S=h[f-a+y],x=m[y],w=S.w*x;g.x+=S.x*w,g.y+=S.y*w,g.z+=S.z*w,g.w+=S.w*x}return g}(this.degree,this.knots,this.controlPoints,i);return s.w!==1&&s.divideScalar(s.w),n.set(s.x,s.y,s.z)}getTangent(e,t=new O){const n=t,i=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=uC(this.degree,this.knots,this.controlPoints,i,1);return n.copy(s[1]).normalize(),n}}let xt,dn,bi;class dC extends Qn{constructor(e){super(e)}load(e,t,n,i,s){const a=this,c=a.path===""?Ka.extractUrlBase(e):a.path,h=new hi(this.manager);h.setPath(a.path),h.setResponseType("arraybuffer"),h.setRequestHeader(a.requestHeader),h.setWithCredentials(a.withCredentials),h.load(e,function(d){try{t(a.parse(d,c))}catch(f){i?i(f):console.error(f),a.manager.itemError(e)}},n,i,s==null?void 0:s.mainFile)}parse(e,t){if(function(i){const s="Kaydara FBX Binary  \0";return i.byteLength>=s.length&&s===fw(i,0,s.length)}(e))xt=new vC().parse(e);else{const i=fw(e);if(!function(s){const a=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let c=0;function h(d){const f=s[d-1];return s=s.slice(c+d),c++,f}for(let d=0;d<a.length;++d)if(h(1)===a[d])return!1;return!0}(i))throw new Error("THREE.FBXLoader: Unknown format.");if(hw(i)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+hw(i));xt=new gC().parse(i)}const n=new Ed(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new pC(n,this.manager).parse(xt)}}class pC{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){dn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),i=this.parseDeformers(),s=new fC().parse(i);return this.parseScene(i,s,n),bi}parseConnections(){const e=new Map;return"Connections"in xt&&xt.Connections.connections.forEach(function(t){const n=t[0],i=t[1],s=t[2];e.has(n)||e.set(n,{parents:[],children:[]});const a={ID:i,relationship:s};e.get(n).parents.push(a),e.has(i)||e.set(i,{parents:[],children:[]});const c={ID:n,relationship:s};e.get(i).children.push(c)}),e}parseImages(){const e={},t={};if("Video"in xt.Objects){const n=xt.Objects.Video;for(const i in n){const s=n[i];if(e[parseInt(i)]=s.RelativeFilename||s.Filename,"Content"in s){const a=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,c=typeof s.Content=="string"&&s.Content!=="";if(a||c){const h=this.parseImage(n[i]);t[s.RelativeFilename||s.Filename]=h}}}}for(const n in e){const i=e[n];t[i]!==void 0?e[n]=t[i]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();let s;switch(i){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),s="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if(typeof t=="string")return"data:"+s+";base64,"+t;{const a=new Uint8Array(t);return window.URL.createObjectURL(new Blob([a],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in xt.Objects){const n=xt.Objects.Texture;for(const i in n){const s=this.parseTexture(n[i],e);t.set(parseInt(i),s)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const i=e.WrapModeU,s=e.WrapModeV,a=i!==void 0?i.value:0,c=s!==void 0?s.value:0;if(n.wrapS=a===0?vi:bn,n.wrapT=c===0?vi:bn,"Scaling"in e){const h=e.Scaling.value;n.repeat.x=h[0],n.repeat.y=h[1]}if("Translation"in e){const h=e.Translation.value;n.offset.x=h[0],n.offset.y=h[1]}return n}loadTexture(e,t){let n;const i=this.textureLoader.path,s=dn.get(e.id).children;let a;s!==void 0&&s.length>0&&t[s[0].ID]!==void 0&&(n=t[s[0].ID],n.indexOf("blob:")!==0&&n.indexOf("data:")!==0||this.textureLoader.setPath(void 0));const c=e.FileName.slice(-3).toLowerCase();if(c==="tga"){const h=this.manager.getHandler(".tga");h===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new zt):(h.setPath(this.textureLoader.path),a=h.load(n))}else c==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new zt):a=this.textureLoader.load(n);return this.textureLoader.setPath(i),a}parseMaterials(e){const t=new Map;if("Material"in xt.Objects){const n=xt.Objects.Material;for(const i in n){const s=this.parseMaterial(n[i],e);s!==null&&t.set(parseInt(i),s)}}return t}parseMaterial(e,t){const n=e.id,i=e.attrName;let s=e.ShadingModel;if(typeof s=="object"&&(s=s.value),!dn.has(n))return null;const a=this.parseParameters(e,t,n);let c;switch(s.toLowerCase()){case"phong":c=new Qc;break;case"lambert":c=new L0;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),c=new Qc}return c.setValues(a),c.name=i,c}parseParameters(e,t,n){const i={};e.BumpFactor&&(i.bumpScale=e.BumpFactor.value),e.Diffuse?i.color=new Ie().fromArray(e.Diffuse.value):!e.DiffuseColor||e.DiffuseColor.type!=="Color"&&e.DiffuseColor.type!=="ColorRGB"||(i.color=new Ie().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(i.displacementScale=e.DisplacementFactor.value),e.Emissive?i.emissive=new Ie().fromArray(e.Emissive.value):!e.EmissiveColor||e.EmissiveColor.type!=="Color"&&e.EmissiveColor.type!=="ColorRGB"||(i.emissive=new Ie().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(i.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(i.opacity=parseFloat(e.Opacity.value)),i.opacity<1&&(i.transparent=!0),e.ReflectionFactor&&(i.reflectivity=e.ReflectionFactor.value),e.Shininess&&(i.shininess=e.Shininess.value),e.Specular?i.specular=new Ie().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(i.specular=new Ie().fromArray(e.SpecularColor.value));const s=this;return dn.get(n).children.forEach(function(a){const c=a.relationship;switch(c){case"Bump":i.bumpMap=s.getTexture(t,a.ID);break;case"Maya|TEX_ao_map":i.aoMap=s.getTexture(t,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=s.getTexture(t,a.ID),i.map!==void 0&&(i.map.encoding=mt);break;case"DisplacementColor":i.displacementMap=s.getTexture(t,a.ID);break;case"EmissiveColor":i.emissiveMap=s.getTexture(t,a.ID),i.emissiveMap!==void 0&&(i.emissiveMap.encoding=mt);break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=s.getTexture(t,a.ID);break;case"ReflectionColor":i.envMap=s.getTexture(t,a.ID),i.envMap!==void 0&&(i.envMap.mapping=Is,i.envMap.encoding=mt);break;case"SpecularColor":i.specularMap=s.getTexture(t,a.ID),i.specularMap!==void 0&&(i.specularMap.encoding=mt);break;case"TransparentColor":case"TransparencyFactor":i.alphaMap=s.getTexture(t,a.ID),i.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",c)}}),i}getTexture(e,t){return"LayeredTexture"in xt.Objects&&t in xt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=dn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in xt.Objects){const n=xt.Objects.Deformer;for(const i in n){const s=n[i],a=dn.get(parseInt(i));if(s.attrType==="Skin"){const c=this.parseSkeleton(a,n);c.ID=i,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=a.parents[0].ID,e[i]=c}else if(s.attrType==="BlendShape"){const c={id:i};c.rawTargets=this.parseMorphTargets(a,n),c.id=i,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[i]=c}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(i){const s=t[i.ID];if(s.attrType!=="Cluster")return;const a={ID:i.ID,indices:[],weights:[],transformLink:new Ne().fromArray(s.TransformLink.a)};"Indexes"in s&&(a.indices=s.Indexes.a,a.weights=s.Weights.a),n.push(a)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let i=0;i<e.children.length;i++){const s=e.children[i],a=t[s.ID],c={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;c.geoID=dn.get(parseInt(s.ID)).children.filter(function(h){return h.relationship===void 0})[0].ID,n.push(c)}return n}parseScene(e,t,n){bi=new Yn;const i=this.parseModels(e.skeletons,t,n),s=xt.Objects.Model,a=this;i.forEach(function(h){const d=s[h.ID];a.setLookAtProperties(h,d),dn.get(h.ID).parents.forEach(function(f){const m=i.get(f.ID);m!==void 0&&m.add(h)}),h.parent===null&&bi.add(h)}),this.bindSkeleton(e.skeletons,t,i),this.createAmbientLight(),bi.traverse(function(h){if(h.userData.transformData){h.parent&&(h.userData.transformData.parentMatrix=h.parent.matrix,h.userData.transformData.parentMatrixWorld=h.parent.matrixWorld);const d=dw(h.userData.transformData);h.applyMatrix4(d),h.updateWorldMatrix()}});const c=new mC().parse();bi.children.length===1&&bi.children[0].isGroup&&(bi.children[0].animations=c,bi=bi.children[0]),bi.animations=c}parseModels(e,t,n){const i=new Map,s=xt.Objects.Model;for(const a in s){const c=parseInt(a),h=s[a],d=dn.get(c);let f=this.buildSkeleton(d,e,c,h.attrName);if(!f){switch(h.attrType){case"Camera":f=this.createCamera(d);break;case"Light":f=this.createLight(d);break;case"Mesh":f=this.createMesh(d,t,n);break;case"NurbsCurve":f=this.createCurve(d,t);break;case"LimbNode":case"Root":f=new ul;break;default:f=new Yn}f.name=h.attrName?gt.sanitizeNodeName(h.attrName):"",f.ID=c}this.getTransformData(f,h),i.set(c,f)}return i}buildSkeleton(e,t,n,i){let s=null;return e.parents.forEach(function(a){for(const c in t){const h=t[c];h.rawBones.forEach(function(d,f){if(d.ID===a.ID){const m=s;s=new ul,s.matrixWorld.copy(d.transformLink),s.name=i?gt.sanitizeNodeName(i):"",s.ID=n,h.bones[f]=s,m!==null&&s.add(m)}})}}),s}createCamera(e){let t,n;if(e.children.forEach(function(i){const s=xt.Objects.NodeAttribute[i.ID];s!==void 0&&(n=s)}),n===void 0)t=new ct;else{let i=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(i=1);let s=1;n.NearPlane!==void 0&&(s=n.NearPlane.value/1e3);let a=1e3;n.FarPlane!==void 0&&(a=n.FarPlane.value/1e3);let c=window.innerWidth,h=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(c=n.AspectWidth.value,h=n.AspectHeight.value);const d=c/h;let f=45;n.FieldOfView!==void 0&&(f=n.FieldOfView.value);const m=n.FocalLength?n.FocalLength.value:null;switch(i){case 0:t=new Kt(f,d,s,a),m!==null&&t.setFocalLength(m);break;case 1:t=new Hs(-c/2,c/2,h/2,-h/2,s,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+i+"."),t=new ct}}return t}createLight(e){let t,n;if(e.children.forEach(function(i){const s=xt.Objects.NodeAttribute[i.ID];s!==void 0&&(n=s)}),n===void 0)t=new ct;else{let i;i=n.LightType===void 0?0:n.LightType.value;let s=16777215;n.Color!==void 0&&(s=new Ie().fromArray(n.Color.value));let a=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(a=0);let c=0;n.FarAttenuationEnd!==void 0&&(c=n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?0:n.FarAttenuationEnd.value);const h=1;switch(i){case 0:t=new Jc(s,a,c,h);break;case 1:t=new Rd(s,a);break;case 2:let d=Math.PI/3;n.InnerAngle!==void 0&&(d=fn.degToRad(n.InnerAngle.value));let f=0;n.OuterAngle!==void 0&&(f=fn.degToRad(n.OuterAngle.value),f=Math.max(f,1)),t=new Ad(s,a,c,d,f,h);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Jc(s,a)}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let i,s=null,a=null;const c=[];return e.children.forEach(function(h){t.has(h.ID)&&(s=t.get(h.ID)),n.has(h.ID)&&c.push(n.get(h.ID))}),c.length>1?a=c:c.length>0?a=c[0]:(a=new Qc({color:13421772}),c.push(a)),"color"in s.attributes&&c.forEach(function(h){h.vertexColors=!0}),s.FBX_Deformer?(i=new cd(s,a),i.normalizeSkinWeights()):i=new et(s,a),i}createCurve(e,t){const n=e.children.reduce(function(s,a){return t.has(a.ID)&&(s=t.get(a.ID)),s},null),i=new Un({color:3342591,linewidth:1});return new kr(n,i)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?pw(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&dn.get(e.ID).children.forEach(function(n){if(n.relationship==="LookAtProperty"){const i=xt.Objects.Model[n.ID];if("Lcl_Translation"in i){const s=i.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(s),bi.add(e.target)):e.lookAt(new O().fromArray(s))}}})}bindSkeleton(e,t,n){const i=this.parsePoseNodes();for(const s in e){const a=e[s];dn.get(parseInt(a.ID)).parents.forEach(function(c){if(t.has(c.ID)){const h=c.ID;dn.get(h).parents.forEach(function(d){n.has(d.ID)&&n.get(d.ID).bind(new hl(a.bones),i[d.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in xt.Objects){const t=xt.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const i=t[n].PoseNode;Array.isArray(i)?i.forEach(function(s){e[s.Node]=new Ne().fromArray(s.Matrix.a)}):e[i.Node]=new Ne().fromArray(i.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in xt&&"AmbientColor"in xt.GlobalSettings){const e=xt.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],i=e[2];if(t!==0||n!==0||i!==0){const s=new Ie(t,n,i);bi.add(new z0(s,1))}}}}class fC{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in xt.Objects){const n=xt.Objects.Geometry;for(const i in n){const s=dn.get(parseInt(i)),a=this.parseGeometry(s,n[i],e);t.set(parseInt(i),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const i=n.skeletons,s=[],a=e.parents.map(function(m){return xt.Objects.Model[m.ID]});if(a.length===0)return;const c=e.children.reduce(function(m,g){return i[g.ID]!==void 0&&(m=i[g.ID]),m},null);e.children.forEach(function(m){n.morphTargets[m.ID]!==void 0&&s.push(n.morphTargets[m.ID])});const h=a[0],d={};"RotationOrder"in h&&(d.eulerOrder=pw(h.RotationOrder.value)),"InheritType"in h&&(d.inheritType=parseInt(h.InheritType.value)),"GeometricTranslation"in h&&(d.translation=h.GeometricTranslation.value),"GeometricRotation"in h&&(d.rotation=h.GeometricRotation.value),"GeometricScaling"in h&&(d.scale=h.GeometricScaling.value);const f=dw(d);return this.genGeometry(t,c,s,f)}genGeometry(e,t,n,i){const s=new $e;e.attrName&&(s.name=e.attrName);const a=this.parseGeoNode(e,t),c=this.genBuffers(a),h=new We(c.vertex,3);if(h.applyMatrix4(i),s.setAttribute("position",h),c.colors.length>0&&s.setAttribute("color",new We(c.colors,3)),t&&(s.setAttribute("skinIndex",new Hh(c.weightsIndices,4)),s.setAttribute("skinWeight",new We(c.vertexWeights,4)),s.FBX_Deformer=t),c.normal.length>0){const d=new mn().getNormalMatrix(i),f=new We(c.normal,3);f.applyNormalMatrix(d),s.setAttribute("normal",f)}if(c.uvs.forEach(function(d,f){let m="uv"+(f+1).toString();f===0&&(m="uv"),s.setAttribute(m,new We(c.uvs[f],2))}),a.material&&a.material.mappingType!=="AllSame"){let d=c.materialIndex[0],f=0;if(c.materialIndex.forEach(function(m,g){m!==d&&(s.addGroup(f,g-f,d),d=m,f=g)}),s.groups.length>0){const m=s.groups[s.groups.length-1],g=m.start+m.count;g!==c.materialIndex.length&&s.addGroup(g,c.materialIndex.length-g,d)}s.groups.length===0&&s.addGroup(0,c.materialIndex.length,c.materialIndex[0])}return this.addMorphTargets(s,e,n,i),s}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let i=0;for(;e.LayerElementUV[i];)e.LayerElementUV[i].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[i])),i++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(i,s){i.indices.forEach(function(a,c){n.weightTable[a]===void 0&&(n.weightTable[a]=[]),n.weightTable[a].push({id:s,weight:i.weights[c]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,i=0,s=!1,a=[],c=[],h=[],d=[],f=[],m=[];const g=this;return e.vertexIndices.forEach(function(y,S){let x,w=!1;y<0&&(y^=-1,w=!0);let T=[],_=[];if(a.push(3*y,3*y+1,3*y+2),e.color){const E=Gd(S,n,y,e.color);h.push(E[0],E[1],E[2])}if(e.skeleton){if(e.weightTable[y]!==void 0&&e.weightTable[y].forEach(function(E){_.push(E.weight),T.push(E.id)}),_.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const E=[0,0,0,0],R=[0,0,0,0];_.forEach(function(P,C){let F=P,W=T[C];R.forEach(function(B,V,U){if(F>B){U[V]=F,F=B;const te=E[V];E[V]=W,W=te}})}),T=E,_=R}for(;_.length<4;)_.push(0),T.push(0);for(let E=0;E<4;++E)f.push(_[E]),m.push(T[E])}if(e.normal){const E=Gd(S,n,y,e.normal);c.push(E[0],E[1],E[2])}e.material&&e.material.mappingType!=="AllSame"&&(x=Gd(S,n,y,e.material)[0],x<0&&(g.negativeMaterialIndices=!0,x=0)),e.uv&&e.uv.forEach(function(E,R){const P=Gd(S,n,y,E);d[R]===void 0&&(d[R]=[]),d[R].push(P[0]),d[R].push(P[1])}),i++,w&&(i>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),g.genFace(t,e,a,x,c,h,d,f,m,i),n++,i=0,a=[],c=[],h=[],d=[],f=[],m=[])}),t}genFace(e,t,n,i,s,a,c,h,d,f){for(let m=2;m<f;m++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(m-1)]]),e.vertex.push(t.vertexPositions[n[3*(m-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(m-1)+2]]),e.vertex.push(t.vertexPositions[n[3*m]]),e.vertex.push(t.vertexPositions[n[3*m+1]]),e.vertex.push(t.vertexPositions[n[3*m+2]]),t.skeleton&&(e.vertexWeights.push(h[0]),e.vertexWeights.push(h[1]),e.vertexWeights.push(h[2]),e.vertexWeights.push(h[3]),e.vertexWeights.push(h[4*(m-1)]),e.vertexWeights.push(h[4*(m-1)+1]),e.vertexWeights.push(h[4*(m-1)+2]),e.vertexWeights.push(h[4*(m-1)+3]),e.vertexWeights.push(h[4*m]),e.vertexWeights.push(h[4*m+1]),e.vertexWeights.push(h[4*m+2]),e.vertexWeights.push(h[4*m+3]),e.weightsIndices.push(d[0]),e.weightsIndices.push(d[1]),e.weightsIndices.push(d[2]),e.weightsIndices.push(d[3]),e.weightsIndices.push(d[4*(m-1)]),e.weightsIndices.push(d[4*(m-1)+1]),e.weightsIndices.push(d[4*(m-1)+2]),e.weightsIndices.push(d[4*(m-1)+3]),e.weightsIndices.push(d[4*m]),e.weightsIndices.push(d[4*m+1]),e.weightsIndices.push(d[4*m+2]),e.weightsIndices.push(d[4*m+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(m-1)]),e.colors.push(a[3*(m-1)+1]),e.colors.push(a[3*(m-1)+2]),e.colors.push(a[3*m]),e.colors.push(a[3*m+1]),e.colors.push(a[3*m+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(i),e.materialIndex.push(i),e.materialIndex.push(i)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[3*(m-1)]),e.normal.push(s[3*(m-1)+1]),e.normal.push(s[3*(m-1)+2]),e.normal.push(s[3*m]),e.normal.push(s[3*m+1]),e.normal.push(s[3*m+2])),t.uv&&t.uv.forEach(function(g,y){e.uvs[y]===void 0&&(e.uvs[y]=[]),e.uvs[y].push(c[y][0]),e.uvs[y].push(c[y][1]),e.uvs[y].push(c[y][2*(m-1)]),e.uvs[y].push(c[y][2*(m-1)+1]),e.uvs[y].push(c[y][2*m]),e.uvs[y].push(c[y][2*m+1])})}addMorphTargets(e,t,n,i){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;n.forEach(function(a){a.rawTargets.forEach(function(c){const h=xt.Objects.Geometry[c.geoID];h!==void 0&&s.genMorphGeometry(e,t,h,i,c.name)})})}genMorphGeometry(e,t,n,i,s){const a=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],c=n.Vertices!==void 0?n.Vertices.a:[],h=n.Indexes!==void 0?n.Indexes.a:[],d=3*e.attributes.position.count,f=new Float32Array(d);for(let S=0;S<h.length;S++){const x=3*h[S];f[x]=c[3*S],f[x+1]=c[3*S+1],f[x+2]=c[3*S+2]}const m={vertexIndices:a,vertexPositions:f},g=this.genBuffers(m),y=new We(g.vertex,3);y.name=s||n.attrName,y.applyMatrix4(i),e.morphAttributes.position.push(y)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.Normals.a;let s=[];return n==="IndexToDirect"&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:i,indices:s,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.UV.a;let s=[];return n==="IndexToDirect"&&(s=e.UVIndex.a),{dataSize:2,buffer:i,indices:s,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.Colors.a;let s=[];return n==="IndexToDirect"&&(s=e.ColorIndex.a),{dataSize:4,buffer:i,indices:s,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const i=e.Materials.a,s=[];for(let a=0;a<i.length;++a)s.push(a);return{dataSize:1,buffer:i,indices:s,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new $e;const n=t-1,i=e.KnotVector.a,s=[],a=e.Points.a;for(let f=0,m=a.length;f<m;f+=4)s.push(new Ke().fromArray(a,f));let c,h;if(e.Form==="Closed")s.push(s[0]);else if(e.Form==="Periodic"){c=n,h=i.length-1-c;for(let f=0;f<n;++f)s.push(s[f])}const d=new hC(n,i,s,c,h).getPoints(12*s.length);return new $e().setFromPoints(d)}}class mC{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const i=t[n],s=this.addClip(i);e.push(s)}return e}parseClips(){if(xt.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=xt.Objects.AnimationCurveNode,t=new Map;for(const n in e){const i=e[n];if(i.attrName.match(/S|R|T|DeformPercent/)!==null){const s={id:i.id,attr:i.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=xt.Objects.AnimationCurve;for(const n in t){const i={id:t[n].id,times:t[n].KeyTime.a.map(yC),values:t[n].KeyValueFloat.a},s=dn.get(i.id);if(s!==void 0){const a=s.parents[0].ID,c=s.parents[0].relationship;c.match(/X/)?e.get(a).curves.x=i:c.match(/Y/)?e.get(a).curves.y=i:c.match(/Z/)?e.get(a).curves.z=i:c.match(/d|DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=i)}}}parseAnimationLayers(e){const t=xt.Objects.AnimationLayer,n=new Map;for(const i in t){const s=[],a=dn.get(parseInt(i));a!==void 0&&(a.children.forEach(function(c,h){if(e.has(c.ID)){const d=e.get(c.ID);if(d.curves.x!==void 0||d.curves.y!==void 0||d.curves.z!==void 0){if(s[h]===void 0){const f=dn.get(c.ID).parents.filter(function(m){return m.relationship!==void 0})[0].ID;if(f!==void 0){const m=xt.Objects.Model[f.toString()];if(m===void 0)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",c);const g={modelName:m.attrName?gt.sanitizeNodeName(m.attrName):"",ID:m.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};bi.traverse(function(y){y.ID===m.id&&(g.transform=y.matrix,y.userData.transformData&&(g.eulerOrder=y.userData.transformData.eulerOrder))}),g.transform||(g.transform=new Ne),"PreRotation"in m&&(g.preRotation=m.PreRotation.value),"PostRotation"in m&&(g.postRotation=m.PostRotation.value),s[h]=g}}s[h]&&(s[h][d.attr]=d)}else if(d.curves.morph!==void 0){if(s[h]===void 0){const f=dn.get(c.ID).parents.filter(function(w){return w.relationship!==void 0})[0].ID,m=dn.get(f).parents[0].ID,g=dn.get(m).parents[0].ID,y=dn.get(g).parents[0].ID,S=xt.Objects.Model[y],x={modelName:S.attrName?gt.sanitizeNodeName(S.attrName):"",morphName:xt.Objects.Deformer[f].attrName};s[h]=x}s[h][d.attr]=d}}}),n.set(parseInt(i),s))}return n}parseAnimStacks(e){const t=xt.Objects.AnimationStack,n={};for(const i in t){const s=dn.get(parseInt(i)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(s[0].ID);n[i]={name:t[i].attrName,layer:a}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(i){t=t.concat(n.generateTracks(i))}),new Za(e.name,-1,t)}generateTracks(e){const t=[];let n=new O,i=new Ut,s=new O;if(e.transform&&e.transform.decompose(n,i,s),n=n.toArray(),i=new Xn().setFromQuaternion(i,e.eulerOrder).toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");a!==void 0&&t.push(a)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const a=this.generateRotationTrack(e.modelName,e.R.curves,i,e.preRotation,e.postRotation,e.eulerOrder);a!==void 0&&t.push(a)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");a!==void 0&&t.push(a)}if(e.DeformPercent!==void 0){const a=this.generateMorphTrack(e);a!==void 0&&t.push(a)}return t}generateVectorTrack(e,t,n,i){const s=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(s,t,n);return new Qa(e+"."+i,s,a)}generateRotationTrack(e,t,n,i,s,a){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(fn.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(fn.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(fn.degToRad));const c=this.getTimesForAllAxes(t),h=this.getKeyframeTrackValues(c,t,n);i!==void 0&&((i=i.map(fn.degToRad)).push(a),i=new Xn().fromArray(i),i=new Ut().setFromEuler(i)),s!==void 0&&((s=s.map(fn.degToRad)).push(a),s=new Xn().fromArray(s),s=new Ut().setFromEuler(s).invert());const d=new Ut,f=new Xn,m=[];for(let g=0;g<h.length;g+=3)f.set(h[g],h[g+1],h[g+2],a),d.setFromEuler(f),i!==void 0&&d.premultiply(i),s!==void 0&&d.multiply(s),d.toArray(m,g/3*4);return new fs(e+".quaternion",c,m)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(s){return s/100}),i=bi.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new qa(e.modelName+".morphTargetInfluences["+i+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,i){return n-i}),t.length>1){let n=1,i=t[0];for(let s=1;s<t.length;s++){const a=t[s];a!==i&&(t[n]=a,i=a,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const i=n,s=[];let a=-1,c=-1,h=-1;return e.forEach(function(d){if(t.x&&(a=t.x.times.indexOf(d)),t.y&&(c=t.y.times.indexOf(d)),t.z&&(h=t.z.times.indexOf(d)),a!==-1){const f=t.x.values[a];s.push(f),i[0]=f}else s.push(i[0]);if(c!==-1){const f=t.y.values[c];s.push(f),i[1]=f}else s.push(i[1]);if(h!==-1){const f=t.z.values[h];s.push(f),i[2]=f}else s.push(i[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],i=e.values[t]-n,s=Math.abs(i);if(s>=180){const a=s/180,c=i/a;let h=n+c;const d=e.times[t-1],f=(e.times[t]-d)/a;let m=d+f;const g=[],y=[];for(;m<e.times[t];)g.push(m),m+=f,y.push(h),h+=c;e.times=mw(e.times,t,g),e.values=mw(e.values,t,y)}}}}class gC{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new uw,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(i,s){const a=i.match(/^[\s\t]*;/),c=i.match(/^[\s\t]*$/);if(a||c)return;const h=i.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),d=i.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),f=i.match("^\\t{"+(t.currentIndent-1)+"}}");h?t.parseNodeBegin(i,h):d?t.parseNodeProperty(i,d,n[++s]):f?t.popStack():i.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(i)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),i=t[2].split(",").map(function(h){return h.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:n},a=this.parseNodeAttr(i),c=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,s):n in c?(n==="PoseNode"?c.PoseNode.push(s):c[n].id!==void 0&&(c[n]={},c[n][c[n].id]=c[n]),a.id!==""&&(c[n][a.id]=s)):typeof a.id=="number"?(c[n]={},c[n][a.id]=s):n!=="Properties70"&&(c[n]=n==="PoseNode"?[s]:s),typeof a.id=="number"&&(s.id=a.id),a.name!==""&&(s.attrName=a.name),a.type!==""&&(s.attrType=a.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",i="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),i=e[2]),{id:t,name:n,type:i}}parseNodeProperty(e,t,n){let i=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();i==="Content"&&s===","&&(s=n.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name!=="Properties70"){if(i==="C"){const c=s.split(",").slice(1),h=parseInt(c[0]),d=parseInt(c[1]);let f=s.split(",").slice(3);f=f.map(function(m){return m.trim().replace(/^"/,"")}),i="connections",s=[h,d],function(m,g){for(let y=0,S=m.length,x=g.length;y<x;y++,S++)m[S]=g[y]}(s,f),a[i]===void 0&&(a[i]=[])}i==="Node"&&(a.id=s),i in a&&Array.isArray(a[i])?a[i].push(s):i!=="a"?a[i]=s:a.a=s,this.setCurrentProp(a,i),i==="a"&&s.slice(-1)!==","&&(a.a=tg(s))}else this.parseNodeSpecialProperty(e,i,s)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=tg(t.a))}parseNodeSpecialProperty(e,t,n){const i=n.split('",').map(function(f){return f.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=i[0],a=i[1],c=i[2],h=i[3];let d=i[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":d=parseFloat(d);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":d=tg(d)}this.getPrevNode()[s]={type:a,type2:c,flag:h,value:d},this.setCurrentProp(this.getPrevNode(),s)}}class vC{parse(e){const t=new cw(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const i=new uw;for(;!this.endOfContent(t);){const s=this.parseNode(t,n);s!==null&&i.add(s.name,s)}return i}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},i=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),c=e.getString(a);if(i===0)return null;const h=[];for(let g=0;g<s;g++)h.push(this.parseProperty(e));const d=h.length>0?h[0]:"",f=h.length>1?h[1]:"",m=h.length>2?h[2]:"";for(n.singleProperty=s===1&&e.getOffset()===i;i>e.getOffset();){const g=this.parseNode(e,t);g!==null&&this.parseSubNode(c,n,g)}return n.propertyList=h,typeof d=="number"&&(n.id=d),f!==""&&(n.attrName=f),m!==""&&(n.attrType=m),c!==""&&(n.name=c),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const i=n.propertyList[0];Array.isArray(i)?(t[n.name]=n,n.a=i):t[n.name]=i}else if(e==="Connections"&&n.name==="C"){const i=[];n.propertyList.forEach(function(s,a){a!==0&&i.push(s)}),t.connections===void 0&&(t.connections=[]),t.connections.push(i)}else if(n.name==="Properties70")Object.keys(n).forEach(function(i){t[i]=n[i]});else if(e==="Properties70"&&n.name==="P"){let i=n.propertyList[0],s=n.propertyList[1];const a=n.propertyList[2],c=n.propertyList[3];let h;i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),h=s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[i]={type:s,type2:a,flag:c,value:h}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const i=e.getUint32(),s=e.getUint32(),a=e.getUint32();if(s===0)switch(t){case"b":case"c":return e.getBooleanArray(i);case"d":return e.getFloat64Array(i);case"f":return e.getFloat32Array(i);case"i":return e.getInt32Array(i);case"l":return e.getInt64Array(i)}const c=aC(new Uint8Array(e.getArrayBuffer(a))),h=new cw(c.buffer);switch(t){case"b":case"c":return h.getBooleanArray(i);case"d":return h.getFloat64Array(i);case"f":return h.getFloat32Array(i);case"i":return h.getInt32Array(i);case"l":return h.getInt64Array(i)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class cw{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t===void 0||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const i=n.indexOf(0);return i>=0&&(n=new Uint8Array(this.dv.buffer,t,i)),this._textDecoder.decode(n)}}class uw{add(e,t){this[e]=t}}function hw(l){const e=l.match(/FBXVersion: (\d+)/);if(e)return parseInt(e[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function yC(l){return l/46186158e3}const xC=[];function Gd(l,e,t,n){let i;switch(n.mappingType){case"ByPolygonVertex":i=l;break;case"ByPolygon":i=e;break;case"ByVertice":i=t;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(i=n.indices[i]);const s=i*n.dataSize,a=s+n.dataSize;return function(c,h,d,f){for(let m=d,g=0;m<f;m++,g++)c[g]=h[m];return c}(xC,n.buffer,s,a)}const eg=new Xn,Al=new O;function dw(l){const e=new Ne,t=new Ne,n=new Ne,i=new Ne,s=new Ne,a=new Ne,c=new Ne,h=new Ne,d=new Ne,f=new Ne,m=new Ne,g=new Ne,y=l.inheritType?l.inheritType:0;if(l.translation&&e.setPosition(Al.fromArray(l.translation)),l.preRotation){const V=l.preRotation.map(fn.degToRad);V.push(l.eulerOrder||Xn.DEFAULT_ORDER),t.makeRotationFromEuler(eg.fromArray(V))}if(l.rotation){const V=l.rotation.map(fn.degToRad);V.push(l.eulerOrder||Xn.DEFAULT_ORDER),n.makeRotationFromEuler(eg.fromArray(V))}if(l.postRotation){const V=l.postRotation.map(fn.degToRad);V.push(l.eulerOrder||Xn.DEFAULT_ORDER),i.makeRotationFromEuler(eg.fromArray(V)),i.invert()}l.scale&&s.scale(Al.fromArray(l.scale)),l.scalingOffset&&c.setPosition(Al.fromArray(l.scalingOffset)),l.scalingPivot&&a.setPosition(Al.fromArray(l.scalingPivot)),l.rotationOffset&&h.setPosition(Al.fromArray(l.rotationOffset)),l.rotationPivot&&d.setPosition(Al.fromArray(l.rotationPivot)),l.parentMatrixWorld&&(m.copy(l.parentMatrix),f.copy(l.parentMatrixWorld));const S=t.clone().multiply(n).multiply(i),x=new Ne;x.extractRotation(f);const w=new Ne;w.copyPosition(f);const T=w.clone().invert().multiply(f),_=x.clone().invert().multiply(T),E=s,R=new Ne;if(y===0)R.copy(x).multiply(S).multiply(_).multiply(E);else if(y===1)R.copy(x).multiply(_).multiply(S).multiply(E);else{const V=new Ne().scale(new O().setFromMatrixScale(m)).clone().invert(),U=_.clone().multiply(V);R.copy(x).multiply(S).multiply(U).multiply(E)}const P=d.clone().invert(),C=a.clone().invert();let F=e.clone().multiply(h).multiply(d).multiply(t).multiply(n).multiply(i).multiply(P).multiply(c).multiply(a).multiply(s).multiply(C);const W=new Ne().copyPosition(F),B=f.clone().multiply(W);return g.copyPosition(B),F=g.clone().multiply(R),F.premultiply(f.invert()),F}function pw(l){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return(l=l||0)===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[l]}function tg(l){return l.split(",").map(function(e){return parseFloat(e)})}function fw(l,e,t){return e===void 0&&(e=0),t===void 0&&(t=l.byteLength),new TextDecoder().decode(new Uint8Array(l,e,t))}function mw(l,e,t){return l.slice(0,e).concat(t).concat(l.slice(e))}const ng=new WeakMap;class bC extends Qn{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const s=new hi(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{this.parse(a,t,i)},n,i)}parse(e,t,n){this.decodeDracoFile(e,t,null,null,Di).catch(n)}decodeDracoFile(e,t,n,i,s=jo){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:s};return this.decodeGeometry(e,a).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(ng.has(e)){const h=ng.get(e);if(h.key===n)return h.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,a=e.byteLength,c=this._getWorker(s,a).then(h=>(i=h,new Promise((d,f)=>{i._callbacks[s]={resolve:d,reject:f},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(h=>this._createGeometry(h.geometry));return c.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),ng.set(e,{key:n,promise:c}),c}_createGeometry(e){const t=new $e;e.index&&t.setIndex(new tt(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],s=i.name,a=i.array,c=i.itemSize,h=new tt(a,c);s==="color"&&this._assignVertexColorSpace(h,i.vertexColorSpace),t.setAttribute(s,h)}return t}_assignVertexColorSpace(e,t){if(t!==Di)return;const n=new Ie;for(let i=0,s=e.count;i<s;i++)n.fromBufferAttribute(e,i).convertSRGBToLinear(),e.setXYZ(i,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new hi(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((i,s)=>{n.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const i=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=SC.toString(),a=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const a=s.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){this.workerPool.map(e=>e._taskLoad)}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function SC(){let l,e;function t(n,i,s,a,c,h){const d=h.num_components(),f=s.num_points()*d,m=f*c.BYTES_PER_ELEMENT,g=function(x,w){switch(w){case Float32Array:return x.DT_FLOAT32;case Int8Array:return x.DT_INT8;case Int16Array:return x.DT_INT16;case Int32Array:return x.DT_INT32;case Uint8Array:return x.DT_UINT8;case Uint16Array:return x.DT_UINT16;case Uint32Array:return x.DT_UINT32}}(n,c),y=n._malloc(m);i.GetAttributeDataArrayForAllPoints(s,h,g,m,y);const S=new c(n.HEAPF32.buffer,y,f).slice();return n._free(y),{name:a,array:S,itemSize:d}}onmessage=function(n){const i=n.data;switch(i.type){case"init":l=i.decoderConfig,e=new Promise(function(c){l.onModuleLoaded=function(h){c({draco:h})},DracoDecoderModule(l)});break;case"decode":const s=i.buffer,a=i.taskConfig;e.then(c=>{const h=c.draco,d=new h.Decoder;try{const f=function(g,y,S,x){const w=x.attributeIDs,T=x.attributeTypes;let _,E;const R=y.GetEncodedGeometryType(S);if(R===g.TRIANGULAR_MESH)_=new g.Mesh,E=y.DecodeArrayToMesh(S,S.byteLength,_);else{if(R!==g.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");_=new g.PointCloud,E=y.DecodeArrayToPointCloud(S,S.byteLength,_)}if(!E.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+E.error_msg());const P={index:null,attributes:[]};for(const C in w){const F=self[T[C]];let W,B;if(x.useUniqueIDs)B=w[C],W=y.GetAttributeByUniqueId(_,B);else{if(B=y.GetAttributeId(_,g[w[C]]),B===-1)continue;W=y.GetAttribute(_,B)}const V=t(g,y,_,C,F,W);C==="color"&&(V.vertexColorSpace=x.vertexColorSpace),P.attributes.push(V)}return R===g.TRIANGULAR_MESH&&(P.index=function(C,F,W){const B=W.num_faces(),V=3*B,U=4*V,te=C._malloc(U);F.GetTrianglesUInt32Array(W,U,te);const ue=new Uint32Array(C.HEAPF32.buffer,te,V).slice();return C._free(te),{array:ue,itemSize:1}}(g,y,_)),g.destroy(_),P}(h,d,new Int8Array(s),a),m=f.attributes.map(g=>g.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:i.id,error:f.message})}finally{h.destroy(d)}})}}}class wC extends Qn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new AC(t)}),this.register(function(t){return new IC(t)}),this.register(function(t){return new NC(t)}),this.register(function(t){return new kC(t)}),this.register(function(t){return new LC(t)}),this.register(function(t){return new PC(t)}),this.register(function(t){return new CC(t)}),this.register(function(t){return new DC(t)}),this.register(function(t){return new EC(t)}),this.register(function(t){return new OC(t)}),this.register(function(t){return new RC(t)}),this.register(function(t){return new MC(t)}),this.register(function(t){return new FC(t)}),this.register(function(t){return new UC(t)})}load(e,t,n,i,s){const a=this;let c;c=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:Ka.extractUrlBase(e),this.manager.itemStart(e);const h=function(f){i?i(f):console.error(f),a.manager.itemError(e),a.manager.itemEnd(e)},d=new hi(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{a.parse(f,c,function(m){t(m),a.manager.itemEnd(e)},h,s==null?void 0:s.additionalFiles)}catch(m){h(m)}},n,h,s==null?void 0:s.mainFile)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i,s){let a;const c={},h={},d=new TextDecoder;if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===gw){try{c[wt.KHR_BINARY_GLTF]=new jC(e)}catch(m){return void(i&&i(m))}a=JSON.parse(c[wt.KHR_BINARY_GLTF].content)}else a=JSON.parse(d.decode(e));else a=e;if(a.asset===void 0||a.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const f=new eD(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let m=0;m<this.pluginCallbacks.length;m++){const g=this.pluginCallbacks[m](f);h[g.name]=g,c[g.name]=!0}if(a.extensionsUsed)for(let m=0;m<a.extensionsUsed.length;++m){const g=a.extensionsUsed[m],y=a.extensionsRequired||[];switch(g){case wt.KHR_MATERIALS_UNLIT:c[g]=new TC;break;case wt.KHR_DRACO_MESH_COMPRESSION:c[g]=new HC(a,this.dracoLoader);break;case wt.KHR_TEXTURE_TRANSFORM:c[g]=new GC;break;case wt.KHR_MESH_QUANTIZATION:c[g]=new VC;break;default:y.indexOf(g)>=0&&h[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}a.additionalFiles=s,f.setExtensions(c),f.setPlugins(h),f.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,s){n.parse(e,t,i,s)})}}function _C(){let l={};return{get:function(e){return l[e]},add:function(e,t){l[e]=t},remove:function(e){delete l[e]},removeAll:function(){l={}}}}const wt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class MC{constructor(e){this.parser=e,this.name=wt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const s=t.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new Ie(16777215);a.color!==void 0&&h.fromArray(a.color);const d=a.range!==void 0?a.range:0;switch(a.type){case"directional":c=new Rd(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Jc(h),c.distance=d;break;case"spot":c=new Ad(h),c.distance=d,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,c.angle=a.spot.outerConeAngle,c.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return c.position.set(0,0,0),c.decay=2,Js(c,a),a.intensity!==void 0&&(c.intensity=a.intensity),c.name=t.createUniqueName(a.name||"light_"+e),i=Promise.resolve(c),t.cache.add(n,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,i=n.json.nodes[e],s=(i.extensions&&i.extensions[this.name]||{}).light;return s===void 0?null:this._loadLight(s).then(function(a){return n._getNodeRef(t.cache,s,a)})}}class TC{constructor(){this.name=wt.KHR_MATERIALS_UNLIT}getMaterialType(){return xi}extendParams(e,t,n){const i=[];e.color=new Ie(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}s.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",s.baseColorTexture,mt))}return Promise.all(i)}}class EC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name].emissiveStrength;return i!==void 0&&(t.emissiveIntensity=i),Promise.resolve()}}class AC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const c=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new de(c,c)}return Promise.all(s)}}class RC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class LC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ie(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=i.extensions[this.name];return a.sheenColorFactor!==void 0&&t.sheenColor.fromArray(a.sheenColorFactor),a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,mt)),a.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class PC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class CC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const c=a.attenuationColor||[1,1,1];return t.attenuationColor=new Ie(c[0],c[1],c[2]),Promise.all(s)}}class DC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}}class OC{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ps:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],a=i.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const c=a.specularColorFactor||[1,1,1];return t.specularColor=new Ie(c[0],c[1],c[2]),a.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,mt)),Promise.all(s)}}class IC{constructor(e){this.parser=e,this.name=wt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class NC{constructor(e){this.parser=e,this.name=wt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],c=i.images[a.source];let h=n.textureLoader;if(c.uri){const d=n.options.manager.getHandler(c.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,a.source,h);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class kC{constructor(e){this.parser=e,this.name=wt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],c=i.images[a.source];let h=n.textureLoader;if(c.uri){const d=n.options.manager.getHandler(c.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,a.source,h);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class FC{constructor(e){this.name=wt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(c){const h=i.byteOffset||0,d=i.byteLength||0,f=i.count,m=i.byteStride,g=new Uint8Array(c,h,d);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(f,m,g,i.mode,i.filter).then(function(y){return y.buffer}):a.ready.then(function(){const y=new ArrayBuffer(f*m);return a.decodeGltfBuffer(new Uint8Array(y),f,m,g,i.mode,i.filter),y})})}return null}}class UC{constructor(e){this.name=wt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const i=t.meshes[n.mesh];for(const h of i.primitives)if(h.mode!==Ji.TRIANGLES&&h.mode!==Ji.TRIANGLE_STRIP&&h.mode!==Ji.TRIANGLE_FAN&&h.mode!==void 0)return null;const s=n.extensions[this.name].attributes,a=[],c={};for(const h in s)a.push(this.parser.getDependency("accessor",s[h]).then(d=>(c[h]=d,c[h])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(h=>{const d=h.pop(),f=d.isGroup?d.children:[d],m=h[0].count,g=[];for(const y of f){const S=new Ne,x=new O,w=new Ut,T=new O(1,1,1),_=new hd(y.geometry,y.material,m);for(let E=0;E<m;E++)c.TRANSLATION&&x.fromBufferAttribute(c.TRANSLATION,E),c.ROTATION&&w.fromBufferAttribute(c.ROTATION,E),c.SCALE&&T.fromBufferAttribute(c.SCALE,E),_.setMatrixAt(E,S.compose(x,w,T));for(const E in c)E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&y.geometry.setAttribute(E,c[E]);ct.prototype.copy.call(_,y),_.frustumCulled=!1,this.parser.assignFinalMaterial(_),g.push(_)}return d.isGroup?(d.clear(),d.add(...g),d):g[0]}))}}const gw="glTF",zC=1313821514,BC=5130562;class jC{constructor(e){this.name=wt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==gw)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,s=new DataView(e,12);let a=0;for(;a<i;){const c=s.getUint32(a,!0);a+=4;const h=s.getUint32(a,!0);if(a+=4,h===zC){const d=new Uint8Array(e,12+a,c);this.content=n.decode(d)}else if(h===BC){const d=12+a;this.body=e.slice(d,d+c)}a+=c}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class HC{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=wt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,c={},h={},d={};for(const f in a){const m=rg[f]||f.toLowerCase();c[m]=a[f]}for(const f in e.attributes){const m=rg[f]||f.toLowerCase();if(a[f]!==void 0){const g=n.accessors[e.attributes[f]],y=Rl[g.componentType];d[m]=y.name,h[m]=g.normalized===!0}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(m){i.decodeDracoFile(f,function(g){for(const y in g.attributes){const S=g.attributes[y],x=h[y];x!==void 0&&(S.normalized=x)}m(g)},c,d)})})}}class GC{constructor(){this.name=wt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class VC{constructor(){this.name=wt.KHR_MESH_QUANTIZATION}}class vw extends Tl{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let a=0;a!==i;a++)t[a]=n[s+a];return t}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=2*c,d=3*c,f=i-t,m=(n-t)/f,g=m*m,y=g*m,S=e*d,x=S-d,w=-2*y+3*g,T=y-g,_=1-w,E=T-g+m;for(let R=0;R!==c;R++){const P=a[x+R+c],C=a[x+R+h]*f,F=a[S+R+c],W=a[S+R]*f;s[R]=_*P+E*C+w*F+T*W}return s}}const WC=new Ut;class XC extends vw{interpolate_(e,t,n,i){const s=super.interpolate_(e,t,n,i);return WC.fromArray(s).normalize().toArray(s),s}}const Ji={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Rl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},yw={9728:Rt,9729:at,9984:bc,9985:bh,9986:zo,9987:cr},xw={33071:bn,33648:Uo,10497:vi},ig={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},rg={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ll={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qC={CUBICSPLINE:void 0,LINEAR:Da,STEP:Bo},YC="OPAQUE",QC="MASK",ZC="BLEND";function nu(l,e,t){for(const n in t.extensions)l[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Js(l,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(l.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function KC(l,e){if(l.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)l.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(l.morphTargetInfluences.length===t.length){l.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)l.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function JC(l){const e=l.extensions&&l.extensions[wt.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+bw(e.attributes):l.indices+":"+bw(l.attributes)+":"+l.mode,t}function bw(l){let e="";const t=Object.keys(l).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+l[t[n]]+";";return e}function sg(l){switch(l){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const $C=new Ne;class eD{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new _C,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,s=-1;typeof navigator<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||i&&s<98?this.textureLoader=new Ed(this.options.manager):this.textureLoader=new lS(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new hi(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(a){const c={scene:a[0][i.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:i.asset,parser:n,userData:{}};nu(s,c,i),Js(c,i),Promise.all(n._invokeAll(function(h){return h.afterRoot&&h.afterRoot(c)})).then(function(){e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const a=t[i].joints;for(let c=0,h=a.length;c<h;c++)e[a[c]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const a=e[i];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(n[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),s=(a,c)=>{const h=this.associations.get(a);h!=null&&this.associations.set(c,h);for(const[d,f]of a.children.entries())s(f,c.children[d])};return s(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,a){return n.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[wt.KHR_BINARY_GLTF].body);let i=this.json.additionalFiles,s=i?i.find(c=>c.name===t.uri):null;const a=this.options;return new Promise(function(c,h){n.load(Ka.resolveURL(t.uri,a.path),c,void 0,function(){h(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))},s)})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const a=ig[i.type],c=Rl[i.componentType],h=i.normalized===!0,d=new c(i.count*a);return Promise.resolve(new tt(d,a,h))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(a){const c=a[0],h=ig[i.type],d=Rl[i.componentType],f=d.BYTES_PER_ELEMENT,m=f*h,g=i.byteOffset||0,y=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,S=i.normalized===!0;let x,w;if(y&&y!==m){const T=Math.floor(g/y),_="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+T+":"+i.count;let E=t.cache.get(_);E||(x=new d(c,T*y,i.count*y/f),E=new sl(x,y/f),t.cache.add(_,E)),w=new ui(E,h,g%y/f,S)}else x=c===null?new d(i.count*h):new d(c,g,i.count*h),w=new tt(x,h,S);if(i.sparse!==void 0){const T=ig.SCALAR,_=Rl[i.sparse.indices.componentType],E=i.sparse.indices.byteOffset||0,R=i.sparse.values.byteOffset||0,P=new _(a[1],E,i.sparse.count*T),C=new d(a[2],R,i.sparse.count*h);c!==null&&(w=new tt(w.array.slice(),w.itemSize,w.normalized));for(let F=0,W=P.length;F<W;F++){const B=P[F];if(w.setX(B,C[F*h]),h>=2&&w.setY(B,C[F*h+1]),h>=3&&w.setZ(B,C[F*h+2]),h>=4&&w.setW(B,C[F*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e].source,s=t.images[i];let a=this.textureLoader;if(s.uri){const c=n.manager.getHandler(s.uri);c!==null&&(a=c)}return this.loadTextureImage(e,i,a)}loadTextureImage(e,t,n){const i=this,s=this.json,a=s.textures[e],c=s.images[t],h=(c.uri||c.bufferView)+":"+a.sampler;if(this.textureCache[h])return this.textureCache[h];const d=this.loadImageSource(t,n).then(function(f){f.flipY=!1,f.name=a.name||c.name||"";const m=(s.samplers||{})[a.sampler]||{};return f.magFilter=yw[m.magFilter]||at,f.minFilter=yw[m.minFilter]||cr,f.wrapS=xw[m.wrapS]||vi,f.wrapT=xw[m.wrapT]||vi,i.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[h]=d,d}loadImageSource(e,t){const n=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(m=>m.clone());const a=i.images[e],c=self.URL||self.webkitURL;let h=a.uri||"",d=!1;if(a.bufferView!==void 0)h=n.getDependency("bufferView",a.bufferView).then(function(m){d=!0;const g=new Blob([m],{type:a.mimeType});return h=c.createObjectURL(g),h});else{if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");if(i.additionalFiles){let m=h.split("\\").pop().split("/").pop(),g=i.additionalFiles.find(y=>m===y.name);g&&(h=Kb(g))}}const f=Promise.resolve(h).then(function(m){return new Promise(function(g,y){let S=g;t.isImageBitmapLoader===!0&&(S=function(x){const w=new zt(x);w.needsUpdate=!0,g(w)}),t.load(Ka.resolveURL(m,s.path),S,void 0,y)})}).then(function(m){var g;return d===!0&&c.revokeObjectURL(h),m.userData.mimeType=a.mimeType||((g=a.uri).search(/\.jpe?g($|\?)/i)>0||g.search(/^data\:image\/jpeg/)===0?"image/jpeg":g.search(/\.webp($|\?)/i)>0||g.search(/^data\:image\/webp/)===0?"image/webp":"image/png"),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),m});return this.sourceCache[e]=f,f}assignTexture(e,t,n,i){const s=this;return this.getDependency("texture",n.index).then(function(a){if(!a)return null;if(n.texCoord===void 0||n.texCoord==0||t==="aoMap"&&n.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[wt.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[wt.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const h=s.associations.get(a);a=s.extensions[wt.KHR_TEXTURE_TRANSFORM].extendTexture(a,c),s.associations.set(a,h)}}return i!==void 0&&(a.encoding=i),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let h=this.cache.get(c);h||(h=new pd,un.prototype.copy.call(h,n),h.color.copy(n.color),h.map=n.map,h.sizeAttenuation=!1,this.cache.add(c,h)),n=h}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let h=this.cache.get(c);h||(h=new Un,un.prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(c,h)),n=h}if(i||s||a){let c="ClonedMaterial:"+n.uuid+":";i&&(c+="derivative-tangents:"),s&&(c+="vertex-colors:"),a&&(c+="flat-shading:");let h=this.cache.get(c);h||(h=n.clone(),s&&(h.vertexColors=!0),a&&(h.flatShading=!0),i&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(c,h),this.associations.set(h,this.associations.get(n))),n=h}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return Bt}loadMaterial(e){const t=this,n=this.json,i=this.extensions,s=n.materials[e];let a;const c={},h=[];if((s.extensions||{})[wt.KHR_MATERIALS_UNLIT]){const f=i[wt.KHR_MATERIALS_UNLIT];a=f.getMaterialType(),h.push(f.extendParams(c,s,t))}else{const f=s.pbrMetallicRoughness||{};if(c.color=new Ie(1,1,1),c.opacity=1,Array.isArray(f.baseColorFactor)){const m=f.baseColorFactor;c.color.fromArray(m),c.opacity=m[3]}f.baseColorTexture!==void 0&&h.push(t.assignTexture(c,"map",f.baseColorTexture,mt)),c.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,c.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(c,"metalnessMap",f.metallicRoughnessTexture)),h.push(t.assignTexture(c,"roughnessMap",f.metallicRoughnessTexture))),a=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,c)})))}s.doubleSided===!0&&(c.side=Me);const d=s.alphaMode||YC;if(d===ZC?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,d===QC&&(c.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==xi&&(h.push(t.assignTexture(c,"normalMap",s.normalTexture)),c.normalScale=new de(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;c.normalScale.set(f,f)}return s.occlusionTexture!==void 0&&a!==xi&&(h.push(t.assignTexture(c,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==xi&&(c.emissive=new Ie().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&a!==xi&&h.push(t.assignTexture(c,"emissiveMap",s.emissiveTexture,mt)),Promise.all(h).then(function(){const f=new a(c);return s.name&&(f.name=s.name),Js(f,s),t.associations.set(f,{materials:e}),s.extensions&&nu(i,f,s),f})}createUniqueName(e){const t=gt.sanitizeNodeName(e||"");let n=t;for(let i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function s(c){return n[wt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(h){return Sw(h,c,t)})}const a=[];for(let c=0,h=e.length;c<h;c++){const d=e[c],f=JC(d),m=i[f];if(m)a.push(m.promise);else{let g;g=d.extensions&&d.extensions[wt.KHR_DRACO_MESH_COMPRESSION]?s(d):Sw(new $e,d,t),i[f]={primitive:d,promise:g},a.push(g)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,i=this.extensions,s=n.meshes[e],a=s.primitives,c=[];for(let d=0,f=a.length;d<f;d++){const m=a[d].material===void 0?((h=this.cache).DefaultMaterial===void 0&&(h.DefaultMaterial=new Bt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:se})),h.DefaultMaterial):this.getDependency("material",a[d].material);c.push(m)}var h;return c.push(t.loadGeometries(a)),Promise.all(c).then(function(d){const f=d.slice(0,d.length-1),m=d[d.length-1],g=[];for(let S=0,x=m.length;S<x;S++){const w=m[S],T=a[S];let _;const E=f[S];if(T.mode===Ji.TRIANGLES||T.mode===Ji.TRIANGLE_STRIP||T.mode===Ji.TRIANGLE_FAN||T.mode===void 0)_=s.isSkinnedMesh===!0?new cd(w,E):new et(w,E),_.isSkinnedMesh===!0&&_.normalizeSkinWeights(),T.mode===Ji.TRIANGLE_STRIP?_.geometry=Y0(_.geometry,Am):T.mode===Ji.TRIANGLE_FAN&&(_.geometry=Y0(_.geometry,Rh));else if(T.mode===Ji.LINES)_=new gr(w,E);else if(T.mode===Ji.LINE_STRIP)_=new kr(w,E);else if(T.mode===Ji.LINE_LOOP)_=new d0(w,E);else{if(T.mode!==Ji.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);_=new f0(w,E)}Object.keys(_.geometry.morphAttributes).length>0&&KC(_,s),_.name=t.createUniqueName(s.name||"mesh_"+e),Js(_,s),T.extensions&&nu(i,_,T),t.assignFinalMaterial(_),g.push(_)}for(let S=0,x=g.length;S<x;S++)t.associations.set(g[S],{meshes:e,primitives:S});if(g.length===1)return g[0];const y=new Yn;t.associations.set(y,{meshes:e});for(let S=0,x=g.length;S<x;S++)y.add(g[S]);return y})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return n.type==="perspective"?t=new Kt(fn.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new Hs(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Js(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,s=t.joints.length;i<s;i++)n.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(i){const s=i.pop(),a=i,c=[],h=[];for(let d=0,f=a.length;d<f;d++){const m=a[d];if(m){c.push(m);const g=new Ne;s!==null&&g.fromArray(s.array,16*d),h.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new hl(c,h)})}loadAnimation(e){const t=this.json.animations[e],n=[],i=[],s=[],a=[],c=[];for(let h=0,d=t.channels.length;h<d;h++){const f=t.channels[h],m=t.samplers[f.sampler],g=f.target,y=g.node,S=t.parameters!==void 0?t.parameters[m.input]:m.input,x=t.parameters!==void 0?t.parameters[m.output]:m.output;n.push(this.getDependency("node",y)),i.push(this.getDependency("accessor",S)),s.push(this.getDependency("accessor",x)),a.push(m),c.push(g)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(s),Promise.all(a),Promise.all(c)]).then(function(h){const d=h[0],f=h[1],m=h[2],g=h[3],y=h[4],S=[];for(let w=0,T=d.length;w<T;w++){const _=d[w],E=f[w],R=m[w],P=g[w],C=y[w];if(_===void 0)continue;let F;switch(_.updateMatrix(),Ll[C.path]){case Ll.weights:F=qa;break;case Ll.rotation:F=fs;break;default:F=Qa}const W=_.name?_.name:_.uuid,B=P.interpolation!==void 0?qC[P.interpolation]:Da,V=[];Ll[C.path]===Ll.weights?_.traverse(function(te){te.morphTargetInfluences&&V.push(te.name?te.name:te.uuid)}):V.push(W);let U=R.array;if(R.normalized){const te=sg(U.constructor),ue=new Float32Array(U.length);for(let ce=0,we=U.length;ce<we;ce++)ue[ce]=U[ce]*te;U=ue}for(let te=0,ue=V.length;te<ue;te++){const ce=new F(V[te]+"."+Ll[C.path],E.array,U,B);P.interpolation==="CUBICSPLINE"&&(ce.createInterpolant=function(we){return new(this instanceof fs?XC:vw)(this.times,this.values,this.getValueSize()/3,we)},ce.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),S.push(ce)}}const x=t.name?t.name:"animation_"+e;return new Za(x,void 0,S)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(s){const a=n._getNodeRef(n.meshCache,i.mesh,s);return i.weights!==void 0&&a.traverse(function(c){if(c.isMesh)for(let h=0,d=i.weights.length;h<d;h++)c.morphTargetInfluences[h]=i.weights[h]}),a})}loadNode(e){const t=this,n=this.json.nodes[e],i=t._loadNodeShallow(e),s=[],a=n.children||[];for(let h=0,d=a.length;h<d;h++)s.push(t.getDependency("node",a[h]));const c=n.skin===void 0?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([i,Promise.all(s),c]).then(function(h){const d=h[0],f=h[1],m=h[2];m!==null&&d.traverse(function(g){g.isSkinnedMesh&&g.bind(m,$C)});for(let g=0,y=f.length;g<y;g++)d.add(f[g]);return d})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],a=s.name?i.createUniqueName(s.name):"",c=[],h=i._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return h&&c.push(h),s.camera!==void 0&&c.push(i.getDependency("camera",s.camera).then(function(d){return i._getNodeRef(i.cameraCache,s.camera,d)})),i._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){c.push(d)}),this.nodeCache[e]=Promise.all(c).then(function(d){let f;if(f=s.isBone===!0?new ul:d.length>1?new Yn:d.length===1?d[0]:new ct,f!==d[0])for(let m=0,g=d.length;m<g;m++)f.add(d[m]);if(s.name&&(f.userData.name=s.name,f.name=a),Js(f,s),s.extensions&&nu(n,f,s),s.matrix!==void 0){const m=new Ne;m.fromArray(s.matrix),f.applyMatrix4(m)}else s.translation!==void 0&&f.position.fromArray(s.translation),s.rotation!==void 0&&f.quaternion.fromArray(s.rotation),s.scale!==void 0&&f.scale.fromArray(s.scale);return i.associations.has(f)||i.associations.set(f,{}),i.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,s=new Yn;n.name&&(s.name=i.createUniqueName(n.name)),Js(s,n),n.extensions&&nu(t,s,n);const a=n.nodes||[],c=[];for(let h=0,d=a.length;h<d;h++)c.push(i.getDependency("node",a[h]));return Promise.all(c).then(function(h){for(let d=0,f=h.length;d<f;d++)s.add(h[d]);return i.associations=(d=>{const f=new Map;for(const[m,g]of i.associations)(m instanceof un||m instanceof zt)&&f.set(m,g);return d.traverse(m=>{const g=i.associations.get(m);g!=null&&f.set(m,g)}),f})(s),s})}}function Sw(l,e,t){const n=e.attributes,i=[];function s(a,c){return t.getDependency("accessor",a).then(function(h){l.setAttribute(c,h)})}for(const a in n){const c=rg[a]||a.toLowerCase();c in l.attributes||i.push(s(n[a],c))}if(e.indices!==void 0&&!l.index){const a=t.getDependency("accessor",e.indices).then(function(c){l.setIndex(c)});i.push(a)}return Js(l,e),function(a,c,h){const d=c.attributes,f=new Ir;if(d.POSITION===void 0)return;{const y=h.json.accessors[d.POSITION],S=y.min,x=y.max;if(S===void 0||x===void 0)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(f.set(new O(S[0],S[1],S[2]),new O(x[0],x[1],x[2])),y.normalized){const w=sg(Rl[y.componentType]);f.min.multiplyScalar(w),f.max.multiplyScalar(w)}}const m=c.targets;if(m!==void 0){const y=new O,S=new O;for(let x=0,w=m.length;x<w;x++){const T=m[x];if(T.POSITION!==void 0){const _=h.json.accessors[T.POSITION],E=_.min,R=_.max;if(E!==void 0&&R!==void 0){if(S.setX(Math.max(Math.abs(E[0]),Math.abs(R[0]))),S.setY(Math.max(Math.abs(E[1]),Math.abs(R[1]))),S.setZ(Math.max(Math.abs(E[2]),Math.abs(R[2]))),_.normalized){const P=sg(Rl[_.componentType]);S.multiplyScalar(P)}y.max(S)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}f.expandByVector(y)}a.boundingBox=f;const g=new rs;f.getCenter(g.center),g.radius=f.min.distanceTo(f.max)/2,a.boundingSphere=g}(l,e,t),Promise.all(i).then(function(){return e.targets!==void 0?function(a,c,h){let d=!1,f=!1,m=!1;for(let x=0,w=c.length;x<w;x++){const T=c[x];if(T.POSITION!==void 0&&(d=!0),T.NORMAL!==void 0&&(f=!0),T.COLOR_0!==void 0&&(m=!0),d&&f&&m)break}if(!d&&!f&&!m)return Promise.resolve(a);const g=[],y=[],S=[];for(let x=0,w=c.length;x<w;x++){const T=c[x];if(d){const _=T.POSITION!==void 0?h.getDependency("accessor",T.POSITION):a.attributes.position;g.push(_)}if(f){const _=T.NORMAL!==void 0?h.getDependency("accessor",T.NORMAL):a.attributes.normal;y.push(_)}if(m){const _=T.COLOR_0!==void 0?h.getDependency("accessor",T.COLOR_0):a.attributes.color;S.push(_)}}return Promise.all([Promise.all(g),Promise.all(y),Promise.all(S)]).then(function(x){const w=x[0],T=x[1],_=x[2];return d&&(a.morphAttributes.position=w),f&&(a.morphAttributes.normal=T),m&&(a.morphAttributes.color=_),a.morphTargetsRelative=!0,a})}(l,e.targets,t):l})}var Pl,tD=function(){var l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var t,n=WebAssembly.validate(l)?"b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;t9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;h8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgohAaoclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;uzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:EPliuo97eue978Jjjjjbca9Rhidndnadcl9hmbdnaec98GglTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaiaeciGgvcdtgdVcbczad9R;8kbaiabalcdtfglad;8qbbdnavTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkalaiad;8qbbskdnaec98GgxTmbcbhvabhdinadczfglalpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgvax6mbkkaxae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabaxcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbhdabheinaeaepbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbaeczfheadclfgdav6mbkkdnaval9pmbaialciGgdcdtgeVcbc;abae9R;8kbaiabavcdtfgvae;8qbbdnadTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiae;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb":"b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:P8Yqdbk;3sezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfgocl4cifcd4hxdndndndnaoc9WGgmTmbcbhPcehsawcjdfhzalhHinaraH9Rax6midnaraHaxfgl9RcK6mbczhoinawcj;cbfaogifgoc9WfhOdndndndndnaHaic9WfgAco4fRbbaAci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOalRblalRbbgAco4gCaCciSgCE86bbaocGfalclfaCfgORbbaAcl4ciGgCaCciSgCE86bbaocVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbaoc7faOaCfgORbbaAciGgAaAciSgAE86bbaoctfaOaAfgARbbalRbegOco4gCaCciSgCE86bbaoc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc93faAaCfgARbbaOciGgOaOciSgOE86bbaoc94faAaOfgARbbalRbdgOco4gCaCciSgCE86bbaoc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc97faAaCfgARbbaOciGgOaOciSgOE86bbaoc98faAaOfgORbbalRbiglco4gAaAciSgAE86bbaoc99faOaAfgORbbalcl4ciGgAaAciSgAE86bbaoc9:faOaAfgORbbalcd4ciGgAaAciSgAE86bbaocufaOaAfgoRbbalciGglalciSglE86bbaoalfhlxdkaOalRbwalRbbgAcl4gCaCcsSgCE86bbaocGfalcwfaCfgORbbaAcsGgAaAcsSgAE86bbaocVfaOaAfgORbbalRbegAcl4gCaCcsSgCE86bbaoc7faOaCfgORbbaAcsGgAaAcsSgAE86bbaoctfaOaAfgORbbalRbdgAcl4gCaCcsSgCE86bbaoc91faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc4faOaAfgORbbalRbigAcl4gCaCcsSgCE86bbaoc93faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc94faOaAfgORbbalRblgAcl4gCaCcsSgCE86bbaoc95faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc96faOaAfgORbbalRbvgAcl4gCaCcsSgCE86bbaoc97faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc98faOaAfgORbbalRbogAcl4gCaCcsSgCE86bbaoc99faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc9:faOaAfgORbbalRbrglcl4gAaAcsSgAE86bbaocufaOaAfgoRbbalcsGglalcsSglE86bbaoalfhlxekaOal8Pbb83bbaOcwfalcwf8Pbb83bbalczfhlkdnaiam9pmbaiczfhoaral9RcL0mekkaiam6mialTmidnakTmbawaPfRbbhOcbhoazhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkkazcefhzaPcefgPad6hsalhHaPad9hmexvkkcbhlasceGmdxikalaxad2fhCdnakTmbcbhHcehsawcjdfhminaral9Rax6mialTmdalaxfhlawaHfRbbhOcbhoamhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkamcefhmaHcefgHad6hsaHad9hmbkaChlxikcbhocehsinaral9Rax6mdalTmealaxfhlaocefgoad6hsadao9hmbkaChlxdkcbhlasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqalmbkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;yzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2geTmbinababydbgdcwtcw91:Yadce91cjjj;8ifcjjj98G::NUdbabclfhbaecufgembkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaiczfhiaeczfheadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",i=WebAssembly.instantiate(s(n),{}).then(function(S){(t=S.instance).exports.__wasm_call_ctors()});function s(S){for(var x=new Uint8Array(S.length),w=0;w<S.length;++w){var T=S.charCodeAt(w);x[w]=T>96?T-97:T>64?T-39:T+4}var _=0;for(w=0;w<S.length;++w)x[_++]=x[w]<60?e[x[w]]:64*(x[w]-60)+x[++w];return x.buffer.slice(0,_)}function a(S,x,w,T,_,E){var R=t.exports.sbrk,P=w+3&-4,C=R(P*T),F=R(_.length),W=new Uint8Array(t.exports.memory.buffer);W.set(_,F);var B=S(C,w,T,F,_.length);if(B==0&&E&&E(C,P,T),x.set(W.subarray(C,C+w*T)),R(C-R(0)),B!=0)throw new Error("Malformed buffer data: "+B)}var c={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},d=[],f=0;function m(S){var x={object:new Worker(S),pending:0,requests:{}};return x.object.onmessage=function(w){var T=w.data;x.pending-=T.count,x.requests[T.id][T.action](T.value),delete x.requests[T.id]},x}function g(S){for(var x="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(s(n))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+a.toString()+y.toString(),w=new Blob([x],{type:"text/javascript"}),T=URL.createObjectURL(w),_=0;_<S;++_)d[_]=m(T);URL.revokeObjectURL(T)}function y(S){i.then(function(){var x=S.data;try{var w=new Uint8Array(x.count*x.size);a(t.exports[x.mode],w,x.count,x.size,x.source,t.exports[x.filter]),self.postMessage({id:x.id,count:x.count,action:"resolve",value:w},[w.buffer])}catch(T){self.postMessage({id:x.id,count:x.count,action:"reject",value:T})}})}return{ready:i,supported:!0,useWorkers:function(S){g(S)},decodeVertexBuffer:function(S,x,w,T,_){a(t.exports.meshopt_decodeVertexBuffer,S,x,w,T,t.exports[c[_]])},decodeIndexBuffer:function(S,x,w,T){a(t.exports.meshopt_decodeIndexBuffer,S,x,w,T)},decodeIndexSequence:function(S,x,w,T){a(t.exports.meshopt_decodeIndexSequence,S,x,w,T)},decodeGltfBuffer:function(S,x,w,T,_,E){a(t.exports[h[_]],S,x,w,T,t.exports[c[E]])},decodeGltfBufferAsync:function(S,x,w,T,_){return d.length>0?function(E,R,P,C,F){for(var W=d[0],B=1;B<d.length;++B)d[B].pending<W.pending&&(W=d[B]);return new Promise(function(V,U){var te=new Uint8Array(P),ue=f++;W.pending+=E,W.requests[ue]={resolve:V,reject:U},W.object.postMessage({id:ue,count:E,size:R,source:te,mode:C,filter:F},[te.buffer])})}(S,x,w,h[T],c[_]):i.then(function(){var E=new Uint8Array(S*x);return a(t.exports[h[T]],E,S,x,w,t.exports[c[_]]),E})}}}();class nD extends Jb{constructor(e){super(e),this.type=yi}parse(e){const t=function(h,d){switch(h){case 1:console.error("THREE.RGBELoader Read Error: "+(d||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(d||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(d||""));break;default:console.error("THREE.RGBELoader: Error: "+(d||""))}return-1},n=function(h,d,f){d=d||1024;let m=h.pos,g=-1,y=0,S="",x=String.fromCharCode.apply(null,new Uint16Array(h.subarray(m,m+128)));for(;0>(g=x.indexOf(`
`))&&y<d&&m<h.byteLength;)S+=x,y+=x.length,m+=128,x+=String.fromCharCode.apply(null,new Uint16Array(h.subarray(m,m+128)));return-1<g&&(f!==!1&&(h.pos+=y+g+1),S+x.slice(0,g))},i=function(h,d,f,m){const g=h[d+3],y=Math.pow(2,g-128)/255;f[m+0]=h[d+0]*y,f[m+1]=h[d+1]*y,f[m+2]=h[d+2]*y,f[m+3]=1},s=function(h,d,f,m){const g=h[d+3],y=Math.pow(2,g-128)/255;f[m+0]=$c.toHalfFloat(Math.min(h[d+0]*y,65504)),f[m+1]=$c.toHalfFloat(Math.min(h[d+1]*y,65504)),f[m+2]=$c.toHalfFloat(Math.min(h[d+2]*y,65504)),f[m+3]=$c.toHalfFloat(1)},a=new Uint8Array(e);a.pos=0;const c=function(h){const d=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,f=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,m=/^\s*FORMAT=(\S+)\s*$/,g=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,y={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let S,x;if(h.pos>=h.byteLength||!(S=n(h)))return t(1,"no header found");if(!(x=S.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(y.valid|=1,y.programtype=x[1],y.string+=S+`
`;S=n(h),S!==!1;)if(y.string+=S+`
`,S.charAt(0)!=="#"){if((x=S.match(d))&&(y.gamma=parseFloat(x[1])),(x=S.match(f))&&(y.exposure=parseFloat(x[1])),(x=S.match(m))&&(y.valid|=2,y.format=x[1]),(x=S.match(g))&&(y.valid|=4,y.height=parseInt(x[1],10),y.width=parseInt(x[2],10)),2&y.valid&&4&y.valid)break}else y.comments+=S+`
`;return 2&y.valid?4&y.valid?y:t(3,"missing image size specifier"):t(3,"missing format specifier")}(a);if(c!==-1){const h=c.width,d=c.height,f=function(m,g,y){const S=g;if(S<8||S>32767||m[0]!==2||m[1]!==2||128&m[2])return new Uint8Array(m);if(S!==(m[2]<<8|m[3]))return t(3,"wrong scanline width");const x=new Uint8Array(4*g*y);if(!x.length)return t(4,"unable to allocate buffer space");let w=0,T=0;const _=4*S,E=new Uint8Array(4),R=new Uint8Array(_);let P=y;for(;P>0&&T<m.byteLength;){if(T+4>m.byteLength)return t(1);if(E[0]=m[T++],E[1]=m[T++],E[2]=m[T++],E[3]=m[T++],E[0]!=2||E[1]!=2||(E[2]<<8|E[3])!=S)return t(3,"bad rgbe scanline format");let C,F=0;for(;F<_&&T<m.byteLength;){C=m[T++];const B=C>128;if(B&&(C-=128),C===0||F+C>_)return t(3,"bad scanline data");if(B){const V=m[T++];for(let U=0;U<C;U++)R[F++]=V}else R.set(m.subarray(T,T+C),F),F+=C,T+=C}const W=S;for(let B=0;B<W;B++){let V=0;x[w]=R[B+V],V+=S,x[w+1]=R[B+V],V+=S,x[w+2]=R[B+V],V+=S,x[w+3]=R[B+V],w+=4}P--}return x}(a.subarray(a.pos),h,d);if(f!==-1){let m,g,y;switch(this.type){case Ci:y=f.length/4;const S=new Float32Array(4*y);for(let w=0;w<y;w++)i(f,4*w,S,4*w);m=S,g=Ci;break;case yi:y=f.length/4;const x=new Uint16Array(4*y);for(let w=0;w<y;w++)s(f,4*w,x,4*w);m=x,g=yi;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:h,height:d,data:m,header:c.string,gamma:c.gamma,exposure:c.exposure,type:g}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,i,s){return super.load(e,function(a,c){switch(a.type){case Ci:case yi:a.encoding=ur,a.minFilter=at,a.magFilter=at,a.generateMipmaps=!1,a.flipY=!0}t&&t(a,c)},n,i,s)}}class Zn{static Clear(){this.caches.clear()}static RegistLoader(e){let t=new e;for(let n of t.extensions)this.loaders.set(n,t)}static Load(e){return new Promise((t,n)=>{let{url:i,file:s,ext:a}=function(d){let f="",m=null,g="";return typeof File<"u"&&d instanceof File?(f=d.name,g=Hd(f),m=d):typeof d=="object"?(f=d.mainFile.name,g=Hd(f),m=d):(f+=d,g=Hd(f)),{url:f,file:m,ext:g}}(e.url),c=function(d,f){let m=[d];for(let g in f)m.push(g+"="+f[g]);return m.join(",")}(i,e.settings),h=this.caches.get(c);if(h)t(h);else{const d=f=>{this.caches.set(c,f),t(f)};this.loaders.has(a)?this.loaders.get(a).load({...e,url:i,file:s,onLoad:d,onError:n}):n("missing loader for"+a)}})}}N(Zn,"loaders",new Map),N(Zn,"caches",new Map),Zn.RegistLoader(class extends Zs{constructor(){super(...arguments);N(this,"extensions",["atlas"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:s,settings:a}){(async()=>{let c=await function({url:d,file:f,onProgress:m}){return new Promise((g,y)=>new JS().load({url:d,file:f,onLoad:g,onError:y,onProgress:m}))}({url:e,file:t}).catch(s),h=await function({url:d,file:f,onProgress:m,settings:g}){return new Promise((y,S)=>new $S().load({url:d,file:f,onLoad:y,onError:S,onProgress:m,settings:g}))}({url:`${QS(e)}/${c.meta.image}`,file:t,onProgress:i,settings:a}).catch(s);n(new KS(c,h))})()}}),Zn.RegistLoader(class extends Zs{constructor(){super(...arguments);N(this,"extensions",["fbx"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:s}){new dC().load(e,n,i,s,t)}}),Zn.RegistLoader(class extends Zs{constructor(){super(...arguments);N(this,"extensions",["gltf","glb"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:s}){let a=new bC;a.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.5/");let c=new wC;c.setMeshoptDecoder(tD),c.setDRACOLoader(a),c.load(e,h=>n(Object.assign(h.scene,{animations:h.animations})),i,s,t)}}),Zn.RegistLoader(class extends Zs{constructor(){super(...arguments);N(this,"extensions",["hdr"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:s,settings:a}){new nD().load(e,c=>n(Object.assign(c,a)),i,s,t)}}),Zn.RegistLoader(JS),Zn.RegistLoader($S),Zn.RegistLoader(class extends Zs{constructor(){super(...arguments);N(this,"extensions",["mp3","wav","ogg"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:s}){new cS().load(e,n,i,s,t)}}),function(l){l[l.Destroyed=1]="Destroyed",l[l.OnLoadCalled=2]="OnLoadCalled",l[l.OnEnableCalled=4]="OnEnableCalled",l[l.StartCalled=8]="StartCalled",l[l.Deactivating=16]="Deactivating"}(Pl||(Pl={}));let iD=100;class Br extends L{constructor(t){super();N(this,"uuid",""+iD++);N(this,"name","");N(this,"_objFlags",0);this.name=t||this.name}__setFlag(t){this._objFlags|=t}__clearFlag(t){this._objFlags&=~t}__getFlag(t){return!!(this._objFlags&t)}get isValid(){return!(this._objFlags&Pl.Destroyed)}destroy(){return!this.__getFlag(Pl.Destroyed)&&(this.destroyImmediate(),!0)}destroyImmediate(){this._onPreDestroy&&this._onPreDestroy(),this.__setFlag(Pl.Destroyed)}}N(Br,"Flags",Pl);class Tt extends Br{constructor(){super(...arguments);N(this,"viewer");N(this,"node");N(this,"isComponent",!0);N(this,"_enabled",!0)}get enabled(){return this._enabled}set enabled(t){var n;this._enabled!==t&&(this._enabled=t,(n=this.viewer)==null||n.componentScheduler.enableComponent(this,t))}_onPreDestroy(){var t,n;this.unscheduleAll(),(t=this.viewer)==null||t.removeComponent(this.node,this),this._enabled&&((n=this.viewer)==null||n.componentScheduler.enableComponent(this,!1)),this.onDestroy&&this.__getFlag(Br.Flags.OnLoadCalled)&&this.onDestroy()}schedule(t,n,i=-1){var s;(s=this.viewer)==null||s.scheduler.schedule(this,t,n,i)}unshedule(t){var n;(n=this.viewer)==null||n.scheduler.unshedule(this,t)}unscheduleAll(){var t;(t=this.viewer)==null||t.scheduler.unscheduleAll(this)}}class Kn extends Tt{constructor(){super(...arguments);N(this,"isPlugin",!0)}}class Vd extends Kn{update(e){this.viewer.render(e)}}class ag{constructor(e){N(this,"_targets",[]);N(this,"_callback");this._callback=e}add(e){this._targets.push(e)}remove(e){let t=this._targets.indexOf(e);t!==-1&&this._targets.splice(t,1)}invoke(e){let t=this._callback;for(let n of this._targets)t(n,e)}}class rD extends ag{invoke(e){if(this._targets.length>0){let t=this._callback;for(let n of this._targets)t(n,e);this._targets.length=0}}}class sD{constructor(){N(this,"startInvoker",new rD(e=>e.start()));N(this,"updateInvoker",new ag((e,t)=>e.update(t)));N(this,"lastUpdateInvoker",new ag((e,t)=>e.lastUpdate(t)))}start(){this.startInvoker.invoke(0)}update(e){this.updateInvoker.invoke(e)}lastUpdate(e){this.lastUpdateInvoker.invoke(e)}enableComponent(e,t){t?e.__getFlag(Br.Flags.OnEnableCalled)===!1&&(e.__setFlag(Br.Flags.OnEnableCalled),e.onEnable&&e.onEnable(),e.start&&this.startInvoker.add(e),e.update&&this.updateInvoker.add(e),e.lastUpdate&&this.lastUpdateInvoker.add(e)):e.__getFlag(Br.Flags.OnEnableCalled)&&(e.__clearFlag(Br.Flags.OnEnableCalled),e.onDisable&&e.onDisable(),e.start&&this.startInvoker.remove(e),e.update&&this.updateInvoker.remove(e),e.lastUpdate&&this.lastUpdateInvoker.remove(e))}}class aD extends Br{constructor(){super(...arguments);N(this,"_scheduler",new J);N(this,"_componentScheduler",new sD)}get scheduler(){return this._scheduler}get componentScheduler(){return this._componentScheduler}update(t){this._scheduler.update(t),this._componentScheduler.start(),this._componentScheduler.update(t),this._componentScheduler.lastUpdate(t)}destroyNode(t){t.removeFromParent(),this.destroyComponents(t)}activeNode(t,n){t.visible=n,this.activeComponents(t)}destroyComponents(t){let n=this._getComponents(t);for(let i of n)i.destroy();t._components=[];for(let i of t.children)this.destroyComponents(i)}activeComponents(t){let n=t.visible;for(let i of this._getComponents(t))this._activeComponent(i,n);for(let i of t.children)this.activeComponents(i)}addComponent(t,n,i){let s=t instanceof Tt?t.node:t,a=typeof n=="function",c=this._findComponent(s,a?n:n.constructor);if(c===void 0){c=a?new n:n,c.node=s,c.viewer=this;let h=c._dependencies;if(h)for(let d of h)this.getComponent(s,d)==null&&this.addComponent(s,d);c.__getFlag(Br.Flags.OnLoadCalled)===!1&&(c.__setFlag(Br.Flags.OnLoadCalled),c.onLoad&&c.onLoad(i||{})),this._getComponents(s).push(c),this._activeComponent(c,!0),this.emit("component-changed",{action:"add",target:c})}return c}removeComponent(t,n){let i=this._getComponents(t),s=i.indexOf(n);return s!=-1&&(i.splice(s,1),this.emit("omponent-changed",{action:"remove",target:n})),this}getComponent(t,n){return this._findComponent(t,n)}getComponentsInChidren(t,n,i=[]){let s=this._getComponents(t);for(let a=s.length;a--;)s[a]instanceof n&&i.push(s[a]);for(let a of t.children)this.getComponentsInChidren(a,n,i);return i}_getComponents(t){let n=t._components;return n==null&&(n=t._components=[]),n}_findComponent(t,n){let i=this._getComponents(t);for(let s=i.length;s--;){let a=i[s];if(a instanceof n)return a}}_activeComponent(t,n){this._componentScheduler.enableComponent(t,n)}}var Si=Yt(622),oD=Yt(631);const{Tween:lD,getAll:cD,remove:uD,update:hD}=Yt(622),{TweenChain:dD}=Yt(631);class ww{static Tween(e){return new lD(e)}static Timeline(e){return new dD(e)}static KillTweensOf(e){let t=cD();for(let n of t)n._object===e&&uD(n)}static TweenUpdate(e){hD(e)}}class _w extends Kn{update(e){ww.TweenUpdate()}}const Jt=class Jt{constructor(e){N(this,"viewer");N(this,"_listeners",[]);N(this,"_mouseWheel",0);N(this,"_touches",[]);N(this,"_touchCount",0);N(this,"_pointerButton",-1);N(this,"_pointerPosition",new de);N(this,"_pointer",new de);N(this,"_keys",{});this.viewer=e}get pointerButton(){return this._pointerButton}get pointer(){return this._pointer}get pointerPosition(){return this._pointerPosition}get mouseWheel(){return this._mouseWheel}get touchCount(){return this._touchCount}get touches(){return this._touches}get keys(){return this._keys}addEventListeners(){const e=this.viewer.renderer.domElement;e.style.touchAction="none",this._addEventListener(window,"resize",()=>this._onResize()),this._addEventListener(e,"contextmenu",t=>t.preventDefault()),this._addEventListener(e,"pointerdown",t=>this._onPointerDown(t),{passive:!1}),this._addEventListener(e,"pointerup",t=>this._onPointerUp(t),{passive:!1}),this._addEventListener(e,"pointermove",t=>{this._onPointerMove(t)},{passive:!0}),this._addEventListener(e,"mousewheel",t=>this._onMouseWheel(t),{passive:!1}),this._addEventListener(e,"touchstart",t=>this._onTouchStart(t),{passive:!0}),this._addEventListener(e,"touchend",t=>this._onTouchEnd(t),{passive:!0}),this._addEventListener(e,"touchmove",t=>this._onTouchMove(t),{passive:!0}),this._addEventListener(e,"keydown",t=>this._onKeyDown(t),{passive:!0}),this._addEventListener(e,"keypress",t=>this._onKeyPress(t),{passive:!0}),this._addEventListener(e,"keyup",t=>this._onKeyUp(t),{passive:!0}),this._onResize()}_onResize(){this.viewer.resize(window.innerWidth,window.innerHeight),this.viewer.emit(Jt.RESIZE,window.innerWidth,window.innerHeight)}_onPointerDown(e){e.preventDefault(),this._pointerButton=e.button,this.viewer.emit(Jt.POINTER_DOWN,e)}_onPointerUp(e){e.preventDefault(),this._pointerButton=-1,this.viewer.emit(Jt.POINTER_UP,e)}_onPointerMove(e){this._pointer.x=e.pageX/window.innerWidth*2-1,this._pointer.y=1-e.pageY/window.innerHeight*2,this._pointerPosition.set(e.pageX,e.pageY),this.viewer.emit(Jt.POINTER_MOVE,e)}_onMouseWheel(e){e.preventDefault(),this._mouseWheel=e.deltaY,this.viewer.emit(Jt.MOUSE_WHEEL,e)}_onTouchStart(e){this.viewer.emit(Jt.TOUCH_START,e)}_onTouchEnd(e){this.viewer.emit(Jt.TOUCH_END,e)}_onTouchMove(e){let t=e.touches,n=this._touches;for(let i=t.length;i--;){n[i]==null&&(n[i]={id:-1,position:new de});const s=t[i];n[i].id=s.identifier,n[i].position.set(s.pageX,s.pageY)}this._touchCount=t.length,this.viewer.emit(Jt.TOUCH_MOVE,e)}_onKeyDown(e){this._keys[e.key]=!0,this.viewer.emit(Jt.KEYDOWN,e)}_onKeyPress(e){this._keys[e.key]=!0,this.viewer.emit(Jt.KEYPRESS,e)}_onKeyUp(e){this._keys[e.key]=!1,this.viewer.emit(Jt.KEYUP,e)}_addEventListener(e,t,n,i){e.addEventListener?e.addEventListener(t,n):e.on&&e.on(t,n,e),this._listeners.push({target:e,type:t,callback:n})}removeAllListeners(){for(let{target:e,type:t,callback:n}of this._listeners)e.removeEventListener?e.removeEventListener(t,n):e.off&&e.off(t,n,e);this._listeners=[]}};N(Jt,"MOUSE_WHEEL","mousewheel"),N(Jt,"TOUCH_START","touchstart"),N(Jt,"TOUCH_END","touchend"),N(Jt,"TOUCH_MOVE","touchmove"),N(Jt,"POINTER_DOWN","pointerdown"),N(Jt,"POINTER_UP","pointerup"),N(Jt,"POINTER_MOVE","pointermove"),N(Jt,"KEYDOWN","keydown"),N(Jt,"KEYPRESS","keypress"),N(Jt,"KEYUP","keyup"),N(Jt,"RESIZE","resize");let Dn=Jt;dt.matrix=`
mat4 getInstanceMatrix(vec3 p, vec4 q, vec3 s) {
    mat4 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    float sx = s.x;
    float sy = s.y;
    float sz = s.z;
    m[0][0] = (1. - (yy + zz)) * sx;
    m[0][1] = (xy + wz) * sx;
    m[0][2] = (xz - wy) * sx;
    m[0][3] = 0.;
    m[1][0] = (xy - wz) * sy;
    m[1][1] = (1. - (xx + zz)) * sy;
    m[1][2] = (yz + wx) * sy;
    m[1][3] = 0.;
    m[2][0] = (xz + wy) * sz;
    m[2][1] = (yz - wx) * sz;
    m[2][2] = (1. - (xx + yy)) * sz;
    m[2][3] = 0.;
    m[3][0] = p.x;
    m[3][1] = p.y;
    m[3][2] = p.z;
    m[3][3] = 1.;
    return m;
}
mat3 getInstanceRotationMatrix(vec4 q) {
    mat3 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    m[0][0] = (1. - (yy + zz));
    m[0][1] = (xy + wz);
    m[0][2] = (xz - wy);
    m[1][0] = (xy - wz);
    m[1][1] = (1. - (xx + zz));
    m[1][2] = (yz + wx);
    m[2][0] = (xz + wy);
    m[2][1] = (yz - wx);
    m[2][2] = (1. - (xx + yy));
    return m;
}
`;let pD=new O,fD=new O,mD=new de;class gD extends aD{constructor({canvas:t,shadows:n=!1,linear:i=!0,outputEncoding:s=mt,toneMapping:a=em,toneMappingExposure:c=1,camera:h={fov:45,near:1,far:1e3},user:d={},...f}){super();N(this,"_time",0);N(this,"_running",!1);N(this,"_renderer");N(this,"_scene");N(this,"_camera");N(this,"_viewport",{width:1,height:1,factor:1});N(this,"_states",[]);N(this,"_input",new Dn(this));N(this,"_user",null);N(this,"_environment",null);N(this,"_background",null);this._user=d,this._scene=new ja,this._camera=Mt(new Kt(h.fov,h.aspect||window.innerWidth/window.innerHeight,h.near,h.far),h),this._renderer=new nd({canvas:t,...f}),this._renderer.setPixelRatio(this.dpr),this._renderer.outputEncoding=s,this._renderer.toneMapping=a,this._renderer.toneMappingExposure=c,this._renderer.shadowMap.enabled=!!n,this._renderer.shadowMap.type=typeof n=="boolean"?D:n,this._renderer.info.autoReset=!1,this._input.addEventListeners(),this._addDefaultPlugins(),this._printInfo(i),t||document.body.appendChild(this._renderer.domElement),this.start()}get environment(){return this._environment}get background(){return this._background}get input(){return this._input}get time(){return this._time}get renderer(){return this._renderer}get scene(){return this._scene}get camera(){return this._camera}get dpr(){return Math.min(2,window.devicePixelRatio)}get viewport(){return this._viewport}get size(){return this._renderer.getSize(mD)}get user(){return this._user}_printInfo(t){Pn.enabled=t;const n=this._renderer.getContext();["Welcome to xviewer.js","Three Version: "+ie,"WebGL Version: "+n.getParameter(n.VERSION),"ColorSpace: "+Pn.workingColorSpace].join(`
`)}_onPreDestroy(){Zn.Clear(),this._user={},this._input.removeAllListeners(),this._renderer.dispose(),this.destroyComponents(this._scene),this.stop()}async load({replace:t,castShadow:n,receiveShadow:i,parent:s=this._scene,...a}){let c=await Zn.Load(a);return t&&(s.clear(),this.emit("node-changed",{action:"clear",target:s})),(n||i)&&c.traverse(h=>{h instanceof et&&(h.castShadow=!!n,h.receiveShadow=!!i)}),s.add(c),this.emit("node-changed",{action:"add",target:c}),c}async setEnvironment(t){let n=t?t.url:null;this._environment!==n&&(this._environment=n,this.emit("env-changed",n),this._scene.environment=n?await Zn.Load({...t,settings:Object.assign({mapping:Is},t.settings)}):null),t&&t.noBackground||this.setBackground(t)}async setBackground(t){let n=t?t.color||t.url:null;this._background!==n&&(this._background=n,this.emit("bg-changed",n),this._scene.background=n?t.color||await Zn.Load({...t,settings:Object.assign({mapping:Is},t.settings)}):null)}pushScene(t=new ja){return this._states.push({scene:this._scene,camera:this._camera}),this._scene=t||this._scene,this}popScene(){let t=this._states.pop();return t&&(this._scene=t.scene,this._camera=t.camera),this}addNode(t,n={},i=this._scene){let s,a;if(typeof t=="function"){let c=n&&n.args,h=c?new t(...c):new t;h.isCamera&&n.makeDefault&&(h.manual=h.aspect!==this.camera.aspect,this._camera=h),h.isObject3D?s=i.addObject(Mt(h,n)):(s=i.addObject(h.create&&h.create(n)||new ct),a=this.addComponent(s,h,n))}else s=i.addObject(Mt(t,n));return this.emit("node-changed",{action:"add",target:s}),a||s}addPlugin(t,n){return this.addComponent(this._scene,t,n)}removePlugin(t){return this.removeComponent(this._scene,t)}getPlugin(t){return this.getComponent(this._scene,t)}_addDefaultPlugins(){this.addPlugin(Vd),this.addPlugin(_w)}resize(t,n){let i=this._camera;if(i.isOrthographicCamera)this._viewport={width:t/i.zoom,height:n/i.zoom,factor:1};else if(i.isPerspectiveCamera){i.manual||(i.aspect=t/n,i.updateProjectionMatrix());let s=i.getWorldPosition(fD).distanceTo(pD),a=2*Math.tan(fn.degToRad(.5*i.fov))*s,c=a*t/n;this._viewport={width:c,height:a,factor:t/c}}this._renderer.setSize(t,n)}start(){if(this._running==0){this._running=!0;let t=n=>{let i=this._time!==0?n-this._time:0;return this._time=n,i};this._renderer.setAnimationLoop(n=>this.update(t(.001*n)))}return this}render(t){this._renderer.info.reset(),this._renderer.render(this._scene,this._camera)}stop(){return this._time=0,this._running=!1,this._renderer.setAnimationLoop(null),this}}function It(l={}){return function(e,t){e.hasOwnProperty("__properties")==0&&(e.__properties=Object.assign({},e.__proto__.__properties)),e.__properties[t]=l}}function jr(...l){return function(e){let t=e.prototype;t._dependencies==null&&(t._dependencies=[]),t._dependencies.push(...l)}}let{PI:so,cos:Mw,sin:iu,pow:$s,sqrt:Wd}=Math;function Tw(l){return 1-og(1-l)}function og(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375}var lg;(function(l){l[l.Linear=0]="Linear",l[l.QuadraticIn=1]="QuadraticIn",l[l.QuadraticOut=2]="QuadraticOut",l[l.QuadraticInOut=3]="QuadraticInOut",l[l.CubicIn=4]="CubicIn",l[l.CubicOut=5]="CubicOut",l[l.CubicInOut=6]="CubicInOut",l[l.QuarticIn=7]="QuarticIn",l[l.QuarticOut=8]="QuarticOut",l[l.QuarticInOut=9]="QuarticInOut",l[l.QuinticIn=10]="QuinticIn",l[l.QuinticOut=11]="QuinticOut",l[l.QuinticInOut=12]="QuinticInOut",l[l.SinusoidalIn=13]="SinusoidalIn",l[l.SinusoidalOut=14]="SinusoidalOut",l[l.SinusoidalInOut=15]="SinusoidalInOut",l[l.ExponentialIn=16]="ExponentialIn",l[l.ExponentialOut=17]="ExponentialOut",l[l.ExponentialInOut=18]="ExponentialInOut",l[l.CircularIn=19]="CircularIn",l[l.CircularOut=20]="CircularOut",l[l.CircularInOut=21]="CircularInOut",l[l.ElasticIn=22]="ElasticIn",l[l.ElasticOut=23]="ElasticOut",l[l.ElasticInOut=24]="ElasticInOut",l[l.BackIn=25]="BackIn",l[l.BackOut=26]="BackOut",l[l.BackInOut=27]="BackInOut",l[l.BounceIn=28]="BounceIn",l[l.BounceOut=29]="BounceOut",l[l.BounceInOut=30]="BounceInOut"})(lg||(lg={}));const vD=[function(l){return l},function(l){return l*l},function(l){return l*(2-l)},function(l){return(l*=2)<1?.5*l*l:-.5*(--l*(l-2)-1)},function(l){return l*l*l},function(l){return--l*l*l+1},function(l){return(l*=2)<1?.5*l*l*l:.5*((l-=2)*l*l+2)},function(l){return l*l*l*l},function(l){return 1- --l*l*l*l},function(l){return(l*=2)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2)},function(l){return l*l*l*l*l},function(l){return--l*l*l*l*l+1},function(l){return(l*=2)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2)},function(l){return 1-Mw(l*so/2)},function(l){return iu(l*so/2)},function(l){return .5*(1-Mw(so*l))},function(l){return l===0?0:$s(1024,l-1)},function(l){return l===1?1:1-$s(2,-10*l)},function(l){return l===0?0:l===1?1:(l*=2)<1?.5*$s(1024,l-1):.5*(2-$s(2,-10*(l-1)))},function(l){return 1-Wd(1-l*l)},function(l){return Wd(1- --l*l)},function(l){return(l*=2)<1?-.5*(Wd(1-l*l)-1):.5*(Wd(1-(l-=2)*l)+1)},function(l){return l===0?0:l===1?1:-$s(2,10*(l-1))*iu(5*(l-1.1)*so)},function(l){return l===0?0:l===1?1:$s(2,-10*l)*iu(5*(l-.1)*so)+1},function(l){return l===0?0:l===1?1:(l*=2)<1?-.5*$s(2,10*(l-1))*iu(5*(l-1.1)*so):.5*$s(2,-10*(l-1))*iu(5*(l-1.1)*so)+1},function(l){var e=1.70158;return l*l*((e+1)*l-e)},function(l){var e=1.70158;return--l*l*((e+1)*l+e)+1},function(l){var e=2.5949095;return(l*=2)<1?l*l*((e+1)*l-e)*.5:.5*((l-=2)*l*((e+1)*l+e)+2)},Tw,og,function(l){return l<.5?.5*Tw(2*l):.5*og(2*l-1)+.5}];class yD{constructor(){N(this,"style",lg.QuadraticInOut);N(this,"time",4)}}const{clamp:xD,lerp:cg}=fn;class ug extends Tt{constructor(){super(...arguments);N(this,"_vcam",null);N(this,"_vcamSolo",null);N(this,"_vcams",[]);N(this,"_lerpTime",0);N(this,"brainBlend",new yD)}get vcam(){return this._vcam}get vcams(){return this._vcams}update(t){let n=this.getActiveCamera();if(n!=null){for(let i of this._vcams)i.enabled=i===n;if(this._lerpTime<this.brainBlend.time){this._lerpTime+=t;let i=xD(this._lerpTime/this.brainBlend.time,0,1),s=vD[this.brainBlend.style];s&&(i=s(i)),this._lerpToMainCamera(n,i)}else this._lerpToMainCamera(n,1)}}activeCamera(t,n=4){this._vcamSolo!==t&&(this._vcamSolo=t,this._lerpTime=0,this.brainBlend.time=n)}addCamera(t){this._vcams.indexOf(t)===-1&&this._vcams.push(t)}removeCamera(t){let n=this._vcams.indexOf(t);n!==-1&&this._vcams.splice(n,1)}getActiveCamera(){return this._vcamSolo||this._vcams.filter(t=>t.enabled).sort((t,n)=>n.priority-t.priority)[0]}_lerpToMainCamera(t,n){let i=this.viewer.camera,s=t,a=s.lens,c=i.fov,h=i.near,d=i.far;i.position.lerp(s.finalPosition,n),i.quaternion.slerp(s.finalRotation,n),i.fov=cg(c,a.fov,n),i.near=cg(h,a.near,n),i.far=cg(d,a.far,n),c==a.fov&&h==a.near&&d==a.far||i.updateProjectionMatrix()}}const{clamp:ao}=fn,{min:bD,max:ru,acos:SD,abs:wi}=Math,su=1e-6,wD=Math.log(.01);function Ew(l,e,t,n){let i=-wD/t;return l+(e-l)*(1-Math.exp(-i*n))}function Cl(l,e,t,n){let i=1-bD(n,t)/t,s=i*i;return l+(e-l)*(1-s*s)}function _D(l,e,t,n,i){return l.copy(e).slerp(t,Ew(0,1,n,i))}function MD(l,e,t,n,i){return l.copy(e).slerp(t,Cl(0,1,n,i))}function hg(l,e,t,n,i,s){l._velocity===void 0&&(l._velocity=0);let a=2/(n=Math.max(1e-4,n)),c=a*s,h=1/(1+c+.48*c*c+.235*c*c*c),d=e-t,f=t,m=i*n;d=ao(d,-m,m),t=e-d;let g=(l._velocity+a*d)*s;l._velocity=(l._velocity-a*g)*h;let y=t+(d+g)*h;return f-e>0==y>f&&(y=f,l._velocity=(y-f)/s),y}function TD(l,e,t,n,i=l){return i.copy(l).slerp(e,hg(i,0,1,t,1/0,n))}function ED(l,e,t,n,i=l){return i.copy(l).lerp(e,hg(i,0,1,t,1/0,n))}let Aw=new O;function AD(l,e,t,n,i=l){if(n<=0)return i.copy(e);let s=Aw.copy(e).sub(l);return s.lengthSq()<su?i.copy(e):i.copy(l).add(s.multiplyScalar(ao(t*n,0,1)))}function RD(l,e,t,n,i=l){let s=Aw.copy(e).sub(l),a=s.length(),c=n*t;if(a>c){if(c>0){let h=s.multiplyScalar(1/a);return i.copy(l).add(h)}return i.copy(l)}return i.copy(e)}function Rw(l,e,t=su){return wi(l.x-e.x)<=t*ru(1,wi(l.x),wi(e.x))&&wi(l.y-e.y)<=t*ru(1,wi(l.y),wi(e.y))&&wi(l.z-e.z)<=t*ru(1,wi(l.z),wi(e.z))&&wi(l.w-e.w)<=t*ru(1,wi(l.w),wi(e.w))}function LD(l,e,t,n){return n<=0||Rw(l,e)?e:l.slerp(e,ao(n*t,0,1))}function PD(l,e,t,n,i=l){if(n<=0||Rw(l,e))return i.copy(e);let s=ao(n*t,0,1),a=ru(function(c,h){let d=c.x*h.x+c.y*h.y+c.z*h.z+c.w*h.w;return SD(2*d*d-1)}(l,e),su);return i.copy(l).slerp(e,ao(s/a,0,1))}function CD(l,e,t,n){if(n<=0)return e;let i=e-l;return wi(i)<su?e:l+i*ao(n*t,0,1)}function DD(l,e,t,n){let i=e-l;if(wi(i)<su)return e;let s=n*t;return l+ao(i,-s,s)}var Hr;(function(l){l[l.FREE=0]="FREE",l[l.TRANSLATE=1]="TRANSLATE",l[l.LOCK=2]="LOCK"})(Hr||(Hr={}));class Lw{constructor(){N(this,"mode",Hr.FREE);N(this,"forbidX",!1);N(this,"forbidY",!1);N(this,"forbidZ",!1);N(this,"forbidPanX",!1);N(this,"forbidPanY",!1);N(this,"rotateSpeed",2);N(this,"rotateSmoothing",.5);N(this,"panSpeed",2);N(this,"panSmoothing",.5);N(this,"phiMin",.001);N(this,"phiMax",Math.PI-.001);N(this,"thetaMin",-1/0);N(this,"thetaMax",1/0);N(this,"distanceMin",.001);N(this,"distanceMax",1/0);N(this,"rotateTouchID",0)}}class Pw{constructor(){N(this,"trackedObjectOffset",new O)}}class Cw{constructor(){N(this,"fov",45);N(this,"near",.1);N(this,"far",1e3)}}class Dw extends Tt{constructor(){super(...arguments);N(this,"_finalPosition",new O);N(this,"_finalRotation",new Ut);N(this,"priority",10);N(this,"lookAt",null);N(this,"follow",null);N(this,"lens",new Cw);N(this,"aim",new Pw);N(this,"correctPosition",new O);N(this,"correctRotation",new Ut);N(this,"lookaheadPosition",new O);N(this,"brain")}get finalPosition(){return this._finalPosition.copy(this.node.position).add(this.correctPosition)}get finalRotation(){return this._finalRotation.copy(this.node.quaternion).multiply(this.correctRotation)}onLoad({lookAt:t,fov:n,near:i,far:s,...a}){this.node.isCamera=!0,this.lookAt=t,Mt(this.lens,{fov:n,near:i,far:s}),Mt(this.node,a),this.brain=this.viewer.getComponent(this.viewer.camera,ug),this.brain.addCamera(this)}onDestroy(){this.brain.removeCamera(this)}update(t){this.lookAt&&this.node.lookAt(this.lookAt.position)}}const{clamp:au,degToRad:OD}=fn,{abs:vs,tan:ID}=Math;let xr=new de,Xd=new de,ND=new de,kD=new de,qd=new de,Gr=new O,$i=new O,Ow=new O,Iw=new O,Nw=new O,oo=new Ut,dg=new Ut,_i=new bS,FD=new Xn;class kw extends Dw{constructor(){super(...arguments);N(this,"_button",-1);N(this,"_touchID",-1);N(this,"_distanceDelta",0);N(this,"_preLoc0",new de);N(this,"_preLoc1",new de);N(this,"_rotateDelta",new de);N(this,"_panDelta",new de);N(this,"freelook",new Lw)}onLoad({forbidX:t=!1,forbidY:n=!1,forbidZ:i=!1,forbidPanX:s=!1,forbidPanY:a=!1,mode:c=Hr.FREE,...h}){super.onLoad(h),Mt(this.freelook,{forbidX:t,forbidY:n,forbidZ:i,forbidPanX:s,forbidPanY:a,mode:c})}onEnable(){this.viewer.on(Dn.POINTER_DOWN,this._onPointerDown,this),this.viewer.on(Dn.POINTER_UP,this._onPointerUp,this),this.viewer.on(Dn.POINTER_MOVE,this._onPointerMove,this),this.viewer.on(Dn.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.on(Dn.TOUCH_START,this._onTouchStart,this),this.viewer.on(Dn.TOUCH_MOVE,this._onTouchMove,this),this.reset()}onDisable(){this.viewer.off(Dn.POINTER_DOWN,this._onPointerDown,this),this.viewer.off(Dn.POINTER_UP,this._onPointerUp,this),this.viewer.off(Dn.POINTER_MOVE,this._onPointerMove,this),this.viewer.off(Dn.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.off(Dn.TOUCH_START,this._onTouchStart,this),this.viewer.off(Dn.TOUCH_MOVE,this._onTouchMove,this)}reset(){this._button=-1,this._touchID=-1,this._rotateDelta.set(0,0),this._panDelta.set(0,0),this._distanceDelta=0}_onPointerDown(t){this._button=t.button,this._preLoc0.set(t.pageX,t.pageY)}_onPointerUp(t){this._button=-1}_onPointerMove(t){switch(xr.set(t.pageX,t.pageY),this._button){case 0:this._rotateDelta.add(this._calculateRotateDelta(qd,this._preLoc0,xr));break;case 1:this._panDelta.add(this._calculatePanDelta(qd,this._preLoc0,xr))}this._preLoc0.copy(xr)}_onMouseWheel(t){if(this.lookAt){let n=Gr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset).distanceTo(this.node.position),i=n+this._distanceDelta;t.deltaY>0?i*=this._calculateDistanceScale(1/.85):t.deltaY<0&&(i*=this._calculateDistanceScale(.85)),this._distanceDelta=i-n}}_onTouchStart(t){if(this._button>-1)return;let n=t.touches,i=this.freelook.rotateTouchID;n.length>i+1?(this._preLoc0.set(n[i].pageX,n[i].pageY),this._preLoc1.set(n[i+1].pageX,n[i+1].pageY)):n.length>i&&(this._touchID=n[i].identifier,this._preLoc0.set(n[i].pageX,n[i].pageY))}_onTouchMove(t){if(this._button>-1)return;let n=t.touches,i=this.freelook.rotateTouchID;if(n.length>i+1){if(xr.set(n[i].pageX,n[i].pageY),Xd.set(n[i+1].pageX,n[i+1].pageY),this.lookAt){let s=Gr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset).distanceTo(this.node.position),a=(s+this._distanceDelta)*this._calculateDistanceScale(this._preLoc0.distanceTo(this._preLoc1)/xr.distanceTo(Xd));this._distanceDelta=a-s}this._panDelta.add(this._calculatePanDelta(qd,kD.copy(this._preLoc0).add(this._preLoc1).multiplyScalar(.5),ND.copy(xr).add(Xd).multiplyScalar(.5))),this._preLoc0.copy(xr),this._preLoc1.copy(Xd)}else n.length>i&&this._touchID===n[i].identifier&&(xr.set(n[i].pageX,n[i].pageY),this._rotateDelta.add(this._calculateRotateDelta(qd,this._preLoc0,xr)),this._preLoc0.copy(xr))}_calculateDistanceScale(t){return this.freelook.forbidZ&&(t=1),t}_calculateRotateDelta(t,n,i){let s=this.freelook,a=this.viewer.renderer.domElement;return t.copy(i).sub(n).multiplyScalar(2*s.rotateSpeed*Math.PI/a.height),t.y=-t.y,s.forbidX&&(t.x=0),s.forbidY&&(t.y=0),t}_calculatePanDelta(t,n,i){let s=this.freelook,a=this.viewer.renderer.domElement;return t.copy(i).sub(n).multiplyScalar(s.panSpeed/a.height),s.forbidPanX&&(t.x=0),s.forbidPanY&&(t.y=0),t}update(t){let n=this.freelook;if(this.lookAt){switch(Gr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset),n.mode){case Hr.FREE:if(vs(this._rotateDelta.x)+vs(this._rotateDelta.y)+vs(this._distanceDelta)>.001){oo.setFromUnitVectors(this.node.up,ct.DEFAULT_UP),$i.copy(this.node.position).sub(Gr),$i.applyQuaternion(oo),_i.setFromVector3($i);let i=Cl(1,0,this.freelook.rotateSmoothing,t);this._rotateDelta.x=_i.theta-au(_i.theta-this._rotateDelta.x,n.thetaMin,n.thetaMax),_i.theta=_i.theta-this._rotateDelta.x*(1-i),this._rotateDelta.y=au(_i.phi+this._rotateDelta.y,n.phiMin,n.phiMax)-_i.phi,_i.phi=au(_i.phi+this._rotateDelta.y*(1-i),.001,Math.PI-.001),this._distanceDelta=au(_i.radius+this._distanceDelta,n.distanceMin,n.distanceMax)-_i.radius,_i.radius=_i.radius+this._distanceDelta*(1-i),this._rotateDelta.multiplyScalar(i),this._distanceDelta*=i,$i.setFromSpherical(_i),$i.applyQuaternion(oo.invert()),this.node.position.copy($i.add(Gr))}break;case Hr.TRANSLATE:if(vs(this._distanceDelta)>.001){$i.copy(this.node.position).sub(this.lookAt.position);let i=Cl(1,0,this.freelook.rotateSmoothing,t),s=$i.length();this._distanceDelta=au(s+this._distanceDelta,n.distanceMin,n.distanceMax)-s;let a=s+this._distanceDelta*(1-i);this._distanceDelta*=i;let c=$i.normalize().multiplyScalar(a).add(this.lookAt.position);Ow.copy(c).sub(this.node.position),this.aim.trackedObjectOffset.add(Ow),this.node.position.copy(c),Gr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset)}break;case Hr.LOCK:if(vs(this._rotateDelta.x)+vs(this._rotateDelta.y)+vs(this._distanceDelta)>.001){let i=Cl(1,0,this.freelook.rotateSmoothing,t);oo.setFromEuler(FD.set(-this._rotateDelta.y*(1-i),this._rotateDelta.x*(1-i),0)),oo.multiply(this.node.quaternion),dg.copy(this.node.quaternion).invert(),dg.multiply(oo),this.node.quaternion.multiply(dg.multiply(oo)),this._rotateDelta.multiplyScalar(i)}}switch(n.mode){case Hr.FREE:case Hr.TRANSLATE:if(vs(this._panDelta.x)+vs(this._panDelta.y)>.001){$i.copy(this.node.position).sub(Gr),Iw.setFromMatrixColumn(this.node.matrix,0),Nw.setFromMatrixColumn(this.node.matrix,1);let i=2*$i.length()*ID(OD(.5*this.lens.fov)),s=Cl(1,0,this.freelook.panSmoothing,t),a=this.aim.trackedObjectOffset;a.sub(Iw.multiplyScalar(this._panDelta.x*i*(1-s))),a.add(Nw.multiplyScalar(this._panDelta.y*i*(1-s))),this._panDelta.multiplyScalar(s),Gr.copy(this.lookAt.position).add(a),this.node.position.copy($i.add(Gr))}this.node.lookAt(Gr)}}}}const Fw="SYSTEM_UPDATE",Uw="SYSTEM_UPDATE_AFTER",UD="EULER";function zD(l,e,t){l.sleep||(l.mass!==1&&l.acceleration.multiplyScalar(1/l.mass),l.velocity.add(l.acceleration.multiplyScalar(e)),l.position.add(l.velocity.multiplyScalar(e)),l.acceleration.set(0,0,0))}function BD(l,e,t,n=UD){zD(l,e)}class Yd{constructor(e,t){N(this,"a");N(this,"b");N(this,"arr");Array.isArray(e)?this.arr=e:(this.a=e??0,this.b=t??this.a)}getValue(e=!1){return this.arr?this.arr[this.arr.length*Math.random()>>0]:function(t,n,i){if(t===n)return i?t>>0:t;{let s=t+Math.random()*(n-t);return i?s>>0:s}}(this.a,this.b,e)}}class zw{constructor(e=1,t=0,n=1){N(this,"_countSpan",null);N(this,"_intervalSpan",null);N(this,"_elapse",0);N(this,"_inteval",0);N(this,"_lastTime",0);N(this,"_repeat",1);N(this,"_repeatCount",1);this._countSpan=Array.isArray(e)?new Yd(e[0],e[1]):new Yd(e),this._intervalSpan=Array.isArray(t)?new Yd(t[0],t[1]):new Yd(t),this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat=n}reset(){this._elapse=0,this._lastTime=0,this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat}getVaue(e){return(this._repeatCount>0||this._repeat<0)&&(this._elapse+=e,this._elapse-this._lastTime>=this._inteval)?(this._lastTime+=this._inteval,this._inteval=this._intervalSpan.getValue(),this._repeatCount--,this._countSpan.getValue(!0)):0}}const{PI:pg}=Math,Dl={easeLinear:function(l){return l},easeInQuad:function(l){return Math.pow(l,2)},easeOutQuad:function(l){return-(Math.pow(l-1,2)-1)},easeInOutQuad:function(l){return(l/=.5)<1?.5*Math.pow(l,2):-.5*((l-=2)*l-2)},easeInCubic:function(l){return Math.pow(l,3)},easeOutCubic:function(l){return Math.pow(l-1,3)+1},easeInOutCubic:function(l){return(l/=.5)<1?.5*Math.pow(l,3):.5*(Math.pow(l-2,3)+2)},easeInQuart:function(l){return Math.pow(l,4)},easeOutQuart:function(l){return-(Math.pow(l-1,4)-1)},easeInOutQuart:function(l){return(l/=.5)<1?.5*Math.pow(l,4):-.5*((l-=2)*Math.pow(l,3)-2)},easeInSine:function(l){return 1-Math.cos(l*(pg/2))},easeOutSine:function(l){return Math.sin(l*(pg/2))},easeInOutSine:function(l){return-.5*(Math.cos(pg*l)-1)},easeInExpo:function(l){return l===0?0:Math.pow(2,10*(l-1))},easeOutExpo:function(l){return l===1?1:1-Math.pow(2,-10*l)},easeInOutExpo:function(l){return l===0?0:l===1?1:(l/=.5)<1?.5*Math.pow(2,10*(l-1)):.5*(2-Math.pow(2,-10*--l))},easeInCirc:function(l){return-(Math.sqrt(1-l*l)-1)},easeOutCirc:function(l){return Math.sqrt(1-Math.pow(l-1,2))},easeInOutCirc:function(l){return(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1)},easeInBack:function(l){var e=1.70158;return l*l*((e+1)*l-e)},easeOutBack:function(l){var e=1.70158;return(l-=1)*l*((e+1)*l+e)+1},easeInOutBack:function(l){var e=1.70158;return(l/=.5)<1?l*l*((1+(e*=1.525))*l-e)*.5:.5*((l-=2)*l*((1+(e*=1.525))*l+e)+2)}};function Bw(l){return l.constructor.type==="Span"?l.getValue():l}function Qd(l,e,t){for(var n in e)l.hasOwnProperty(n)&&(t?t.indexOf(n)<0&&(l[n]=Bw(e[n])):l[n]=Bw(e[n]));return l}function jD(l,e){for(let t in e)if(l.hasOwnProperty(t)){let n=l[t];n&&n.copy?n.copy(e[t]):l[t]=e[t]}return l}const{clamp:_U,clamp01:HD}=fn;class fg{constructor(e){N(this,"index",0);N(this,"age",0);N(this,"life",1/0);N(this,"energy",1);N(this,"progress",0);N(this,"dead",!1);N(this,"sleep",!1);N(this,"delay",0);N(this,"acceleration",new O);N(this,"scale",new O(1,1,1));N(this,"position",new O);N(this,"velocity",new O);N(this,"rotation",new Xn);N(this,"behaviours",[]);N(this,"parent",null);N(this,"color",new Ie);N(this,"alpha",1);N(this,"mass",1);N(this,"easing",Dl.easeLinear);N(this,"transform",{});N(this,"rand",new O);Qd(this,e)}reset(){return this.age=0,this.life=1/0,this.energy=1,this.progress=0,this.dead=!1,this.sleep=!1,this.delay=0,this.acceleration.set(0,0,0),this.scale.set(1,1,1),this.position.set(0,0,0),this.velocity.set(0,0,0),this.rotation.set(0,0,0),this.parent=null,this.color.setRGB(1,1,1),this.alpha=1,this.mass=1,this.easing=Dl.easeLinear,this.rand.set(0,0,0),this.removeAllBehaviours(),this}destroy(){return this.dead=!0,this.parent=null,this}update(e){if(this.sleep||this.dead)return!1;if(this.delay>0)return this.delay-=e,!1;if(this.age+=e,this.age>this.life){if(!(this.energy>0))return this.destroy(),!1;this.energy=0,this.progress=1}else this.progress=this.easing(HD(this.age/this.life)),this.energy=1-this.progress;for(let t=this.behaviours.length;t--;)this.behaviours[t].applyBehaviour(this,e,this.progress);return!0}addBehaviour(...e){for(let t of e)this.behaviours.push(t),t.initialize(this)}removeBehaviour(e){let t=this.behaviours.indexOf(e);t>-1&&this.behaviours.splice(t,1)}removeAllBehaviours(){this.behaviours.length=0}}const GD=new ZS(null,new Ke,new Ke);class jw{constructor(e={}){N(this,"spriteFrame",GD);N(this,"count",1);N(this,"interval",0);N(this,"repeat",1);N(this,"billboard",!0);N(this,"behaviours",[]);Qd(this,e)}}const{clamp:VD}=fn,Hw={count:1};class WD extends fg{constructor(t){super();N(this,"rate",new zw(1,.1));N(this,"playing",!1);N(this,"particles",[]);N(this,"damping",.006);N(this,"controller",new jw);Qd(this,t),this.initialize(this.controller)}initialize({count:t,interval:n,repeat:i,behaviours:s}){this.rate=new zw(t,n,i),this.behaviours=s}update(t){return!this.sleep&&!this.dead&&(this.age+=t,this.age>this.life&&this.particles.length==0&&this.destroy(),this.playing&&this.generate(t),this.particles.length>0&&this.integrate(t),!0)}integrate(t){var s,a,c;this.damping;let n,i=VD(60*t,.5,1.5);for(let h=this.particles.length;h--;)n=this.particles[h],n.update(t)&&((s=this.parent)==null||s.emit("PARTICLE_UPDATE",n),this.controller.onParticleUpdate&&this.controller.onParticleUpdate(n),BD(n,i)),n.dead&&(this.particles.splice(h,1),(a=this.parent)==null||a.pool.expire(n),(c=this.parent)==null||c.emit("PARTICLE_DEAD",n))}createParticle(t){var i;let n=this.parent.pool.get(fg);n.reset(),n.addBehaviour(...this.behaviours),n.parent=this,n.index=this.particles.length,this.particles.push(n),(i=this.parent)==null||i.emit("PARTICLE_CREATED",n),this.controller.onParticleCreate&&this.controller.onParticleCreate(n,t)}generate(t){for(let n=Hw.count=this.rate.getVaue(t);n--;)this.createParticle(Hw)}emit(t){for(let n=t.count=Math.max(1,t.count);n--;)this.createParticle(t)}play(){this.playing=!0,this.rate.reset()}stop(){this.playing=!1}}class XD{constructor(){N(this,"list",[])}get(e){return this.list.length>0?this.list.pop():new e}expire(e){this.list.push(e)}}var Gw=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class mg extends Tt{constructor(){super(...arguments);N(this,"playing",!1);N(this,"pool",new XD);N(this,"emitters",[]);N(this,"renderers",[])}onLoad({name:t,...n}){this.name=t||"ParticleSystem-"+this.uuid,Mt(this.node,n)}addEmitter(t){return t.parent=this,this.emitters.push(t),this.emit("EMITTER_ADDED",t),this}removeEmitter(t){return t.parent!==this||(t.parent=null,this.emitters.splice(this.emitters.indexOf(t),1),this.emit("EMITTER_REMOVED",t)),this}addRenderer(t){return this.renderers.push(t.init(this)),this}removeRenderer(t){return this.renderers.splice(this.renderers.indexOf(t.reset()),1),this}play(){for(let t=this.emitters.length;t--;)this.emitters[t].play();return this.playing=!0,this}stop(){return this.playing=!1,this}update(t){if(!this.playing)return;let n;for(let i=this.emitters.length;i--;)n=this.emitters[i],n.update(t),n.particles.length&&this.emit(Fw,this);this.emit(Uw,this)}getCount(){let t=0;for(let n=this.emitters.length;n--;)t+=this.emitters[n].particles.length;return t}onDestroy(){for(let t=this.emitters.length;t--;)this.emitters[t].destroy();for(let t=this.renderers.length;t--;)this.renderers[t].destroy();this.emitters.length=0,this.renderers.length=0}}Gw([It()],mg.prototype,"play",null),Gw([It()],mg.prototype,"stop",null);class ou{constructor(e=!0){N(this,"enabled");this.enabled=e}applyBehaviour(e,t,n){this.enabled&&this.mutate(e,t,n)}initialize(e){}mutate(e,t,n){}}class qD extends ou{constructor(t=1,n,i=Dl.easeLinear,s){super(s);N(this,"alphaA");N(this,"alphaB");N(this,"easing");this.alphaA=t,this.alphaB=n,this.easing=i}initialize(t){t.transform.alphaA=this.alphaA,t.transform.alphaB=this.alphaB}mutate(t,n,i){t.alpha=t.transform.alphaB!==void 0?fn.lerp(t.transform.alphaA,t.transform.alphaB,this.easing(i)):t.transform.alphaA}}class YD extends ou{constructor(t=new Ie,n,i=Dl.easeLinear,s){super(s);N(this,"colorA");N(this,"colorB");N(this,"easing");this.colorA=t,this.colorB=n,this.easing=i}initialize(t){var n;t.transform.colorA=this.colorA.clone(),t.transform.colorB=(n=this.colorB)==null?void 0:n.clone()}mutate(t,n,i){t.color.copy(t.transform.colorA),t.transform.colorB&&t.color.lerp(t.transform.colorB,this.easing(i))}}class Vw extends ou{constructor(t=new O,n){super(n);N(this,"force");this.force=t,this.force.multiplyScalar(100)}initialize(t){t.transform.force=this.force.clone()}mutate(t,n,i){t.acceleration.add(t.transform.force)}}class QD extends Vw{constructor(t=10,n){super(new O(0,-t,0),n);N(this,"gravity");this.gravity=t}}class ZD extends ou{constructor(t=new O,n,i=Dl.easeLinear,s){super(s);N(this,"scaleA");N(this,"scaleB");N(this,"easing");this.scaleA=t,this.scaleB=n,this.easing=i}initialize(t){var n;t.transform.scaleA=this.scaleA.clone(),t.transform.scaleB=(n=this.scaleB)==null?void 0:n.clone()}mutate(t,n,i){t.scale.copy(t.transform.scaleA),t.transform.scaleB&&t.scale.lerp(t.transform.scaleB,this.easing(i))}}class Ww extends et{constructor(){super(...arguments);N(this,"system")}init(t){return this.system=t,this.system.node.add(this),this.system.on(Fw,this.onSystemUpdate,this),this.system.on(Uw,this.onSystemUpdateAfter,this),this}reset(){return this.system&&(this.system.targetOff(this),this.system.node.remove(this),this.system=void 0),this}destroy(){}onSystemUpdate(t){}onSystemUpdateAfter(t){}}const Xw={blending:xn,depthTest:!0,depthWrite:!1,transparent:!0,maxParticles:200},gg=new hs;let Ol=new Ut;class KD extends Ww{constructor(t=Xw){super();N(this,"stride",21);N(this,"buffer");N(this,"interleavedBuffer");N(this,"geometry",new Cd);N(this,"renderMode",0);const{blending:n,useAlphaSDF:i,depthTest:s,depthWrite:a,transparent:c,maxParticles:h,map:d,...f}={...Xw,...t},m=new St({uniforms:{map:{value:d}},defines:{USE_ALPHA_SDF:!!i,IS_ADDITIVE_BLENDING:n===xn},vertexShader:`
precision highp float;
attribute vec4 texCoords;
attribute vec4 meshCoords;
attribute vec3 spritePos;
attribute vec4 spriteQuat;
attribute vec4 spriteColor;
attribute vec2 decorators;

varying vec2 vUv;
varying vec4 vColor;

#include <matrix>

mat2 makeRotateMatrix(in float rad) {
    float c = cos(rad);
    float s = sin(rad);
    return mat2(c,-s,s,c);
}

void main() {
    vColor = spriteColor;
    vUv = uv * texCoords.zw + texCoords.xy;
    vUv.y = 1. - vUv.y;

    mat4 instanceMatrix = getInstanceMatrix(spritePos, spriteQuat, vec3(1.));
    mat4 mvMatrix = modelViewMatrix * instanceMatrix;

    vec4 transformed = vec4(position,1.);
    transformed.xy = transformed.xy * meshCoords.zw + meshCoords.xy;

    vec4 mvPosition = mvMatrix * transformed;
    vec4 bbPosition = mvMatrix * vec4(0.,0.,0.,1.);
    vec2 scale = vec2(length(mvMatrix[0].xyz), length(mvMatrix[1].xyz));
    bbPosition.xy += makeRotateMatrix(spriteQuat.x) * transformed.xy * scale;
    mvPosition = mix(mvPosition, bbPosition, decorators.x);
    
    gl_Position = projectionMatrix * mvPosition;
}
`,fragmentShader:`
precision highp float;
uniform sampler2D map;
varying vec2 vUv;
varying vec4 vColor;

float luma(vec3 color) { return dot(color, vec3(0.299, 0.587, 0.114)); }

void main() {
    vec4 color = texture2D(map, vUv);
    float shape = color.r;

#ifdef USE_ALPHA_SDF
#ifdef IS_ADDITIVE_BLENDING
    float l = vColor.a * luma(vColor.rgb);
    shape = max(smoothstep(0.48, 0.52, shape), shape * l);
#else
    shape = smoothstep(0.48, 0.52, shape);
#endif
#endif

    float alpha = color.a * vColor.a;
    vec3 col = vColor.rgb * vColor.a * shape;
    gl_FragColor = vec4(col, alpha * shape);
}
`,blending:n,depthTest:s,depthWrite:a,transparent:c});let g=new Float32Array(h*this.stride),y=new yS(g,this.stride),S=new Cd;S.index=gg.index,S.attributes.position=gg.attributes.position,S.attributes.uv=gg.attributes.uv,S.setAttribute("texCoords",new ui(y,4,0,!1)),S.setAttribute("meshCoords",new ui(y,4,4,!1)),S.setAttribute("spritePos",new ui(y,3,8,!1)),S.setAttribute("decorators",new ui(y,2,11,!1)),S.setAttribute("spriteQuat",new ui(y,4,13,!1)),S.setAttribute("spriteColor",new ui(y,4,17,!1)),this.buffer=g,this.interleavedBuffer=y,this.interleavedBuffer.setUsage(dx),this.geometry=S,this.material=m,this.frustumCulled=!1,Mt(this,f)}onSystemUpdateAfter(t){let n=0,i=t.emitters;for(let s=i.length;s--;){let a=i[s].particles;for(let c=a.length;c--;)this.commitInstanceBuffer(a[c],n++*this.stride)}this.interleavedBuffer.needsUpdate=!0,this.geometry.instanceCount=n,this.visible=n>0}commitInstanceBuffer(t,n=0){let{position:i,rotation:s,scale:a,color:c}=t,{billboard:h,spriteFrame:d}=t.parent.controller,{texCoords:f,meshCoords:m}=d;h?Ol.x=s.x:Ol.setFromEuler(s);let g=this.buffer;g[n++]=f.x,g[n++]=f.y,g[n++]=f.z,g[n++]=f.w,g[n++]=m.x*a.x,g[n++]=m.y*a.y,g[n++]=m.z*a.x,g[n++]=m.w*a.y,g[n++]=i.x,g[n++]=i.y,g[n++]=i.z,g[n++]=h?1:0,g[n++]=0,g[n++]=Ol.x,g[n++]=Ol.y,g[n++]=Ol.z,g[n++]=Ol.w,g[n++]=c.r,g[n++]=c.g,g[n++]=c.b,g[n++]=t.alpha}}class JD extends Tt{create({width:e=1,height:t=1,depth:n=1,widthSegments:i=1,heightSegments:s=1,depthSegments:a=1,material:c=new Bt,...h}){return Mt(new et(new cs(e,t,n,i,s,a),c),h)}}class $D extends Tt{create({radius:e=1,length:t=1,capSegments:n=4,radialSegments:i=8,material:s=new Bt,...a}){return Mt(new et(new dl(e,t,n,i),s),a)}}class eO extends Tt{create({radius:e,segments:t,thetaStart:n,thetaLength:i,material:s=new Bt,...a}){return Mt(new et(new pl(e,t,n,i),s),a)}}class tO extends Tt{create({radius:e=1,height:t=1,radialSegments:n=32,heightSegments:i=1,openEnded:s=!1,thetaStart:a=0,thetaLength:c=2*Math.PI,material:h=new Bt,...d}){return Mt(new et(new fl(e,t,n,i,s,a,c),h),d)}}class nO extends Tt{create({radiusTop:e=1,radiusBottom:t=1,height:n=1,radialSegments:i=32,heightSegments:s=1,openEnded:a=!1,thetaStart:c=0,thetaLength:h=2*Math.PI,material:d=new Bt,...f}){return Mt(new et(new Ws(e,t,n,i,s,a,c,h),d),f)}}class iO extends Tt{create({radius:e=1,detail:t=0,material:n=new Bt,...i}){return Mt(new et(new ml(e,t),n),i)}}class rO extends Tt{create({geometry:e=null,thresholdAngle:t=1,material:n=new Bt,...i}){return Mt(new et(new M0(e,t),n),i)}}class sO extends Tt{create({shapes:e=new ds([new de(.5,.5),new de(-.5,.5),new de(-.5,-.5),new de(.5,-.5)]),options:t={},material:n=new Bt,...i}){return Mt(new et(new vl(e,t),n),i)}}class aO extends Tt{create({radius:e=1,detail:t=0,material:n=new Bt,...i}){return Mt(new et(new yl(e,t),n),i)}}class oO extends Tt{create({points:e=[new de(0,-.5),new de(.5,0),new de(0,.5)],segments:t=12,phiStart:n=0,phiLength:i=2*Math.PI,material:s=new Bt,...a}){return Mt(new et(new Ha(e,t,n,i),s),a)}}class lO extends Tt{create({radius:e=1,detail:t=0,material:n=new Bt,...i}){return Mt(new et(new Va(e,t),n),i)}}class cO extends Tt{create({width:e=1,height:t=1,widthSegments:n=1,heightSegments:i=1,material:s=new Bt,...a}){return Mt(new et(new hs(e,t,n,i),s),a)}}class uO extends Tt{create({vertices:e=[],indices:t=[],radius:n=1,detail:i=0,material:s=new Bt,...a}){return Mt(new et(new Fr(e,t,n,i),s),a)}}class hO extends Tt{create({innerRadius:e=.5,outerRadius:t=1,thetaSegments:n=32,phiSegments:i=1,thetaStart:s=0,thetaLength:a=2*Math.PI,material:c=new Bt,...h}){return Mt(new et(new xl(e,t,n,i,s,a),c),h)}}class dO extends Tt{create({shapes:e=new ds([new de(0,.5),new de(-.5,-.5),new de(.5,-.5)]),curveSegments:t=12,material:n=new Bt,...i}){return Mt(new et(new bl(e,t),n),i)}}class pO extends Tt{create({radius:e,widthSegments:t,heightSegments:n,material:i=new Bt,...s}){return Mt(new et(new Xs(e,t,n),i),s)}}class fO extends Tt{create({radius:e=1,detail:t=0,material:n=new Bt,...i}){return Mt(new et(new Sl(e,t),n),i)}}class mO extends Tt{create({radius:e=1,tube:t=.4,radialSegments:n=12,tubularSegments:i=48,arc:s=2*Math.PI,material:a=new Bt,...c}){return Mt(new et(new wl(e,t,n,i,s),a),c)}}class gO extends Tt{create({radius:e=1,tube:t=.4,tubularSegments:n=64,radialSegments:i=8,p:s=2,q:a=3,material:c=new Bt,...h}){return Mt(new et(new _l(e,t,n,i,s,a),c),h)}}class vO extends Tt{create({path:e=new xd(new O(-1,-1,0),new O(-1,1,0),new O(1,1,0)),tubularSegments:t=64,radius:n=1,radialSegments:i=8,closed:s=!1,material:a=new Bt,...c}){return Mt(new et(new Ml(e,t,n,i,s),a),c)}}class yO extends Tt{create({geometry:e=null,material:t=new Bt,...n}){return Mt(new et(new A0(e),t),n)}}class qw extends St{constructor(t=new de){super({uniforms:{inputBuffer:new Ge(null),depthBuffer:new Ge(null),resolution:new Ge(new de),texelSize:new Ge(new de),halfTexelSize:new Ge(new de),kernel:new Ge(0),scale:new Ge(1),cameraNear:new Ge(0),cameraFar:new Ge(1),minDepthThreshold:new Ge(0),maxDepthThreshold:new Ge(1),depthScale:new Ge(0),depthToBlurRatioBias:new Ge(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <encodings_fragment>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:Be,depthWrite:!1,depthTest:!1});N(this,"kernel");this.toneMapped=!1,this.setTexelSize(t.x,t.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(t,n){this.uniforms.texelSize.value.set(t,n),this.uniforms.halfTexelSize.value.set(t,n).multiplyScalar(.5)}setResolution(t){this.uniforms.resolution.value.copy(t)}}class Yw{constructor({gl:e,resolution:t,width:n=500,height:i=500,minDepthThreshold:s=0,maxDepthThreshold:a=1,depthScale:c=0,depthToBlurRatioBias:h=.25}){N(this,"renderTargetA");N(this,"renderTargetB");N(this,"convolutionMaterial");N(this,"scene");N(this,"camera");N(this,"screen");N(this,"renderToScreen",!1);this.renderTargetA=new Lt(t,t,{minFilter:at,magFilter:at,stencilBuffer:!1,depthBuffer:!1,type:yi}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new qw,this.convolutionMaterial.setTexelSize(1/n,1/i),this.convolutionMaterial.setResolution(new de(n,i)),this.scene=new ja,this.camera=new el,this.convolutionMaterial.uniforms.minDepthThreshold.value=s,this.convolutionMaterial.uniforms.maxDepthThreshold.value=a,this.convolutionMaterial.uniforms.depthScale.value=c,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=h,this.convolutionMaterial.defines.USE_DEPTH=c>0;const d=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),f=new Float32Array([0,0,2,0,0,2]),m=new $e;m.setAttribute("position",new tt(d,3)),m.setAttribute("uv",new tt(f,2)),this.screen=new et(m,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,n){const i=this.scene,s=this.camera,a=this.renderTargetA,c=this.renderTargetB;let h=this.convolutionMaterial,d=h.uniforms;d.depthBuffer.value=t.depthTexture;const f=h.kernel;let m,g,y,S=t;for(g=0,y=f.length-1;g<y;++g)m=1&g?c:a,d.kernel.value=f[g],d.inputBuffer.value=S.texture,e.setRenderTarget(m),e.render(i,s),S=m;d.kernel.value=f[g],d.inputBuffer.value=S.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(i,s)}}class Qw extends Bt{constructor(t={}){super(t);N(this,"_tDepth",{value:null});N(this,"_distortionMap",{value:null});N(this,"_tDiffuse",{value:null});N(this,"_tDiffuseBlur",{value:null});N(this,"_textureMatrix",{value:null});N(this,"_hasBlur",{value:!1});N(this,"_mirror",{value:0});N(this,"_mixBlur",{value:0});N(this,"_blurStrength",{value:.5});N(this,"_minDepthThreshold",{value:.9});N(this,"_maxDepthThreshold",{value:1});N(this,"_depthScale",{value:0});N(this,"_depthToBlurRatioBias",{value:.25});N(this,"_distortion",{value:1});N(this,"_mixContrast",{value:1});this.setValues(t)}onBeforeCompile(t){var n;(n=t.defines)!=null&&n.USE_UV||(t.defines.USE_UV=""),t.uniforms.hasBlur=this._hasBlur,t.uniforms.tDiffuse=this._tDiffuse,t.uniforms.tDepth=this._tDepth,t.uniforms.distortionMap=this._distortionMap,t.uniforms.tDiffuseBlur=this._tDiffuseBlur,t.uniforms.textureMatrix=this._textureMatrix,t.uniforms.mirror=this._mirror,t.uniforms.mixBlur=this._mixBlur,t.uniforms.mixStrength=this._blurStrength,t.uniforms.minDepthThreshold=this._minDepthThreshold,t.uniforms.maxDepthThreshold=this._maxDepthThreshold,t.uniforms.depthScale=this._depthScale,t.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,t.uniforms.distortion=this._distortion,t.uniforms.mixContrast=this._mixContrast,t.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${t.vertexShader}`,t.vertexShader=t.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),t.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
		uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${t.fragmentShader}`,t.fragmentShader=t.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(t){this._tDiffuse.value=t}get tDepth(){return this._tDepth.value}set tDepth(t){this._tDepth.value=t}get distortionMap(){return this._distortionMap.value}set distortionMap(t){this._distortionMap.value=t}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(t){this._tDiffuseBlur.value=t}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(t){this._textureMatrix.value=t}get hasBlur(){return this._hasBlur.value}set hasBlur(t){this._hasBlur.value=t}get mirror(){return this._mirror.value}set mirror(t){this._mirror.value=t}get mixBlur(){return this._mixBlur.value}set mixBlur(t){this._mixBlur.value=t}get mixStrength(){return this._blurStrength.value}set mixStrength(t){this._blurStrength.value=t}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(t){this._minDepthThreshold.value=t}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(t){this._maxDepthThreshold.value=t}get depthScale(){return this._depthScale.value}set depthScale(t){this._depthScale.value=t}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(t){this._depthToBlurRatioBias.value=t}get distortion(){return this._distortion.value}set distortion(t){this._distortion.value=t}get mixContrast(){return this._mixContrast.value}set mixContrast(t){this._mixContrast.value=t}}const lu=new Ke,ys=new Ke,Il=new us,lo=new O,vg=new O,cu=new O,uu=new Ne,ea=new O,Zd=new O,Kd=new O;class xO extends Tt{constructor(){super(...arguments);N(this,"_fbo1");N(this,"_fbo2");N(this,"_blurPass");N(this,"_hasBlur",!1);N(this,"_virtualCamera",new Kt);N(this,"_reflectorOffset",0);N(this,"_textureMatrix",new Ne);N(this,"_reflectorMaterial")}create({width:t=1,height:n=1,...i}){return Mt(new et(new hs(t,n)),{rotation:YS(-Math.PI/2,0,0),...i})}onLoad({mixBlur:t=0,mixStrength:n=1,resolution:i=256,blur:s=[0,0],minDepthThreshold:a=.9,maxDepthThreshold:c=1,depthScale:h=0,depthToBlurRatioBias:d=.25,mirror:f=0,distortion:m=1,mixContrast:g=1,distortionMap:y,reflectorOffset:S=0,...x}){const w=this.viewer.renderer,T={minFilter:at,magFilter:at,type:yi};this._fbo1=new Lt(i,i,T),this._fbo1.depthBuffer=!0,this._fbo1.depthTexture=new Uc(i,i),this._fbo1.depthTexture.format=ts,this._fbo1.depthTexture.type=Sh,this._fbo2=new Lt(i,i,T),this._blurPass=new Yw({gl:w,resolution:i,width:s[0],height:s[1],minDepthThreshold:a,maxDepthThreshold:c,depthScale:h,depthToBlurRatioBias:d});let _=this._hasBlur=s[0]+s[1]>0;this._reflectorOffset=S,this._reflectorMaterial=Object.assign(new Qw,{mirror:f,mixBlur:t,textureMatrix:this._textureMatrix,tDiffuse:this._fbo1.texture,tDepth:this._fbo1.depthTexture,tDiffuseBlur:this._fbo2.texture,hasBlur:_,mixStrength:n,minDepthThreshold:a,maxDepthThreshold:c,depthScale:h,depthToBlurRatioBias:d,distortion:m,distortionMap:y,mixContrast:g,defines:{USE_BLUR:_?"":void 0,USE_DEPTH:h>0?"":void 0,USE_DISTORTION:y?"":void 0},...x},!0),this.node.material=this._reflectorMaterial}onDestroy(){this._fbo1.dispose(),this._fbo2.dispose(),this._reflectorMaterial.dispose()}beforeRender(){const t=this.viewer.camera,n=this._virtualCamera,i=this._textureMatrix;if(lo.setFromMatrixPosition(this.node.matrixWorld),vg.setFromMatrixPosition(t.matrixWorld),uu.extractRotation(this.node.matrixWorld),ea.set(0,0,1),ea.applyMatrix4(uu),lo.addScaledVector(ea,this._reflectorOffset),cu.subVectors(lo,vg),cu.dot(ea)>0)return;cu.reflect(ea).negate(),cu.add(lo),uu.extractRotation(t.matrixWorld),Kd.set(0,0,-1),Kd.applyMatrix4(uu),Kd.add(vg),Zd.subVectors(lo,Kd),Zd.reflect(ea).negate(),Zd.add(lo),n.position.copy(cu),n.up.set(0,1,0),n.up.applyMatrix4(uu),n.up.reflect(ea),n.lookAt(Zd),n.far=t.far,n.updateMatrixWorld(),n.projectionMatrix.copy(t.projectionMatrix),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(n.projectionMatrix),i.multiply(n.matrixWorldInverse),i.multiply(this.node.matrixWorld),Il.setFromNormalAndCoplanarPoint(ea,lo),Il.applyMatrix4(n.matrixWorldInverse),ys.set(Il.normal.x,Il.normal.y,Il.normal.z,Il.constant);const s=n.projectionMatrix;lu.x=(Math.sign(ys.x)+s.elements[8])/s.elements[0],lu.y=(Math.sign(ys.y)+s.elements[9])/s.elements[5],lu.z=-1,lu.w=(1+s.elements[10])/s.elements[14],ys.multiplyScalar(2/ys.dot(lu)),s.elements[2]=ys.x,s.elements[6]=ys.y,s.elements[10]=ys.z+1,s.elements[14]=ys.w}update(t){this.node.visible=!1;const n=this.viewer.renderer,i=this.viewer.scene,s=n.xr.enabled,a=n.shadowMap.autoUpdate;this.beforeRender(),n.xr.enabled=!1,n.shadowMap.autoUpdate=!1,n.setRenderTarget(this._fbo1),n.state.buffers.depth.setMask(!0),n.autoClear||n.clear(),n.render(i,this._virtualCamera),this._hasBlur&&this._blurPass.render(n,this._fbo1,this._fbo2),n.xr.enabled=s,n.shadowMap.autoUpdate=a,this.node.visible=!0,n.setRenderTarget(null)}}class bO extends Tt{constructor(){super(...arguments);N(this,"_fbo");N(this,"_scene");N(this,"_camera")}get texture(){return this._fbo.texture}onLoad({width:t=128,height:n=128,...i}){const{scene:s,camera:a,size:c,renderer:h}=this.viewer;this._scene=s,this._camera=a,this._fbo=new Lt(t||c.width,n||c.height),this._fbo.texture.readPixels=(d,f,m,g,y)=>h.readRenderTargetPixels(this._fbo,d,f,m,g,y),Mt(this.texture,i)}update(t){const n=this.viewer.renderer;n.setRenderTarget(this._fbo),n.render(this._scene,this._camera),n.setRenderTarget(null)}}class yg extends Tt{create(){return new et(new Xs(500,60,40),new xi({side:ye}))}}class SO extends yg{onLoad(e){Zn.Load(Object.assign({magFilter:at,minFilter:at},e)).then(t=>{this.node.material.map=t,this.node.material.needsUpdate=!0})}}class wO extends yg{}class Zw extends Tt{create(){return new j0(new Od)}onLoad({listener:e}){this.viewer.addNode(this.node.listener,{},e||this.viewer.camera)}play({url:e,loop:t=!1,volume:n=1,force:i=!1}){Zn.Load({url:e}).then(s=>{i&&this.node.stop(),this.node.setBuffer(s),this.node.setLoop(t),this.node.setVolume(n),this.node.isPlaying||this.node.play()})}stop(){this.node.stop()}}class _O extends Tt{create(){return new Od}onLoad(e){this.node}}class MO extends Zw{create(){return new gS(new Od)}play({refDistance:e=20,maxDistance:t=1e4,...n}){super.play(n),this.node.setRefDistance(e),this.node.setMaxDistance(t)}}function xg(l){return l>1e3?Math.floor(.001*l)+"k":l>1e6?Math.floor(1e-6*l)+"m":l}var co=function(l,e,t){var n=1/0,i=0,s=Math.round,a=s(window.devicePixelRatio||1),c=80*a,h=48*a,d=3*a,f=2*a,m=3*a,g=15*a,y=74*a,S=30*a,x=document.createElement("canvas");x.width=c,x.height=h,x.style.cssText="width:80px;height:48px";var w=x.getContext("2d");return w.font="bold "+9*a+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=t,w.fillRect(0,0,c,h),w.fillStyle=e,w.fillText(l,d,f),w.fillRect(m,g,y,S),w.fillStyle=t,w.globalAlpha=.9,w.fillRect(m,g,y,S),{dom:x,update:function(T,_){n=Math.min(n,T),i=Math.max(i,T),w.fillStyle=t,w.globalAlpha=1,w.fillRect(0,0,c,g),w.fillStyle=e,w.fillText(xg(s(T))+" "+l+" ("+xg(s(n))+"-"+xg(s(i))+")",d,f),w.drawImage(x,m+a,g,y-a,S,m,g,y-a,S),w.fillRect(m+y-a,g,a,S),w.fillStyle=t,w.globalAlpha=.9,w.fillRect(m+y-a,g,a,s((1-T/_)*S))}}},TO=function(){var l=0,e=document.createElement("div");function t(f){return e.appendChild(f.dom),f}function n(f){for(var m=0;m<e.children.length;m++)e.children[m].style.display=m===f?"block":"none";l=f}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(f){f.preventDefault(),n(++l%e.children.length)},!1);var i=(performance||Date).now(),s=i,a=0,c=t(new co("FPS","#0ff","#002")),h=t(new co("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=t(new co("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){a++;var f=(performance||Date).now();if(h.update(f-i,200),f>=s+1e3&&(c.update(1e3*a/(f-s),100),s=f,a=0,d)){var m=performance.memory;d.update(m.usedJSHeapSize/1048576,m.jsHeapSizeLimit/1048576)}return f},update:function(){i=this.end()},domElement:e,setMode:n}};class EO extends Kn{constructor(){super(...arguments);N(this,"_stats",new TO);N(this,"_dcPanel",new co("DC","#ff8","#221"));N(this,"_triPanel",new co("TRI","#ff8","#221"));N(this,"_texPanel",new co("TEX","#ff8","#221"));N(this,"_prgPanel",new co("PRG","#ff8","#221"))}onLoad(t){this._stats.addPanel(this._dcPanel),this._stats.addPanel(this._texPanel),this._stats.addPanel(this._triPanel),this._stats.addPanel(this._prgPanel),this._stats.showPanel(0),document.body.appendChild(this._stats.dom)}update(t){let n=this.viewer.renderer.info;this._dcPanel.update(n.render.calls,300),this._triPanel.update(n.render.triangles,5e5),this._texPanel.update(n.memory.textures,200),this._prgPanel.update(n.programs.length,50),this._stats.update()}}class AO extends Kn{constructor(){super(...arguments);N(this,"name","VirtualCameraPlugin");N(this,"_brain",null);N(this,"_freelookCamera",null)}onEnable(){this._brain&&(this._brain.enabled=!0),this._freelookCamera&&(this._freelookCamera.enabled=!0)}onDisable(){this._brain&&(this._brain.enabled=!1),this._freelookCamera&&(this._freelookCamera.enabled=!1)}onLoad(t){const n=this.viewer.camera,i=Object.assign({fov:n.fov,near:n.near,far:n.far,lookAt:new ct,position:qS(0,0,4)},t);this._brain=this.viewer.addComponent(n,ug),this._freelookCamera=this.viewer.addNode(kw,i)}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.18.2
 * @author George Michael Brower
 * @license MIT
 */class ki{constructor(e,t,n,i,s="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(i),this.$name=document.createElement("div"),this.$name.classList.add("name"),ki.nextNameID=ki.nextNameID||0,this.$name.id="lil-gui-name-"+ ++ki.nextNameID,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",a=>a.stopPropagation()),this.domElement.addEventListener("keyup",a=>a.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Kw extends ki{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function bg(l){let e,t;return(e=l.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=l.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=l.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const RO={isPrimitive:!0,match:l=>typeof l=="string",fromHexString:bg,toHexString:bg},hu={isPrimitive:!0,match:l=>typeof l=="number",fromHexString:l=>parseInt(l.substring(1),16),toHexString:l=>"#"+l.toString(16).padStart(6,0)},LO={isPrimitive:!1,match:l=>Array.isArray(l),fromHexString(l,e,t=1){const n=hu.fromHexString(l);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(255&n)/255*t},toHexString:([l,e,t],n=1)=>hu.toHexString(l*(n=255/n)<<16^e*n<<8^t*n<<0)},PO={isPrimitive:!1,match:l=>Object(l)===l,fromHexString(l,e,t=1){const n=hu.fromHexString(l);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(255&n)/255*t},toHexString:({r:l,g:e,b:t},n=1)=>hu.toHexString(l*(n=255/n)<<16^e*n<<8^t*n<<0)},CO=[RO,hu,LO,PO];class Jw extends ki{constructor(e,t,n,i){var s;super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(s=this.initialValue,CO.find(a=>a.match(s))),this._rgbScale=i,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const a=bg(this.$text.value);a&&this._setValueFromHexString(a)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Jd extends ki{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",i=>{i.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class $w extends ki{constructor(e,t,n,i,s,a){super(e,t,n,"number"),this._initInput(),this.min(i),this.max(s);const c=a!==void 0;this.step(c?a:this._getImplicitStep(),c),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=f=>{const m=parseFloat(this.$input.value);isNaN(m)||(this._snapClampSetValue(m+f),this.$input.value=this.getValue())};let t,n,i,s,a,c=!1;const h=f=>{if(c){const m=f.clientX-t,g=f.clientY-n;Math.abs(g)>5?(f.preventDefault(),this.$input.blur(),c=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(m)>5&&d()}if(!c){const m=f.clientY-i;a-=m*this._step*this._arrowKeyMultiplier(f),s+a>this._max?a=this._max-s:s+a<this._min&&(a=this._min-s),this._snapClampSetValue(s+a)}i=f.clientY},d=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",d)};this.$input.addEventListener("input",()=>{let f=parseFloat(this.$input.value);isNaN(f)||(this._stepExplicit&&(f=this._snap(f)),this.setValue(this._clamp(f)))}),this.$input.addEventListener("keydown",f=>{f.key==="Enter"&&this.$input.blur(),f.code==="ArrowUp"&&(f.preventDefault(),e(this._step*this._arrowKeyMultiplier(f))),f.code==="ArrowDown"&&(f.preventDefault(),e(this._step*this._arrowKeyMultiplier(f)*-1))}),this.$input.addEventListener("wheel",f=>{this._inputFocused&&(f.preventDefault(),e(this._step*this._normalizeMouseWheel(f)))},{passive:!1}),this.$input.addEventListener("mousedown",f=>{t=f.clientX,n=i=f.clientY,c=!0,s=this.getValue(),a=0,window.addEventListener("mousemove",h),window.addEventListener("mouseup",d)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=g=>{const y=this.$slider.getBoundingClientRect();let S=((x,w,T,_,E)=>(x-w)/(T-w)*(E-_)+_)(g,y.left,y.right,this._min,this._max);this._snapClampSetValue(S)},t=g=>{e(g.clientX)},n=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)};let i,s,a=!1;const c=g=>{g.preventDefault(),this._setDraggingStyle(!0),e(g.touches[0].clientX),a=!1},h=g=>{if(a){const y=g.touches[0].clientX-i,S=g.touches[0].clientY-s;Math.abs(y)>Math.abs(S)?c(g):(window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d))}else g.preventDefault(),e(g.touches[0].clientX)},d=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d)},f=this._callOnFinishChange.bind(this);let m;this.$slider.addEventListener("mousedown",g=>{this._setDraggingStyle(!0),e(g.clientX),window.addEventListener("mousemove",t),window.addEventListener("mouseup",n)}),this.$slider.addEventListener("touchstart",g=>{g.touches.length>1||(this._hasScrollBar?(i=g.touches[0].clientX,s=g.touches[0].clientY,a=!0):c(g),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",d))},{passive:!1}),this.$slider.addEventListener("wheel",g=>{if(Math.abs(g.deltaX)<Math.abs(g.deltaY)&&this._hasScrollBar)return;g.preventDefault();const y=this._normalizeMouseWheel(g)*this._step;this._snapClampSetValue(this.getValue()+y),this.$input.value=this.getValue(),clearTimeout(m),m=setTimeout(f,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class e_ extends ki{constructor(e,t,n,i){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(i)?i:Object.values(i),this._names=Array.isArray(i)?i:Object.keys(i),this._names.forEach(s=>{const a=document.createElement("option");a.innerHTML=s,this.$select.appendChild(a)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=t===-1?e:this._names[t],this}}class t_ extends ki{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",i=>{i.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let uo=null,n_=new WeakMap;class i_ extends ki{constructor(e,t,n){super(e,t,n,"image"),this.$img=document.createElement("img"),this.$widget.appendChild(this.$img),this.updateDisplay()}updateDisplay(){return async function(e){if(e instanceof HTMLImageElement)return e.src;{let t=n_.get(e);if(t)return t;const n=Math.min(e.width,256),i=Math.min(e.height,256);if(uo==null&&(uo=document.createElement("canvas").getContext("2d")),uo.canvas.width=n,uo.canvas.height=i,e.data){let s=uo.createImageData(e.width,e.height);s.data.set(e.data),e=await createImageBitmap(s)}return e instanceof ImageBitmap?(uo.drawImage(e,0,0,e.width,e.height,0,0,n,i),n_.set(e,t=uo.canvas.toDataURL()),t):""}}(this.getValue()).then(e=>this.$img.src=e),this}}class $d{constructor(e){this.dom=e}add(){for(let e=0;e<arguments.length;e++){const t=arguments[e];t instanceof $d?this.dom.appendChild(t.dom):console.error("UIElement:",t,"is not an instance of UIElement.")}return this}remove(){for(let e=0;e<arguments.length;e++){const t=arguments[e];t instanceof $d?this.dom.removeChild(t.dom):console.error("UIElement:",t,"is not an instance of UIElement.")}return this}clear(){for(;this.dom.children.length;)this.dom.removeChild(this.dom.lastChild)}setId(e){return this.dom.id=e,this}getId(){return this.dom.id}setClass(e){return this.dom.className=e,this}addClass(e){return this.dom.classList.add(e),this}removeClass(e){return this.dom.classList.remove(e),this}setStyle(e,t){for(let n=0;n<t.length;n++)this.dom.style[e]=t[n];return this}setDisabled(e){return this.dom.disabled=e,this}setTextContent(e){return this.dom.textContent=e,this}getIndexOfChild(e){return Array.prototype.indexOf.call(this.dom.children,e.dom)}}function r_(l){let e=l.toString(),t=e.indexOf(".");return t>0?e.length-t-1:0}class DO extends $d{constructor(e){super(document.createElement("input")),this.dom.style.cursor="ns-resize",this.dom.value="0.00",this.value=0,this.min=-1/0,this.max=1/0,this.step=.01,this.precision=r_(this.step),this.unit="",this.setValue(e);const t=this,n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!0);let i=0,s=0;const a={x:0,y:0},c={x:0,y:0};function h(y){const S=t.value;a.x=y.clientX,a.y=y.clientY,i+=a.x-c.x-(a.y-c.y);let x=s+10*i/(y.shiftKey?5:50)*t.step;x=Math.min(t.max,Math.max(t.min,x)),S!==x&&(t.setValue(x),t.dom.dispatchEvent(n)),c.x=y.clientX,c.y=y.clientY}function d(){document.removeEventListener("mousemove",h,!1),document.removeEventListener("mouseup",d,!1),Math.abs(i)<2&&(t.dom.focus(),t.dom.select())}function f(y){const S=t.value;a.x=y.touches[0].pageX,a.y=y.touches[0].pageY,i+=a.x-c.x-(a.y-c.y);let x=s+i/(y.shiftKey?5:50)*t.step;x=Math.min(t.max,Math.max(t.min,x)),S!==x&&(t.setValue(x),t.dom.dispatchEvent(n)),c.x=y.touches[0].pageX,c.y=y.touches[0].pageY}function m(y){y.touches.length===0&&(document.removeEventListener("touchmove",f,!1),document.removeEventListener("touchend",m,!1))}function g(){t.dom.style.cursor="ns-resize"}g(),this.dom.addEventListener("keydown",function(y){switch(y.stopPropagation(),y.keyCode){case 13:t.dom.blur();break;case 38:y.preventDefault(),t.setValue(t.getValue()+t.step),t.dom.dispatchEvent(n);break;case 40:y.preventDefault(),t.setValue(t.getValue()-t.step),t.dom.dispatchEvent(n)}},!1),this.dom.addEventListener("mousedown",function(y){y.preventDefault(),i=0,s=t.value,c.x=y.clientX,c.y=y.clientY,document.addEventListener("mousemove",h,!1),document.addEventListener("mouseup",d,!1)},!1),this.dom.addEventListener("touchstart",function(y){y.touches.length===1&&(i=0,s=t.value,c.x=y.touches[0].pageX,c.y=y.touches[0].pageY,document.addEventListener("touchmove",f,!1),document.addEventListener("touchend",m,!1))},!1),this.dom.addEventListener("change",function(){t.setValue(t.dom.value)},!1),this.dom.addEventListener("focus",function(){t.dom.style.backgroundColor="",t.dom.style.cursor=""},!1),this.dom.addEventListener("blur",g,!1)}getValue(){return this.value}setValue(e){return e!==void 0&&((e=parseFloat(e))<this.min&&(e=this.min),e>this.max&&(e=this.max),this.value=e,this.dom.value=e.toFixed(this.precision),this.unit!==""&&(this.dom.value+=" "+this.unit),this._onChangeCallback&&this._onChangeCallback(e)),this}onChange(e){return this._onChangeCallback=e,this}setStep(e){return this.step=e,this.precision=r_(e),this}setRange(e,t){return this.min=e,this.max=t,this}setUnit(e){return this.unit=e,this}}class OO extends ki{constructor(e,t,n,i,s,a){super(e,t,n,"vector"),this.vector=this.initialValue.clone&&this.initialValue.clone()||Object.assign({},this.initialValue);let c=[];this.initialValue.x!==void 0&&c.push("x"),this.initialValue.y!==void 0&&c.push("y"),this.initialValue.z!==void 0&&c.push("z"),this.initialValue.w!==void 0&&c.push("w");for(let h=0;h<c.length;h++)this.setInput(c[h],h<c.length-1,i,s,a)}setInput(e,t,n,i,s){let a=new DO(this.vector[e]);if(a.dom.setAttribute("type","number"),a.dom.setAttribute("aria-labelledby",this.$name.id),a.setRange(n,i),a.setStep(s),a.setValue(this.vector[e]),a.onChange(c=>{this.vector[e]=c,this.setValue(this.vector)}),this.$widget.appendChild(a.dom),t){let c=document.createElement("div");c.classList.add("fill"),this.$widget.appendChild(c)}}}let s_=!1;class ep{constructor({parent:e,autoPlace:t=e===void 0,container:n,width:i,title:s="Controls",id:a=s,closeFolders:c=!1,injectStyles:h=!0,touchStyles:d=!0}={}){if(this.id=a,this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",f=>{f.code!=="Enter"&&f.code!=="Space"||(f.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),d&&this.domElement.classList.add("allow-touch-styles"),!s_&&h&&(function(f){const m=document.createElement("style");m.innerHTML=f;const g=document.querySelector("head link[rel=stylesheet], head style");g?document.head.insertBefore(m,g):document.head.appendChild(m)}(`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid rgba(255, 255, 255, 0.6);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "↕";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}
.lil-gui .controller.image img {
  max-width: 100%;
}
.lil-gui .controller.vector input {
  color: var(--number-color);
}
.lil-gui .controller.vector .fill {
  height: 100%;
  margin-left: var(--spacing);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "▾";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "▸";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "✓";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`),s_=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),i&&this.domElement.style.setProperty("--width",i+"px"),this._closeFolders=c}add(e,t,n,i,s){if(Object(n)===n)return new e_(this,e,t,n);const a=e[t];switch(typeof a){case"number":return new $w(this,e,t,n,i,s);case"boolean":return new Kw(this,e,t);case"string":return new t_(this,e,t);case"function":return new Jd(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,a)}addColor(e,t,n=1){return new Jw(this,e,t,n)}addImage(e,t){return new i_(this,e,t)}addVector(e,t,n=-1/0,i=1/0,s=.01){return new OO(this,e,t,n,i,s)}addFolder(e,t=e){const n=new ep({parent:this,title:e,id:t});return this.root._closeFolders&&n.close(),n}removeFolder(e){let t=this.getFolder(e);return t&&t.destroy(),this}getFolder(e){return this.folders.find(t=>t.id===e)}load(e,t=!0){return e.controllers&&this.controllers.forEach(n=>{n instanceof Jd||n._name in e.controllers&&n.load(e.controllers[n._name])}),t&&e.folders&&this.folders.forEach(n=>{n._title in e.folders&&n.load(e.folders[n._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof Jd)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}}),e&&this.folders.forEach(n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const n=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const i=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=i+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(t=>t.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const ho=`varying vec2 vUv;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`;class IO extends St{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new Ge(null),luminanceBuffer1:new Ge(null),minLuminance:new Ge(.01),deltaTime:new Ge(0),tau:new Ge(1)},extensions:{shaderTextureLOD:!0},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <packing>\r
\r
#define packFloatToRGBA(v) packDepthToRGBA(v)\r
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\r
\r
uniform lowp sampler2D luminanceBuffer0;\r
uniform lowp sampler2D luminanceBuffer1;\r
\r
uniform float minLuminance;\r
uniform float deltaTime;\r
uniform float tau;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	// This 1x1 buffer contains the previous luminance.\r
	float l0 = unpackRGBAToFloat(texture2D(luminanceBuffer0, vUv));\r
\r
	// Get the current average scene luminance.\r
	#if __VERSION__ < 300\r
\r
		float l1 = texture2DLodEXT(luminanceBuffer1, vUv, MIP_LEVEL_1X1).r;\r
\r
	#else\r
\r
		float l1 = textureLod(luminanceBuffer1, vUv, MIP_LEVEL_1X1).r;\r
\r
	#endif\r
\r
	l0 = max(minLuminance, l0);\r
	l1 = max(minLuminance, l1);\r
\r
	// Adapt the luminance using Pattanaik's technique.\r
	float adaptedLum = l0 + (l1 - l0) * (1.0 - exp(-deltaTime * tau));\r
\r
	gl_FragColor = (adaptedLum == 1.0) ? vec4(1.0) : packFloatToRGBA(adaptedLum);\r
\r
}\r
`,vertexShader:ho})}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}}class tp extends St{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{inputBuffer:new Ge(null),cocBuffer:new Ge(null),texelSize:new Ge(new de),kernel64:new Ge(null),kernel16:new Ge(null),scale:new Ge(1)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#if PASS == 1\r
\r
	uniform vec4 kernel64[32];\r
\r
#else\r
\r
	uniform vec4 kernel16[8];\r
\r
#endif\r
\r
uniform lowp sampler2D cocBuffer;\r
uniform vec2 texelSize;\r
uniform float scale;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	#ifdef FOREGROUND\r
\r
		vec2 CoCNearFar = texture2D(cocBuffer, vUv).rg;\r
		float CoC = CoCNearFar.r * scale;\r
\r
	#else\r
\r
		float CoC = texture2D(cocBuffer, vUv).g * scale;\r
\r
	#endif\r
\r
	if(CoC == 0.0) {\r
\r
		// Skip blurring.\r
		gl_FragColor = texture2D(inputBuffer, vUv);\r
\r
	} else {\r
\r
		#ifdef FOREGROUND\r
\r
			// Use far CoC to avoid weak blurring around foreground objects.\r
			vec2 step = texelSize * max(CoC, CoCNearFar.g * scale);\r
\r
		#else\r
\r
			vec2 step = texelSize * CoC;\r
\r
		#endif\r
\r
		#if PASS == 1\r
\r
			vec4 acc = vec4(0.0);\r
\r
			// Each vector contains two sampling points (64 in total).\r
			for(int i = 0; i < 32; ++i) {\r
\r
				vec4 kernel = kernel64[i];\r
\r
				vec2 uv = step * kernel.xy + vUv;\r
				acc += texture2D(inputBuffer, uv);\r
\r
				uv = step * kernel.zw + vUv;\r
				acc += texture2D(inputBuffer, uv);\r
\r
			}\r
\r
			gl_FragColor = acc / 64.0;\r
\r
		#else\r
\r
			vec4 maxValue = texture2D(inputBuffer, vUv);\r
\r
			// Each vector contains two sampling points (16 in total).\r
			for(int i = 0; i < 8; ++i) {\r
\r
				vec4 kernel = kernel16[i];\r
\r
				vec2 uv = step * kernel.xy + vUv;\r
				maxValue = max(texture2D(inputBuffer, uv), maxValue);\r
\r
				uv = step * kernel.zw + vUv;\r
				maxValue = max(texture2D(inputBuffer, uv), maxValue);\r
\r
\r
			}\r
\r
			gl_FragColor = maxValue;\r
\r
		#endif\r
\r
	}\r
\r
}\r
`,vertexShader:ho}),t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.scale}setScale(e){this.scale=e}generateKernel(){const e=new Float64Array(128),t=new Float64Array(32);let n=0,i=0;for(let s=0,a=Math.sqrt(80);s<80;++s){const c=2.39996323*s,h=Math.sqrt(s)/a,d=h*Math.cos(c),f=h*Math.sin(c);s%5==0?(t[i++]=d,t[i++]=f):(e[n++]=d,e[n++]=f)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}const Xt="srgb",np="srgb-linear",a_=Number(ie.replace(/\D+/g,""))>=152,NO=new Map([[ur,np],[mt,Xt]]),kO=new Map([[np,ur],[Xt,mt]]);function ta(l){return l===null?null:a_?l.outputColorSpace:NO.get(l.outputEncoding)}function Fi(l,e){l!==null&&(a_?l.colorSpace=e:l.encoding=kO.get(e))}function o_(l,e,t){return l*(e-t)-e}function Sg(l,e,t){return Math.min(Math.max((l+e)/(e-t),0),1)}class FO extends St{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ge(null),focusDistance:new Ge(0),focusRange:new Ge(0),cameraNear:new Ge(.3),cameraFar:new Ge(1e3)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <packing>\r
\r
#ifdef GL_FRAGMENT_PRECISION_HIGH\r
\r
	uniform highp sampler2D depthBuffer;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer;\r
\r
#endif\r
\r
uniform float focusDistance;\r
uniform float focusRange;\r
uniform float cameraNear;\r
uniform float cameraFar;\r
\r
varying vec2 vUv;\r
\r
float readDepth(const in vec2 uv) {\r
\r
	#if DEPTH_PACKING == 3201\r
\r
		return unpackRGBAToDepth(texture2D(depthBuffer, uv));\r
\r
	#else\r
\r
		return texture2D(depthBuffer, uv).r;\r
\r
	#endif\r
\r
}\r
\r
void main() {\r
\r
	float depth = readDepth(vUv);\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		float viewZ = perspectiveDepthToViewZ(depth, cameraNear, cameraFar);\r
		float linearDepth = viewZToOrthographicDepth(viewZ, cameraNear, cameraFar);\r
\r
	#else\r
\r
		float linearDepth = depth;\r
\r
	#endif\r
\r
	float signedDistance = linearDepth - focusDistance;\r
	float magnitude = smoothstep(0.0, focusRange, abs(signedDistance));\r
\r
	gl_FragColor.rg = magnitude * vec2(\r
		step(signedDistance, 0.0),\r
		step(0.0, signedDistance)\r
	);\r
\r
}\r
`,vertexShader:ho}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=hr){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-o_(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=Sg(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-o_(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=Sg(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Kt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}const wg=0,UO=1,zO=2,BO=3,jO=4,HO=5,GO=6,VO=7,WO=8,l_=9,XO=10,qO=11,YO=12,QO=13,ZO=14,KO=15,JO=16,$O=17,e5=18,t5=19,n5=20,i5=21,r5=22,c_=23,s5=24,a5=25,o5=26,l5=27,u_=28,c5=29,_g=30,u5=31,h5=32,d5=0,p5=1,Mg=1,h_=2,d_=0,du=1,Tg=2,Pt={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Eg=2,f5=3,m5=0,p_=1,g5=2,br={REINHARD:0,REINHARD2:1,REINHARD2_ADAPTIVE:2,OPTIMIZED_CINEON:3,ACES_FILMIC:4},v5=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])];class y5 extends St{constructor(e=new Ke){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ge(null),texelSize:new Ge(new Ke),scale:new Ge(1),kernel:new Ge(0)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
\r
void main() {\r
\r
	vec4 sum = texture2D(inputBuffer, vUv0); // Top left\r
	sum += texture2D(inputBuffer, vUv1); // Top right\r
	sum += texture2D(inputBuffer, vUv2); // Bottom right\r
	sum += texture2D(inputBuffer, vUv3); // Bottom left\r
	gl_FragColor = sum * 0.25; // Compute the average\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec4 texelSize; // XY = texel size, ZW = half texel size\r
uniform float kernel;\r
uniform float scale;\r
\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
\r
void main() {\r
\r
	vec2 uv = position.xy * 0.5 + 0.5;\r
	vec2 dUv = (texelSize.xy * vec2(kernel) + texelSize.zw) * scale;\r
\r
	vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\r
	vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\r
	vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\r
	vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`}),this.setTexelSize(e.x,e.y),this.kernelSize=Eg}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get kernelSequence(){return v5[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t,.5*e,.5*t)}setSize(e,t){const n=1/e,i=1/t;this.uniforms.texelSize.value.set(n,i,.5*n,.5*i)}}class f_ extends St{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ge(null),opacity:new Ge(1)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <dithering_pars_fragment>\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
uniform float opacity;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec4 texel = texture2D(inputBuffer, vUv);\r
	gl_FragColor = opacity * texel;\r
\r
	#include <encodings_fragment>\r
	#include <dithering_fragment>\r
\r
}\r
`,vertexShader:ho})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}}class x5 extends St{constructor(){super({name:"DepthMaskMaterial",defines:{DEPTH_EPSILON:"0.0001",DEPTH_PACKING_0:"0",DEPTH_PACKING_1:"0",DEPTH_TEST_STRATEGY:Mg},uniforms:{inputBuffer:new Ge(null),depthBuffer0:new Ge(null),depthBuffer1:new Ge(null),cameraNearFar:new Ge(new de(1,1))},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <packing>\r
\r
#ifdef GL_FRAGMENT_PRECISION_HIGH\r
\r
	uniform highp sampler2D depthBuffer0;\r
	uniform highp sampler2D depthBuffer1;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer0;\r
	uniform mediump sampler2D depthBuffer1;\r
\r
#endif\r
\r
uniform sampler2D inputBuffer;\r
uniform vec2 cameraNearFar;\r
\r
float getViewZ(const in float depth) {\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		return perspectiveDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\r
\r
	#else\r
\r
		return orthographicDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\r
\r
	#endif\r
\r
}\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec2 depth;\r
\r
	#if DEPTH_PACKING_0 == 3201\r
\r
		depth.x = unpackRGBAToDepth(texture2D(depthBuffer0, vUv));\r
\r
	#else\r
\r
		depth.x = texture2D(depthBuffer0, vUv).r;\r
\r
	#endif\r
\r
	#if DEPTH_PACKING_1 == 3201\r
\r
		depth.y = unpackRGBAToDepth(texture2D(depthBuffer1, vUv));\r
\r
	#else\r
\r
		depth.y = texture2D(depthBuffer1, vUv).r;\r
\r
	#endif\r
\r
	bool isMaxDepth = (depth.x == 1.0);\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		// Linearize.\r
		depth.x = viewZToOrthographicDepth(getViewZ(depth.x), cameraNearFar.x, cameraNearFar.y);\r
		depth.y = viewZToOrthographicDepth(getViewZ(depth.y), cameraNearFar.x, cameraNearFar.y);\r
\r
	#endif\r
\r
	#if DEPTH_TEST_STRATEGY == 0\r
\r
		// Decide based on depth test.\r
		bool keep = depthTest(depth.x, depth.y);\r
\r
	#elif DEPTH_TEST_STRATEGY == 1\r
\r
		// Always keep max depth.\r
		bool keep = isMaxDepth || depthTest(depth.x, depth.y);\r
\r
	#else\r
\r
		// Always discard max depth.\r
		bool keep = !isMaxDepth && depthTest(depth.x, depth.y);\r
\r
	#endif\r
\r
	if(keep) {\r
\r
		gl_FragColor = texture2D(inputBuffer, vUv);\r
\r
	} else {\r
\r
		discard;\r
\r
	}\r
\r
}\r
`,vertexShader:ho}),this.depthMode=vh}set depthBuffer0(e){this.uniforms.depthBuffer0.value=e}set depthPacking0(e){this.defines.DEPTH_PACKING_0=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer0(e,t=hr){this.depthBuffer0=e,this.depthPacking0=t}set depthBuffer1(e){this.uniforms.depthBuffer1.value=e}set depthPacking1(e){this.defines.DEPTH_PACKING_1=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer1(e,t=hr){this.depthBuffer1=e,this.depthPacking1=t}get maxDepthStrategy(){return Number(this.defines.DEPTH_TEST_STRATEGY)}set maxDepthStrategy(e){this.defines.DEPTH_TEST_STRATEGY=e.toFixed(0),this.needsUpdate=!0}get keepFar(){return this.maxDepthStrategy}set keepFar(e){this.maxDepthStrategy=e?Mg:h_}getMaxDepthStrategy(){return this.maxDepthStrategy}setMaxDepthStrategy(e){this.maxDepthStrategy=e}get epsilon(){return Number(this.defines.DEPTH_EPSILON)}set epsilon(e){this.defines.DEPTH_EPSILON=e.toFixed(16),this.needsUpdate=!0}getEpsilon(){return this.epsilon}setEpsilon(e){this.epsilon=e}get depthMode(){return Number(this.defines.DEPTH_MODE)}set depthMode(e){let t;switch(e){case Kf:t="false";break;case Jf:t="true";break;case vc:t="abs(d1 - d0) <= DEPTH_EPSILON";break;case yh:t="abs(d1 - d0) > DEPTH_EPSILON";break;case vh:t="d0 > d1";break;case gc:t="d0 >= d1";break;case $f:t="d0 <= d1";break;default:t="d0 < d1"}this.defines.DEPTH_MODE=e.toFixed(0),this.defines["depthTest(d0, d1)"]=t,this.needsUpdate=!0}getDepthMode(){return this.depthMode}setDepthMode(e){this.depthMode=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNearFar.value.set(e.near,e.far),e instanceof Kt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}class b5 extends St{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Ge(null),texelSize:new Ge(new de)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
// (1 / 4) * 0.5 = 0.125\r
#define WEIGHT_INNER 0.125\r
// (1 / 9) * 0.5 = 0.0555555\r
#define WEIGHT_OUTER 0.0555555\r
\r
varying vec2 vUv;\r
varying vec2 vUv00;\r
varying vec2 vUv01;\r
varying vec2 vUv02;\r
varying vec2 vUv03;\r
varying vec2 vUv04;\r
varying vec2 vUv05;\r
varying vec2 vUv06;\r
varying vec2 vUv07;\r
varying vec2 vUv08;\r
varying vec2 vUv09;\r
varying vec2 vUv10;\r
varying vec2 vUv11;\r
\r
float clampToBorder(const in vec2 uv) {\r
\r
	return float(uv.s >= 0.0 && uv.s <= 1.0 && uv.t >= 0.0 && uv.t <= 1.0);\r
\r
}\r
\r
void main() {\r
\r
	vec4 c = vec4(0.0);\r
\r
	vec4 w = WEIGHT_INNER * vec4(\r
		clampToBorder(vUv00),\r
		clampToBorder(vUv01),\r
		clampToBorder(vUv02),\r
		clampToBorder(vUv03)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv00);\r
	c += w.y * texture2D(inputBuffer, vUv01);\r
	c += w.z * texture2D(inputBuffer, vUv02);\r
	c += w.w * texture2D(inputBuffer, vUv03);\r
\r
	w = WEIGHT_OUTER * vec4(\r
		clampToBorder(vUv04),\r
		clampToBorder(vUv05),\r
		clampToBorder(vUv06),\r
		clampToBorder(vUv07)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv04);\r
	c += w.y * texture2D(inputBuffer, vUv05);\r
	c += w.z * texture2D(inputBuffer, vUv06);\r
	c += w.w * texture2D(inputBuffer, vUv07);\r
\r
	w = WEIGHT_OUTER * vec4(\r
		clampToBorder(vUv08),\r
		clampToBorder(vUv09),\r
		clampToBorder(vUv10),\r
		clampToBorder(vUv11)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv08);\r
	c += w.y * texture2D(inputBuffer, vUv09);\r
	c += w.z * texture2D(inputBuffer, vUv10);\r
	c += w.w * texture2D(inputBuffer, vUv11);\r
\r
	c += WEIGHT_OUTER * texture2D(inputBuffer, vUv);\r
	gl_FragColor = c;\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec2 texelSize;\r
\r
varying vec2 vUv;\r
varying vec2 vUv00;\r
varying vec2 vUv01;\r
varying vec2 vUv02;\r
varying vec2 vUv03;\r
varying vec2 vUv04;\r
varying vec2 vUv05;\r
varying vec2 vUv06;\r
varying vec2 vUv07;\r
varying vec2 vUv08;\r
varying vec2 vUv09;\r
varying vec2 vUv10;\r
varying vec2 vUv11;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	vUv00 = vUv + texelSize * vec2(-1.0, 1.0);\r
	vUv01 = vUv + texelSize * vec2(1.0, 1.0);\r
	vUv02 = vUv + texelSize * vec2(-1.0, -1.0);\r
	vUv03 = vUv + texelSize * vec2(1.0, -1.0);\r
\r
	vUv04 = vUv + texelSize * vec2(-2.0, 2.0);\r
	vUv05 = vUv + texelSize * vec2(0.0, 2.0);\r
	vUv06 = vUv + texelSize * vec2(2.0, 2.0);\r
	vUv07 = vUv + texelSize * vec2(-2.0, 0.0);\r
	vUv08 = vUv + texelSize * vec2(2.0, 0.0);\r
	vUv09 = vUv + texelSize * vec2(-2.0, -2.0);\r
	vUv10 = vUv + texelSize * vec2(0.0, -2.0);\r
	vUv11 = vUv + texelSize * vec2(2.0, -2.0);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}class S5 extends St{constructor(e,t,n,i,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:ie.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ge(null),depthBuffer:new Ge(null),resolution:new Ge(new de),texelSize:new Ge(new de),cameraNear:new Ge(.3),cameraFar:new Ge(1e3),aspect:new Ge(1),time:new Ge(0)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:s}),e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=hr){this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){return this.fragmentShader=`#include <common>\r
#include <packing>\r
#include <dithering_pars_fragment>\r
\r
#define packFloatToRGBA(v) packDepthToRGBA(v)\r
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#if DEPTH_PACKING == 3201\r
\r
	uniform lowp sampler2D depthBuffer;\r
\r
#elif defined(GL_FRAGMENT_PRECISION_HIGH)\r
\r
	uniform highp sampler2D depthBuffer;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer;\r
\r
#endif\r
\r
uniform vec2 resolution;\r
uniform vec2 texelSize;\r
\r
uniform float cameraNear;\r
uniform float cameraFar;\r
uniform float aspect;\r
uniform float time;\r
\r
varying vec2 vUv;\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#if THREE_REVISION >= 137\r
\r
	vec4 sRGBToLinear(const in vec4 value) {\r
\r
		return vec4(mix(\r
			pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)),\r
			value.rgb * 0.0773993808,\r
			vec3(lessThanEqual(value.rgb, vec3(0.04045)))\r
		), value.a);\r
\r
	}\r
\r
#endif\r
\r
float readDepth(const in vec2 uv) {\r
\r
	#if DEPTH_PACKING == 3201\r
\r
		return unpackRGBAToDepth(texture2D(depthBuffer, uv));\r
\r
	#else\r
\r
		return texture2D(depthBuffer, uv).r;\r
\r
	#endif\r
\r
}\r
\r
float getViewZ(const in float depth) {\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		return perspectiveDepthToViewZ(depth, cameraNear, cameraFar);\r
\r
	#else\r
\r
		return orthographicDepthToViewZ(depth, cameraNear, cameraFar);\r
\r
	#endif\r
\r
}\r
\r
/**\r
 * Based on work by Sam Hocevar, Emil Persson and Ian Taylor.\r
 * https://www.chilliant.com/rgb2hsv.html\r
 */\r
\r
vec3 RGBToHCV(const in vec3 RGB) {\r
\r
	vec4 P = mix(vec4(RGB.bg, -1.0, 2.0 / 3.0), vec4(RGB.gb, 0.0, -1.0 / 3.0), step(RGB.b, RGB.g));\r
	vec4 Q = mix(vec4(P.xyw, RGB.r), vec4(RGB.r, P.yzx), step(P.x, RGB.r));\r
	float C = Q.x - min(Q.w, Q.y);\r
	float H = abs((Q.w - Q.y) / (6.0 * C + EPSILON) + Q.z);\r
	return vec3(H, C, Q.x);\r
\r
}\r
\r
vec3 RGBToHSL(const in vec3 RGB) {\r
\r
	vec3 HCV = RGBToHCV(RGB);\r
	float L = HCV.z - HCV.y * 0.5;\r
	float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + EPSILON);\r
	return vec3(HCV.x, S, L);\r
\r
}\r
\r
vec3 HueToRGB(const in float H) {\r
\r
	float R = abs(H * 6.0 - 3.0) - 1.0;\r
	float G = 2.0 - abs(H * 6.0 - 2.0);\r
	float B = 2.0 - abs(H * 6.0 - 4.0);\r
	return clamp(vec3(R, G, B), 0.0, 1.0);\r
\r
}\r
\r
vec3 HSLToRGB(const in vec3 HSL) {\r
\r
	vec3 RGB = HueToRGB(HSL.x);\r
	float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\r
	return (RGB - 0.5) * C + HSL.z;\r
\r
}\r
\r
FRAGMENT_HEAD\r
\r
void main() {\r
\r
	FRAGMENT_MAIN_UV\r
\r
	vec4 color0 = texture2D(inputBuffer, UV);\r
	vec4 color1 = vec4(0.0);\r
\r
	FRAGMENT_MAIN_IMAGE\r
\r
	gl_FragColor = color0;\r
\r
	#ifdef ENCODE_OUTPUT\r
\r
		#include <encodings_fragment>\r
\r
	#endif\r
\r
	#include <dithering_fragment>\r
\r
}\r
`.replace(Pt.FRAGMENT_HEAD,e.get(Pt.FRAGMENT_HEAD)||"").replace(Pt.FRAGMENT_MAIN_UV,e.get(Pt.FRAGMENT_MAIN_UV)||"").replace(Pt.FRAGMENT_MAIN_IMAGE,e.get(Pt.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=`uniform vec2 resolution;\r
uniform vec2 texelSize;\r
\r
uniform float cameraNear;\r
uniform float cameraFar;\r
uniform float aspect;\r
uniform float time;\r
\r
varying vec2 vUv;\r
\r
VERTEX_HEAD\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	VERTEX_MAIN_SUPPORT\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`.replace(Pt.VERTEX_HEAD,e.get(Pt.VERTEX_HEAD)||"").replace(Pt.VERTEX_MAIN_SUPPORT,e.get(Pt.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Kt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return Pt}}class w5 extends St{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:ie.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ge(null),threshold:new Ge(0),smoothing:new Ge(1),range:new Ge(null)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#ifdef RANGE\r
\r
	uniform vec2 range;\r
\r
#elif defined(THRESHOLD)\r
\r
	uniform float threshold;\r
	uniform float smoothing;\r
\r
#endif\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec4 texel = texture2D(inputBuffer, vUv);\r
	float l = luminance(texel.rgb);\r
\r
	#ifdef RANGE\r
\r
		// Apply a luminance range mask.\r
		float low = step(range.x, l);\r
		float high = step(l, range.y);\r
\r
		l *= low * high;\r
\r
	#elif defined(THRESHOLD)\r
\r
		l = smoothstep(threshold, threshold + smoothing, l);\r
\r
	#endif\r
\r
	#ifdef COLOR\r
\r
		gl_FragColor = vec4(texel.rgb * l, l);\r
\r
	#else\r
\r
		gl_FragColor = vec4(l);\r
\r
	#endif\r
\r
}\r
`,vertexShader:ho}),this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}}class _5 extends St{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Ge(e),inputBuffer:new Ge(null),strength:new Ge(1)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#ifdef MASK_PRECISION_HIGH\r
\r
	uniform mediump sampler2D maskTexture;\r
\r
#else\r
\r
	uniform lowp sampler2D maskTexture;\r
\r
#endif\r
\r
#if MASK_FUNCTION != 0\r
\r
	uniform float strength;\r
\r
#endif\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	#if COLOR_CHANNEL == 0\r
\r
		float mask = texture2D(maskTexture, vUv).r;\r
\r
	#elif COLOR_CHANNEL == 1\r
\r
		float mask = texture2D(maskTexture, vUv).g;\r
\r
	#elif COLOR_CHANNEL == 2\r
\r
		float mask = texture2D(maskTexture, vUv).b;\r
\r
	#else\r
\r
		float mask = texture2D(maskTexture, vUv).a;\r
\r
	#endif\r
\r
	#if MASK_FUNCTION == 0\r
\r
		#ifdef INVERTED\r
\r
			// (mask > 0.0) ? 0.0 : 1.0;\r
			mask = step(mask, 0.0);\r
\r
		#else\r
\r
			// (mask > 0.0) ? 1.0 : 0.0;\r
			mask = 1.0 - step(mask, 0.0);\r
\r
		#endif\r
\r
	#else\r
\r
		mask = clamp(mask * strength, 0.0, 1.0);\r
\r
		#ifdef INVERTED\r
\r
			mask = 1.0 - mask;\r
\r
		#endif\r
\r
	#endif\r
\r
	#if MASK_FUNCTION == 2\r
\r
		// MULTIPLY_RGB_SET_ALPHA\r
		gl_FragColor = vec4(mask * texture2D(inputBuffer, vUv).rgb, mask);\r
\r
	#else\r
\r
		// DISCARD / MULTIPLY\r
		gl_FragColor = mask * texture2D(inputBuffer, vUv);\r
\r
	#endif\r
\r
}\r
`,vertexShader:ho}),this.colorChannel=d5,this.maskFunction=m5}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Sn&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}}class M5 extends St{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Ge(null),supportBuffer:new Ge(null),texelSize:new Ge(new de),radius:new Ge(.85)},blending:Be,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
	uniform mediump sampler2D supportBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
	uniform lowp sampler2D supportBuffer;\r
\r
#endif\r
\r
uniform float radius;\r
\r
varying vec2 vUv;\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
varying vec2 vUv4;\r
varying vec2 vUv5;\r
varying vec2 vUv6;\r
varying vec2 vUv7;\r
\r
void main() {\r
\r
	vec4 c = vec4(0.0);\r
\r
	c += texture2D(inputBuffer, vUv0) * 0.0625;\r
	c += texture2D(inputBuffer, vUv1) * 0.125;\r
	c += texture2D(inputBuffer, vUv2) * 0.0625;\r
	c += texture2D(inputBuffer, vUv3) * 0.125;\r
	c += texture2D(inputBuffer, vUv) * 0.25;\r
	c += texture2D(inputBuffer, vUv4) * 0.125;\r
	c += texture2D(inputBuffer, vUv5) * 0.0625;\r
	c += texture2D(inputBuffer, vUv6) * 0.125;\r
	c += texture2D(inputBuffer, vUv7) * 0.0625;\r
\r
	vec4 baseColor = texture2D(supportBuffer, vUv);\r
	gl_FragColor = mix(baseColor, c, radius);\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec2 texelSize;\r
\r
varying vec2 vUv;\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
varying vec2 vUv4;\r
varying vec2 vUv5;\r
varying vec2 vUv6;\r
varying vec2 vUv7;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	vUv0 = vUv + texelSize * vec2(-1.0, 1.0);\r
	vUv1 = vUv + texelSize * vec2(0.0, 1.0);\r
	vUv2 = vUv + texelSize * vec2(1.0, 1.0);\r
	vUv3 = vUv + texelSize * vec2(-1.0, 0.0);\r
\r
	vUv4 = vUv + texelSize * vec2(1.0, 0.0);\r
	vUv5 = vUv + texelSize * vec2(-1.0, -1.0);\r
	vUv6 = vUv + texelSize * vec2(0.0, -1.0);\r
	vUv7 = vUv + texelSize * vec2(1.0, -1.0);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}set supportBuffer(e){this.uniforms.supportBuffer.value=e}get radius(){return this.uniforms.radius.value}set radius(e){this.uniforms.radius.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}const T5=new el;let na=null;class On{constructor(e="Pass",t=new ja,n=T5){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new et(function(){if(na===null){const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),i=new Float32Array([0,0,2,0,0,2]);na=new $e,na.setAttribute!==void 0?(na.setAttribute("position",new tt(n,3)),na.setAttribute("uv",new tt(i,2))):(na.addAttribute("position",new tt(n,3)),na.addAttribute("uv",new tt(i,2)))}return na}(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new ja),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=hr){}render(e,t,n,i,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Lt||t instanceof un||t instanceof zt||t instanceof On)&&this[e].dispose()}}}class m_ extends On{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new f_,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Lt(1,1,{minFilter:at,magFilter:at,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,i,s){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Sn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":ta(e)===Xt&&Fi(this.renderTarget.texture,Xt))}}class E5 extends On{constructor(e,{minLuminance:t=.01,adaptationRate:n=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new IO,this.needsSwap=!1,this.renderTargetPrevious=new Lt(1,1,{minFilter:Rt,magFilter:Rt,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const i=this.fullscreenMaterial;i.luminanceBuffer0=this.renderTargetPrevious.texture,i.luminanceBuffer1=e,i.minLuminance=t,i.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new m_(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,i,s){this.fullscreenMaterial.deltaTime=i,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}}class A5 extends On{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,i,s){const a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}}const g_=new Ie;class Ag extends On{constructor(e=!0,t=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,i,s){const a=this.overrideClearColor,c=this.overrideClearAlpha,h=e.getClearAlpha(),d=a!==null,f=c>=0;d?(e.getClearColor(g_),e.setClearColor(a,f?c:h)):f&&e.setClearAlpha(c),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),d?e.setClearColor(g_,h):f&&e.setClearAlpha(h)}}const Nl=-1;class Jn extends Xi{constructor(e,t=-1,n=-1,i=1){super(),this.resizable=e,this.baseSize=new de(1,1),this.preferredSize=new de(t,n),this.target=this.preferredSize,this.s=i,this.effectiveSize=new de,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,n=this.effectiveSize,i=this.scale;t.width!==Nl?n.width=t.width:t.height!==Nl?n.width=Math.round(t.height*(e.width/Math.max(e.height,1))):n.width=Math.round(e.width*i),t.height!==Nl?n.height=t.height:t.width!==Nl?n.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n.height=Math.round(e.height*i)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar(Nl),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){this.baseSize.width===e&&this.baseSize.height===t||(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){this.preferredSize.width===e&&this.preferredSize.height===t||(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Nl}}let Rg=!1;class v_{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let n;if(t.material.flatShading)switch(t.material.side){case Me:n=this.materialsFlatShadedDoubleSide;break;case ye:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded}else switch(t.material.side){case Me:n=this.materialsDoubleSide;break;case ye:n=this.materialsBackSide;break;default:n=this.materials}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=n[2]:t.isInstancedMesh?t.material=n[1]:t.material=n[0],++this.meshCount}}}cloneMaterial(e){if(!(e instanceof St))return e.clone();const t=e.uniforms,n=new Map;for(const s in t){const a=t[s].value;a.isRenderTargetTexture&&(t[s].value=null,n.set(s,a))}const i=e.clone();for(const s of n)t[s[0]].value=s[1],i.uniforms[s[0]].value=s[1];return i}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){const t=this.materials=[this.cloneMaterial(e),this.cloneMaterial(e),this.cloneMaterial(e)];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=se;t[2].skinning=!0,this.materialsBackSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.side=ye,i}),this.materialsDoubleSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.side=Me,i}),this.materialsFlatShaded=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=ye,i}),this.materialsFlatShadedDoubleSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=Me,i})}}render(e,t,n){const i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Rg){const s=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const a of s)a[0].material=a[1];this.meshCount!==s.size&&s.clear()}else{const s=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=s}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Rg}static set workaroundEnabled(e){Rg=e}}class y_ extends On{constructor(e,t,n=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Ag,this.overrideMaterialManager=n===null?null:new v_(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new v_(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,i,s){const a=this.scene,c=this.camera,h=this.selection,d=c.layers.mask,f=a.background,m=e.shadowMap.autoUpdate,g=this.renderToScreen?null:t;h!==null&&c.layers.set(h.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(g),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,a,c):e.render(a,c),c.layers.mask=d,a.background=f,e.shadowMap.autoUpdate=m}}class R5 extends On{constructor(e,t,{renderTarget:n,resolutionScale:i=1,width:s=Jn.AUTO_SIZE,height:a=Jn.AUTO_SIZE,resolutionX:c=s,resolutionY:h=a}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new y_(e,t,new td({depthPacking:Lh}));const d=this.renderPass;d.skipShadowMapUpdate=!0,d.ignoreBackground=!0;const f=d.getClearPass();f.overrideClearColor=new Ie(16777215),f.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Lt(1,1,{minFilter:Rt,magFilter:Rt}),this.renderTarget.texture.name="DepthPass.Target");const m=this.resolution=new Jn(this,c,h,i);m.addEventListener("change",g=>this.setSize(m.baseWidth,m.baseHeight))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,s){const a=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,a)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}}function x_(l,e,t){for(const n of e){const i="$1"+l+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(s,i))}}function L5(l,e,t){let n=e.getFragmentShader(),i=e.getVertexShader();const s=n!==void 0&&/mainImage/.test(n),a=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&t.attributes&Tg)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const c=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,h=t.shaderParts;let d=h.get(Pt.FRAGMENT_HEAD)||"",f=h.get(Pt.FRAGMENT_MAIN_UV)||"",m=h.get(Pt.FRAGMENT_MAIN_IMAGE)||"",g=h.get(Pt.VERTEX_HEAD)||"",y=h.get(Pt.VERTEX_MAIN_SUPPORT)||"";const S=new Set,x=new Set;if(a&&(f+=`	${l}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const _=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);y+=`	${l}MainSupport(`,y+=_?`vUv);
`:`);
`;for(const E of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const R of E[1].split(/\s*,\s*/))t.varyings.add(R),S.add(R),x.add(R);for(const E of i.matchAll(c))x.add(E[1])}for(const _ of n.matchAll(c))x.add(_[1]);for(const _ of e.defines.keys())x.add(_.replace(/\([\w\s,]*\)/g,""));for(const _ of e.uniforms.keys())x.add(_);x.delete("while"),x.delete("for"),x.delete("if"),e.uniforms.forEach((_,E)=>t.uniforms.set(l+E.charAt(0).toUpperCase()+E.slice(1),_)),e.defines.forEach((_,E)=>t.defines.set(l+E.charAt(0).toUpperCase()+E.slice(1),_));const w=new Map([["fragment",n],["vertex",i]]);x_(l,x,t.defines),x_(l,x,w),n=w.get("fragment"),i=w.get("vertex");const T=e.blendMode;if(t.blendModes.set(T.blendFunction,T),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(m+=e.inputColorSpace===Xt?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==""?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const _=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;m+=`${l}MainImage(color0, UV, `,t.attributes&du&&_.test(n)&&(m+="depth, ",t.readDepth=!0),m+=`color1);
	`;const E=l+"BlendOpacity";t.uniforms.set(E,T.opacity),m+=`color0 = blend${T.blendFunction}(color0, color1, ${E});

	`,d+=`uniform float ${E};

`}if(d+=n+`
`,i!==null&&(g+=i+`
`),h.set(Pt.FRAGMENT_HEAD,d),h.set(Pt.FRAGMENT_MAIN_UV,f),h.set(Pt.FRAGMENT_MAIN_IMAGE,m),h.set(Pt.VERTEX_HEAD,g),h.set(Pt.VERTEX_MAIN_SUPPORT,y),e.extensions!==null)for(const _ of e.extensions)t.extensions.add(_)}}class P5 extends On{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new S5(null,null,null,e),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(t),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort((t,n)=>n.attributes-t.attributes);for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new N5;let t=0;for(const c of this.effects)if(c.blendMode.blendFunction===l_)e.attributes|=c.getAttributes()&du;else{if(e.attributes&c.getAttributes()&Tg)throw new Error(`Convolution effects cannot be merged (${c.name})`);L5("e"+t++,c,e)}let n=e.shaderParts.get(Pt.FRAGMENT_HEAD),i=e.shaderParts.get(Pt.FRAGMENT_MAIN_IMAGE),s=e.shaderParts.get(Pt.FRAGMENT_MAIN_UV);const a=/\bblend\b/g;for(const c of e.blendModes.values())n+=c.getShaderCode().replace(a,`blend${c.blendFunction}`)+`
`;e.attributes&du?(e.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,e.colorSpace===Xt&&(i+=`color0 = sRGBToLinear(color0);
	`),e.uvTransformation?(s=`vec2 transformedUv = vUv;
`+s,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(Pt.FRAGMENT_HEAD,n),e.shaderParts.set(Pt.FRAGMENT_MAIN_IMAGE,i),e.shaderParts.set(Pt.FRAGMENT_MAIN_UV,s);for(const[c,h]of e.shaderParts)h!==null&&e.shaderParts.set(c,h.trim().replace(/^#/,`
#`));this.skipRendering=t===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=hr){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,i,s){for(const a of this.effects)a.update(e,t,i);if(!this.skipRendering||this.renderToScreen){const a=this.fullscreenMaterial;a.inputBuffer=t.texture,a.time+=i*this.timeScale,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const i of this.effects)i.initialize(e,t,n);this.updateMaterial(),n!==void 0&&n!==Sn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){e.type==="change"&&this.recompile()}}class b_ extends On{constructor({kernelSize:e=Eg,resolutionScale:t=.5,width:n=Jn.AUTO_SIZE,height:i=Jn.AUTO_SIZE,resolutionX:s=n,resolutionY:a=i}={}){super("KawaseBlurPass"),this.renderTargetA=new Lt(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const c=this.resolution=new Jn(this,s,a,t);c.addEventListener("change",h=>this.setSize(c.baseWidth,c.baseHeight)),this._blurMaterial=new y5,this._blurMaterial.kernelSize=e,this.copyMaterial=new f_}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(e){this._blurMaterial=e}get dithering(){return this.copyMaterial.dithering}set dithering(e){this.copyMaterial.dithering=e}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(e){this.blurMaterial.kernelSize=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,s){const a=this.scene,c=this.camera,h=this.renderTargetA,d=this.renderTargetB,f=this.blurMaterial,m=f.kernelSequence;let g=t;this.fullscreenMaterial=f;for(let y=0,S=m.length;y<S;++y){const x=1&y?d:h;f.kernel=m[y],f.inputBuffer=g.texture,e.setRenderTarget(x),e.render(a,c),g=x}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=g.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(a,c)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const i=n.width,s=n.height;this.renderTargetA.setSize(i,s),this.renderTargetB.setSize(i,s),this.blurMaterial.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==Sn?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):ta(e)===Xt&&(Fi(this.renderTargetA.texture,Xt),Fi(this.renderTargetB.texture,Xt)))}static get AUTO_SIZE(){return Jn.AUTO_SIZE}}class S_ extends On{constructor({renderTarget:e,luminanceRange:t,colorOutput:n,resolutionScale:i=1,width:s=Jn.AUTO_SIZE,height:a=Jn.AUTO_SIZE,resolutionX:c=s,resolutionY:h=a}={}){super("LuminancePass"),this.fullscreenMaterial=new w5(n,t),this.needsSwap=!1,this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new Lt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const d=this.resolution=new Jn(this,c,h,i);d.addEventListener("change",f=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,i,s){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){n!==void 0&&n!==Sn&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}class C5 extends On{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Ag(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,i,s){const a=e.getContext(),c=e.state.buffers,h=this.scene,d=this.camera,f=this.clearPass,m=this.inverted?0:1,g=1-m;c.color.setMask(!1),c.depth.setMask(!1),c.color.setLocked(!0),c.depth.setLocked(!0),c.stencil.setTest(!0),c.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),c.stencil.setFunc(a.ALWAYS,m,4294967295),c.stencil.setClear(g),c.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?f.render(e,null):(f.render(e,t),f.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(h,d)):(e.setRenderTarget(t),e.render(h,d),e.setRenderTarget(n),e.render(h,d)),c.color.setLocked(!1),c.depth.setLocked(!1),c.stencil.setLocked(!1),c.stencil.setFunc(a.EQUAL,1,4294967295),c.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),c.stencil.setLocked(!0)}}class D5 extends On{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Lt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new b5,this.upsamplingMaterial=new M5,this.resolution=new de}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(e){if(this.levels!==e){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<e;++n){const i=t.clone();i.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(i)}this.upsamplingMipmaps.push(t);for(let n=1,i=e-1;n<i;++n){const s=t.clone();s.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(s)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(e){this.upsamplingMaterial.radius=e}render(e,t,n,i,s){const{scene:a,camera:c}=this,{downsamplingMaterial:h,upsamplingMaterial:d}=this,{downsamplingMipmaps:f,upsamplingMipmaps:m}=this;let g=t;this.fullscreenMaterial=h;for(let y=0,S=f.length;y<S;++y){const x=f[y];h.setSize(g.width,g.height),h.inputBuffer=g.texture,e.setRenderTarget(x),e.render(a,c),g=x}this.fullscreenMaterial=d;for(let y=m.length-1;y>=0;--y){const S=m[y];d.setSize(g.width,g.height),d.inputBuffer=g.texture,d.supportBuffer=f[y].texture,e.setRenderTarget(S),e.render(a,c),g=S}}setSize(e,t){const n=this.resolution;n.set(e,t);let i=n.width,s=n.height;for(let a=0,c=this.downsamplingMipmaps.length;a<c;++a)i=Math.round(.5*i),s=Math.round(.5*s),this.downsamplingMipmaps[a].setSize(i,s),a<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[a].setSize(i,s)}initialize(e,t,n){if(n!==void 0){const i=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const s of i)s.texture.type=n;if(n!==Sn)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(ta(e)===Xt)for(const s of i)Fi(s.texture,Xt)}}dispose(){super.dispose();for(const e of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))e.dispose()}}class ia extends On{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.input=t}setInput(e){this.input=e}render(e,t,n,i,s){const a=this.fullscreenMaterial.uniforms;t!==null&&a!==void 0&&a[this.input]!==void 0&&(a[this.input].value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){n!==void 0&&n!==Sn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}const Lg=.001;class O5{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*Lg}get fixedDelta(){return this._fixedDelta*Lg}set fixedDelta(e){this._fixedDelta=1e3*e}get elapsed(){return this._elapsed*Lg}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(e!==void 0?e:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(e){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}}class I5{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,s,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new m_,this.depthTexture=null,this.passes=[],this.timer=new O5,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new de),n=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Sn&&ta(e)===Xt&&(Fi(this.inputBuffer.texture,Xt),Fi(this.outputBuffer.texture,Xt),this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const s of this.passes)s.initialize(e,n,i)}}replaceRenderer(e,t=!0){const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(n.domElement),i.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new Uc;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Ns,e.type=es):e.type=$r,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,i){const s=this.renderer,a=s===null?new de:s.getDrawingBufferSize(new de),c={minFilter:at,magFilter:at,stencilBuffer:t,depthBuffer:e,type:n},h=new Lt(a.width,a.height,c);return i>0&&(h.ignoreDepthForMultisampleCopy=!1,h.samples=i),n===Sn&&ta(s)===Xt&&Fi(h.texture,Xt),h.texture.name="EffectComposer.Buffer",h.texture.generateMipmaps=!1,h}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,i=this.renderer,s=i.getDrawingBufferSize(new de),a=i.getContext().getContextAttributes().alpha,c=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(s.width,s.height),e.initialize(i,a,c),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const h=this.createDepthTexture();for(e of n)e.setDepthTexture(h)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const i=(s,a)=>s||a.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let i,s,a,c=this.inputBuffer,h=this.outputBuffer,d=!1;e===void 0&&(this.timer.update(),e=this.timer.delta);let f=null;for(let m=this.passes.length;m--;)if(this.passes[m].enabled){f=this.passes[m];break}for(const m of this.passes)m.enabled&&(this.autoRenderToScreen&&(m.renderToScreen=m===f),m.render(t,c,h,e,d),m.needsSwap&&(d&&(n.renderToScreen=m.renderToScreen,i=t.getContext(),s=t.state.buffers.stencil,s.setFunc(i.NOTEQUAL,1,4294967295),n.render(t,c,h,e,d),s.setFunc(i.EQUAL,1,4294967295)),a=c,c=h,h=a),m instanceof C5?d=!0:m instanceof A5&&(d=!1))}setSize(e,t,n){const i=this.renderer,s=i.getSize(new de);e!==void 0&&t!==void 0||(e=s.width,t=s.height),s.width===e&&s.height===t||i.setSize(e,t,n);const a=i.getDrawingBufferSize(new de);this.inputBuffer.setSize(a.width,a.height),this.outputBuffer.setSize(a.width,a.height);for(const c of this.passes)c.setSize(a.width,a.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}}class N5{constructor(){this.shaderParts=new Map([[Pt.FRAGMENT_HEAD,null],[Pt.FRAGMENT_MAIN_UV,null],[Pt.FRAGMENT_MAIN_IMAGE,null],[Pt.VERTEX_HEAD,null],[Pt.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=d_,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=np}}class k5 extends Set{constructor(e,t=10){super(),this.l=t,this.exclusive=!1,e!==void 0&&this.set(e)}get layer(){return this.l}set layer(e){const t=this.l;for(const n of this)n.layers.disable(t),n.layers.enable(e);this.l=e}getLayer(){return this.layer}setLayer(e){this.layer=e}isExclusive(){return this.exclusive}setExclusive(e){this.exclusive=e}clear(){const e=this.layer;for(const t of this)t.layers.disable(e);return super.clear()}set(e){this.clear();for(const t of e)this.add(t);return this}indexOf(e){return this.has(e)?0:-1}add(e){return this.exclusive?e.layers.set(this.layer):e.layers.enable(this.layer),super.add(e)}delete(e){return this.has(e)&&e.layers.disable(this.layer),super.delete(e)}toggle(e){let t;return this.has(e)?(this.delete(e),t=!1):(this.add(e),t=!0),t}setVisible(e){for(const t of this)e?t.layers.enable(0):t.layers.disable(0);return this}}const F5=new Map([[wg,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x + y, opacity);\r
\r
}\r
`],[UO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y, min(y.a, opacity));\r
\r
}\r
`],[zO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, (x + y) * 0.5, opacity);\r
\r
}\r
`],[BO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(yHSL.rg, xHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[jO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(step(0.0, y) * (1.0 - min(vec4(1.0), (1.0 - x) / y)), vec4(1.0), step(1.0, x));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[HO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = step(0.0, x) * mix(min(vec4(1.0), x / max(1.0 - y, 1e-9)), vec4(1.0), step(1.0, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[GO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, min(x, y), opacity);\r
\r
}\r
`],[VO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, abs(x - y), opacity);\r
\r
}\r
`],[WO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x / max(y, 1e-12), opacity);\r
\r
}\r
`],[l_,null],[XO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, (x + y - 2.0 * x * y), opacity);\r
\r
}\r
`],[qO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 a = min(x, 1.0), b = min(y, 1.0);\r
	vec4 z = mix(2.0 * a * b, 1.0 - 2.0 * (1.0 - a) * (1.0 - b), step(0.5, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[YO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, step(1.0, x + y), opacity);\r
\r
}\r
`],[QO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(yHSL.r, xHSL.gb));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[ZO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, 1.0 - y, opacity);\r
\r
}\r
`],[KO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y * (1.0 - x), opacity);\r
\r
}\r
`],[JO,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, max(x, y), opacity);\r
\r
}\r
`],[$O,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, clamp(y + x - 1.0, 0.0, 1.0), opacity);\r
\r
}\r
`],[e5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, min(x + y, 1.0), opacity);\r
\r
}\r
`],[t5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, clamp(2.0 * y + x - 1.0, 0.0, 1.0), opacity);\r
\r
}\r
`],[n5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(xHSL.rg, yHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[i5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x * y, opacity);\r
\r
}\r
`],[r5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, 1.0 - abs(1.0 - x - y), opacity);\r
\r
}\r
`],[c_,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y, opacity);\r
\r
}\r
`],[s5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(2.0 * y * x, 1.0 - 2.0 * (1.0 - y) * (1.0 - x), step(0.5, x));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[a5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 y2 = 2.0 * y;\r
\r
	vec4 z = mix(\r
		mix(y2, x, step(0.5 * x, y)),\r
		max(vec4(0.0), y2 - 1.0), \r
		step(x, (y2 - 1.0))\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`],[o5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(min(x * x / max(1.0 - y, 1e-12), 1.0), y, step(1.0, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[l5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(xHSL.r, yHSL.g, xHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[u_,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x + y - min(x * y, 1.0), opacity);\r
\r
}\r
`],[c5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 y2 = 2.0 * y;\r
	vec4 w = step(0.5, y);\r
\r
	vec4 z = mix(\r
		x - (1.0 - y2) * x * (1.0 - x), \r
		mix(\r
			x + (y2 - 1.0) * (sqrt(x) - x),\r
			x + (y2 - 1.0) * x * ((16.0 * x - 12.0) * x + 3.0),\r
			w * (1.0 - step(0.25, x))\r
		),\r
		w\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`],[_g,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return y;\r
\r
}\r
`],[u5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, max(x + y - 1.0, 0.0), opacity);\r
\r
}\r
`],[h5,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(\r
		max(1.0 - min((1.0 - x) / (2.0 * y), 1.0), 0.0),\r
		min(x / (2.0 * (1.0 - y)), 1.0),\r
		step(0.5, y)\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`]]);class U5 extends Xi{constructor(e,t=1){super(),this._blendFunction=e,this.opacity=new Ge(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return F5.get(this.blendFunction)}}class kl extends Xi{constructor(e,t,{attributes:n=d_,blendFunction:i=c_,defines:s=new Map,uniforms:a=new Map,extensions:c=null,vertexShader:h=null}={}){super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=h,this.defines=s,this.uniforms=a,this.extensions=c,this.blendMode=new U5(i),this.blendMode.addEventListener("change",d=>this.setChanged()),this._inputColorSpace=np,this._outputColorSpace=""}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=hr){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Lt||t instanceof un||t instanceof zt||t instanceof On)&&this[e].dispose()}}}class w_ extends kl{constructor({blendFunction:e=u_,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,mipmapBlur:i=!1,intensity:s=1,radius:a=.85,levels:c=8,kernelSize:h=f5,resolutionScale:d=.5,width:f=Jn.AUTO_SIZE,height:m=Jn.AUTO_SIZE,resolutionX:g=f,resolutionY:y=m}={}){super("BloomEffect",`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D map;\r
\r
#else\r
\r
	uniform lowp sampler2D map;\r
\r
#endif\r
\r
uniform float intensity;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	outputColor = texture2D(map, uv) * intensity;\r
\r
}\r
`,{blendFunction:e,uniforms:new Map([["map",new Ge(null)],["intensity",new Ge(s)]])}),this.renderTarget=new Lt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new b_({kernelSize:h}),this.luminancePass=new S_({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new D5,this.mipmapBlurPass.enabled=i,this.mipmapBlurPass.radius=a,this.mipmapBlurPass.levels=c,this.uniforms.get("map").value=i?this.mipmapBlurPass.texture:this.renderTarget.texture;const S=this.resolution=new Jn(this,g,y,d);S.addEventListener("change",x=>this.setSize(S.baseWidth,S.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){const i=this.renderTarget,s=this.luminancePass;s.enabled?(s.render(e,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,s.renderTarget):this.blurPass.render(e,s.renderTarget,i)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,t):this.blurPass.render(e,t,i)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(e,t),this.mipmapBlurPass.setSize(e,t)}initialize(e,t,n){this.blurPass.initialize(e,t,n),this.luminancePass.initialize(e,t,n),this.mipmapBlurPass.initialize(e,t,n),n!==void 0&&(this.renderTarget.texture.type=n,ta(e)===Xt&&Fi(this.renderTarget.texture,Xt))}}class z5 extends kl{constructor({offset:e=new de(.001,5e-4),radialModulation:t=!1,modulationOffset:n=.15}={}){super("ChromaticAberrationEffect",`#ifdef RADIAL_MODULATION\r
\r
	uniform float modulationOffset;\r
\r
#endif\r
\r
varying float vActive;\r
varying vec2 vUvR;\r
varying vec2 vUvB;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	vec2 ra = inputColor.ra;\r
	vec2 ba = inputColor.ba;\r
\r
	#ifdef RADIAL_MODULATION\r
\r
		const vec2 center = vec2(0.5);\r
		float d = distance(uv, center) * 2.0;\r
		d = max(d - modulationOffset, 0.0);\r
\r
		if(vActive > 0.0 && d > 0.0) {\r
\r
			ra = texture2D(inputBuffer, mix(uv, vUvR, d)).ra;\r
			ba = texture2D(inputBuffer, mix(uv, vUvB, d)).ba;\r
\r
		}\r
\r
	#else\r
\r
		if(vActive > 0.0) {\r
\r
			ra = texture2D(inputBuffer, vUvR).ra;\r
			ba = texture2D(inputBuffer, vUvB).ba;\r
\r
		}\r
\r
	#endif\r
\r
	outputColor = vec4(ra.x, inputColor.g, ba.x, max(max(ra.y, ba.y), inputColor.a));\r
\r
}\r
`,{vertexShader:`uniform vec2 offset;\r
\r
varying float vActive;\r
varying vec2 vUvR;\r
varying vec2 vUvB;\r
\r
void mainSupport(const in vec2 uv) {\r
\r
	vec2 shift = offset * vec2(1.0, aspect);\r
	vActive = (shift.x != 0.0 || shift.y != 0.0) ? 1.0 : 0.0;\r
	vUvR = uv + shift;\r
	vUvB = uv - shift;\r
\r
}\r
`,attributes:Tg,uniforms:new Map([["offset",new Ge(e)],["modulationOffset",new Ge(n)]])}),this.radialModulation=t}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(e){e?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(e){this.uniforms.get("modulationOffset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}}class B5 extends kl{constructor(e,{blendFunction:t,worldFocusDistance:n,worldFocusRange:i,focusDistance:s=0,focalLength:a=.1,focusRange:c=a,bokehScale:h=1,resolutionScale:d=1,width:f=Jn.AUTO_SIZE,height:m=Jn.AUTO_SIZE,resolutionX:g=f,resolutionY:y=m}={}){super("DepthOfFieldEffect",`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D nearColorBuffer;\r
	uniform mediump sampler2D farColorBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D nearColorBuffer;\r
	uniform lowp sampler2D farColorBuffer;\r
\r
#endif\r
\r
uniform lowp sampler2D nearCoCBuffer;\r
uniform float scale;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, const in float depth, out vec4 outputColor) {\r
\r
	vec4 colorNear = texture2D(nearColorBuffer, uv);\r
	vec4 colorFar = texture2D(farColorBuffer, uv);\r
\r
	float cocNear = texture2D(nearCoCBuffer, uv).r;\r
	cocNear = min(cocNear * scale, 1.0);\r
\r
	// The far color buffer has been premultiplied with the CoC buffer.\r
	vec4 result = inputColor * (1.0 - colorFar.a) + colorFar;\r
	result = mix(result, colorNear, cocNear);\r
\r
	outputColor = result;\r
\r
}\r
`,{blendFunction:t,attributes:du,uniforms:new Map([["nearColorBuffer",new Ge(null)],["farColorBuffer",new Ge(null)],["nearCoCBuffer",new Ge(null)],["scale",new Ge(1)]])}),this.camera=e,this.renderTarget=new Lt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new ia(new FO(e));const S=this.cocMaterial;S.focusDistance=s,S.focusRange=c,n!==void 0&&(S.worldFocusDistance=n),i!==void 0&&(S.worldFocusRange=i),this.blurPass=new b_({resolutionScale:d,resolutionX:g,resolutionY:y,kernelSize:Eg}),this.maskPass=new ia(new _5(this.renderTargetCoC.texture));const x=this.maskPass.fullscreenMaterial;x.maskFunction=p_,x.colorChannel=p5,this.bokehNearBasePass=new ia(new tp(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new ia(new tp(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new ia(new tp(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new ia(new tp(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const w=this.resolution=new Jn(this,g,y,d);w.addEventListener("change",T=>this.setSize(w.baseWidth,w.baseHeight)),this.bokehScale=h}set mainCamera(e){this.camera=e,this.cocMaterial.copyCameraSettings(e)}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){this.bokehNearBasePass.fullscreenMaterial.scale=e,this.bokehNearFillPass.fullscreenMaterial.scale=e,this.bokehFarBasePass.fullscreenMaterial.scale=e,this.bokehFarFillPass.fullscreenMaterial.scale=e,this.maskPass.fullscreenMaterial.strength=e,this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){const t=this.camera;return Sg(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e,t=hr){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,n){const i=this.renderTarget,s=this.renderTargetCoC,a=this.renderTargetCoCBlurred,c=this.renderTargetMasked;if(this.target!==null){const h=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=h}this.cocPass.render(e,null,s),this.blurPass.render(e,s,a),this.maskPass.render(e,t,c),this.bokehFarBasePass.render(e,c,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const i=n.width,s=n.height;this.cocPass.setSize(e,t),this.blurPass.setSize(e,t),this.maskPass.setSize(e,t),this.renderTargetCoC.setSize(e,t),this.renderTargetMasked.setSize(e,t),this.renderTarget.setSize(i,s),this.renderTargetNear.setSize(i,s),this.renderTargetFar.setSize(i,s),this.renderTargetCoCBlurred.setSize(i,s),this.bokehNearBasePass.fullscreenMaterial.setSize(e,t),this.bokehNearFillPass.fullscreenMaterial.setSize(e,t),this.bokehFarBasePass.fullscreenMaterial.setSize(e,t),this.bokehFarFillPass.fullscreenMaterial.setSize(e,t)}initialize(e,t,n){this.cocPass.initialize(e,t,n),this.maskPass.initialize(e,t,n),this.bokehNearBasePass.initialize(e,t,n),this.bokehNearFillPass.initialize(e,t,n),this.bokehFarBasePass.initialize(e,t,n),this.bokehFarFillPass.initialize(e,t,n),this.blurPass.initialize(e,t,Sn),this.maskPass.fullscreenMaterial.maskFunction=t?p_:g5,n!==void 0&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,ta(e)===Xt&&(Fi(this.renderTarget.texture,Xt),Fi(this.renderTargetNear.texture,Xt),Fi(this.renderTargetFar.texture,Xt),Fi(this.renderTargetMasked.texture,Xt)))}}class j5 extends kl{constructor({blendFunction:e=_g}={}){super("FXAAEffect",`/**\r
 * FXAA 3.11 by Timothy Lottes\r
 *\r
 * Copyright (c) 2011, NVIDIA CORPORATION. All rights reserved.\r
 *\r
 * TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THIS SOFTWARE IS PROVIDED "AS IS" AND NVIDIA AND ITS SUPPLIERS\r
 * DISCLAIM ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF\r
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL NVIDIA OR ITS SUPPLIERS BE LIABLE FOR ANY\r
 * SPECIAL, INCIDENTAL, INDIRECT, OR CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS\r
 * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY OTHER PECUNIARY LOSS) ARISING OUT OF\r
 * THE USE OF OR INABILITY TO USE THIS SOFTWARE, EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\r
 */\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))\r
#define ONE_OVER_TWELVE 0.08333333333333333\r
\r
varying vec2 vUvDown;\r
varying vec2 vUvUp;\r
varying vec2 vUvLeft;\r
varying vec2 vUvRight;\r
\r
varying vec2 vUvDownLeft;\r
varying vec2 vUvUpRight;\r
varying vec2 vUvUpLeft;\r
varying vec2 vUvDownRight;\r
\r
vec4 fxaa(const in vec4 inputColor, const in vec2 uv) {\r
\r
	// Luma at the current fragment.\r
	float lumaCenter = luminance(inputColor.rgb);\r
\r
	// Luma at the four direct neighbours of the current fragment.\r
	float lumaDown = luminance(texture2D(inputBuffer, vUvDown).rgb);\r
	float lumaUp = luminance(texture2D(inputBuffer, vUvUp).rgb);\r
	float lumaLeft = luminance(texture2D(inputBuffer, vUvLeft).rgb);\r
	float lumaRight = luminance(texture2D(inputBuffer, vUvRight).rgb);\r
\r
	// Find the maximum and minimum luma around the current fragment.\r
	float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));\r
	float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));\r
\r
	// Compute the delta.\r
	float lumaRange = lumaMax - lumaMin;\r
\r
	// Skip AA if the luma variation is lower than a threshold (low contrast or dark area).\r
	if(lumaRange < max(EDGE_THRESHOLD_MIN, lumaMax * EDGE_THRESHOLD_MAX)) {\r
\r
		return inputColor;\r
\r
	}\r
\r
	// Query the 4 remaining corners lumas.\r
	float lumaDownLeft = luminance(texture2D(inputBuffer, vUvDownLeft).rgb);\r
	float lumaUpRight = luminance(texture2D(inputBuffer, vUvUpRight).rgb);\r
	float lumaUpLeft = luminance(texture2D(inputBuffer, vUvUpLeft).rgb);\r
	float lumaDownRight = luminance(texture2D(inputBuffer, vUvDownRight).rgb);\r
\r
	// Combine the four edges lumas (using intermediary variables for future computations with the same values).\r
	float lumaDownUp = lumaDown + lumaUp;\r
	float lumaLeftRight = lumaLeft + lumaRight;\r
\r
	// Same for corners.\r
	float lumaLeftCorners = lumaDownLeft + lumaUpLeft;\r
	float lumaDownCorners = lumaDownLeft + lumaDownRight;\r
	float lumaRightCorners = lumaDownRight + lumaUpRight;\r
	float lumaUpCorners = lumaUpRight + lumaUpLeft;\r
\r
	// Compute an estimation of the gradient along the horizontal and vertical axis.\r
	float edgeHorizontal = (\r
		abs(-2.0 * lumaLeft + lumaLeftCorners) +\r
		abs(-2.0 * lumaCenter + lumaDownUp ) * 2.0 +\r
		abs(-2.0 * lumaRight + lumaRightCorners)\r
	);\r
\r
	float edgeVertical = (\r
		abs(-2.0 * lumaUp + lumaUpCorners) +\r
		abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 +\r
		abs(-2.0 * lumaDown + lumaDownCorners)\r
	);\r
\r
	// Check if the local edge is horizontal or vertical.\r
	bool isHorizontal = (edgeHorizontal >= edgeVertical);\r
\r
	// Choose the step size (one pixel) accordingly.\r
	float stepLength = isHorizontal ? texelSize.y : texelSize.x;\r
\r
	// Select the two neighboring texels' lumas in the opposite direction to the local edge.\r
	float luma1 = isHorizontal ? lumaDown : lumaLeft;\r
	float luma2 = isHorizontal ? lumaUp : lumaRight;\r
\r
	// Compute gradients in this direction.\r
	float gradient1 = abs(luma1 - lumaCenter);\r
	float gradient2 = abs(luma2 - lumaCenter);\r
\r
	// Check which direction is the steepest.\r
	bool is1Steepest = gradient1 >= gradient2;\r
\r
	// Gradient in the corresponding direction, normalized.\r
	float gradientScaled = 0.25 * max(gradient1, gradient2);\r
\r
	// Average luma in the correct direction.\r
	float lumaLocalAverage = 0.0;\r
\r
	if(is1Steepest) {\r
\r
		// Switch the direction.\r
		stepLength = -stepLength;\r
		lumaLocalAverage = 0.5 * (luma1 + lumaCenter);\r
\r
	} else {\r
\r
		lumaLocalAverage = 0.5 * (luma2 + lumaCenter);\r
\r
	}\r
\r
	// Shift UV in the correct direction by half a pixel.\r
	vec2 currentUv = uv;\r
\r
	if(isHorizontal) {\r
\r
		currentUv.y += stepLength * 0.5;\r
\r
	} else {\r
\r
		currentUv.x += stepLength * 0.5;\r
\r
	}\r
\r
	// Compute offset (for each iteration step) in the right direction.\r
	vec2 offset = isHorizontal ? vec2(texelSize.x, 0.0) : vec2(0.0, texelSize.y);\r
\r
	// Compute UVs to explore on each side of the edge, orthogonally. The QUALITY allows us to step faster.\r
	vec2 uv1 = currentUv - offset * QUALITY(0);\r
	vec2 uv2 = currentUv + offset * QUALITY(0);\r
\r
	// Read lumas at both extremities of the exploration segment, and compute the delta w.r.t. the local average luma.\r
	float lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\r
	float lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\r
	lumaEnd1 -= lumaLocalAverage;\r
	lumaEnd2 -= lumaLocalAverage;\r
\r
	// If the deltas at the current extremities are larger than the local gradient, the side of the edge has been reached.\r
	bool reached1 = abs(lumaEnd1) >= gradientScaled;\r
	bool reached2 = abs(lumaEnd2) >= gradientScaled;\r
	bool reachedBoth = reached1 && reached2;\r
\r
	// If the side has not been reached, continue to explore in this direction.\r
	if(!reached1) {\r
\r
		uv1 -= offset * QUALITY(1);\r
\r
	}\r
\r
	if(!reached2) {\r
\r
		uv2 += offset * QUALITY(1);\r
\r
	}\r
\r
	// If both sides have not been reached, continue to explore.\r
	if(!reachedBoth) {\r
\r
		for(int i = 2; i < SAMPLES; ++i) {\r
\r
			// If needed, read luma in 1st direction, compute delta.\r
			if(!reached1) {\r
\r
				lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\r
				lumaEnd1 = lumaEnd1 - lumaLocalAverage;\r
\r
			}\r
\r
			// If needed, read luma in opposite direction, compute delta.\r
			if(!reached2) {\r
\r
				lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\r
				lumaEnd2 = lumaEnd2 - lumaLocalAverage;\r
\r
			}\r
\r
			// If the deltas are larger than the local gradient, the side of the edge has been reached.\r
			reached1 = abs(lumaEnd1) >= gradientScaled;\r
			reached2 = abs(lumaEnd2) >= gradientScaled;\r
			reachedBoth = reached1 && reached2;\r
			\r
			// If the side has not been reached, continue to explore in this direction, with dynamic quality.\r
			if(!reached1) {\r
\r
				uv1 -= offset * QUALITY(i);\r
\r
			}\r
\r
			if(!reached2) {\r
\r
				uv2 += offset * QUALITY(i);\r
\r
			}\r
\r
			// If both sides have been reached, stop the exploration.\r
			if(reachedBoth) {\r
\r
				break;\r
\r
			}\r
\r
		}\r
\r
	}\r
\r
	// Compute the distances to each side edge of the edge (!).\r
	float distance1 = isHorizontal ? (uv.x - uv1.x) : (uv.y - uv1.y);\r
	float distance2 = isHorizontal ? (uv2.x - uv.x) : (uv2.y - uv.y);\r
\r
	// Check in which direction the side of the edge is closer.\r
	bool isDirection1 = distance1 < distance2;\r
	float distanceFinal = min(distance1, distance2);\r
\r
	// Thickness of the edge.\r
	float edgeThickness = (distance1 + distance2);\r
\r
	// Check if the luma at the center is smaller than the local average.\r
	bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;\r
\r
	// If the luma is smaller than at its neighbour, the delta luma at each end should be positive (same variation).\r
	bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;\r
	bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;\r
\r
	// Only keep the result in the direction of the closer side of the edge.\r
	bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;\r
\r
	// UV offset: read in the direction of the closest side of the edge.\r
	float pixelOffset = -distanceFinal / edgeThickness + 0.5;\r
\r
	// If the luma variation is incorrect, do not offset.\r
	float finalOffset = correctVariation ? pixelOffset : 0.0;\r
\r
	// Sub-Pixel Shifting\r
	// Full weighted average of the luma over the 3x3 neighborhood.\r
	float lumaAverage = ONE_OVER_TWELVE * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);\r
	// Ratio of the delta between the global average and the center luma, over the luma range in the 3x3 neighborhood.\r
	float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);\r
	float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;\r
	// Compute a sub-pixel offset based on this delta.\r
	float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * SUBPIXEL_QUALITY;\r
\r
	// Pick the biggest of the two offsets.\r
	finalOffset = max(finalOffset, subPixelOffsetFinal);\r
\r
	// Compute the final UV coordinates.\r
	vec2 finalUv = uv;\r
\r
	if(isHorizontal) {\r
\r
		finalUv.y += finalOffset * stepLength;\r
\r
	} else {\r
\r
		finalUv.x += finalOffset * stepLength;\r
\r
	}\r
\r
	return texture2D(inputBuffer, finalUv);\r
\r
}\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	outputColor = fxaa(inputColor, uv);\r
\r
}\r
`,{vertexShader:`varying vec2 vUvDown;\r
varying vec2 vUvUp;\r
varying vec2 vUvLeft;\r
varying vec2 vUvRight;\r
\r
varying vec2 vUvDownLeft;\r
varying vec2 vUvUpRight;\r
varying vec2 vUvUpLeft;\r
varying vec2 vUvDownRight;\r
\r
void mainSupport(const in vec2 uv) {\r
\r
	vUvDown = uv + vec2(0.0, -1.0) * texelSize;\r
	vUvUp = uv + vec2(0.0, 1.0) * texelSize;\r
	vUvRight = uv + vec2(1.0, 0.0) * texelSize;\r
	vUvLeft = uv + vec2(-1.0, 0.0) * texelSize;\r
\r
	vUvDownLeft = uv + vec2(-1.0, -1.0) * texelSize;\r
	vUvUpRight = uv + vec2(1.0, 1.0) * texelSize;\r
	vUvUpLeft = uv + vec2(-1.0, 1.0) * texelSize;\r
	vUvDownRight = uv + vec2(1.0, -1.0) * texelSize;\r
\r
}\r
`,blendFunction:e,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(e){this.defines.set("EDGE_THRESHOLD_MIN",e.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(e){this.defines.set("EDGE_THRESHOLD_MAX",e.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(e){this.defines.set("SUBPIXEL_QUALITY",e.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(e){this.defines.set("SAMPLES",e.toFixed(0)),this.setChanged()}}new O,new Ne,new Ie,new O,new O;class H5 extends w_{constructor(e,t,n){super(n),this.setAttributes(this.getAttributes()|du),this.camera=t,this.depthPass=new R5(e,t),this.clearPass=new Ag(!0,!1,!1),this.clearPass.overrideClearColor=new Ie(0),this.depthMaskPass=new ia(new x5);const i=this.depthMaskMaterial;i.copyCameraSettings(t),i.depthBuffer1=this.depthPass.texture,i.depthPacking1=Lh,i.depthMode=vc,this.renderTargetMasked=new Lt(1,1,{depthBuffer:!1}),this.renderTargetMasked.texture.name="Bloom.Masked",this.selection=new k5,this.selection.layer=11,this._inverted=!1,this._ignoreBackground=!1}set mainScene(e){this.depthPass.mainScene=e}set mainCamera(e){this.camera=e,this.depthPass.mainCamera=e,this.depthMaskMaterial.copyCameraSettings(e)}getSelection(){return this.selection}get depthMaskMaterial(){return this.depthMaskPass.fullscreenMaterial}get inverted(){return this._inverted}set inverted(e){this._inverted=e,this.depthMaskMaterial.depthMode=e?yh:vc}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get ignoreBackground(){return this._ignoreBackground}set ignoreBackground(e){this._ignoreBackground=e,this.depthMaskMaterial.maxDepthStrategy=e?h_:Mg}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}setDepthTexture(e,t=hr){this.depthMaskMaterial.depthBuffer0=e,this.depthMaskMaterial.depthPacking0=t}update(e,t,n){const i=this.camera,s=this.selection,a=this.inverted;let c=t;if(this.ignoreBackground||!a||s.size>0){const h=i.layers.mask;i.layers.set(s.layer),this.depthPass.render(e),i.layers.mask=h,c=this.renderTargetMasked,this.clearPass.render(e,c),this.depthMaskPass.render(e,t,c)}super.update(e,c,n)}setSize(e,t){super.setSize(e,t),this.renderTargetMasked.setSize(e,t),this.depthPass.setSize(e,t)}initialize(e,t,n){super.initialize(e,t,n),this.clearPass.initialize(e,t,n),this.depthPass.initialize(e,t,n),this.depthMaskPass.initialize(e,t,n),n!==void 0&&(this.renderTargetMasked.texture.type=n,ta(e)===Xt&&Fi(this.renderTargetMasked.texture,Xt))}}class G5 extends kl{constructor({blendFunction:e=_g,adaptive:t=!0,mode:n=t?br.REINHARD2_ADAPTIVE:br.REINHARD2,resolution:i=256,maxLuminance:s=16,whitePoint:a=s,middleGrey:c=.6,minLuminance:h=.01,averageLuminance:d=1,adaptationRate:f=1}={}){super("ToneMappingEffect",`#include <tonemapping_pars_fragment>\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
uniform lowp sampler2D luminanceBuffer;\r
uniform float whitePoint;\r
uniform float middleGrey;\r
\r
#if TONE_MAPPING_MODE != 2\r
\r
	uniform float averageLuminance;\r
\r
#endif\r
\r
vec3 Reinhard2ToneMapping(vec3 color) {\r
\r
	color *= toneMappingExposure;\r
\r
	// Calculate the luminance of the current pixel.\r
	float l = luminance(color);\r
\r
	#if TONE_MAPPING_MODE == 2\r
\r
		// Get the average luminance from the adaptive 1x1 buffer.\r
		float lumAvg = unpackRGBAToFloat(texture2D(luminanceBuffer, vec2(0.5)));\r
\r
	#else\r
\r
		float lumAvg = averageLuminance;\r
\r
	#endif\r
\r
	float lumScaled = (l * middleGrey) / max(lumAvg, 1e-6);\r
	float lumCompressed = lumScaled * (1.0 + lumScaled / (whitePoint * whitePoint));\r
	lumCompressed /= (1.0 + lumScaled);\r
\r
	return clamp(lumCompressed * color, 0.0, 1.0);\r
\r
}\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	#if TONE_MAPPING_MODE == 1 || TONE_MAPPING_MODE == 2\r
\r
		outputColor = vec4(Reinhard2ToneMapping(inputColor.rgb), inputColor.a);\r
\r
	#else\r
\r
		outputColor = vec4(toneMapping(inputColor.rgb), inputColor.a);\r
\r
	#endif\r
\r
}\r
`,{blendFunction:e,uniforms:new Map([["luminanceBuffer",new Ge(null)],["maxLuminance",new Ge(s)],["whitePoint",new Ge(a)],["middleGrey",new Ge(c)],["averageLuminance",new Ge(d)]])}),this.renderTargetLuminance=new Lt(1,1,{minFilter:cr,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new S_({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new E5(this.luminancePass.texture,{minLuminance:h,adaptationRate:f}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=i,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode!==e){switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case br.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case br.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)","OptimizedCineonToneMapping(texel)");break;case br.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel")}this.adaptiveLuminancePass.enabled=e===br.REINHARD2_ADAPTIVE,this.setChanged()}}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===br.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?br.REINHARD2_ADAPTIVE:br.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}}class po extends Kn{constructor(){super(...arguments);N(this,"_composer");N(this,"_effects",[]);N(this,"_effectPass",null);N(this,"_effectsNeedUpdate",!1)}onLoad({depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:s=yi}){this._composer=new I5(this.viewer.renderer,{depthBuffer:t,stencilBuffer:n,multisampling:i,frameBufferType:s}),this._composer.addPass(new y_(this.viewer.scene,this.viewer.camera))}onDestroy(){this._composer.dispose()}onEnable(){let t=this.viewer.getPlugin(Vd);t&&(t.enabled=!1),this.viewer.on(Dn.RESIZE,this.onResize,this)}onDisable(){let t=this.viewer.getPlugin(Vd);t&&(t.enabled=!0),this.viewer.off(Dn.RESIZE,this.onResize,this)}onResize(t,n){this._composer.setSize(t,n)}addPass(t){this._composer.addPass(t)}removePass(t){this._composer.removePass(t)}addEffect(t){this._effects.push(t),this._effectsNeedUpdate=!0}removeEffect(t){let n=this._effects.indexOf(t);n>-1&&(this._effects.splice(n,1),this._effectsNeedUpdate=!0)}updateEffects(){this._effectsNeedUpdate&&(this._effectsNeedUpdate=!1,this._effectPass&&(this.removePass(this._effectPass),this._effectPass=null),this._effects.length&&(this._effectPass=new P5(this.viewer.camera,...this._effects),this.addPass(this._effectPass)))}update(t){this.updateEffects(),this.viewer.renderer.info.reset(),this._composer.render(t)}}var V5=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let fo=class extends Kn{constructor(){super(...arguments);N(this,"pass")}onEnable(){this.pass.enabled=!0}onDisable(){this.pass.enabled=!1}onLoad(e){var t;this.initialize&&this.initialize(e),(t=this.viewer.getPlugin(po))==null||t.addPass(this.pass)}onDestroy(){var e;(e=this.viewer.getPlugin(po))==null||e.removePass(this.pass)}};fo=V5([jr(po)],fo);const W5=new Hs(-1,1,1,-1,0,1),Pg=new $e;Pg.setAttribute("position",new We([-1,3,0,-1,-1,0,3,-1,0],3)),Pg.setAttribute("uv",new We([0,2,0,0,2,0],2));class X5{constructor(e){this._mesh=new et(Pg,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,W5)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const Cg={uniforms:{tDiffuse:{value:null},tDepth:{value:null},tNormal:{value:null},tNoise:{value:null},uClippingParams:{value:new Ke},uSamples:{value:[]},uAoParams:{value:new Ke},uScreenSize:{value:new Ke},uSsaoProjectionInfo:{value:new Ke},uFrameModTaaSS:{value:0},cameraNear:{value:.1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Ne},cameraInverseProjectionMatrix:{value:new Ne}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }`,fragmentShader:`
    precision highp float;

    #include <packing>

    uniform sampler2D tDiffuse;
    uniform sampler2D tDepth;
    uniform sampler2D tNormal;
    uniform sampler2D tNoise;
    uniform vec4      uSamples[32]; 
    uniform vec4      uAoParams;
    uniform vec4      uScreenSize;
    uniform vec4      uSsaoProjectionInfo;
    uniform float     uFrameModTaaSS;
    varying vec2      vUv;

    //x = far - near
    //y = near
    //z = tanFov * aspect
    //w = tanFov
    uniform vec4      uClippingParams;

    #define uRadius     uAoParams.x
    #define uSampleCnt  uAoParams.y
    #define uGiBoost    uAoParams.z
    #define uBias       uAoParams.w

    uniform float cameraNear;
    uniform float cameraFar;
    uniform mat4 cameraProjectionMatrix;
    uniform mat4 cameraInverseProjectionMatrix;

    vec3 ndcToView(vec2 ndc, float depth) {
        float z = depth * uClippingParams.x + uClippingParams.y;
        return vec3(ndc * uClippingParams.zw, -1.0) * z;
    }
    
    vec2 viewToNdc(vec3 view) {
        return -view.xy / (uClippingParams.zw * view.z);
    }

    vec3 textureNormal(sampler2D map, vec2 uv) {
	    return unpackRGBToNormal(texture(map, uv).xyz);
    }

    float textureDepth(sampler2D map, vec2 uv) {
        return (-perspectiveDepthToViewZ(texture(map, uv).r, cameraNear, cameraFar ) - cameraNear) / (cameraFar - cameraNear);
    }

    float zValueFromScreenSpacePosition(const in float depth) {
        return (depth * uClippingParams.x + uClippingParams.y);
    }

    vec3 reconstructCSPosition(const in vec2 ssP, const in float z) {
        return vec3((ssP.xy * uSsaoProjectionInfo.xy + uSsaoProjectionInfo.zw) * z, z);
    }

    vec3 getPosition(const in vec2 uv) {
        return reconstructCSPosition(uv * uScreenSize.xy, zValueFromScreenSpacePosition(textureDepth(tDepth, uv)));
    }

    vec3 getOffsetedPixelPos(const in vec2 uv, const in vec2 unitOffset, const in float screenSpaceRadius) {
        vec2 uvOff = uv + floor(screenSpaceRadius * unitOffset) / uScreenSize.xy;
        float d = zValueFromScreenSpacePosition(textureDepth(tDepth, uvOff));
        return reconstructCSPosition(uvOff * uScreenSize.xy, d);
    }

    float interleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {
        vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);
        return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));
    }

    float hash(vec2 p) {
        return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453123);
    }

    vec2 hash2(vec2 p) { // replace this by something better
        p = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));
        return fract(sin(p) * 43758.5453123);
    }

    vec3 hash3(vec2 p){
        // p += uFrameModTaaSS * vec2(0.05);
        vec3 q = vec3(dot(p,vec2(127.1,311.7)), 
                    dot(p,vec2(269.5,183.3)), 
                    dot(p,vec2(419.2,371.9)) );
        return fract(sin(q)*43758.5453);
    }


    vec3 ssao() {
        vec2 uv = vUv;

        float uSsaoRadius = uRadius;
        float uSsaoIntensity = uGiBoost;
        float uSsaoProjectionScale = -1559.1949;
        float uSsaoBias = 0.008;

        vec3 cameraSpacePosition = getPosition(uv);
        float ssRadius = -uSsaoProjectionScale * uSsaoRadius / cameraSpacePosition.z;

        float d = textureDepth(tDepth, vUv);
        if(d >= 0.999) {
             return vec3(1.);
        }
        if (ssRadius < 1.) {
            return vec3(1.);
        }

        vec3 normal = normalize(cross(dFdy(cameraSpacePosition), dFdx(cameraSpacePosition)));
        // vec3 normal = -textureNormal(tNormal, uv);
        // return normal * 0.5 + 0.5;

        float nFalloff = mix(1.0, max(0.0, 1.5 * normal.z), 0.35);
        // return vec3(nFalloff);

        float randomAngle = 6.28 * interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);
        float invRadius2 = 1.0 / (uSsaoRadius * uSsaoRadius);
        float contrib = 0.0;
        float vv;
        float vn;
        float screenSpaceRadius;
        float angle;
        vec3 occludingPoint;
        vec2 offsetUnitVec;

        float offset = 0.;
        float nbSamples = 32.;
        for (float i = 0.; i < nbSamples; i++) {
            screenSpaceRadius = (offset + i + 0.5) * (1.0 / nbSamples);
            angle = screenSpaceRadius * (3.0 * 6.28) + randomAngle;
            screenSpaceRadius = max(0.75, screenSpaceRadius * ssRadius);
            offsetUnitVec = vec2(cos(angle), sin(angle));
            occludingPoint = getOffsetedPixelPos(uv, offsetUnitVec, screenSpaceRadius);
            occludingPoint -= cameraSpacePosition;
            vv = dot(occludingPoint, occludingPoint);
            vn = dot(occludingPoint, normal);
            contrib += max(1. - vv * invRadius2, 0.0) * max((vn - uSsaoBias) * inversesqrt(vv), 0.0);
        }
        float aoValue = max(0.0, 1.0 - sqrt(contrib * nFalloff / nbSamples));
        aoValue = pow(aoValue, 10.0 * uSsaoIntensity);
        return vec3(mix(1.0, aoValue, clamp(ssRadius - 1.0, 0.0, 1.0)));
    }

    // vec3 ssao2() {
    //     const float ATTF = 1e-5; 
    //     float d = textureDepth(tDepth, vUv);
    //     if( d >= 0.999) {
    //         discard;
    //     }
    //     float occ = 0.;
    //     float occCnt = 0.;
    //     vec3 p = ndcToView(vUv * 2. - 1., d);
    //     // vec3 n = textureNormal(tNormal, vUv);
    //     vec3 n = normalize(cross(dFdx(p), dFdy(p)));

    //     vec3  rvec = normalize(texture(tNoise, gl_FragCoord.xy/64.0).rgb*2.-1.);
    //     for(int i = 0; i<32 && d < 1.; i++) {
    //         vec3 dir = reflect(uSamples[i].xyz, rvec); // a la Crysis
    //         dir -= 2.*dir*step(dot(n,dir), 0.);  // a la Starcraft
    //         vec3 sp = p + (dir*uRadius) * (d*1e2); // scale radius with depth
    //         vec2 spNdc = viewToNdc(sp); // get sample ndc coords
            
    //         bvec4 outOfScreen = bvec4(false); // check if sample projects to screen
    //         outOfScreen.xy = lessThan(spNdc, vec2(-1));
    //         outOfScreen.zw = greaterThan(spNdc, vec2(1));
    //         if(any(outOfScreen)) continue;

    //         float spd = textureDepth(tDepth, (spNdc*0.5+0.5));
    //         vec3  occEye = -sp/sp.z*(spd*uClippingParams.x+uClippingParams.y); // compute correct pos
    //         vec3  occVec = occEye - p; // vector
    //         float att2 = 1.0+ATTF*length(occVec); // quadratic attenuation
    //         occ += max(0.0,dot(normalize(occVec),n)-0.25) / (att2*att2);
    //         ++occCnt;
    //     }
    //     return occCnt > 0.0 ? vec3(1.0-occ*uGiBoost/occCnt) : vec3(1.);
    // }

    vec3 ssao2() {
        const float ATTF = 1e-5; 
        float d = textureDepth(tDepth, vUv);
        if( d >= 0.999) {
            discard;
        }
        float occ = 0.;
        float occCnt = 0.;
        vec3 p = ndcToView(vUv * 2. - 1., d);
        vec3 n = textureNormal(tNormal, vUv);
        // vec3 n = normalize(cross(dFdx(p), dFdy(p)));

        float invRadius2 = 1.0 / (uRadius * uRadius);
        vec2 sUv = gl_FragCoord.xy/64.;
        vec3 rvec = normalize(hash3(sUv)*2.-1.);
        float nbSamples = 8.; //采样率太低会出现水波纹
        // for(int i = 0; i < 32 && d < 1.; i++) {
        for(float i = 0.; i<nbSamples && d < 1.; i++) {
            vec2 st = sUv * i;
            vec3 s = (hash3(st)*2.-1.) * mix(1e-5,.5,hash(st)); //随机缩放步长,固定步长更容易收敛,随机步长AO更准确
            vec3 dir = reflect(s, rvec); // a la Crysis
            // vec3 dir = reflect(uSamples[i].xyz, rvec); // a la Crysis
            dir -= 2.*dir*step(dot(n,dir), 0.);  // a la Starcraft
            vec3 sp = p + (dir*uRadius) * (d*5.); // scale radius with depth
            vec2 spNdc = viewToNdc(sp); // get sample ndc coords
            
            bvec4 outOfScreen = bvec4(false); // check if sample projects to screen
            outOfScreen.xy = lessThan(spNdc, vec2(-1));
            outOfScreen.zw = greaterThan(spNdc, vec2(1));
            if(any(outOfScreen)) continue;

            float spd = textureDepth(tDepth, (spNdc*0.5+0.5));
            vec3  occEye = -sp/sp.z*(spd*uClippingParams.x+uClippingParams.y); // compute correct pos
            vec3  occVec = occEye - p; // vector
            float att2 = 1.0+ATTF*length(occVec); // quadratic attenuation
            occ += max(0.0,dot(normalize(occVec),n)-0.25) / (att2*att2) * max(0., 1.-dot(occVec,occVec) * invRadius2);
            ++occCnt;
        }
        return occCnt > 0.0 ? vec3(1.0-occ*uGiBoost*10./occCnt) : vec3(1.);
    }

    void main() {        
        gl_FragColor.rgb = ssao2();
        // gl_FragColor.rgb = vec3(interleavedGradientNoise(vUv, 0.));
        // gl_FragColor.rgb = vec3(hash(gl_FragCoord.xy/64.));
        // gl_FragColor.rgb = texture(tNoise, gl_FragCoord.xy/64.0).rgb;
        gl_FragColor.a = 1.;
    }
    `},{randFloat:ip,randInt:Dg,degToRad:q5,lerp:MU}=fn;let __=new Ke,Y5=new Ke;class Q5 extends On{constructor(t,n){super();N(this,"_scene");N(this,"_camera");N(this,"_ssaoMaterial");N(this,"_fsQuad");N(this,"_depthTexture");N(this,"_normalRenderTarget");N(this,"_normalMaterial");N(this,"_aoParams",new Ke(24,32,1,0));this._scene=t,this._camera=n,this._ssaoMaterial=new St({uniforms:$m.clone(Cg.uniforms),vertexShader:Cg.vertexShader,fragmentShader:Cg.fragmentShader});let i=window.innerWidth,s=window.innerHeight;this._depthTexture=new Uc(i,s,es),this._normalRenderTarget=new Lt(i,s,{depthTexture:this._depthTexture}),this._normalMaterial=new R0({blending:Be}),this._fsQuad=new X5(null),this._createSamples(),this._createNoiseTexure()}get radius(){return this._aoParams.x}set radius(t){this._aoParams.x=t}get giBoost(){return this._aoParams.z}set giBoost(t){this._aoParams.z=t}_createSamples(){let t=[];for(let n=0;n<32;n++){let i=new O().set(ip(-1,1),ip(-1,1),ip(-1,1)).normalize();t[n]=new Ke(i.x,i.y,i.z,1).multiplyScalar(ip(1e-5,1))}this._ssaoMaterial.uniforms.uSamples.value=t}_createNoiseTexure(){let t=new Uint8Array(16384);for(let i=0;i<16384;i+=4)t[i+0]=Dg(0,255),t[i+1]=Dg(0,255),t[i+2]=Dg(0,255);let n=new Gs(t,64,64,oi,Sn);n.wrapS=vi,n.wrapT=vi,n.minFilter=at,n.magFilter=at,n.needsUpdate=!0,this._ssaoMaterial.uniforms.tNoise.value=n}setSize(t,n){this._normalRenderTarget.setSize(t,n),this._ssaoMaterial.uniforms.uScreenSize.value=Y5.set(t,n,1/t,1/n);let i=this._camera.projectionMatrix.elements,s=new Ke(-2/(t*i[0]),-2/(n*i[5]),(1-i[2])/i[0],(1+i[6])/i[5]);this._ssaoMaterial.uniforms.uSsaoProjectionInfo.value=s}render(t,n,i,s,a){this._renderOverride(t,this._normalMaterial,this._normalRenderTarget),this._blit(t,i,this.renderToScreen?null:n,this._ssaoMaterial)}_renderOverride(t,n,i){t.setRenderTarget(i),this._scene.overrideMaterial=n,t.render(this._scene,this._camera),this._scene.overrideMaterial=null}_blit(t,n,i,s){t.setRenderTarget(i),s.uniforms.tDiffuse.value=n.texture,s.uniforms.tDepth.value=this._normalRenderTarget.depthTexture,s.uniforms.tNormal.value=this._normalRenderTarget.texture,s.uniforms.uAoParams.value=this._aoParams,s.uniforms.uFrameModTaaSS.value++;let a=this._camera;this._ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(a.projectionMatrixInverse),this._ssaoMaterial.uniforms.cameraProjectionMatrix.value=a.projectionMatrix,this._ssaoMaterial.uniforms.cameraNear.value=a.near,this._ssaoMaterial.uniforms.cameraFar.value=a.far;let c=Math.tan(.5*q5(a.fov));__.set(a.far-a.near,a.near,c*a.aspect,c),this._ssaoMaterial.uniforms.uClippingParams.value=__,this._fsQuad.material=s,this._fsQuad.render(t)}dispose(){this._ssaoMaterial.dispose(),this._fsQuad.dispose()}}var M_=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class Og extends fo{initialize(e){this.pass=new Q5(this.viewer.scene,this.viewer.camera)}get radius(){return this.pass.radius}set radius(e){this.pass.radius=e}get giBoost(){return this.pass.giBoost}set giBoost(e){this.pass.giBoost=e}}M_([It({min:.001,max:10,step:.001})],Og.prototype,"radius",null),M_([It({min:.1,max:2,step:.01})],Og.prototype,"giBoost",null);const pu=new $e;pu.setAttribute("position",new tt(new Float32Array([-1,-1,3,-1,-1,3]),2)),pu.setAttribute("uv",new tt(new Float32Array([0,0,2,0,0,2]),2)),pu.boundingSphere=new rs,pu.computeBoundingSphere=function(){};const Z5=new Hs;class fu{constructor(e){this._mesh=new et(pu,e),this._mesh.frustumCulled=!1}render(e){e.render(this._mesh,Z5)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}const K5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new Ne},viewMat:{value:new Ne},projViewMat:{value:new Ne},projectionMatrixInv:{value:new Ne},viewMatrixInv:{value:new Ne},cameraPos:{value:new O},resolution:{value:new de},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 1);
}`,fragmentShader:`
    #define SAMPLES 16
    #define FSAMPLES 16.0
uniform sampler2D sceneDiffuse;
uniform highp sampler2D sceneNormal;
uniform highp sampler2D sceneDepth;
uniform mat4 projectionMatrixInv;
uniform mat4 viewMatrixInv;
uniform mat4 projMat;
uniform mat4 viewMat;
uniform mat4 projViewMat;
uniform vec3 cameraPos;
uniform vec2 resolution;
uniform float time;
uniform vec3[SAMPLES] samples;
uniform float[SAMPLES] samplesR;
uniform float radius;
uniform float distanceFalloff;
uniform float near;
uniform float far;
uniform bool logDepth;
uniform bool ortho;
uniform bool screenSpaceRadius;
uniform sampler2D bluenoise;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }

    vec3 getWorldPosLog(vec3 posS) {
      vec2 uv = posS.xy;
      float z = posS.z;
      float nearZ =near;
      float farZ = far;
      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
      vec4 wpos = projectionMatrixInv * clipVec;
      return wpos.xyz / wpos.w;
    }
    vec3 getWorldPos(float depth, vec2 coord) {
      #ifdef LOGDEPTH
        return getWorldPosLog(vec3(coord, depth));
      #endif
      float z = depth * 2.0 - 1.0;
      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
      // Perspective division
     vec4 worldSpacePosition = viewSpacePosition;
     worldSpacePosition.xyz /= worldSpacePosition.w;
      return worldSpacePosition.xyz;
  }

  vec3 computeNormal(vec3 worldPos, vec2 vUv) {
    ivec2 p = ivec2(vUv * resolution);
    float c0 = texelFetch(sceneDepth, p, 0).x;
    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;

    float dl = abs((2.0 * l1 - l2) - c0);
    float dr = abs((2.0 * r1 - r2) - c0);
    float db = abs((2.0 * b1 - b2) - c0);
    float dt = abs((2.0 * t1 - t2) - c0);

    vec3 ce = getWorldPos(c0, vUv).xyz;

    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;

    return normalize(cross(dpdx, dpdy));
}

void main() {
      vec4 diffuse = texture2D(sceneDiffuse, vUv);
      float depth = texture2D(sceneDepth, vUv).x;
      if (depth == 1.0) {
        gl_FragColor = vec4(vec3(1.0), 1.0);
        return;
      }
      vec3 worldPos = getWorldPos(depth, vUv);
    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);
      #ifdef HALFRES
        vec3 normal = texture2D(sceneNormal, vUv).rgb;
      #else
        vec3 normal = computeNormal(worldPos, vUv);
      #endif
      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);
      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);
      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));
      vec3 bitangent = cross(normal, tangent);
      mat3 tbn = mat3(tangent, bitangent, normal);
      float occluded = 0.0;
      float totalWeight = 0.0;
     /* float radiusScreen = distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(48.0, 0.0) / resolution)
      );/*vUv.x < 0.5 ? radius : min(distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(100.0, 0.0) / resolution)
      ), radius);
      float distanceFalloffScreen = radiusScreen * 0.2;*/
      float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;
      for(float i = 0.0; i < FSAMPLES; i++) {
        vec3 sampleDirection = 
        tbn * 
        samples[int(i)];
        ;
        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];
        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;
        vec4 offset = projMat * vec4(samplePos, 1.0);
        offset.xyz /= offset.w;
        offset.xyz = offset.xyz * 0.5 + 0.5;
        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;
        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) 
         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/
        #ifdef LOGDEPTH
        float distSample = linearize_depth_log(sampleDepth, near, far);
        #else
        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);
        #endif
        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);
        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));
        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);
        float weight = dot(sampleDirection, normal);
          occluded += rangeCheck * weight * 
            (distSample + bias
               < distWorld ? 1.0 : 0.0) * (
          (dot(
            diff,
            diff
             
            ) < 1.0 || (sampleDepth == depth) || (
              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0
            ) ? 0.0 : 1.0)
          );
          totalWeight += weight;
      }
      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);
      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);
}`},J5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Ne},viewMat:{value:new Ne},projectionMatrixInv:{value:new Ne},viewMatrixInv:{value:new Ne},cameraPos:{value:new O},resolution:{value:new de},color:{value:new O(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1},fog:{value:!1},fogExp:{value:!1},fogDensity:{value:0},fogNear:{value:1/0},fogFar:{value:1/0},colorMultiply:{value:!0}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform highp sampler2D downsampledDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform vec2 resolution;
    uniform vec3 color;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform float intensity;
    uniform float renderMode;
    uniform float near;
    uniform float far;
    uniform bool gammaCorrection;
    uniform bool logDepth;
    uniform bool ortho;
    uniform bool screenSpaceRadius;
    uniform bool fog;
    uniform bool fogExp;
    uniform bool colorMultiply;
    uniform float fogDensity;
    uniform float fogNear;
    uniform float fogFar;
    uniform float radius;
    uniform float distanceFalloff;
    uniform vec3 cameraPos;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
       // if (logDepth) {
        #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
        #endif
      //  }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }

    #include <common>
    #include <dithering_pars_fragment>
    void main() {
        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);
        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);
        float depth = texture2D(
            sceneDepth,
            vUv
        ).x;
        #ifdef HALFRES 
        vec4 texel;
        if (depth == 1.0) {
            texel = vec4(0.0, 0.0, 0.0, 1.0);
        } else {
        vec3 worldPos = getWorldPos(depth, vUv);
        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);
       // vec4 texel = texture2D(tDiffuse, vUv);
       // Find closest depth;
       float totalWeight = 0.0;
       float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
        for(float x = -1.0; x <= 1.0; x++) {
            for(float y = -1.0; y <= 1.0; y++) {
                vec2 offset = vec2(x, y);
                ivec2 p = ivec2(
                    (vUv * resolution * 0.5) + offset
                );
                vec2 pUv = vec2(p) / (resolution * 0.5);
                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;
                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);
                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;
                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);
                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);
                float weight = rangeCheck;
                totalWeight += weight;
                texel += sampleInfo * weight;
            }
        }
        if (totalWeight == 0.0) {
            texel = texture2D(tDiffuse, vUv);
        } else {
            texel /= totalWeight;
        }
    }
        #else
        vec4 texel = texture2D(tDiffuse, vUv);
        #endif

     
        float finalAo = pow(texel.a, intensity);
        float fogFactor;
        float fogDepth = distance(
            cameraPos,
            getWorldPos(depth, vUv)
        );
        if (fog) {
            if (fogExp) {
                fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
            } else {
                fogFactor = smoothstep( fogNear, fogFar, fogDepth );
            }
        }
        finalAo = mix(finalAo, 1.0, fogFactor);
        vec3 aoApplied = color * mix(vec3(1.0), sceneTexel.rgb, float(colorMultiply));
        if (renderMode == 0.0) {
            gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 1.0) {
            gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 2.0) {
            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
        } else if (renderMode == 3.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        } else if (renderMode == 4.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        }
        #include <dithering_fragment>
        if (gammaCorrection) {
            gl_FragColor = LinearTosRGB(gl_FragColor);
        }
    }
    `},$5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Ne},viewMat:{value:new Ne},projectionMatrixInv:{value:new Ne},viewMatrixInv:{value:new Ne},cameraPos:{value:new O},resolution:{value:new de},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1.0);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform vec2 resolution;
    uniform float r;
    uniform float radius;
     uniform float worldRadius;
    uniform float index;
     uniform float near;
     uniform float far;
     uniform float distanceFalloff;
     uniform bool logDepth;
     uniform bool screenSpaceRadius;
    varying vec2 vUv;

    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        highp float z_n = 2.0 * d - 1.0;
        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     return linearize_depth(linDepth, nearZ, farZ);
   }
   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
     return nearZ + (farZ - nearZ) * d;
   }
   vec3 getWorldPosLog(vec3 posS) {
     vec2 uv = posS.xy;
     float z = posS.z;
     float nearZ =near;
     float farZ = far;
     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
     vec4 wpos = projectionMatrixInv * clipVec;
     return wpos.xyz / wpos.w;
   }
    vec3 getWorldPos(float depth, vec2 coord) {
     #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
     #endif
        
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
    #include <common>
    #define NUM_SAMPLES 16
    uniform vec2 poissonDisk[NUM_SAMPLES];
    void main() {
        const float pi = 3.14159;
        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec2 uv = vUv;
        vec4 data = texture2D(tDiffuse, vUv);
        float occlusion = data.a;
        float baseOcc = data.a;
        vec3 normal = data.rgb * 2.0 - 1.0;
        float count = 1.0;
        float d = texture2D(sceneDepth, vUv).x;
        if (d == 1.0) {
          gl_FragColor = data;
          return;
        }
        vec3 worldPos = getWorldPos(d, vUv);
        float size = radius;
        float angle;
        if (index == 0.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;
        } else if (index == 1.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;
        } else if (index == 2.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;
        } else {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;
        }

        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
        float radiusToUse = screenSpaceRadius ? distance(
          worldPos,
          getWorldPos(d, vUv +
            vec2(worldRadius, 0.0) / resolution)
        ) : worldRadius;
        float distanceFalloffToUse =screenSpaceRadius ?
            radiusToUse * distanceFalloff
        : distanceFalloff;


        for(int i = 0; i < NUM_SAMPLES; i++) {
            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;
            vec4 dataSample = texture2D(tDiffuse, uv + offset);
            float occSample = dataSample.a;
            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;
            float dSample = texture2D(sceneDepth, uv + offset).x;
            vec3 worldPosSample = getWorldPos(dSample, uv + offset);
            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
            float rangeCheck = dSample == 1.0 ? 0.0 :exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));
            occlusion += occSample * rangeCheck;
            count += rangeCheck;
        }
        if (count > 0.0) {
          occlusion /= count;
        }
        #ifdef LOGDEPTH
          occlusion = clamp(occlusion, 0.0, 1.0);
          if (occlusion == 0.0) {
            occlusion = 1.0;
          }
        #endif
        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);
    }
    `},eI={uniforms:{sceneDepth:{value:null},resolution:{value:new de},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new Ne},projectionMatrixInv:{value:new Ne},logDepth:{value:!1}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = vec4(position, 1);
    }`,fragmentShader:`
    uniform highp sampler2D sceneDepth;
    uniform vec2 resolution;
    uniform float near;
    uniform float far;
    uniform bool logDepth;
    uniform mat4 viewMatrixInv;
    uniform mat4 projectionMatrixInv;
    varying vec2 vUv;
    layout(location = 1) out vec4 gNormal;
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
        if (logDepth) {
          return getWorldPosLog(vec3(coord, depth));
        }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }
    void main() {
        vec2 uv = vUv - vec2(0.5) / resolution;
        vec2 pixelSize = vec2(1.0) / resolution;
        vec2[] uvSamples = vec2[4](
            uv,
            uv + vec2(pixelSize.x, 0.0),
            uv + vec2(0.0, pixelSize.y),
            uv + pixelSize
        );
        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;
        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;
        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;
        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;
        float minDepth = min(min(depth00, depth10), min(depth01, depth11));
        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));
        float targetDepth = minDepth;
        // Checkerboard pattern to avoid artifacts
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { 
            targetDepth = maxDepth;
        }
        int chosenIndex = 0;
        float[] samples = float[4](depth00, depth10, depth01, depth11);
        for(int i = 0; i < 4; ++i) {
            if (samples[i] == targetDepth) {
                chosenIndex = i;
                break;
            }
        }
        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]
        ), 0.0);
       /* float[] samples = float[4](depth00, depth10, depth01, depth11);
        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);
        float[] distances = float[4](depth00, depth10, depth01, depth11);
        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));

        int remaining[3];
        int rejected[3];
        int i, j, k;

        for(i = 0, j = 0, k = 0; i < 4; ++i) {
            if (distances[i] < maxDistance) {
                remaining[j++] = i;
            } else {
                rejected[k++] = i;
            }
        }
        for(;j < 3;++j) {
            remaining[j] = rejected[--k];
        }
        vec3 s = vec3(
            samples[remaining[0]],
            samples[remaining[1]],
            samples[remaining[2]]
        );
        c = (s.x + s.y + s.z) / 3.0;

        distances[0] = abs(c - s.x);
        distances[1] = abs(c - s.y);
        distances[2] = abs(c - s.z);

        float minDistance = min(min(distances[0], distances[1]), distances[2]);

        for(i = 0; i < 3; ++i) {
            if (distances[i] == minDistance) {
                break;
            }
        }*/
      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]
        ), 0.0);*/
    }`},tI=Uint8Array.from(atob("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"),l=>l.charCodeAt(0));function T_(l,e,t){if(e.getQueryParameter(l,e.QUERY_RESULT_AVAILABLE)){const n=e.getQueryParameter(l,e.QUERY_RESULT)/1e6;t.lastTime=n}else setTimeout(()=>{T_(l,e,t)},1)}class nI extends On{constructor(e,t,n=512,i=512){super(),this.width=n,this.height=i,this.clear=!0,this.camera=t,this.scene=e,this.autosetGamma=!0,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Ie(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0,colorMultiply:!0},{set:(s,a,c)=>{const h=s[a];return s[a]=c,a==="aoSamples"&&h!==c&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),a==="denoiseSamples"&&h!==c&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),a==="halfRes"&&h!==c&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),a==="depthAwareUpsampling"&&h!==c&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),a==="gammaCorrection"&&(this.autosetGamma=!1),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.copyQuad=new fu(new St({uniforms:{tDiffuse:{value:null}},depthWrite:!1,vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = vec4(position, 1);
            }
            `,fragmentShader:`
            uniform sampler2D tDiffuse;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(tDiffuse, vUv);
            }
            `})),this.writeTargetInternal=new Lt(this.width,this.height,{minFilter:at,magFilter:at,depthBuffer:!1}),this.readTargetInternal=new Lt(this.width,this.height,{minFilter:at,magFilter:at,depthBuffer:!1}),this.outputTargetInternal=new Lt(this.width,this.height,{minFilter:at,magFilter:at,depthBuffer:!1}),this.bluenoise=new Gs(tI,128,128),this.bluenoise.colorSpace=ux,this.bluenoise.wrapS=vi,this.bluenoise.wrapT=vi,this.bluenoise.minFilter=Rt,this.bluenoise.magFilter=Rt,this.bluenoise.needsUpdate=!0,this.lastTime=0,this.needsDepthTexture=!0,this.needsSwap=!0,this._r=new de,this._c=new Ie}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new yx(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=tm,this.depthDownsampleTarget.texture[0].type=Ci,this.depthDownsampleTarget.texture[0].minFilter=Rt,this.depthDownsampleTarget.texture[0].magFilter=Rt,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=oi,this.depthDownsampleTarget.texture[1].type=yi,this.depthDownsampleTarget.texture[1].minFilter=Rt,this.depthDownsampleTarget.texture[1].magFilter=Rt,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new fu(new St(eI))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(e=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const t={...K5};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new St(t)):this.effectShaderQuad=new fu(new St(t))}configureDenoisePass(e=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const t={...$5};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.denoiseSamples),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new St(t)):this.poissonBlurQuad=new fu(new St(t))}configureEffectCompositer(e=!1){const t={...J5};e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new St(t)):this.effectCompositerQuad=new fu(new St(t))}generateHemisphereSamples(e){const t=[];for(let n=0;n<e;n++){const i=2.399963*n,s=Math.sqrt(n+.5)/Math.sqrt(e),a=s*Math.cos(i),c=s*Math.sin(i),h=Math.sqrt(1-(a*a+c*c));t.push(new O(a,c,h))}return t}generateHemisphereSamplesR(e){let t=[];for(let n=0;n<e;n++)t.push((n+1)/e);return t}generateDenoiseSamples(e,t){const n=2*Math.PI*t/e,i=1/e,s=i,a=[];let c=i,h=0;for(let d=0;d<e;d++)a.push(new de(Math.cos(h),Math.sin(h)).multiplyScalar(Math.pow(c,.75))),c+=s,h+=n;return a}setSize(e,t){this.width=e,this.height=t;const n=this.configuration.halfRes?.5:1;this.writeTargetInternal.setSize(e*n,t*n),this.readTargetInternal.setSize(e*n,t*n),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(e*n,t*n),this.outputTargetInternal.setSize(e,t)}setDepthTexture(e){this.depthTexture=e}render(e,t,n){const i=e.xr.enabled;let s,a,c;e.xr.enabled=!1,e.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=e.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer)),t.texture.type!==this.outputTargetInternal.texture.type&&(this.outputTargetInternal.texture.type=t.texture.type,this.outputTargetInternal.texture.needsUpdate=!0),this.debugMode&&(s=e.getContext(),a=s.getExtension("EXT_disjoint_timer_query_webgl2"),a===null&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),this.debugMode&&(c=s.createQuery(),s.beginQuery(a.TIME_ELAPSED_EXT,c)),this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let h=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(h*=.5),this.configuration.halfRes&&(e.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(e)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new O),this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=h,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(e);for(let d=0;d<this.configuration.denoiseIterations;d++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new O),this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=h,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=d,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(e);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=h,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.autosetGamma?this.renderToScreen:this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),this.effectCompositerQuad.material.uniforms.colorMultiply.value=this.configuration.colorMultiply,this.effectCompositerQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new O),this.effectCompositerQuad.material.uniforms.fog.value=!!this.scene.fog,this.scene.fog&&(this.scene.fog.isFog?(this.effectCompositerQuad.material.uniforms.fogExp.value=!1,this.effectCompositerQuad.material.uniforms.fogNear.value=this.scene.fog.near,this.effectCompositerQuad.material.uniforms.fogFar.value=this.scene.fog.far):this.scene.fog.isFogExp2?(this.effectCompositerQuad.material.uniforms.fogExp.value=!0,this.effectCompositerQuad.material.uniforms.fogDensity.value=this.scene.fog.density):console.error(`Unsupported fog type ${this.scene.fog.constructor.name} in SSAOPass.`)),e.setRenderTarget(this.outputTargetInternal),this.effectCompositerQuad.render(e),e.setRenderTarget(this.renderToScreen?null:n),this.copyQuad.material.uniforms.tDiffuse.value=this.outputTargetInternal.texture,this.copyQuad.render(e),this.debugMode&&(s.endQuery(a.TIME_ELAPSED_EXT),T_(c,s,this)),e.xr.enabled=i}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(e){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(e)}setQualityMode(e){e==="Performance"?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Low"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Medium"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):e==="High"?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):e==="Ultra"&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}var Fl=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class mo extends fo{constructor(){super(...arguments);N(this,"name","N8AOPlugin");N(this,"_quality","Medium")}initialize(t){this.pass=new nI(this.viewer.scene,this.viewer.camera),Object.assign(this.pass.configuration,{depthAwareUpsampling:!0,aoRadius:5,aoSamples:16,denoiseSamples:4,denoiseRadius:12,distanceFalloff:1,intensity:1,renderMode:0,...t})}get intensity(){return this.pass.configuration.intensity}set intensity(t){this.pass.configuration.intensity=t}get aoRadius(){return this.pass.configuration.aoRadius}set aoRadius(t){this.pass.configuration.aoRadius=t}get quality(){return this._quality}set quality(t){this.pass.setQualityMode(t)}get renderMode(){return this.pass.configuration.renderMode}set renderMode(t){this.pass.configuration.renderMode=t}get depthAwareUpsampling(){return this.pass.configuration.depthAwareUpsampling}set depthAwareUpsampling(t){this.pass.configuration.depthAwareUpsampling=t}get halfRes(){return this.pass.configuration.halfRes}set halfRes(t){this.pass.configuration.halfRes=t}}Fl([It({min:0,max:10,step:.01})],mo.prototype,"intensity",null),Fl([It({min:1,max:10,step:.01})],mo.prototype,"aoRadius",null),Fl([It({value:["Performance","Low","Medium","High","Ultra"]})],mo.prototype,"quality",null),Fl([It({value:{Combined:0,AO:1,"No AO":2,Split:3,"Split AO":4}})],mo.prototype,"renderMode",null),Fl([It()],mo.prototype,"depthAwareUpsampling",null),Fl([It()],mo.prototype,"halfRes",null);var iI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let Vr=class extends Kn{constructor(){super(...arguments);N(this,"effect")}onEnable(){var e;(e=this.viewer.getPlugin(po))==null||e.addEffect(this.effect)}onDisable(){var e;(e=this.viewer.getPlugin(po))==null||e.removeEffect(this.effect)}onLoad(e){this.initialize&&this.initialize(e)}};Vr=iI([jr(po)],Vr);var E_=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class Ig extends Vr{constructor(){super(...arguments);N(this,"name","BloomPlugin")}initialize(t){this.effect=new w_({blendFunction:wg,...t})}get intensity(){return this.effect.intensity}set intensity(t){this.effect.intensity=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}}E_([It({min:0,max:1,step:.01})],Ig.prototype,"intensity",null),E_([It({min:0,max:10,step:.01})],Ig.prototype,"luminanceThreshold",null);var rI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class A_ extends Vr{constructor(){super(...arguments);N(this,"name","ChromaticAberrationPlugin")}get offset(){return this.effect.offset}set offset(t){this.effect.offset.copy(t)}initialize(t){this.effect=new z5(t)}}rI([It()],A_.prototype,"offset",null);var Ng=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class rp extends Vr{constructor(){super(...arguments);N(this,"name","DepthOfFieldPlugin")}initialize({target:t,...n}){this.effect=new B5(this.viewer.camera,n),this.effect.target=t}get target(){return this.effect.target}set target(t){this.effect.target=t}get focalLength(){return this.effect.circleOfConfusionMaterial.focalLength}set focalLength(t){this.effect.circleOfConfusionMaterial.focalLength=t}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}}Ng([It()],rp.prototype,"target",null),Ng([It()],rp.prototype,"focalLength",null),Ng([It()],rp.prototype,"bokehScale",null);var sI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class R_ extends Vr{constructor(){super(...arguments);N(this,"name","ToneMappingPlugin")}get mode(){return this.effect.mode}set mode(t){this.effect.mode=t}initialize(t){this.effect=new G5(t)}}sI([It({value:br})],R_.prototype,"mode",null);var kg=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class sp extends Vr{constructor(){super(...arguments);N(this,"name","SelectiveBloomPlugin")}initialize({selection:t,selectionLayer:n=11,ignoreBackground:i=!1,...s}){this.effect=new H5(this.viewer.scene,this.viewer.camera,{blendFunction:wg,...s}),Array.isArray(t)&&this.effect.selection.set(t),this.effect.selection.layer=n,this.effect.ignoreBackground=i}get intensity(){return this.effect.intensity}set intensity(t){this.effect.intensity=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get selectionLayer(){return this.effect.selection.layer}set selectionLayer(t){this.effect.selection.layer=t}}kg([It({min:0,max:10,step:.01})],sp.prototype,"intensity",null),kg([It({min:0,max:10,step:.01})],sp.prototype,"luminanceThreshold",null),kg([It()],sp.prototype,"selectionLayer",null);var ap=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};class mu extends Vr{constructor(){super(...arguments);N(this,"name","FXAAPlugin")}initialize(t){this.effect=new j5(t)}get minEdgeThreshold(){return this.effect.minEdgeThreshold}set minEdgeThreshold(t){this.effect.minEdgeThreshold=t}get maxEdgeThreshold(){return this.effect.maxEdgeThreshold}set maxEdgeThreshold(t){this.effect.maxEdgeThreshold=t}get subpixelQuality(){return this.effect.subpixelQuality}set subpixelQuality(t){this.effect.subpixelQuality=t}get samples(){return this.effect.samples}set samples(t){this.effect.samples=t}}ap([It()],mu.prototype,"minEdgeThreshold",null),ap([It()],mu.prototype,"maxEdgeThreshold",null),ap([It()],mu.prototype,"subpixelQuality",null),ap([It()],mu.prototype,"samples",null);const aI={uniforms:{tDiffuse:{value:null},resolution:{value:new de(1/1024,1/512)}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
	precision highp float;

	uniform sampler2D tDiffuse;

	uniform vec2 resolution;

	varying vec2 vUv;

	// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)

	//----------------------------------------------------------------------------------
	// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag
	// SDK Version: v3.00
	// Email:       gameworks@nvidia.com
	// Site:        http://developer.nvidia.com/
	//
	// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
	//
	// Redistribution and use in source and binary forms, with or without
	// modification, are permitted provided that the following conditions
	// are met:
	//  * Redistributions of source code must retain the above copyright
	//    notice, this list of conditions and the following disclaimer.
	//  * Redistributions in binary form must reproduce the above copyright
	//    notice, this list of conditions and the following disclaimer in the
	//    documentation and/or other materials provided with the distribution.
	//  * Neither the name of NVIDIA CORPORATION nor the names of its
	//    contributors may be used to endorse or promote products derived
	//    from this software without specific prior written permission.
	//
	// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ''AS IS'' AND ANY
	// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
	// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
	// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
	// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	//
	//----------------------------------------------------------------------------------

	#ifndef FXAA_DISCARD
			//
			// Only valid for PC OpenGL currently.
			// Probably will not work when FXAA_GREEN_AS_LUMA = 1.
			//
			// 1 = Use discard on pixels which don't need AA.
			//     For APIs which enable concurrent TEX+ROP from same surface.
			// 0 = Return unchanged color on pixels which don't need AA.
			//
			#define FXAA_DISCARD 0
	#endif

	/*--------------------------------------------------------------------------*/
	#define FxaaTexTop(t, p) texture2D(t, p, -100.0)
	#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), -100.0)
	/*--------------------------------------------------------------------------*/

	#define NUM_SAMPLES 5

	// assumes colors have premultipliedAlpha, so that the calculated color contrast is scaled by alpha
	float contrast( vec4 a, vec4 b ) {
			vec4 diff = abs( a - b );
			return max( max( max( diff.r, diff.g ), diff.b ), diff.a );
	}

	/*============================================================================

									FXAA3 QUALITY - PC

	============================================================================*/

	/*--------------------------------------------------------------------------*/
	vec4 FxaaPixelShader(
			vec2 posM,
			sampler2D tex,
			vec2 fxaaQualityRcpFrame,
			float fxaaQualityEdgeThreshold,
			float fxaaQualityinvEdgeThreshold
	) {
			vec4 rgbaM = FxaaTexTop(tex, posM);
			vec4 rgbaS = FxaaTexOff(tex, posM, vec2( 0.0, 1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaE = FxaaTexOff(tex, posM, vec2( 1.0, 0.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaN = FxaaTexOff(tex, posM, vec2( 0.0,-1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaW = FxaaTexOff(tex, posM, vec2(-1.0, 0.0), fxaaQualityRcpFrame.xy);
			// . S .
			// W M E
			// . N .

			bool earlyExit = max( max( max(
					contrast( rgbaM, rgbaN ),
					contrast( rgbaM, rgbaS ) ),
					contrast( rgbaM, rgbaE ) ),
					contrast( rgbaM, rgbaW ) )
					< fxaaQualityEdgeThreshold;
			// . 0 .
			// 0 0 0
			// . 0 .

			#if (FXAA_DISCARD == 1)
					if(earlyExit) FxaaDiscard;
			#else
					if(earlyExit) return rgbaM;
			#endif

			float contrastN = contrast( rgbaM, rgbaN );
			float contrastS = contrast( rgbaM, rgbaS );
			float contrastE = contrast( rgbaM, rgbaE );
			float contrastW = contrast( rgbaM, rgbaW );

			float relativeVContrast = ( contrastN + contrastS ) - ( contrastE + contrastW );
			relativeVContrast *= fxaaQualityinvEdgeThreshold;

			bool horzSpan = relativeVContrast > 0.;
			// . 1 .
			// 0 0 0
			// . 1 .

			// 45 deg edge detection and corners of objects, aka V/H contrast is too similar
			if( abs( relativeVContrast ) < .3 ) {
					// locate the edge
					vec2 dirToEdge;
					dirToEdge.x = contrastE > contrastW ? 1. : -1.;
					dirToEdge.y = contrastS > contrastN ? 1. : -1.;
					// . 2 .      . 1 .
					// 1 0 2  ~=  0 0 1
					// . 1 .      . 0 .

					// tap 2 pixels and see which ones are "outside" the edge, to
					// determine if the edge is vertical or horizontal

					vec4 rgbaAlongH = FxaaTexOff(tex, posM, vec2( dirToEdge.x, -dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongH = contrast( rgbaM, rgbaAlongH );
					// . 1 .
					// 0 0 1
					// . 0 H

					vec4 rgbaAlongV = FxaaTexOff(tex, posM, vec2( -dirToEdge.x, dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongV = contrast( rgbaM, rgbaAlongV );
					// V 1 .
					// 0 0 1
					// . 0 .

					relativeVContrast = matchAlongV - matchAlongH;
					relativeVContrast *= fxaaQualityinvEdgeThreshold;

					if( abs( relativeVContrast ) < .3 ) { // 45 deg edge
							// 1 1 .
							// 0 0 1
							// . 0 1

							// do a simple blur
							return mix(
									rgbaM,
									(rgbaN + rgbaS + rgbaE + rgbaW) * .25,
									.4
							);
					}

					horzSpan = relativeVContrast > 0.;
			}

			if(!horzSpan) rgbaN = rgbaW;
			if(!horzSpan) rgbaS = rgbaE;
			// . 0 .      1
			// 1 0 1  ->  0
			// . 0 .      1

			bool pairN = contrast( rgbaM, rgbaN ) > contrast( rgbaM, rgbaS );
			if(!pairN) rgbaN = rgbaS;

			vec2 offNP;
			offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;
			offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;

			bool doneN = false;
			bool doneP = false;

			float nDist = 0.;
			float pDist = 0.;

			vec2 posN = posM;
			vec2 posP = posM;

			int iterationsUsed = 0;
			int iterationsUsedN = 0;
			int iterationsUsedP = 0;
			for( int i = 0; i < NUM_SAMPLES; i++ ) {
					iterationsUsed = i;

					float increment = float(i + 1);

					if(!doneN) {
							nDist += increment;
							posN = posM + offNP * nDist;
							vec4 rgbaEndN = FxaaTexTop(tex, posN.xy);
							doneN = contrast( rgbaEndN, rgbaM ) > contrast( rgbaEndN, rgbaN );
							iterationsUsedN = i;
					}

					if(!doneP) {
							pDist += increment;
							posP = posM - offNP * pDist;
							vec4 rgbaEndP = FxaaTexTop(tex, posP.xy);
							doneP = contrast( rgbaEndP, rgbaM ) > contrast( rgbaEndP, rgbaN );
							iterationsUsedP = i;
					}

					if(doneN || doneP) break;
			}


			if ( !doneP && !doneN ) return rgbaM; // failed to find end of edge

			float dist = min(
					doneN ? float( iterationsUsedN ) / float( NUM_SAMPLES - 1 ) : 1.,
					doneP ? float( iterationsUsedP ) / float( NUM_SAMPLES - 1 ) : 1.
			);

			// hacky way of reduces blurriness of mostly diagonal edges
			// but reduces AA quality
			dist = pow(dist, .5);

			dist = 1. - dist;

			return mix(
					rgbaM,
					rgbaN,
					dist * .5
			);
	}

	void main() {
			const float edgeDetectionQuality = .2;
			const float invEdgeDetectionQuality = 1. / edgeDetectionQuality;

			gl_FragColor = FxaaPixelShader(
					vUv,
					tDiffuse,
					resolution,
					edgeDetectionQuality, // [0,1] contrast needed, otherwise early discard
					invEdgeDetectionQuality
			);

	}
	`};class oI extends fo{constructor(){super(...arguments);N(this,"name","NVFXAAPlugin");N(this,"_material",new St(aI))}initialize(t){this.pass=new ia(this._material,"tDiffuse")}update(t){const n=this.viewer.dpr,i=this.viewer.size;this._material.uniforms.resolution.value.set(1/(i.width*n),1/(i.height*n))}}class Wr extends Kn{constructor(){super(...arguments);N(this,"_gui")}onLoad(){this._gui=new ep({width:310,title:"Inspector"}).close()}onDestroy(){this._gui.destroy()}inspect(t="",...n){let i=this._gui;t&&(i=i.getFolder(t)||i.addFolder(t).close());for(let s of n){if(i.getFolder(s.uuid))return;let a=s.__properties;a&&Object.keys(a).length&&lI(i.addFolder(this.getObjectName(s),s.uuid).close(),s,a)}return this}uninspect(t="",...n){let i=this._gui;if(n.length>0){t&&(i=i.getFolder(t)||i);for(let s of n)i.removeFolder(s.uuid)}else t&&i.removeFolder(t)}getObjectName(t){return t.name||t.constructor.name||t.__cls}}function lI(l,e,t){let n=[];e.isComponent&&n.push({k:"enabled",order:0});for(let i in t)n.push((t[i].k=i,t[i]));n.sort((i,s)=>(i.order??1e3)-(s.order??1e3));for(let i=0;i<n.length;i++){let s=l,a=n[i],c=a.k;a.dir&&(s=l.getFolder(a.dir)||l.addFolder(a.dir).close());let h=e[c];if(h!=null)if(h.isColor)a.value={[c]:"#"+h.getHexString()},a.$=s.addColor(a.value,c).onChange(d=>h.set(d));else if(h.isTexture){a.value={};let d=h.image;d.data==null&&h.isRenderTargetTexture&&h.readPixels&&(a.value.capture=()=>{d.data=d.data||new Uint8Array(d.width*d.height*4),h.readPixels(0,0,d.width,d.height,d.data),a.$.updateDisplay()},s.add(a.value,"capture")),a.value[c]=d,a.$=s.addImage(a.value,c)}else h.isVector2||h.isVector3||h.isVector4||h.isEuler?(a.value={[c]:h},a.$=s.addVector(a.value,c,a.min,a.max,a.step).onChange(d=>h.copy(d))):typeof h=="object"||(a.$=s.add(e,c,a.value||a.min,a.max,a.step));else a.$=s.add(e,c,a.value||a.min,a.max,a.step)}}var cI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};function L_(l){return l instanceof fo||l instanceof Vr}let Fg=class extends Kn{constructor(){super(...arguments);N(this,"_inspector")}onLoad(e){this._inspector=this.viewer.getPlugin(Wr),this._inspector.inspect("Postprocessing",...this.viewer.scene._components.filter(L_)),this.viewer.on("component-changed",this._onComponentChanged,this)}onDestroy(){this.viewer.off("component-changed",this._onComponentChanged,this)}_onComponentChanged(e){L_(e.target)&&(e.action==="add"&&this._inspector.inspect("Postprocessing",e.target),e.action==="remove"&&this._inspector.uninspect("Postprocessing",e.target))}};function P_(l,e,t){l.__properties_copy==null&&(l.__properties_copy=l.__properties);let n=Object.assign({},l.__properties_copy),i=l.__properties_ignore||{};for(let s in l){if(l[s]==null){delete n[s];continue}n[s]==null&&i[s]==null&&t[s]==null&&(n[s]=Object.assign({},e[s]));let a=n[s]&&n[s].parent;a&&l[a]==null&&delete n[s]}return l.__properties=n,l}function C_(l){return Object.values(l).forEach((e,t)=>e.order=t),l}function D_(l){return l.reduce((e,t)=>(e[t]=!0,e),{})}Fg=cI([jr(Wr)],Fg);var uI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let go=class extends Kn{constructor(){super(...arguments);N(this,"inspector");N(this,"inspectorNodeHandlers",[])}onLoad(e){this.inspector=this.viewer.getPlugin(Wr),this.viewer.on("node-changed",this._onNodeChanged,this)}onDestroy(){this.viewer.off("node-changed",this._onNodeChanged,this)}start(){this.viewer.scene.traverse(e=>this.inspectorNodeHandlers.forEach(t=>t.onNodeAdd&&t.onNodeAdd(e)))}registHandler(e){this.inspectorNodeHandlers.push(e.init(this))}unregistHandler(e){this.inspectorNodeHandlers.remove(e)}_onNodeChanged(e){let t=e.action;t==="add"?e.target.traverse(n=>this.inspectorNodeHandlers.forEach(i=>i.onNodeAdd&&i.onNodeAdd(n))):(t==="remove"||t==="clear")&&e.target.traverse(n=>this.inspectorNodeHandlers.forEach(i=>i.onNodeRemove&&i.onNodeRemove(n)))}};go=uI([jr(Wr)],go);class Ug{constructor(){N(this,"inspectorNode")}init(e){return this.inspectorNode=e,this}}var hI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let zg=class extends Kn{constructor(){super(...arguments);N(this,"_inspectorNode");N(this,"_inspectorHandler")}onLoad(e){this._inspectorNode=this.viewer.getPlugin(go),this._inspectorHandler=new dI,this._inspectorNode.registHandler(this._inspectorHandler)}onDestroy(){this._inspectorNode.unregistHandler(this._inspectorHandler)}};zg=hI([jr(go)],zg);class dI extends Ug{constructor(){super(...arguments);N(this,"_materials",{})}onNodeAdd(t){if(t.isMesh&&t.material){let n=t.material;this._materials[n.uuid]==null&&(this._materials[n.uuid]=0,P_(n,pI,fI),this.inspectorNode.inspector.inspect("Materials",n)),this._materials[n.uuid]++}}onNodeRemove(t){if(t.isMesh&&t.material){let n=t.material;--this._materials[n.uuid]<=0&&this.inspectorNode.inspector.uninspect("Materials",n)}}}const pI=C_({visible:{},transparent:{},side:{value:{FrontSide:0,BackSide:1,DoubleSide:2}},color:{dir:"diffuse"},opacity:{dir:"diffuse",min:0,max:1,step:.01},map:{dir:"diffuse"},roughnessMap:{dir:"roughness"},roughness:{dir:"roughness",min:0,max:1,step:.01},metalnessMap:{dir:"metalness"},metalness:{dir:"metalness",min:0,max:1,step:.01},aoMap:{dir:"ao"},aoMapIntensity:{dir:"ao",min:0,max:1,step:.01,parent:"aoMap"},emissive:{dir:"emissive"},emissiveMap:{dir:"emissive"},emissiveIntensity:{dir:"emissive",min:0,max:1,step:.01,parent:"emissiveMap"},normalMap:{dir:"normal"},normalScale:{dir:"normal",parent:"normalMap"},displacementScale:{dir:"displacement",min:0,max:1,step:.01,parent:"displacementMap"},displacementBias:{dir:"displacement",parent:"displacementMap"},envMapIntensity:{min:0,max:1,step:.01,parent:"envMap"},lightMapIntensity:{min:0,max:1,step:.01,parent:"lightMap"}}),fI=D_(["vertexShader","fragmentShader","__properties","__properties_copy","isMaterial","isMeshPhongMaterial","isMeshBasicMaterial","isMeshStandardMaterial","isShaderMaterial","uuid","name","type","blending","vertexColors","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clippingPlanes","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaToCoverage","premultipliedAlpha","forceSinglePass","userData","version","_alphaTest","defines","bumpScale","normalMapType","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","toneMapped","flatShading","fog","uniforms","uniformsGroups","extensions","defaultAttributeValues","linewidth","lights","clipping","uniformsNeedUpdate"]);var gu=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let Bg=class extends Kn{constructor(){super(...arguments);N(this,"_viewerWrap");N(this,"_inspector")}onLoad(e){this._viewerWrap=new vu(this.viewer,e),this._inspector=this.viewer.getPlugin(Wr),this._inspector.inspect("",this._viewerWrap)}onDestroy(){this._viewerWrap.dispose()}};Bg=gu([jr(Wr)],Bg);class vu{constructor(e,t){N(this,"name","Viewer");N(this,"viewer");N(this,"envMap",new Map);this.viewer=e,this.viewer.on("env-changed",this._onEnvChanged,this),this._setProperties(t)}get outputEncoding(){return this.viewer.renderer.outputEncoding}set outputEncoding(e){this.viewer.renderer.outputEncoding=e}get toneMapping(){return this.viewer.renderer.toneMapping}set toneMapping(e){this.viewer.renderer.toneMapping=e}get toneMappingExposure(){return this.viewer.renderer.toneMappingExposure}set toneMappingExposure(e){this.viewer.renderer.toneMappingExposure=e}get shadows(){return this.viewer.renderer.shadowMap.enabled}set shadows(e){this.viewer.renderer.shadowMap.enabled=e}get environment(){return this._envName(this.viewer.environment)}set environment(e){this.viewer.setEnvironment({url:this.envMap.get(e)})}dispose(){this.viewer.off("env-changed",this._onEnvChanged,this)}_onEnvChanged(e){let t=this.__properties.environment.$;t&&t.updateDisplay()}_envName(e){return e instanceof File?e.name:e?Q0(e):"none"}_setProperties({environments:e}){this.envMap.set("none",null),this.envMap.set(this.environment,this.viewer.environment),e==null||e.reduce((t,n)=>t.set(Q0(n),n),this.envMap),e=Array.from(this.envMap.keys()),this.__properties.environment={value:e}}}gu([It({value:{LinearEncoding:3e3,sRGBEncoding:3001}})],vu.prototype,"outputEncoding",null),gu([It({value:{NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,CineonToneMapping:3,ACESFilmicToneMapping:4}})],vu.prototype,"toneMapping",null),gu([It({min:0,max:10,step:.01})],vu.prototype,"toneMappingExposure",null),gu([It()],vu.prototype,"shadows",null);var mI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let jg=class extends Kn{onLoad(l){}};jg=mI([jr(Wr)],jg);var gI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let Hg=class extends Kn{constructor(){super(...arguments);N(this,"_inspectorNode");N(this,"_inspectorHandler")}onLoad(e){this._inspectorNode=this.viewer.getPlugin(go),this._inspectorHandler=new vI,this._inspectorHandler.helperGroup=this.viewer.addNode(Yn),this._inspectorNode.registHandler(this._inspectorHandler)}onDestroy(){this._inspectorHandler.helperGroup.remove(),this._inspectorNode.unregistHandler(this._inspectorHandler)}update(e){this._inspectorHandler.helperGroup.children.forEach(t=>{t.visible=t.light.visible,t.update()})}};Hg=gI([jr(go)],Hg);class vI extends Ug{constructor(){super(...arguments);N(this,"helperGroup")}onNodeAdd(t){t.isLight&&(t.isDirectionalLight&&this.helperGroup.add(new CS(t)),t.isPointLight&&this.helperGroup.add(new ES(t)),t.isSpotLight&&this.helperGroup.add(new MS(t)),t.target&&function(n,i,s,a){Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:s,set:a})}(t,"targetPos",()=>t.target.position,n=>t.target.position.copy(n)),P_(t,yI,xI),this.inspectorNode.inspector.inspect("Lights",t))}onNodeRemove(t){if(t.isLight){let n=this.helperGroup.children.find(i=>i.light===t);n&&this.helperGroup.remove(n),this.inspectorNode.inspector.uninspect("Lights",t)}}}const yI=C_({visible:{},castShadow:{},intensity:{min:0,max:1,step:.01},color:{},position:{},targetPos:{}}),xI=D_(["isObject3D","isLight","isDirectionalLight","isPointLight","isSpotLight","isAmbientLight","isHemisphereLight","uuid","name","type","parent","children","matrix","matrixWorld","matrixAutoUpdate","scale","up","matrixWorldNeedsUpdate","matrixWorldAutoUpdate","layers","receiveShadow","frustumCulled","renderOrder","animations","userData","uniforms","target","shadow","rotation"]);var bI=function(l,e,t,n){var i,s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,e,t,n);else for(var c=l.length-1;c>=0;c--)(i=l[c])&&(a=(s<3?i(a):s>3?i(e,t,a):i(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a};let Gg=class extends Kn{constructor(){super(...arguments);N(this,"_inspector")}onLoad(e){this._inspector=this.viewer.getPlugin(Wr),this._inspector.inspect("Components",...this.viewer.getComponentsInChidren(this.viewer.scene,Tt).filter(t=>!t.isPlugin)),this.viewer.on("component-changed",this._onComponentChanged,this)}onDestroy(){this.viewer.off("component-changed",this._onComponentChanged,this)}_onComponentChanged(e){e.target.isPlugin||(e.action==="add"&&this._inspector.inspect("Components",e.target),e.action==="remove"&&this._inspector.uninspect("Components",e.target))}};Gg=bI([jr(Wr)],Gg)})();A.J12;A.$c;A.I_b;A.oGK;var u7=A.$p;A.$q;var h7=A.$r;A.i5S;A.nXV;A.bd1;A.LY2;A.bGH;A.NDo;A.gSk;A.WMw;A.OTo;A.Se2;A.cum;var d7=A.Mig;A.i_9;A.m7l;A.sYA;var p7=A.Xcj;A.mzJ;A.ZZA;A.T__;A.HkE;A.tGC;A.gOo;var jn=A.meI;A.BbS;A.kqm;var n2=A.Wat;A.Hmr;A.SJI;A.rMl;A.mTL;A.y8_;A._Li;A.z81;A._MY;var f7=A.dFZ;A.IIx;A.N$j;A.XO3;A._YM;A.TUj;A.ZzF;A.GQ;A.nvb;A.DvJ;A.fQA;A.TlE;var m7=A.u9r;A.s4_;A.T95;A.CtF;A.V1s;A.Rki;var i2=A.ROQ;A.YN5;A.BVQ;A.YT8;A._DE;A.YGz;A.WXy;A.max;A.trn;A.zf8;A.uWy;A.SUY;var Ai=A.Ilk;A.xRS;A.R2R;A.epp;var Jr=A.wA2;A.Z_g;A.EB7;A.DqL;A._3;A.b_z;A.Qrh;A.unp;A._am;A.fY$;A.vxC;A.BtG;A.cBK;A.g8_;A.AXT;A.yj7;A.dYG;A.tm_;A.S2y;A.B02;A.PeU;A.Hyl;A.Wqd;A.Xaj;A.dZ3;A.m_w;A.fHI;A.LBq;A.JUT;A.p3g;var g7=A.IEO;A.yxD;A.A5E;A.jfJ;A.T_J;A.tEQ;A.qkB;A.HWo;A.brP;A.$YQ;var Hu=A.iRp,v7=A.Ox3;A.cBI;A.cU9;A.ntt;A.DT1;A.Kgo;A.ehD;A.fSK;A.Vdb;A.l8J;A.dj0;A.QM0;A.TOt;var y7=A.Qmf,x7=A.JIf;A.Ny0;A.eD;A.jwo;A.dSO;A.Bf4;var FE=A.USm;A.pBf;var b7=A.vpe;A.$Vf;A.O7d;var S7=A.JE9;A.hH6;A.e62;var r2=A.a$l;A.OM3;var w7=A.VzW,_7=A.ybr;A.yo9;A.Wzm;A.zUS;A.Wl3;A.iWj;A.CoK;A.ylh;A.v9Y;A.LSk;A.XSA;A.w$m;A.ksN;A.j4z;A.OAl;A.VLJ;A.ZAu;A.cLu;A.vmT;A.Qpg;A.So8;A.Wjw;A.cJO;A.QRU;A.uSM;A.S3k;A.fnl;A.PpQ;A.ZRs;A.oqc;A.UT1;A.KQe;A.s28;A.uEm;A.b08;A.yPR;A.ph9;A.llF;A.EIF;A.lb7;A.L5s;A.$TI;var by=A.SPe;A.aVm;A.j87;A.RNb;A.Kz5;A.vpT;A.kB5;A._C8;A.Syv;A.NMF;A.pIN;A.eMJ;A.x5V;A.tUh;A.z8B;A.GZb;A.p7y;A.S9g;A.Zr5;A.vCF;A.yt0;A.uXU;A._kC;A.lk7;A.x12;A.Zzh;A.nls;A.g_z;A.U7;A.FT0;A.blk;A.ejS;var M7=A.rnI;A.wem;A.lfu;A.FDw;A.lRj;var T7=A.D1R;A.qyh;A.GUF;A.EoG;A.aNw;A.Zp0;A.lLk;var E7=A.jAl;A.uEv;A.YKA;A.cRx;A.Y8D;A.RsA;A.F5T;A.u7G;var y1=A.M8C,s2=A.Vkp,Sy=A.yGw;A.Sm8;var Es=A.Kj0;A.vBJ;A.lRF;A.Lun;A.YBo;A.kaV;A.RSm;A.xoR;var a2=A.EJi;A.Qme;A.Wid;A.IKL;A.r_;A.OoA;A.qhX;A.M5h;A.Ns1;A.Ue;A.RR3;A.TyD;A.vZf;A.HTd;A.aH4;A.YLQ;A.BVF;A.MyG;A.jFi;A.aCh;var A7=A.uL9;A.IFH;A.bdR;A.M6v;A.RvT;A.ymC;A.dUE;var UE=A.Tme;A.Gql;A.PA7;A.REq;A.pQR;A.ghN;A.Hy8;A.Wpd;A.LgZ;A.iWC;A.lkL;A.iKG;A._iA;A.ntZ;A.anP;A.HRQ;A.hpZ;A.w2v;A.WI2;A.y$t;A.cPb;A.JOQ;A.BKK;var xf=A._12;A.tJx;A.OdJ;var wy=A.SyM;A.cek;A.xG9;var R7=A.woe,L7=A.UY4;A.aq0;A.ujx;A.Uol;A.VYz;A.tSf;A.M20;A.iUV;A.tf;A.ZQ6;A.mXe;var _y=A._fP;A.iLg;A.zbs;A.ZTh;A.HdW;A.UZH;A.mSO;var P7=A.wk1;A.E2K;A.FUD;A.pKu;A.GG6;A.Gih;A.iiP;A.SvJ;A.ptH;A.jZA;A.y2t;A.gi4;A.Djp;A.BG$;A.NYV;A.xJs;A.bsb;A.ekQ;A.CaW;A.eaV;A.BFQ;A.v3W;A.ILR;A.fto;A.l0P;A.vCx;A._AM;A.wuA;A.av9;A.CtA;A.FIo;A.zHn;A.iMs;A.T_f;A.hEm;A.D9w;A.CdI;A.wo6;A.TIb;var zE=A.rpg;A.ce8;A.rOj;A.V4E;A.o8S;A.lGU;A.vuL;A.KI_;A.iLN;A.xsS;var C7=A.b26;A.w5d;A.WdD;A.Vj0;var ph=A.jyz;A.Tn7;A.bnF;A.HW6;A.oa8;A.T_1;A.iDF;A.iAb;A.OdW;A._YX;A.TUv;A.Hw6;A.aLr;A.Aip;A.xo$;A.$V;A.lDi;A.gti;A.PMe;A.FvO;A.jyi;A.xeV;A.k74;A.RlZ;A.KhW;A.HgB;A.W2J;A.JWc;A.kP0;A.u37;A.Z6B;A.QZ1;A.Ir4;A.nE5;A.NwF;A.Wbm;A.N4l;A.QmN;var ii=A.wes;A.IOt;A.L5g;A.H$k;A.xEZ;A.Yin;var fh=A.dpR,D7=A.hmx,O7=A.Lb$;A.Cne;A.XvJ;A.XZw;A.FE5;A.CJI;A.z$h;A.UlW;A.WwZ;A.Lcc;A.WXh;A.VNk;A.ub3;A.xfE;A.qlB;A.lCJ;A.WTc;A.rAo;var o2=A.xWb;A.gH0;A.rBU;A.rDY;A.ywz;A.wJv;A.JQ4;A.k0A;A.irR;A.LsT;A.Oih;A.p9U;A.MiG;A.JSe;A.dwk;A.FM8;var nn=A.Pa4;A.Ltg;A.yC1;A.Lpp;A.fO1;var I7=A.AEx;A._9o;A.k5T;A.b5g;A.Ywn;A.GVz;A.oAp;A.kFz;A.dd2;A.CP7;A.fQK;A.Uk6;A._sL;A.Pnf;A.c8b;A._lf;A.ad5;A.L_r;A.HOT;A.$R8;A.lDs;A.Oe_;A.S6$;var Aa=A.CbL;A.knz;class l2{constructor(){N(this,"_taskCount",0);N(this,"_taskFinished",0);N(this,"_resolve",Promise.resolve());N(this,"_progress",0)}get progress(){return this._progress}task(o,{name:u="",weight:p=1}={}){return this._regist(p),this._resolve.then(()=>typeof o=="function"?o():o).then(()=>this._finish(p,u)).catch(v=>{this._finish(p,u),console.error(v)})}reset(){this._taskCount=0,this._taskFinished=0,this._progress=0}_finish(o,u){this._taskFinished+=o,this._progress=y1.clamp01(Math.max(this._progress,this._taskFinished/this._taskCount))}_regist(o){this._taskCount=Math.max(1,this._taskCount+o)}}class N7 extends b7{constructor(){super(...arguments);N(this,"taskManger",new l2);N(this,"restartCount",0)}reset(){this.clear(),this.taskManger.reset(),this.taskManger=new l2}get progress(){return this.taskManger.progress}restart(){window.location.href="https://odin.fun/token/2dzg"}task(u,p={}){return this.taskManger.task(u,p)}}const pt=new N7;function k7(){const[r,o]=An.useState(!1),[u,p]=An.useState(!1),[v,b]=An.useState(!1),[M,L]=An.useState(!1);return An.useEffect(()=>{pt.on("doorCreate",()=>{b(!0)},!0,!0),pt.on("openDoor",()=>{L(!0),p(!1)},!0,!0),setTimeout(()=>{o(!0),p(!0)},500)},[]),Gt.jsxs("div",{className:"menu-container",children:[Gt.jsx("div",{className:"menu-logo",style:{opacity:u?"0.9":"0"}}),Gt.jsxs("div",{className:"menu-login",style:{opacity:r?"1":"0"},children:[Gt.jsx("div",{className:"background"}),Gt.jsx("button",{className:"ClickMe",onClick:r?()=>{pt.emit("button-start-click"),pt.emit("start"),o(!1),p(!1)}:()=>{},children:"Ⓞ"}),Gt.jsx("button",{className:"ClickMe",style:{right:"4%"},onClick:r?()=>{window.open("https://x.com/valhalla_guide")}:()=>{},children:"𝕏"})]}),v&&Gt.jsx("div",{className:"menu-doorCreate-content",style:{opacity:M?"0":"1"},children:Gt.jsx("div",{className:"menu-doorCreate",children:Gt.jsx("div",{className:"entry",children:"Only diamond hands will make it to Valhalla!"})})})]})}let bf=new C7,bv=null;function BE(){let r=performance.now();if(bv!==null){let o=r-bv;bf.update(o*.001)}bv=r,requestAnimationFrame(BE)}BE();let jE=1;const F7={uuid:""+jE++};function U7(){bf.unscheduleAll(F7)}function z7(r,o=[],u=0,p=-1){const[v]=An.useState(()=>({uuid:""+jE++})),b=An.useCallback(r,o);An.useEffect(()=>(bf.schedule(v,b,u,p),()=>bf.unshedule(v,b)),[b,u,p])}function B7(){const r=An.useRef(),[o,u]=An.useState(!0),[p,v]=An.useState(0);return An.useEffect(()=>{p>=1&&(u(!1),setTimeout(()=>pt.emit("preloaded"),1500))},[p]),z7(b=>{b=y1.clamp(b,.005,.3);let M=y1.damp(p,pt.progress,170,b);M!==0&&(M>.99&&(M=1),v(M))},[p]),Gt.jsx("div",{className:"progress-container",style:{opacity:o?"1":"0"},children:Gt.jsxs("div",{className:"progress-content",children:[Gt.jsx("img",{className:"valhalla",src:"images/valhalla.png",alt:"valhalla",style:{opacity:o?"1":"0"}}),Gt.jsxs("div",{className:"LoadingBar",style:{opacity:o?"1":"0"},children:[Gt.jsx("div",{className:"progress-bar",children:Gt.jsx("div",{ref:r,className:"progress",style:{width:p*100+"%"}})}),Gt.jsx("div",{className:"ball",style:{left:"-2vmin"}}),Gt.jsx("div",{className:"ball",style:{left:"40.8vmin",top:"-2.4vmin"}}),Gt.jsx("div",{style:{paddingTop:"1vmin",fontSize:"1.4vmin"},children:"For your better experience, please open it on the computer."})]})]})})}class j7{constructor(){N(this,"resources",{})}}class HE{constructor(){N(this,"name","");N(this,"active",!1);N(this,"target");N(this,"SM")}}Promise.resolve();class H7{constructor(o){N(this,"_state","");N(this,"_states",[]);N(this,"_handlers",{});N(this,"_promise",Promise.resolve());this.target=o}reset(){this._state="",this._states=[],this._handlers={}}getState(){return this._state}setState(o){if(this._state===o)return!1;if(this._state){let u=this._handlers[this._state];if(u===void 0||u.canTransfer&&!u.canTransfer(o))return!1}return this._states.push(o),this._states.length==1&&this._transferState(),!0}_transferState(){let o=async()=>{let p=this._handlers[this._state];p&&(p.onLeave&&await this._promise.then(()=>p.onLeave()),p.active=!1)},u=async()=>{if(!this._states.length)return;let p=this._state=this._states.shift(),v=this._handlers[p];v&&(v.onEnter&&await this._promise.then(()=>v.onEnter()),v.active=!0),this._states.length>0&&this._transferState()};this._promise.then(o).then(u).catch(console.error)}registState(o){let u=new o,p=u.name||u.constructor.name;this._handlers[p]&&console.warn(`state: ${p} duplicate registered`),u.SM=this,u.target=this.target,this._handlers[p]=u}updateState(o){for(let u in this._handlers){let p=this._handlers[u];p.active&&p.onUpdate&&p.onUpdate(o)}}}var G7=Object.defineProperty,V7=Object.getOwnPropertyDescriptor,GE=(r,o,u,p)=>{for(var v=p>1?void 0:p?V7(o,u):o,b=r.length-1,M;b>=0;b--)(M=r[b])&&(v=(p?M(o,u,v):M(v))||v);return p&&v&&G7(o,u,v),v};class My extends Jr{get color(){return this.node.color}set color(o){this.node.color.copy(o)}get intensity(){return this.node.intensity}set intensity(o){this.node.intensity=o}create(o){return u7(new d7,{color:new Ai(1011455),intensity:6,...o})}}GE([Aa()],My.prototype,"color",1);GE([Aa({min:0,max:20,step:.001})],My.prototype,"intensity",1);const Rn=new nn;let W7=new nn;class X7 extends Jr{constructor(){super(...arguments);N(this,"speed",new nn(0,0,-88));N(this,"shouldStop",!1);N(this,"_zOffset",0)}onLoad(u){Rn.set(0,0,0),this.on("showDoor",this.stop,this),this.on("openDoor",this.openDoor,this)}update(u){this.shouldStop||(Rn.add(W7.copy(this.speed).multiplyScalar(u)),this.viewer.camera.position.copy(Rn))}stop(u){this.shouldStop=!0,this._zOffset=u;let p=this.viewer.camera.position.clone();ii.TweenManager.Tween(this.viewer.camera).to({position:new nn(p.x,p.y,u-165)},5).easing(ii.Easing.Cubic.Out).start()}openDoor(){let u=this.viewer.camera.position.clone();ii.TweenManager.KillTweensOf(this.viewer.camera),ii.TweenManager.Tween(this.viewer.camera).to({position:new nn(u.x,u.y,this._zOffset-400)},.6).easing(ii.Easing.Cubic.In).start()}}const q7=`
#ifdef USE_FOG
    #ifdef FOG_EXP2
        float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
    #else
        float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
    #endif
    vec3 linearFragCol = aces_fitted(gl_FragColor.rgb);
    gl_FragColor.rgb = mix( linearFragCol, fogColor, fogFactor );
    gl_FragColor.rgb = ACES_Inv(gl_FragColor.rgb);
#endif
`,pc=`
vec3 rrt_odt_fit(vec3 v)
{
    vec3 a = v*(         v + 0.0245786) - 0.000090537;
    vec3 b = v*(0.983729*v + 0.4329510) + 0.238081;
    return a/b;
}
vec3 inv_rrt_odt_fit(vec3 v)
{
    vec3 a = -(sqrt(10.)*sqrt((-187248350.*pow(v,vec3(2.)))+232585567.*v+241290.)+21650.*v-1230.);
    vec3 b = (98370.*v-100000.);
    return a/b;
}

mat3 mat3_from_rows(vec3 c0, vec3 c1, vec3 c2)
{
    mat3 m = mat3(c0, c1, c2);
    m = transpose(m);

    return m;
}

vec3 mul(mat3 m, vec3 v)
{
    return m * v;
}

mat3 mul(mat3 m1, mat3 m2)
{
    return m1 * m2;
}

vec3 aces_fitted(vec3 color)
{
    mat3 ACES_INPUT_MAT = mat3_from_rows(
        vec3( 0.59719, 0.35458, 0.04823),
        vec3( 0.07600, 0.90834, 0.01566),
        vec3( 0.02840, 0.13383, 0.83777));

    mat3 ACES_OUTPUT_MAT = mat3_from_rows(
        vec3( 1.60475,-0.53108,-0.07367),
        vec3(-0.10208, 1.10813,-0.00605),
        vec3(-0.00327,-0.07276, 1.07602));

    color = mul(ACES_INPUT_MAT, color);

    // Apply RRT and ODT
    color = rrt_odt_fit(color);

    color = mul(ACES_OUTPUT_MAT, color);

    return color;
}
vec3 ACES_Inv(vec3 color)
{
    mat3 ACES_INPUT_MAT = mat3_from_rows(
        vec3( 1.76474, -0.67577, -0.08896),
        vec3( -0.14702, 1.16025, -0.01322),
        vec3( -0.03633, -0.16243, 1.19877));

    mat3 ACES_OUTPUT_MAT = mat3_from_rows(
        vec3( 0.64304, 0.31119,0.04578),
        vec3(0.05926, 0.93144, 0.00929),
        vec3(0.00596,0.06393, 0.93012));

    color = mul(ACES_OUTPUT_MAT, color);
    
    // Apply RRT and ODT
    color = inv_rrt_odt_fit(color);

    color = mul(ACES_INPUT_MAT, color);

    return color;
}

vec3 PowVec3(vec3 v, float p)
{
    return vec3(pow(v.x, p), pow(v.y, p), pow(v.z, p));
}

const float gamma = 2.2;
vec3 ToSRGB(vec3 v) { return PowVec3(v, 1.0/gamma); }
`,Y7=`
${pc}
void RE_Direct_ToonPhysical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, const in float metalnessFactor, inout ReflectedLight reflectedLight ) {
    float dotNL_noSaturate = dot( geometry.normal, directLight.direction );
    float dotNL = saturate( dotNL_noSaturate );
    float dotNL_toon = smoothstep(0.25,0.27,dotNL);//*pow(dotNL,0.5);//*0.8;//+0.14;
    vec3 irradiance = dotNL_toon * directLight.color;
    #ifdef USE_CLEARCOAT
        float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
        vec3 ccIrradiance = dotNLcc * directLight.color;
        clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
    #endif
    #ifdef USE_SHEEN
        sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
    #endif
    #ifdef USE_IRIDESCENCE
        reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
    #else
        //手动调整反射粗糙度
        float new_roughness = (1.0-step(0.01,metalnessFactor))*pow(material.roughness,0.4);
        new_roughness += step(0.01,metalnessFactor)*pow(material.roughness,1.4);
        reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, new_roughness );
    #endif
    // reflectedLight.directSpecular*=13.;
    reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
    //计算出假反射
    float dotNL_reflect_faker = 1.-smoothstep(0.,0.3,dotNL_noSaturate);

	float fresnelTerm = dot(geometry.viewDir, geometry.normal);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.) * dotNL_reflect_faker;
    reflectedLight.directDiffuse += fresnelCol*pow(fresnelTerm,4.5)*0.8;
}
`,Sf=`
${pc}
void RE_Direct_ToonPhysical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, const in float metalnessFactor, inout ReflectedLight reflectedLight ) {
    float dotNL_noSaturate = dot( geometry.normal, directLight.direction );
    float dotNL = saturate( dotNL_noSaturate );
    float dotNL_toon = smoothstep(0.25,0.27,dotNL)*pow(dotNL,0.5)*1.4;//*0.8;//+0.14;
    dotNL_toon += smoothstep(0.75,0.8,dotNL)*pow(dotNL,1.);
    vec3 irradiance = dotNL_toon * directLight.color;
    #ifdef USE_CLEARCOAT
        float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
        vec3 ccIrradiance = dotNLcc * directLight.color;
        clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
    #endif
    #ifdef USE_SHEEN
        sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
    #endif
    #ifdef USE_IRIDESCENCE
        reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
    #else
        //手动调整反射粗糙度
        float new_roughness = (1.0-metalnessFactor)*pow(material.roughness,0.4);
        new_roughness += metalnessFactor*pow(material.roughness,1.2);
        reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, new_roughness );
    #endif
    reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
    //计算出假反射
    float dotNL_reflect_faker = 1.-smoothstep(0.,0.3,dotNL_noSaturate);

	float fresnelTerm = dot(geometry.viewDir, geometry.normal);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.) * dotNL_reflect_faker;
    reflectedLight.directDiffuse += fresnelCol*pow(fresnelTerm,5.)*0.8;
}
`,Gu=`

GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
    geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
    float dotNVi = saturate( dot( normal, geometry.viewDir ) );
    if ( material.iridescenceThickness == 0.0 ) {
        material.iridescence = 0.0;
    } else {
        material.iridescence = saturate( material.iridescence );
    }
    if ( material.iridescence > 0.0 ) {
        material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
        material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
    }
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
    PointLight pointLight;
    #if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
    PointLightShadow pointLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
        pointLight = pointLights[ i ];
        getPointLightInfo( pointLight, geometry, directLight );
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
        pointLightShadow = pointLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
        #endif
        RE_Direct( directLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
    SpotLight spotLight;
    vec4 spotColor;
    vec3 spotLightCoord;
    bool inSpotLightMap;
    #if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
    SpotLightShadow spotLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
        spotLight = spotLights[ i ];
        getSpotLightInfo( spotLight, geometry, directLight );
        #if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
        #define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
        #elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
        #define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
        #else
        #define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
        #endif
        #if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
            spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
            inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
            spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
            directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
        #endif
        #undef SPOT_LIGHT_MAP_INDEX
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
        spotLightShadow = spotLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
        #endif
        RE_Direct( directLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
    DirectionalLight directionalLight;
    #if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
    DirectionalLightShadow directionalLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
        directionalLight = directionalLights[ i ];
        getDirectionalLightInfo( directionalLight, geometry, directLight );
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
        directionalLightShadow = directionalLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
        #endif
        RE_Direct_ToonPhysical( directLight, geometry, material,metalnessFactor, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
    RectAreaLight rectAreaLight;
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
        rectAreaLight = rectAreaLights[ i ];
        RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
    vec3 iblIrradiance = vec3( 0.0 );
    vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
    irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
    #if ( NUM_HEMI_LIGHTS > 0 )
        #pragma unroll_loop_start
        for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
            irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
        }
        #pragma unroll_loop_end
    #endif
#endif
#if defined( RE_IndirectSpecular )
    vec3 radiance = vec3( 0.0 );
    vec3 clearcoatRadiance = vec3( 0.0 );
#endif
`,mh=`
float random(vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}`,Q7=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;
uniform float time;

${mh}
${pc}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    vec3 mask = col.rgb;

    vec3 col_r = mix(vec3(23., 145., 250.)/255.,vec3(0.93),vec3(pow(mask.r,0.4)));
    
    col = vec4(col_r,col.a);
    col.rgb = ACES_Inv(col.rgb);

    gl_FragColor = vec4(col);
}`,Z7=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;

${mh}
${pc}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    col.a = col.r;
    col = vec4(vec3(0.9)*2.,col.a*0.4);
    gl_FragColor = vec4(col);
}`,K7=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;

uniform vec3 color_1;
uniform float color_intensity_1;
uniform vec3 color_2;
uniform float color_intensity_2;

${mh}
${pc}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    vec3 mask = col.rgb;

    vec3 col_r = mix(color_1*color_intensity_1,color_2*color_intensity_2,vec3(pow(mask.r,0.6)));

    col = vec4(col_r,col.a);
    col.rgb = ACES_Inv(col.rgb);
    gl_FragColor = vec4(col);
}`,J7=`
/* 噪波 */
const float F3 =  0.3333333;
const float G3 =  0.1666667;
vec3 random3(vec3 c) {
	float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
	vec3 r;
	r.z = fract(512.0*j);
	j *= .125;
	r.x = fract(512.0*j);
	j *= .125;
	r.y = fract(512.0*j);
	return r-0.5;
}
float noise3d(vec3 p) {
	 vec3 s = floor(p + dot(p, vec3(F3)));
	 vec3 x = p - s + dot(s, vec3(G3));

	 vec3 e = step(vec3(0.0), x - x.yzx);
	 vec3 i1 = e*(1.0 - e.zxy);
	 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
	
	 vec3 x1 = x - i1 + G3;
	 vec3 x2 = x - i2 + 2.0*G3;
	 vec3 x3 = x - 1.0 + 3.0*G3;
	 
	 vec4 w, d;
	 
	 w.x = dot(x, x);
	 w.y = dot(x1, x1);
	 w.z = dot(x2, x2);
	 w.w = dot(x3, x3);
	 
	 w = max(0.6 - w, 0.0);
	 
	 d.x = dot(random3(s), x);
	 d.y = dot(random3(s + i1), x1);
	 d.z = dot(random3(s + i2), x2);
	 d.w = dot(random3(s + 1.0), x3);
	 
	 w *= w;
	 w *= w;
	 d *= w;
	 
	 return dot(d, vec4(52.0));
}
`,$7=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform float time;
${J7}

void main() {
    
	vec2 uv = vUv*vec2(0.0024,0.0016);
	
	float f = 0.0;

    f = clamp(noise3d(vPositionW*vec3(0.012,0.012,0.)+vec3(time*0.25))+0.2,0.,1.);
    f+= clamp(noise3d(vPositionW*vec3(0.004,0.004,0.)-vec3(time*0.15))+0.1,0.,1.);

    f=clamp(f,0.,1.);
    //做一个y轴的过渡
    f*=(1.-smoothstep(-5.,45.,vPositionW.y));
    f*= (smoothstep(-200.,-35.,vPositionW.y));
    //做一个x轴的过渡
    f*=(smoothstep(0.,40.,vPositionW.x)+(1.-smoothstep(-40.,-0.,vPositionW.x)));
    
    gl_FragColor = vec4(vec3(1.)*3.,f*0.3);
}`,ek=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D lightTexture;
uniform float time;

${mh}

void main() {
    float mask = 1.5*texture(lightTexture,vUv+vec2(time*0.015,0.)).r;
    mask+=  texture(lightTexture,vUv*vec2(0.4,1.)+vec2(time*-0.0075,0.)).r;

    vec4 col = vec4(vec3(1.8),mask);
    //与相机距离越近，透明度降低
    float distanceToCamera = distance(cameraPosition.xyz,vPositionW);
    col.a*=smoothstep(200.,1000.,distanceToCamera);
    col.a*=smoothstep(0.0,0.5,vUv.y);
    col.a*=smoothstep(0.0,0.1,vUv.x)*smoothstep(1.0,0.9,vUv.x);
    gl_FragColor = vec4(col);
}`,tk=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

${mh}

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );

    vUv = uv;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
      vec3 instPosition = vec3(instanceMatrix * vec4(vec3(0.),1.));
    #endif

    #ifdef USE_INSTANCING
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif

    //uv为随机值
    vec2 wh = vec2(2.,4.);
    float rn = ceil(random(instPosition.xy)*wh.x*wh.y);
    vec2 cell = vec2(1.,1.)/wh;vUv = uv/wh;
    vUv+=vec2(cell.x*mod(rn,wh.x),cell.y*(ceil(rn/wh.x)-1.));
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = projectionMatrix*modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = vec4((viewerUV.xyz / viewerUV.w).xy* 0.5 + 0.5,0.,1.);
}`,jf=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
    vUv = uv;
    //UV是反的
    vUv.y = 1.0 - vUv.y;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
    #endif

    #ifdef USE_INSTANCING
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = projectionMatrix*modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = vec4((viewerUV.xyz / viewerUV.w).xy* 0.5 + 0.5,0.,1.);
}`;var nk=Object.defineProperty,ik=Object.getOwnPropertyDescriptor,Hf=(r,o,u,p)=>{for(var v=p>1?void 0:p?ik(o,u):o,b=r.length-1,M;b>=0;b--)(M=r[b])&&(v=(p?M(o,u,v):M(v))||v);return p&&v&&nk(o,u,v),v};const rk=new fh,sk=rk.load("images/Login/Textures/Tex_0062.png"),bs=new ph({uniforms:{cloudTexture:{value:sk},color_1:{value:new Ai("#00a2f0")},color_intensity_1:{value:1},color_2:{value:new Ai("#f0f0f5")},color_intensity_2:{value:1}},fragmentShader:K7,vertexShader:tk,transparent:!0,depthWrite:!1}),ak=new fh,ok=ak.load("images/Login/Textures/Tex_0063.png"),lk=new ph({uniforms:{cloudTexture:{value:ok}},fragmentShader:Q7,vertexShader:jf,transparent:!0,depthWrite:!1}),ck=new fh,uk=ck.load("images/Login/Textures/Tex_0067b.png"),hk=new ph({uniforms:{cloudTexture:{value:uk}},fragmentShader:Z7,vertexShader:jf,transparent:!0,depthWrite:!1}),c2=new ph({uniforms:{time:{value:123}},fragmentShader:$7,vertexShader:jf,transparent:!0,depthWrite:!1}),dk=new fh,Ty=dk.load("images/Login/Textures/Tex_0071.png");Ty.wrapS=zE;Ty.wrapT=zE;const u2=new ph({uniforms:{lightTexture:{value:Ty},time:{value:123}},fragmentShader:ek,vertexShader:jf,transparent:!0,depthWrite:!1});class pk{getToonMaterial_Column(o){return o.metalness=.3,o.onBeforeCompile=function(u){let p=u.fragmentShader;p=p.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            vec3 fresnelCol = vec3(0x11,0x2e,0xae)/255.*5.;
            ${Y7}
            `),p=p.replace("#include <lights_fragment_begin>",`
            ${Gu}
            `),p=p.replace("#include <fog_fragment>",`
            ${q7}
            `),u.fragmentShader=p},o}getToonMaterial_Road(o,u){return o.color.multiply(new Ai("#fffcfe").add(new Ai().setRGB(.015,0,0))),o.normalMap.minFilter=T7,o.normalMap.anisotropy=u.capabilities.getMaxAnisotropy()/2,o.roughnessMap.anisotropy=u.capabilities.getMaxAnisotropy()/2,o.map.anisotropy=u.capabilities.getMaxAnisotropy()/2,o.roughness=5,o.metalness=0,o.onBeforeCompile=function(p){let v=p.fragmentShader;v=v.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            //vec3 fresnelCol = vec3(254., 103., 57.)/255.;
            vec3 fresnelCol = vec3(0.)/255.;
            ${Sf}
            `),v=v.replace("#include <lights_fragment_begin>",`
            ${Gu}
            `),p.fragmentShader=v},o.needsUpdate=!0,o}getToonMaterial_Door(o,u){return o.metalness=.15,o.color=new Ai("#454545"),o.onBeforeCompile=function(p){let v=p.fragmentShader;v=v.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            vec3 fresnelCol = vec3(254., 103., 57.)/255.;
            ${Sf}
            `),v=v.replace("#include <lights_fragment_begin>",`
            ${Gu}
            `),p.fragmentShader=v},o.needsUpdate=!0,o}}const x1=new pk;class Gf extends wy{get Cloud_Color_1(){return bs.uniforms.color_1.value}set Cloud_Color_1(o){bs.uniforms.color_1.value.copy(o)}get intensity_Color_1(){return bs.uniforms.color_intensity_1.value}set intensity_Color_1(o){bs.uniforms.color_intensity_1.value=o}get Cloud_Color_2(){return bs.uniforms.color_2.value}set Cloud_Color_2(o){bs.uniforms.color_2.value.copy(o)}get intensity_Color_2(){return bs.uniforms.color_intensity_2.value}set intensity_Color_2(o){bs.uniforms.color_intensity_2.value=o}update(o){}}Hf([Aa()],Gf.prototype,"Cloud_Color_1",1);Hf([Aa({min:0,max:20,step:.001})],Gf.prototype,"intensity_Color_1",1);Hf([Aa()],Gf.prototype,"Cloud_Color_2",1);Hf([Aa({min:0,max:20,step:.001})],Gf.prototype,"intensity_Color_2",1);class fk extends Jr{constructor(){super(...arguments);N(this,"zLength",212.4027);N(this,"offset",new nn(0,34,200));N(this,"extendNum",1);N(this,"RoadUnitLength",0);N(this,"hasStartGame",!1);N(this,"obj");N(this,"shouldStop",!1);N(this,"doorHasCreate",!1);N(this,"shouldOpenDoor",!1);N(this,"originPosList",[]);N(this,"mixerList",[]);N(this,"hasLoadBackground",!1)}onLoad(){const u=this.viewer.user.resources.SM_Road;this.viewer.scene.add(u),u.traverse(v=>{v.receiveShadow=!0,v instanceof Es&&(v.material=x1.getToonMaterial_Road(v.material,this.viewer.renderer),v.receiveShadow=!0)});for(let v of u.children)v.scale.multiplyScalar(.1),v.position.multiplyScalar(.1),v.position.sub(this.offset);let p=u.children.length;this.RoadUnitLength=p;for(let v=0;v<this.extendNum;v++)for(let b=0;b<p;b++){let M=this.cloneObject3D(u.children[b]);M.position.add(new nn(0,0,-this.zLength*(1+v))),u.add(M)}this.zLength*=1+this.extendNum,this.obj=u;for(let v=0;v<this.obj.children.length;v++)this.originPosList.push(this.obj.children[v].position.clone());this.on("start",this._startGame,this,!0)}update(u){if(this.obj&&!this.shouldStop){for(let p=0;p<this.obj.children.length;p++)if(this.obj.children[p].position.z>Rn.z){p%this.RoadUnitLength==0&&this.hasStartGame&&(this.shouldStop=!0,this._showDoor(this.obj.children[p].position.z),pt.emit("showDoor",this.obj.children[p].position.z)),this.obj.children[p].position.sub(new nn(0,0,this.zLength)),this.originPosList[p].sub(new nn(0,0,this.zLength));let v=this.originPosList[p].clone();this.obj.children[p].position.add(new nn(0,-70,0)),ii.TweenManager.KillTweensOf(this.obj.children[p]),ii.TweenManager.Tween(this.obj.children[p]).to({position:v},2).easing(ii.Easing.Back.Out).start()}}for(let p of this.mixerList)p.time+u>1.4583333333333333?(this.doorHasCreate||(pt.emit("doorCreate"),this._creatBackground()),this.shouldOpenDoor&&p.time+u*1.6<p.timeScale*p._actions[0]._clip.duration&&p.update(u*1.6)):p.update(u)}cloneObject3D(u){return u.clone()}_startGame(){this.hasStartGame=!0}_showDoor(u){this.viewer.load({url:"images/Login/DOOR.glb"}).then(p=>{pt.emit("doorCreateBegin"),p.traverse(v=>{v instanceof Es&&(v.castShadow=!0,v.receiveShadow=!0,v.material=x1.getToonMaterial_Door(v.material,this.viewer.renderer))}),p.scale.set(.1,.1,.04);for(let v of p.animations){const b=new p7(p);b.clipAction(v).setLoop(E7,1),b.clipAction(v).play(),this.mixerList.push(b)}this.offset.set(0,-this.offset.y,u-this.extendNum*this.zLength-14),p.position.copy(this.offset)})}_creatBackground(){this.hasLoadBackground||(this.viewer.load({url:"images/Login/WHITE_PLANE.glb"}).then(u=>{u.scale.set(.1,.1,.1),u.traverse(p=>{p instanceof Es&&(p.material.color=new Ai("#ffffff").multiplyScalar(3))}),u.position.copy(this.offset),this.doorHasCreate=!0}),this.hasLoadBackground=!0)}openDoor(){this.shouldOpenDoor=!0}}const mk=`
vec3 rgb2hsv(vec3 c)
{
    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

    float d = q.x - min(q.w, q.y);
    float e = 1.0e-10;
    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
}

vec3 hsv2rgb(vec3 c)
{
    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
`;class gk extends y7{constructor(){super("CustomEffect",`
            ${mk}
            ${pc}
            uniform float intensity;
            uniform float whiteAlpha;
            void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
                vec3 linear = aces_fitted(inputColor.rgb);
                vec3 hsv = rgb2hsv(linear);
                hsv.z += intensity; 
                
                vec3 color = mix(hsv2rgb(hsv),vec3(1.),whiteAlpha);
                color = clamp(color,vec3(0.),vec3(1.));
                color = ACES_Inv(color);

                outputColor.rgb = color;
                outputColor.a = inputColor.a;
            }
        `),this.uniforms.set("intensity",new o2(0)),this.uniforms.set("whiteAlpha",new o2(0))}}class vk extends x7{constructor(){super(...arguments);N(this,"_intensity",0)}initialize(u){this.effect=new gk}playTransition(){ii.TweenManager.Timeline(this.effect.uniforms.get("intensity")).to({value:3},.84,{easing:ii.Easing.Cubic.In}).start(),ii.TweenManager.Timeline(this.effect.uniforms.get("whiteAlpha")).delay(.5).to({value:1},.2).start()}recoverTransition(){}}var yk=Object.defineProperty,xk=Object.getOwnPropertyDescriptor,VE=(r,o,u,p)=>{for(var v=p>1?void 0:p?xk(o,u):o,b=r.length-1,M;b>=0;b--)(M=r[b])&&(v=(p?M(o,u,v):M(v))||v);return p&&v&&yk(o,u,v),v};const Nn=new v7(16736802,35);class Ey extends Jr{constructor(){super(...arguments);N(this,"_originalPos",new nn)}onLoad(u){this._originalPos.set(1e4,0,6e3),this._originalPos.y=Math.sqrt(Math.pow(this._originalPos.x,2)+Math.pow(this._originalPos.z,2))/1.35;let p=new UE;this.viewer.scene.add(p),Nn.target=p,Nn.castShadow=!0,Nn.shadow.mapSize.width=1024,Nn.shadow.mapSize.height=1024,Nn.shadow.camera.top=400,Nn.shadow.camera.bottom=-100,Nn.shadow.camera.left=-100,Nn.shadow.camera.right=400,Nn.shadow.camera.near=1,Nn.shadow.camera.far=5e4,Nn.shadow.bias=-5e-5,this.viewer.scene.add(Nn),this.viewer.renderer.shadowMap.enabled=!0}update(u){Nn.position.copy(Rn.clone().add(this._originalPos)),Nn.target.position.copy(Rn)}get color(){return Nn.color}set color(u){Nn.color.copy(u)}get intensity(){return Nn.intensity}set intensity(u){Nn.intensity=u}}VE([Aa()],Ey.prototype,"color",1);VE([Aa({min:0,max:100,step:.01})],Ey.prototype,"intensity",1);const Ay=206e3,bk=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec3 vPositionW;

float random(float seed) {
    return fract(sin(seed) * 43758.5453);
}

void main() {
    #include <clipping_planes_fragment>
    vec3 outgoingLight = vec3( 0.0 );
    vec4 diffuseColor = vec4( diffuse, opacity );
    #include <logdepthbuf_fragment>

    #if defined( USE_MAP ) || defined( USE_ALPHAMAP )
        vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
    #endif
    #ifdef USE_MAP
        float rr = vColor.r+vColor.g+vColor.b;
        float randomInt = float(int(random(rr) * 3.0));
        diffuseColor.a *= texture2D( map, vec2(uv.x/3.+randomInt/3.,uv.y)).r;
    #endif
    #ifdef USE_ALPHAMAP
        diffuseColor.a *= texture2D( alphaMap, uv ).g;
    #endif
    //与相机距离越近，透明度降低
    float distanceToCamera = distance(cameraPosition.xyz,vPositionW);
    diffuseColor.a*=smoothstep(1500.,5000.,distanceToCamera);

    #include <color_fragment>
    #include <alphatest_fragment>
    outgoingLight = diffuseColor.rgb;
    #include <output_fragment>
    #include <tonemapping_fragment>
    #include <encodings_fragment>
    #include <fog_fragment>
    #include <premultiplied_alpha_fragment>
}`,Sk=`uniform float size;
uniform float scale;
uniform float time;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec3 vPositionW;
float random(float seed) {
    return fract(sin(seed) * 43758.5453);
}

void main() {
    #include <color_vertex>
    #include <morphcolor_vertex>
    #include <begin_vertex>

    //进行随机移动
    float moveLen = 500.;

    vColor;
    transformed+=vec3((random(vColor.r)-0.5)*2.,(random(vColor.g)-0.8)*2.,(random(vColor.b)-0.5)*2.)*sin(time*(0.1*random(vColor.b))+random(vColor.g))*moveLen;
    vColor.a = smoothstep(0.,0.2,sin(time*(1.2*random(vColor.b)+0.4)+random(vColor.g))-0.8);

    #include <morphtarget_vertex>
    #include <project_vertex>
    gl_PointSize = size;
    #ifdef USE_SIZEATTENUATION
        bool isPerspective = isPerspectiveMatrix( projectionMatrix );
        if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
    #endif
    #include <logdepthbuf_vertex>
    #include <clipping_planes_vertex>
    #include <worldpos_vertex>
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    #include <fog_vertex>
}`;let wk=[{Object:"Plane",Location:[39188.92,26406.37,41612.57],Rotation:[1.57,-.85,0]},{Object:"Plane",Location:[38546.52,180333.61,43235.39],Rotation:[1.57,-.85,0]},{Object:"Plane",Location:[47130.91,101574.17,48893.04],Rotation:[1.57,-.85,0]}];class _k extends Jr{constructor(){super(...arguments);N(this,"PolarLightTransforms",[]);N(this,"lightInst");N(this,"starParticle")}onLoad(){const u=wk;for(let v of u){let b={position:new nn(v.Location[0]*.1,v.Location[2]*.1,-v.Location[1]*.1),rotation:new _y().setFromEuler(new FE(v.Rotation[0],-v.Rotation[1],v.Rotation[2])),scale:new nn(.1,.1,.1)};this.PolarLightTransforms.push(b)}let p=function(v,b){return v.position.z-b.position.z};this.PolarLightTransforms.sort(p),this.viewer.load({url:"images/Login/SM_Light.glb"}).then(v=>{v.traverse(b=>{if(b instanceof Es){const M=new by(b.geometry,u2,this.PolarLightTransforms.length);this.viewer.scene.add(M),this.lightInst=M,this.updateInstance()}}),this.viewer.scene.remove(v)}),this.viewer.addPlugin(Mk,{PolarLightTransforms:this.PolarLightTransforms})}update(u){if(u2.uniforms.time.value+=u,this.lightInst&&this.PolarLightTransforms[this.PolarLightTransforms.length-1].position.z>Rn.z){const p=this.PolarLightTransforms.pop();p.position.z-=Ay*.1,this.PolarLightTransforms.unshift(p),this.updateInstance()}}updateInstance(){for(let u=0;u<this.PolarLightTransforms.length;u++){const p=new Sy;p.compose(this.PolarLightTransforms[u].position,this.PolarLightTransforms[u].rotation,this.PolarLightTransforms[u].scale),this.lightInst.setMatrixAt(u,p)}this.lightInst.instanceMatrix.needsUpdate=!0}}class Mk extends wy{constructor(){super(...arguments);N(this,"particlesGeometry");N(this,"particles");N(this,"particlesMaterial");N(this,"LightTransforms")}onLoad({PolarLightTransforms:u}){this.LightTransforms=u;const p=[],v=[],b=400;for(let j=0;j<b;j++){const J=(Math.random()-.5)*2500,ie=(Math.random()-.5)*2500,he=(Math.random()-.5)*1e3;p.push(J,ie,he);const Ee=Math.random()*3-.2,me=Math.random()*3+.5,be=Math.random()*3+1,ke=1;v.push(Ee,me,be,ke)}this.particlesGeometry=new m7;const L=new fh().load("images/Login/Textures/Tex_0075.png"),k=new L7({size:100,transparent:!0,vertexColors:!0,depthWrite:!1,map:L});k.userData={time:{value:0}},k.onBeforeCompile=(j,J)=>{j.uniforms.time=k.userData.time,j.fragmentShader=bk,j.vertexShader=Sk},this.particlesMaterial=k,this.particles=new R7(this.particlesGeometry,k),this.particlesGeometry.setAttribute("position",new r2(p,3)),this.particlesGeometry.setAttribute("color",new r2(v,4)),this.particles.position.set(0,0,-1e3),this.viewer.scene.add(this.particles)}update(u){this.particles.position.set(Rn.x,Rn.y,Rn.z-200),this.particlesMaterial.userData.time.value+=u;let p=this.LightTransforms[this.LightTransforms.length-1].position.clone();p.add(new nn(-2400,-3e3,0)),p.equals(this.particles.position)||this.particles.position.copy(p)}}let Au=[{Object:"Plane",Location:[-60488.11,30484.8,-6891.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-69542.77,101073.62,-6497.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44203.43,57784.28,-11918.68],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-40366.7,181360.72,-11099.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-72774.31,46232.82,-5950.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38697.31,102738.58,-13675.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-39697.58,89473.2,-12885.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-70576.63,98760.97,-5235.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11577.29,20967.52,-8495.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53051.34,58629.79,-8506.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-40641.91,64329.8,-12371.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66843.48,29598.76,-6530.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-42266.62,117846.26,-11546.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-48705.39,101066.07,-10441.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49567.87,164044.48,-10240.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63117.21,134433.47,-8259.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38076.25,28385.15,-11646.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63856.56,63654.14,-6040.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47108.72,146434.25,-9769.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-65756.09,55139.4,-8018.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66542.17,71700.15,-6776.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-52955.52,118478.04,-8090.08],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-46181.9,17829.44,-12024.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-67787.98,101975.33,-7922.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-70802.82,74705.08,-5455.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77337.82,42162.42,-3855.2],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-58027.16,171653.22,-8907.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47533.1,65320.45,-10543.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-78667.24,28819.17,-3939.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38111.49,79744.12,-11381.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-61521.25,67721.06,-7865.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44977.68,8419.15,-12344.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-41123.9,112317.79,-11020.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49029.45,153857.14,-10354.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47707.91,191223.48,-11574.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-74357.59,77016.9,-6039],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-60313.66,111327.62,-9280.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38888.7,158582.42,-13395.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64989.38,18268.15,-6906.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47702.64,29095.63,-11841.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-37533.73,204645.06,-11568.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-69394.3,30884.51,-7636.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-68848.27,47398.38,-6964.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38732.76,43229.99,-11517.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-73883.41,17287.79,-6478.6],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44755.27,58276.9,-9764.92],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-39071.59,51918.05,-11078.43],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63274.73,40025.57,-8652.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-62579.56,50923.39,-8502.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-42790.08,51176.43,-11429.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53200.27,67074.03,-10203.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77784.38,5304.76,-4549.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49289.36,151485.28,-9629.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-55640.91,190088.7,-10384.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53048.9,175399.2,-10796.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66006.77,86973.08,-6132.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-43524.03,54104.23,-10704.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47088.84,80199.55,-9276.33],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77146.67,58302.61,-3942.77],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66249.42,15264.65,-6270.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64073.55,123106.3,-6906.44],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-46229.73,130501.7,-10025.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-82490.97,173482.25,-4353.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-80608.41,144983.98,-2785.73],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-86136.46,162263.17,-3370.05],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81995.86,158964.97,-2667.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81583.3,86139.34,-4563.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63542.82,191916.59,-8719.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84895.84,94419.38,-3594.49],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64876.92,181148.41,-6024.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-67078.11,187838.31,-5642.94],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66333.29,171824.92,-7252.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84164.83,50794.71,-2514.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-75747.9,93340.18,-5363.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-86779.97,69595.43,-3190.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-68075.7,160090,-6346.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81496.24,184704,-5170.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-74364.87,125927.47,-6323.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-76422.23,128279.49,-5181.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84114.8,78938.19,-3427.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-80861.78,199222.39,-4110.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-90903.52,80324.41,-1891.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-65615.95,200893.42,-6966.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-89984.97,193926.34,-2505.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-79432.23,98348.16,-4836.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-75866.27,166627.03,-6072.61],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-61931.27,171435.47,-7012.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-72609.31,157633.53,-6800.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-71874.77,112376.08,-5185.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-58272.69,194003.62,-8954.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33191.57,192969.95,-12168.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7729.77,203302.69,-12044.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33448.5,124687.7,-14101.5],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10800.77,191961.03,-13088.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26776.67,124435.65,-13278.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-6388.23,188151.53,-11936.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33506.66,167310.17,-12751.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10470.86,124911.66,-12972.34],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[21894.78,153700.95,-11352.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22500.16,104625.02,-11561.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[15021.9,161372.28,-13835.44],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35952.62,8960.45,-12680.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[24983.55,169113.8,-11648.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7514.82,207115.61,-12237.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36099.28,199031.14,-12898.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[30087.89,181245.11,-11916.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[34063.2,97968.63,-14079.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11050.82,106841.92,-13121.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[32327.57,102022.19,-12596.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[8259.29,135051.55,-12240.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35508.52,194710.14,-14040.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[13806.81,131640.5,-13873.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11197.23,203040.88,-12422.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[20678.98,92152.57,-13003.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[27871.1,108478.56,-11428.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[14984.64,203967.14,-12377.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[13265.85,139993.58,-13118.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[31890.34,156823.81,-12186.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23321.93,190977.06,-13803.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10227.62,202461.75,-13626.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[24688.1,69232.33,-12567.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[15203.11,188450.92,-11680.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36308.25,63836.87,-13727.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23746.79,206325.89,-12324.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11698.77,198823.94,-13880.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[19291.59,81163.95,-13557.63],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[16262.82,207534.09,-12083.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[12134.07,147130.5,-12981.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26012.87,138733.91,-11915.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[3466.73,183045.06,-12574.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22092.25,188174.31,-13289.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36754.02,51818.83,-11973.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[8574.26,153492.7,-12620.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[30644.81,186736.53,-13303.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35201.45,106908.62,-13286.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23851.34,78647.8,-12721.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22179.39,167124.92,-13018.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[31671.54,50759.5,-12471.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11813.79,143170.44,-13022.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34351.11,27696.56,-12688.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[21255.91,6485.1,-11217.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11208.84,102613.62,-13130.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33057.55,68809.81,-13096.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[4234.78,51710.18,-11486.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[1667.21,71991.79,-14084.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-3965.94,149901.31,-13356.85],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23668.09,192454.53,-13715.24],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[34579.93,535.9,-12641.43],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12943,136305.36,-11375.42],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36129.8,179558.42,-11778.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21417.77,104294.96,-13669.01],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[18684.31,43129.44,-13519.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10694.96,31095.83,-8981.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-29257.06,34978.15,-12890.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11700.69,128994.75,-12722.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26687.75,37564.85,-12873.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-18283.91,68041.17,-12362.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23971.93,53742.49,-12644.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[1813.69,101170.84,-12334.53],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[201.05,132976.06,-13340.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-109.44,27352.04,-13497.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-29617.71,131991.28,-13137.96],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-31325.67,166604.19,-13429.68],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34200.95,156391.66,-13779.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7907.19,39106.35,-11793.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-798.99,83786.37,-12406.34],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-32995.72,124826.48,-11257.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-8568.22,119949.73,-13907.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21707.48,89456.42,-11855.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-13206.12,108514.83,-12494.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36359.77,147442.47,-14037.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-20089.54,125311.23,-11847.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-24227.66,206625,-11776.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-10234.68,116258.25,-12829.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23368.36,114280.21,-13810.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22199.9,47657.26,-13026.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23635.01,28632.46,-11560.63],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6880.52,87265.32,-13670.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-27647.29,86538.07,-13170.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-27256.34,69600.05,-11908.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-15893.25,60098.4,-11558.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33723.85,193627.64,-11240.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23819.21,76624.97,-8963.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-8552.08,8124.37,-13352.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33068.69,127354.11,-12455.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-3920.98,91168.34,-13107.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-2587.8,125725.26,-11725.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[886.14,134066.64,-13209.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-16435.53,43916.24,-12313.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36057.67,34172.8,-12659.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-35375.84,181701.91,-11995.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-10987.94,50148.55,-11494.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7678.29,38058.29,-12141.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6170.16,48239.19,-13554.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[2379.64,25611.57,-12964.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1434.87,118983.62,-13924.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-17754.98,71741.3,-12472.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-4099.07,83695.23,-13730.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-19459.88,121049.45,-12919.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6969.36,32893.25,-12802.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-6095.34,96087.12,-12933.86],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-32797.46,71242.98,-13183.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[16729.79,11503.73,-12044.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-15198.83,103351.99,-12469.89],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-22466.19,192079.95,-13829.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1313.15,99086.27,-12820.38],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36871.18,185380.89,-12529.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-35360.94,7367.01,-11563.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12880.47,169898.52,-12104.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-26283.14,114315.76,-12690.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26090.14,1625.05,-12106.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[17351.56,62470.75,-13134.32],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21606.88,101088.28,-12209.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-175.6,51561.08,-9890.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[20253.86,20200.81,-13226.5],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7315.29,38971.62,-11814.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34409.87,153439.33,-12254.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-22889.51,195137.83,-13730.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-13531.78,44644.05,-13348.08],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-26576.53,28506.67,-12224.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-9095.18,57368.46,-12946.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12337.18,52056.7,-12155.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-17948.2,33375.7,-13310.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1353.68,31655.12,-13855.3],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7224.22,104272.54,-13626.86],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71511.45,107899.02,-7124.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72810.08,49857.28,-6531.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[64592.77,101436.56,-7718.37],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[73622.58,51558.74,-6659.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[43200.82,18227.13,-12499.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82170.21,124002.15,-3823],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[57687.3,6002.62,-8528.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[66682.44,62333.83,-6221.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[52207.59,65898.03,-9726.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62883.23,20746.46,-6422.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71609.9,168502.23,-4851.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[67136.91,65582.41,-5919.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75239.44,110216.45,-6259.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[56903.44,75679.29,-8625.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82051.9,-1572.71,-3188.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70423.33,94955.27,-6042.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72738.38,131873.92,-4846.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[59108.46,77306.6,-9113.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58786.59,93678.12,-7196.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89295.12,11261.52,-3815.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[61955.38,52479.84,-7401.91],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[63051.84,96387.06,-8603.96],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[83699.05,64346.81,-1973.48],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[85843.8,204874.86,-1584.47],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70186.14,69562.7,-5121.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[85904.45,171221.14,-3911.47],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49979.89,36179.12,-11089.29],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70919.38,173793.12,-6153.13],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[83566.2,136606.17,-3045.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[87411.4,5028.76,-3804.73],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[76811.52,2662.42,-5780.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58347.78,980.65,-7687.67],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75660.41,9705.05,-5236.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[80207.13,24260.02,-3198.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46530.74,30774.18,-10716.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[68274.11,69517.43,-7040.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[88295.8,143629.58,-1557.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72078.51,161115.12,-4719.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[74671.67,130453.27,-4800.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[77906.59,145324.61,-3230.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[42864.79,10651.66,-10540.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65980.25,79478.13,-6033.32],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82617.17,120626.51,-2973.77],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89755.86,50612.07,-1160.1],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[91043.76,77887.8,-2530.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[90599.33,109670.28,-2722.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[90479.91,120468.84,-3154.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71373.92,180298.23,-4948.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65874.48,33575.15,-7683.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62643.75,90847.28,-8991.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[81936.69,37121.51,-3387.95],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45169.82,791.72,-12092.89],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[77392.2,110209.6,-5039],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[79861.74,102198.28,-5329.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62561.84,12948.66,-7417.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89089.84,112020.41,-2143.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[56783.67,48e3,-9931.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[69571.55,57019.32,-6273.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[80563.8,113249.64,-4021.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[86451.38,38681.21,-2109.67],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75966.5,80977.07,-4593.61],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[42461.85,-2206.48,-10773.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[66021.14,180875.58,-6845.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44038.62,115115.38,-9916.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65524.25,173954.56,-6129.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49752.55,78332.03,-9069.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[63932.05,150056.62,-8121.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[37629.06,99027.16,-13346.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[43775.45,156398.53,-9922.48],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36576.96,23631.96,-7747.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45697.84,147818.84,-11227.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49266.07,175812.95,-8835],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[50142.55,169308.12,-10517.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45726.14,195604.75,-10526.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[54675.18,149483.39,-7877.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[69604.1,181135.42,-6380.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44948.47,176907.08,-11097.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[39166.82,61122.98,-10930.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44173.32,143495.72,-10092.98],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62606.25,167094.27,-8288.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[52247.95,102230.37,-8862.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46775.55,194146.84,-11945.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[40302,56987.04,-10790.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[59000.56,126305.89,-9596.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[55809.79,206690.89,-8221.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[40529.25,200411.97,-11612.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[54145.5,113944.23,-9723.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46014.91,133397.47,-10047.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[57505.39,140903.88,-9929.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46285.07,117698.52,-9400.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58556.93,207930.09,-8139.21],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[67890.2,177279.2,-7288.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[61931.2,188274.8,-7540.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[53601.83,108660.44,-9249.3],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[60339.25,194334.88,-8445.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[60801.77,180457.8,-7048.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[53743.35,182143.38,-10774.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7154.81,13400.49,-9534.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7615.13,110930.13,-9485.18],Rotation:[1.57,-0,0],Scale:[300,300,300]}];class Tk extends Jr{constructor(){super(...arguments);N(this,"posList",[]);N(this,"instanceMesh")}onLoad(u){const p=new xf(3e3,1500),v=new by(p,bs,Au.length);for(let M=0;M<Au.length;M++){const L=new nn(Au[M].Location[0],Au[M].Location[2],-Au[M].Location[1]).multiplyScalar(.1);this.posList.push(L)}let b=function(M,L){return M.z-L.z};this.posList.sort(b),this.instanceMesh=v,this.updateInstance(),this.viewer.scene.add(v)}update(u){if(this.instanceMesh&&this.posList[this.posList.length-1].z>Rn.z){const p=this.posList.pop();p.z-=Ay*.1,this.posList.unshift(p),this.updateInstance()}}updateInstance(){const u=new _y,p=new nn(1,1,1);for(let v=0;v<this.posList.length;v++){const b=new Sy;b.compose(this.posList[v],u,p),this.instanceMesh.setMatrixAt(v,b)}this.instanceMesh.instanceMatrix.needsUpdate=!0}}class Ek extends Jr{constructor(){super(...arguments);N(this,"FogList",[]);N(this,"number",1);N(this,"interval",80)}onLoad(u){const p=new xf(1e3,1e3);for(let v=0;v<this.number;v++){const b=new Es(p,c2);b.position.z=-v*this.interval,this.viewer.scene.add(b),this.FogList.push(b)}}update(u){for(let p=0;p<this.FogList.length;p++)this.FogList[p].position.z=Rn.z-p*80-400;c2.uniforms.time.value+=u}}let Ak=[{Object:"SM_Qiao01",Location:[-3259.54,55909.38,-8971.05],Rotation:[0,-0,-3.26],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[-9677.17,56694.38,-8971.05],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-16160.93,57487.46,-8971.05],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-19991.23,57955.97,-12244.69],Rotation:[0,-0,-3.26],Scale:[7.49,7.49,7.49]},{Object:"SM_Qiao01",Location:[19413.68,26615.11,-9828.82],Rotation:[0,-0,-5.34],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[6706.94,30988.29,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[10552.28,36268.59,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao01",Location:[16803.78,85760.77,-9828.82],Rotation:[0,-0,-2.88],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[10555.82,84097.91,-9828.82],Rotation:[0,-0,-2.88],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-18525.85,69364.14,-12612.54],Rotation:[0,-0,0],Scale:[9.76,9.76,9.76]},{Object:"SM_ZhuZi01",Location:[-4961.68,77231.14,-16825.37],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-28871.62,103671.23,-11160.32],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[18490.02,38575.96,-18797.49],Rotation:[0,-0,-3.22],Scale:[10.6,10.6,10.6]},{Object:"SM_ZhuZi01",Location:[13441.07,68078.86,-31761.5],Rotation:[0,-0,0],Scale:[16.33,16.33,16.33]},{Object:"SM_ZhuZi01",Location:[13322.26,94559.95,-14267.74],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[4877.59,7859.61,-8885.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-47983.31,98522.4,-21724.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-4796.11,14035.09,-10501.75],Rotation:[0,-0,2.73],Scale:[5.52,5.52,5.52]},{Object:"SM_Qiao01",Location:[-3259.54,154108.7,-9828.82],Rotation:[0,-0,-3.26],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[-9677.17,154893.7,-9828.82],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-16160.93,155686.78,-9828.82],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-19991.23,156155.3,-9828.82],Rotation:[0,-0,-3.26],Scale:[5.52,5.52,5.52]},{Object:"SM_Qiao01",Location:[7277.17,116763.12,-9828.82],Rotation:[0,-0,-5.34],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[11083.29,121989.55,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[14928.63,127269.85,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao01",Location:[25034.26,183082.17,-9828.82],Rotation:[0,-0,-2.88],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[18786.29,181419.3,-9828.82],Rotation:[0,-0,-2.88],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-18525.85,167563.45,-12612.54],Rotation:[0,-0,0],Scale:[9.76,9.76,9.76]},{Object:"SM_ZhuZi01",Location:[21543.86,202600.36,-11815.69],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-28871.62,201870.55,-11160.32],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[27176.13,183971.92,-13077.91],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[9400.02,134814.62,-17395.76],Rotation:[0,-0,-3.22],Scale:[10.6,10.6,10.6]},{Object:"SM_ZhuZi01",Location:[13441.07,166278.17,-33032.77],Rotation:[0,-0,0],Scale:[16.33,16.33,16.33]},{Object:"SM_ZhuZi01",Location:[21552.73,191881.36,-14267.74],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[4877.59,106058.93,-13314.7],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-14183.06,121644.65,-13454.14],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-47983.31,196721.72,-21724.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[12424.48,53632.54,-8836.33],Rotation:[0,-0,-.14],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[5957.73,54554.15,-8836.33],Rotation:[0,-0,-.14],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[16131.76,53104.19,-15754.45],Rotation:[0,-0,-.14],Scale:[12.56,12.56,12.56]},{Object:"SM_Qiao02",Location:[20564.82,21186.92,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[14154.31,22441.3,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[14190.16,22434.29,-9103.71],Rotation:[0,-0,-.19],Scale:[4.16,4.16,4.16]},{Object:"SM_ZhuZi02",Location:[-24156.43,48468.04,-11681.44],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[12409.99,39026.4,-9229.88],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[13072.63,15697.74,-9052.71],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-20425.44,93584.4,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-13926.08,94237.45,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-24151.42,93210.02,-10667.05],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-13962.42,94233.8,-9103.71],Rotation:[0,-0,-3.04],Scale:[4.16,4.16,4.16]},{Object:"SM_Qiao02",Location:[-12631.35,83666.99,-6470.84],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-7632.57,79462.19,-6470.84],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-43669.46,107924.12,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-46243.29,101920.48,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[24239.87,20467.79,-10667.05],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[12899.75,150950.73,-9694.1],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[6489.23,152205.14,-9694.1],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-7462.1,173587.48,-13131.17],Rotation:[0,-0,-.19],Scale:[12.3,12.3,12.3]},{Object:"SM_Qiao02",Location:[28685.56,121142.08,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[22275.04,122396.45,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[22310.89,122389.44,-9103.71],Rotation:[0,-0,-.19],Scale:[4.16,4.16,4.16]},{Object:"SM_ZhuZi02",Location:[-46214.1,154239.41,-11681.44],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[16786.33,130027.66,-6284.35],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[21461.64,110428.16,-12232.26],Rotation:[0,-0,-.19],Scale:[10.35,10.35,10.35]},{Object:"SM_Qiao02",Location:[-20425.44,191783.73,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-13926.08,192436.77,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-24151.42,191409.36,-10667.05],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-13962.42,192433.11,-9103.71],Rotation:[0,-0,-3.04],Scale:[4.16,4.16,4.16]},{Object:"SM_Qiao02",Location:[-15131.77,180023.33,-7205.48],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-10132.99,175818.53,-7205.48],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-43669.46,206123.42,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-46243.29,200119.8,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[32360.61,120422.95,-10667.05],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-10041.13,151780.16,-4538.24],Rotation:[0,-0,-.19],Scale:[4.36,4.36,4.36]},{Object:"SM_ZhuZi02",Location:[-15583.6,24915.45,-16764.29],Rotation:[0,-0,-.19],Scale:[11.01,11.01,11.01]},{Object:"SM_ZhuZi02",Location:[-5821.24,114219,-14220.5],Rotation:[0,-0,-.19],Scale:[8.77,8.77,8.77]},{Object:"SM_ZhuZi02",Location:[18945.66,86650.52,-13077.91],Rotation:[0,-0,-.14],Scale:[11.02,11.02,11.02]},{Object:"SM_Qiao04",Location:[-6615.05,35478.82,-10267.71],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[21913.41,38149.66,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[25049.79,37910.36,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,69364.13,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,69364.14,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7843.3,92904.8,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10854.39,93814.42,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-9760.54,35478.82,-10267.71],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,69364.13,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,69364.14,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-10147.13,133691.66,-6631.95],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[3693.11,135250.05,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[6829.48,135010.75,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[16073.78,190226.2,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[19084.87,191135.83,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-13292.62,133691.66,-6631.95],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10601.09,7859.6,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-21301.37,25171.66,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-18159.03,25030.85,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-23313.97,25261.84,-22485.36],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-19169.94,48441.03,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-22315.43,48441.03,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-17155.32,48441.03,-22345.92],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7455.6,7859.6,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10601.09,106058.93,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-19900.83,121900.85,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-16758.5,121760.05,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-21913.43,121991.04,-22485.36],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-41227.61,154212.38,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-44373.1,154212.39,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-39213,154212.38,-22345.92],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7455.6,106058.93,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-8441.4,11828.74,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-5816.18,13430.53,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-11060.07,10230.94,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-21684.16,67868.18,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-15456.73,70656.77,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-35647.27,65416.07,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-22937.42,82841.48,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-28350.31,86995.72,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-12151.61,74563.68,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-17564.5,78717.92,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-1365.8,66285.88,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-6778.69,70440.12,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[9420.01,58008.08,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[4007.12,62162.32,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-10240.84,111312.08,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-7615.61,112913.88,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-12859.51,109714.29,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-21684.16,166067.5,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-15456.73,168856.08,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-35647.27,163615.41,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-22937.42,181040.8,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-28350.31,185195.05,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-12151.61,172763,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-17564.5,176917.23,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-1365.8,164485.2,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-6778.69,168639.44,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[9420.01,156207.41,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[4007.12,160361.66,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_ZhuZi04",Location:[-4725.46,35505.06,-22840.58],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-10787.73,69364.13,-26072.59],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[5914.76,92322.2,-27727.79],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-8132.51,133691.66,-25333.54],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-10787.73,167563.45,-26072.59],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[14145.23,189643.61,-27727.79],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[5676.85,35604.1,-19298.23],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]}],Rp=new Sy,Lp=new nn,Pp=new _y,Cp=new nn,h2=new FE;class Rk extends Jr{constructor(){super(...arguments);N(this,"columeInstanceMap",new Map)}onLoad(){const u=this.cloneList(Ak);for(let p of u)this.columeInstanceMap.has(p.Object)||this.columeInstanceMap.set(p.Object,{indexList:[],instance:[]}),this.columeInstanceMap.get(p.Object).indexList.push(p);for(let p of this.columeInstanceMap.keys())this.viewer.load({url:"images/Login/"+p+".glb"}).then(v=>{let b=this.columeInstanceMap.get(p);v.traverse(M=>{if(M instanceof Es){let L=x1.getToonMaterial_Column(M.material);const k=new by(M.geometry,L,b.indexList.length);k.castShadow=!0;for(let j=0;j<b.indexList.length;j++){let J=b.indexList[j];Lp.set(J.Location[0]*.1,J.Location[2]*.1,-J.Location[1]*.1),Pp.setFromEuler(h2.set(J.Rotation[0],J.Rotation[2],J.Rotation[1])),Cp.set(J.Scale[0]*.1,J.Scale[2]*.1,J.Scale[1]*.1),Rp.compose(Lp,Pp,Cp),k.setMatrixAt(j,Rp)}this.viewer.scene.add(k),b.instance.push(k)}}),this.viewer.scene.remove(v)})}update(u){for(let p of this.columeInstanceMap.values())for(let v=0;v<p.indexList.length;v++)if(-p.indexList[v].Location[1]*.1>Rn.z+2e3){p.indexList[v].Location[1]+=Ay,Lp.set(p.indexList[v].Location[0]*.1,p.indexList[v].Location[2]*.1,-p.indexList[v].Location[1]*.1),Pp.setFromEuler(h2.set(p.indexList[v].Rotation[0],p.indexList[v].Rotation[2],p.indexList[v].Rotation[1])),Cp.set(p.indexList[v].Scale[0]*.1,p.indexList[v].Scale[2]*.1,p.indexList[v].Scale[1]*.1),Rp.compose(Lp,Pp,Cp);for(let b of p.instance)b.setMatrixAt(v,Rp),b.instanceMatrix.needsUpdate=!0}}cloneList(u){let p=[];for(let v of u)p.push({Object:v.Object,Location:v.Location.slice(),Rotation:v.Rotation.slice(),Scale:v.Scale.slice()});return p}}class Lk extends Jr{constructor(){super(...arguments);N(this,"originalPos",new nn);N(this,"vCloud")}onLoad(u){this.viewer.load({url:"images/Login/SM_BigCloud.glb"}).then(p=>{this.vCloud=p;for(let v of p.children)v.position.multiplyScalar(.1),v.scale.multiplyScalar(.1);p.traverse(v=>{v instanceof Es&&(v.renderOrder=-1,v.name=="Plane011"?v.material=lk:v.material=hk)})})}update(u){this.vCloud&&this.vCloud.position.copy(Rn)}}function Sv(r){let o=-(Math.sqrt(10)*Math.sqrt(-187248350*Math.pow(r,2)+232585567*r+241290)+21650*r-1230),u=98370*r-1e5;return o/u}function Pk(r){let o=new s2;o.set(1.76474,-.67577,-.08896,-.14702,1.16025,-.01322,-.03633,-.16243,1.19877);let u=new s2;return u.set(.64304,.31119,.04578,.05926,.93144,.00929,.00596,.06393,.93012),r=r.applyMatrix3(u),r.set(Sv(r.x),Sv(r.y),Sv(r.z)),r=r.applyMatrix3(o),r}function Ck(r){let o=new nn(r.r,r.g,r.b);return o=Pk(o),r.r=o.x,r.g=o.y,r.b=o.z,r}class Dk extends wy{onLoad(){const u=window.innerHeight,p=new Ai().setHex(7252),v=new Ai().setHex(147361),b=new Ai().setHex(2533631),M=.2,L=.6,k=new Float32Array(1*u*4);for(let J=0;J<u;J++)for(let ie=0;ie<1;ie++){const he=(J*1+ie)*4;let Ee=1-J/(u-1),me=1-this.smoothstep(0,M,Ee),be=this.smoothstep(0,M,Ee)*(1-this.smoothstep(M,L,Ee)),ke=Math.pow(this.smoothstep(M,L,Ee),1),$=new Ai().setRGB(Math.min(me*p.r+be*v.r+ke*b.r,1e5),Math.min(me*p.g+be*v.g+ke*b.g,1e5),Math.min(me*p.b+be*v.b+ke*b.b,1e5));Ck($),k[he]=$.r,k[he+1]=$.g,k[he+2]=$.b,k[he+3]=1}const j=new g7(k,1,u,P7,w7);j.needsUpdate=!0,this.viewer.scene.background=j}smoothstep(o,u,p){return Math.max(0,Math.min((p-o)/(u-o),1))}}class Ok extends Jr{constructor(){super(...arguments);N(this,"zLength",212.4027);N(this,"offset",new nn(0,25,200));N(this,"textObjects",[]);N(this,"originPosList",[]);N(this,"textContents",["ODINDOG","ODINAPE","BITCAT","SATOSHI","ODINGOLD","ODINCAT","PI","BITCAT","ICONFUCIUS","SPARKS","GHIBLIDOG","SUPEREX"]);N(this,"textSpacing",200);N(this,"textHeight",30);N(this,"hasStartGame",!1);N(this,"shouldStop",!1)}onLoad(){this.getTokensData(),this.createTextObjects(),this.on("start",this._startGame,this,!0),pt.on("start",this._startGame,this,!0)}getTokensData(){const u=this.viewer.user.resources.tokens;if(u&&u.data&&Array.isArray(u.data)){const p=u.data.map(v=>v.ticker||v.name||"").filter(v=>v);p.length>0&&(this.textContents=p)}}createTextObjects(){const u=new UE;this.viewer.scene.add(u);for(let p=0;p<this.textContents.length;p++){const v=document.createElement("canvas"),b=512;v.width=b,v.height=b;const M=v.getContext("2d");if(M){M.clearRect(0,0,b,b);const L=this.textContents[p],k=b*.9;let j=b*.5;do{if(M.font=`bold ${j}px Arial,sans-serif`,M.measureText(L).width<=k)break;j*=.95}while(j>10);M.textAlign="center",M.textBaseline="middle",M.fillStyle="#ffffff",M.strokeStyle="#000000",M.lineWidth=j*.1,M.strokeText(L,b/2,b/2),M.fillText(L,b/2,b/2);const J=M.getImageData(0,0,b,b);for(let Q=3;Q<J.data.length&&!(J.data[Q]>0);Q+=4);const ie=new i2(v);ie.needsUpdate=!0;const Ee=M.measureText(L).width/j,me=this.textHeight*Ee*1.2,be=this.textHeight*2,ke=new xf(me,be),$=new a2({map:ie,transparent:!0,color:new Ai(16775885),roughness:.3,metalness:.1,side:2,depthTest:!0,alphaTest:.02});$.onBeforeCompile=function(Q){let se=Q.fragmentShader;se=se.replace("#include <lights_physical_pars_fragment>",`
                    #include <lights_physical_pars_fragment>
                    vec3 fresnelCol = vec3(0.)/255.;
                    ${Sf}
                    `),se=se.replace("#include <lights_fragment_begin>",Gu),Q.fragmentShader=se},$.needsUpdate=!0,$.side=2;const X=new Es(ke,$);X.castShadow=!0,X.receiveShadow=!0;const ne=new nn(0,this.offset.y+.1,(Rn?Rn.z:0)-500-p*this.textSpacing);X.position.copy(ne),X.rotation.y=Math.PI/24*(Math.random()-.5),X.rotation.x=0,X.visible=!0,X.scale.set(.5,.5,.5),u.add(X),this.textObjects.push(X),this.originPosList.push(ne.clone());const D=X.material;D.needsUpdate=!0}}}_startGame(){this.hasStartGame=!0,this.textObjects[0].visible=!0,this.textObjects[0].position.set(0,0,Rn.z-200),this.originPosList[0].copy(this.textObjects[0].position),this.textObjects[0].scale.set(.1,.1,.1),new ii.Tween(this.textObjects[0].scale).to({x:.6,y:.6,z:.6},800+Math.random()*400).easing(ii.Easing.Elastic.Out).start(),pt.on("showDoor",u=>{this.shouldStop=!0,this._showDoor()},this,!0)}_showDoor(){for(let b of this.textObjects)b.visible=!1;const u=document.createElement("canvas"),p=512;u.width=p,u.height=p;const v=u.getContext("2d");if(v){v.clearRect(0,0,p,p);const b="VALHALLA",M=p*.9;let L=p*.5;do{if(v.font=`bold ${L}px Arial,sans-serif`,v.measureText(b).width<=M)break;L*=.95}while(L>10);v.textAlign="center",v.textBaseline="middle",v.fillStyle="#FFD700",v.strokeStyle="#000000",v.lineWidth=L*.1,v.strokeText(b,p/2,p/2),v.fillText(b,p/2,p/2);const k=new i2(u);k.needsUpdate=!0;const J=v.measureText(b).width/L,ie=this.textHeight*J*1.5,he=this.textHeight*2.5,Ee=new xf(ie,he),me=new a2({map:k,transparent:!0,color:new Ai(16766720),emissive:new Ai(10052885),emissiveIntensity:.5,roughness:.2,metalness:.8,side:2,depthTest:!0,alphaTest:.02});me.onBeforeCompile=function($){let X=$.fragmentShader;X=X.replace("#include <lights_physical_pars_fragment>",`
                #include <lights_physical_pars_fragment>
                vec3 fresnelCol = vec3(0.)/255.;
                ${Sf}
                `),X=X.replace("#include <lights_fragment_begin>",Gu),$.fragmentShader=X},me.needsUpdate=!0;const be=new Es(Ee,me);be.castShadow=!0,be.receiveShadow=!0;const ke=new nn(0,38,Rn.z-300);be.position.copy(ke),this.viewer.scene.add(be),be.scale.set(.3,.3,.3),new ii.Tween(be.scale).to({x:.5,y:.5,z:.5},120).easing(ii.Easing.Elastic.Out).start()}}update(u){if(!this.shouldStop)for(let p=0;p<this.textObjects.length;p++){const v=this.textObjects[p],b=this.originPosList[p];Rn.z<b.z&&(p===this.textObjects.length-1?v.position.copy(this.originPosList[0]):v.position.copy(this.originPosList[this.textObjects.length-1]),v.position.z-=300*(p+1),this.originPosList[p].copy(v.position))}}}function WE(r,o){return function(){return r.apply(o,arguments)}}const{toString:Ik}=Object.prototype,{getPrototypeOf:Ry}=Object,Vf=(r=>o=>{const u=Ik.call(o);return r[u]||(r[u]=u.slice(8,-1).toLowerCase())})(Object.create(null)),Cr=r=>(r=r.toLowerCase(),o=>Vf(o)===r),Wf=r=>o=>typeof o===r,{isArray:fc}=Array,oh=Wf("undefined");function Nk(r){return r!==null&&!oh(r)&&r.constructor!==null&&!oh(r.constructor)&&Hi(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const XE=Cr("ArrayBuffer");function kk(r){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(r):o=r&&r.buffer&&XE(r.buffer),o}const Fk=Wf("string"),Hi=Wf("function"),qE=Wf("number"),Xf=r=>r!==null&&typeof r=="object",Uk=r=>r===!0||r===!1,Vp=r=>{if(Vf(r)!=="object")return!1;const o=Ry(r);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},zk=Cr("Date"),Bk=Cr("File"),jk=Cr("Blob"),Hk=Cr("FileList"),Gk=r=>Xf(r)&&Hi(r.pipe),Vk=r=>{let o;return r&&(typeof FormData=="function"&&r instanceof FormData||Hi(r.append)&&((o=Vf(r))==="formdata"||o==="object"&&Hi(r.toString)&&r.toString()==="[object FormData]"))},Wk=Cr("URLSearchParams"),[Xk,qk,Yk,Qk]=["ReadableStream","Request","Response","Headers"].map(Cr),Zk=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function gh(r,o,{allOwnKeys:u=!1}={}){if(r===null||typeof r>"u")return;let p,v;if(typeof r!="object"&&(r=[r]),fc(r))for(p=0,v=r.length;p<v;p++)o.call(null,r[p],p,r);else{const b=u?Object.getOwnPropertyNames(r):Object.keys(r),M=b.length;let L;for(p=0;p<M;p++)L=b[p],o.call(null,r[L],L,r)}}function YE(r,o){o=o.toLowerCase();const u=Object.keys(r);let p=u.length,v;for(;p-- >0;)if(v=u[p],o===v.toLowerCase())return v;return null}const To=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),QE=r=>!oh(r)&&r!==To;function b1(){const{caseless:r}=QE(this)&&this||{},o={},u=(p,v)=>{const b=r&&YE(o,v)||v;Vp(o[b])&&Vp(p)?o[b]=b1(o[b],p):Vp(p)?o[b]=b1({},p):fc(p)?o[b]=p.slice():o[b]=p};for(let p=0,v=arguments.length;p<v;p++)arguments[p]&&gh(arguments[p],u);return o}const Kk=(r,o,u,{allOwnKeys:p}={})=>(gh(o,(v,b)=>{u&&Hi(v)?r[b]=WE(v,u):r[b]=v},{allOwnKeys:p}),r),Jk=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),$k=(r,o,u,p)=>{r.prototype=Object.create(o.prototype,p),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:o.prototype}),u&&Object.assign(r.prototype,u)},eF=(r,o,u,p)=>{let v,b,M;const L={};if(o=o||{},r==null)return o;do{for(v=Object.getOwnPropertyNames(r),b=v.length;b-- >0;)M=v[b],(!p||p(M,r,o))&&!L[M]&&(o[M]=r[M],L[M]=!0);r=u!==!1&&Ry(r)}while(r&&(!u||u(r,o))&&r!==Object.prototype);return o},tF=(r,o,u)=>{r=String(r),(u===void 0||u>r.length)&&(u=r.length),u-=o.length;const p=r.indexOf(o,u);return p!==-1&&p===u},nF=r=>{if(!r)return null;if(fc(r))return r;let o=r.length;if(!qE(o))return null;const u=new Array(o);for(;o-- >0;)u[o]=r[o];return u},iF=(r=>o=>r&&o instanceof r)(typeof Uint8Array<"u"&&Ry(Uint8Array)),rF=(r,o)=>{const p=(r&&r[Symbol.iterator]).call(r);let v;for(;(v=p.next())&&!v.done;){const b=v.value;o.call(r,b[0],b[1])}},sF=(r,o)=>{let u;const p=[];for(;(u=r.exec(o))!==null;)p.push(u);return p},aF=Cr("HTMLFormElement"),oF=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(u,p,v){return p.toUpperCase()+v}),d2=(({hasOwnProperty:r})=>(o,u)=>r.call(o,u))(Object.prototype),lF=Cr("RegExp"),ZE=(r,o)=>{const u=Object.getOwnPropertyDescriptors(r),p={};gh(u,(v,b)=>{let M;(M=o(v,b,r))!==!1&&(p[b]=M||v)}),Object.defineProperties(r,p)},cF=r=>{ZE(r,(o,u)=>{if(Hi(r)&&["arguments","caller","callee"].indexOf(u)!==-1)return!1;const p=r[u];if(Hi(p)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not rewrite read-only method '"+u+"'")})}})},uF=(r,o)=>{const u={},p=v=>{v.forEach(b=>{u[b]=!0})};return fc(r)?p(r):p(String(r).split(o)),u},hF=()=>{},dF=(r,o)=>r!=null&&Number.isFinite(r=+r)?r:o;function pF(r){return!!(r&&Hi(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const fF=r=>{const o=new Array(10),u=(p,v)=>{if(Xf(p)){if(o.indexOf(p)>=0)return;if(!("toJSON"in p)){o[v]=p;const b=fc(p)?[]:{};return gh(p,(M,L)=>{const k=u(M,v+1);!oh(k)&&(b[L]=k)}),o[v]=void 0,b}}return p};return u(r,0)},mF=Cr("AsyncFunction"),gF=r=>r&&(Xf(r)||Hi(r))&&Hi(r.then)&&Hi(r.catch),KE=((r,o)=>r?setImmediate:o?((u,p)=>(To.addEventListener("message",({source:v,data:b})=>{v===To&&b===u&&p.length&&p.shift()()},!1),v=>{p.push(v),To.postMessage(u,"*")}))(`axios@${Math.random()}`,[]):u=>setTimeout(u))(typeof setImmediate=="function",Hi(To.postMessage)),vF=typeof queueMicrotask<"u"?queueMicrotask.bind(To):typeof process<"u"&&process.nextTick||KE,xe={isArray:fc,isArrayBuffer:XE,isBuffer:Nk,isFormData:Vk,isArrayBufferView:kk,isString:Fk,isNumber:qE,isBoolean:Uk,isObject:Xf,isPlainObject:Vp,isReadableStream:Xk,isRequest:qk,isResponse:Yk,isHeaders:Qk,isUndefined:oh,isDate:zk,isFile:Bk,isBlob:jk,isRegExp:lF,isFunction:Hi,isStream:Gk,isURLSearchParams:Wk,isTypedArray:iF,isFileList:Hk,forEach:gh,merge:b1,extend:Kk,trim:Zk,stripBOM:Jk,inherits:$k,toFlatObject:eF,kindOf:Vf,kindOfTest:Cr,endsWith:tF,toArray:nF,forEachEntry:rF,matchAll:sF,isHTMLForm:aF,hasOwnProperty:d2,hasOwnProp:d2,reduceDescriptors:ZE,freezeMethods:cF,toObjectSet:uF,toCamelCase:oF,noop:hF,toFiniteNumber:dF,findKey:YE,global:To,isContextDefined:QE,isSpecCompliantForm:pF,toJSONObject:fF,isAsyncFn:mF,isThenable:gF,setImmediate:KE,asap:vF};function ht(r,o,u,p,v){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",o&&(this.code=o),u&&(this.config=u),p&&(this.request=p),v&&(this.response=v,this.status=v.status?v.status:null)}xe.inherits(ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:xe.toJSONObject(this.config),code:this.code,status:this.status}}});const JE=ht.prototype,$E={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{$E[r]={value:r}});Object.defineProperties(ht,$E);Object.defineProperty(JE,"isAxiosError",{value:!0});ht.from=(r,o,u,p,v,b)=>{const M=Object.create(JE);return xe.toFlatObject(r,M,function(k){return k!==Error.prototype},L=>L!=="isAxiosError"),ht.call(M,r.message,o,u,p,v),M.cause=r,M.name=r.name,b&&Object.assign(M,b),M};const yF=null;function S1(r){return xe.isPlainObject(r)||xe.isArray(r)}function e3(r){return xe.endsWith(r,"[]")?r.slice(0,-2):r}function p2(r,o,u){return r?r.concat(o).map(function(v,b){return v=e3(v),!u&&b?"["+v+"]":v}).join(u?".":""):o}function xF(r){return xe.isArray(r)&&!r.some(S1)}const bF=xe.toFlatObject(xe,{},null,function(o){return/^is[A-Z]/.test(o)});function qf(r,o,u){if(!xe.isObject(r))throw new TypeError("target must be an object");o=o||new FormData,u=xe.toFlatObject(u,{metaTokens:!0,dots:!1,indexes:!1},!1,function(be,ke){return!xe.isUndefined(ke[be])});const p=u.metaTokens,v=u.visitor||J,b=u.dots,M=u.indexes,k=(u.Blob||typeof Blob<"u"&&Blob)&&xe.isSpecCompliantForm(o);if(!xe.isFunction(v))throw new TypeError("visitor must be a function");function j(me){if(me===null)return"";if(xe.isDate(me))return me.toISOString();if(!k&&xe.isBlob(me))throw new ht("Blob is not supported. Use a Buffer instead.");return xe.isArrayBuffer(me)||xe.isTypedArray(me)?k&&typeof Blob=="function"?new Blob([me]):Buffer.from(me):me}function J(me,be,ke){let $=me;if(me&&!ke&&typeof me=="object"){if(xe.endsWith(be,"{}"))be=p?be:be.slice(0,-2),me=JSON.stringify(me);else if(xe.isArray(me)&&xF(me)||(xe.isFileList(me)||xe.endsWith(be,"[]"))&&($=xe.toArray(me)))return be=e3(be),$.forEach(function(ne,D){!(xe.isUndefined(ne)||ne===null)&&o.append(M===!0?p2([be],D,b):M===null?be:be+"[]",j(ne))}),!1}return S1(me)?!0:(o.append(p2(ke,be,b),j(me)),!1)}const ie=[],he=Object.assign(bF,{defaultVisitor:J,convertValue:j,isVisitable:S1});function Ee(me,be){if(!xe.isUndefined(me)){if(ie.indexOf(me)!==-1)throw Error("Circular reference detected in "+be.join("."));ie.push(me),xe.forEach(me,function($,X){(!(xe.isUndefined($)||$===null)&&v.call(o,$,xe.isString(X)?X.trim():X,be,he))===!0&&Ee($,be?be.concat(X):[X])}),ie.pop()}}if(!xe.isObject(r))throw new TypeError("data must be an object");return Ee(r),o}function f2(r){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(p){return o[p]})}function Ly(r,o){this._pairs=[],r&&qf(r,this,o)}const t3=Ly.prototype;t3.append=function(o,u){this._pairs.push([o,u])};t3.toString=function(o){const u=o?function(p){return o.call(this,p,f2)}:f2;return this._pairs.map(function(v){return u(v[0])+"="+u(v[1])},"").join("&")};function SF(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function n3(r,o,u){if(!o)return r;const p=u&&u.encode||SF;xe.isFunction(u)&&(u={serialize:u});const v=u&&u.serialize;let b;if(v?b=v(o,u):b=xe.isURLSearchParams(o)?o.toString():new Ly(o,u).toString(p),b){const M=r.indexOf("#");M!==-1&&(r=r.slice(0,M)),r+=(r.indexOf("?")===-1?"?":"&")+b}return r}class wF{constructor(){this.handlers=[]}use(o,u,p){return this.handlers.push({fulfilled:o,rejected:u,synchronous:p?p.synchronous:!1,runWhen:p?p.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){xe.forEach(this.handlers,function(p){p!==null&&o(p)})}}const m2=wF,i3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},_F=typeof URLSearchParams<"u"?URLSearchParams:Ly,MF=typeof FormData<"u"?FormData:null,TF=typeof Blob<"u"?Blob:null,EF={isBrowser:!0,classes:{URLSearchParams:_F,FormData:MF,Blob:TF},protocols:["http","https","file","blob","url","data"]},Py=typeof window<"u"&&typeof document<"u",w1=typeof navigator=="object"&&navigator||void 0,AF=Py&&(!w1||["ReactNative","NativeScript","NS"].indexOf(w1.product)<0),RF=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),LF=Py&&window.location.href||"http://localhost",PF=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Py,hasStandardBrowserEnv:AF,hasStandardBrowserWebWorkerEnv:RF,navigator:w1,origin:LF},Symbol.toStringTag,{value:"Module"})),ri={...PF,...EF};function CF(r,o){return qf(r,new ri.classes.URLSearchParams,Object.assign({visitor:function(u,p,v,b){return ri.isNode&&xe.isBuffer(u)?(this.append(p,u.toString("base64")),!1):b.defaultVisitor.apply(this,arguments)}},o))}function DF(r){return xe.matchAll(/\w+|\[(\w*)]/g,r).map(o=>o[0]==="[]"?"":o[1]||o[0])}function OF(r){const o={},u=Object.keys(r);let p;const v=u.length;let b;for(p=0;p<v;p++)b=u[p],o[b]=r[b];return o}function r3(r){function o(u,p,v,b){let M=u[b++];if(M==="__proto__")return!0;const L=Number.isFinite(+M),k=b>=u.length;return M=!M&&xe.isArray(v)?v.length:M,k?(xe.hasOwnProp(v,M)?v[M]=[v[M],p]:v[M]=p,!L):((!v[M]||!xe.isObject(v[M]))&&(v[M]=[]),o(u,p,v[M],b)&&xe.isArray(v[M])&&(v[M]=OF(v[M])),!L)}if(xe.isFormData(r)&&xe.isFunction(r.entries)){const u={};return xe.forEachEntry(r,(p,v)=>{o(DF(p),v,u,0)}),u}return null}function IF(r,o,u){if(xe.isString(r))try{return(o||JSON.parse)(r),xe.trim(r)}catch(p){if(p.name!=="SyntaxError")throw p}return(u||JSON.stringify)(r)}const Cy={transitional:i3,adapter:["xhr","http","fetch"],transformRequest:[function(o,u){const p=u.getContentType()||"",v=p.indexOf("application/json")>-1,b=xe.isObject(o);if(b&&xe.isHTMLForm(o)&&(o=new FormData(o)),xe.isFormData(o))return v?JSON.stringify(r3(o)):o;if(xe.isArrayBuffer(o)||xe.isBuffer(o)||xe.isStream(o)||xe.isFile(o)||xe.isBlob(o)||xe.isReadableStream(o))return o;if(xe.isArrayBufferView(o))return o.buffer;if(xe.isURLSearchParams(o))return u.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let L;if(b){if(p.indexOf("application/x-www-form-urlencoded")>-1)return CF(o,this.formSerializer).toString();if((L=xe.isFileList(o))||p.indexOf("multipart/form-data")>-1){const k=this.env&&this.env.FormData;return qf(L?{"files[]":o}:o,k&&new k,this.formSerializer)}}return b||v?(u.setContentType("application/json",!1),IF(o)):o}],transformResponse:[function(o){const u=this.transitional||Cy.transitional,p=u&&u.forcedJSONParsing,v=this.responseType==="json";if(xe.isResponse(o)||xe.isReadableStream(o))return o;if(o&&xe.isString(o)&&(p&&!this.responseType||v)){const M=!(u&&u.silentJSONParsing)&&v;try{return JSON.parse(o)}catch(L){if(M)throw L.name==="SyntaxError"?ht.from(L,ht.ERR_BAD_RESPONSE,this,null,this.response):L}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ri.classes.FormData,Blob:ri.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};xe.forEach(["delete","get","head","post","put","patch"],r=>{Cy.headers[r]={}});const Dy=Cy,NF=xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),kF=r=>{const o={};let u,p,v;return r&&r.split(`
`).forEach(function(M){v=M.indexOf(":"),u=M.substring(0,v).trim().toLowerCase(),p=M.substring(v+1).trim(),!(!u||o[u]&&NF[u])&&(u==="set-cookie"?o[u]?o[u].push(p):o[u]=[p]:o[u]=o[u]?o[u]+", "+p:p)}),o},g2=Symbol("internals");function Ru(r){return r&&String(r).trim().toLowerCase()}function Wp(r){return r===!1||r==null?r:xe.isArray(r)?r.map(Wp):String(r)}function FF(r){const o=Object.create(null),u=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let p;for(;p=u.exec(r);)o[p[1]]=p[2];return o}const UF=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function wv(r,o,u,p,v){if(xe.isFunction(p))return p.call(this,o,u);if(v&&(o=u),!!xe.isString(o)){if(xe.isString(p))return o.indexOf(p)!==-1;if(xe.isRegExp(p))return p.test(o)}}function zF(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,u,p)=>u.toUpperCase()+p)}function BF(r,o){const u=xe.toCamelCase(" "+o);["get","set","has"].forEach(p=>{Object.defineProperty(r,p+u,{value:function(v,b,M){return this[p].call(this,o,v,b,M)},configurable:!0})})}class Yf{constructor(o){o&&this.set(o)}set(o,u,p){const v=this;function b(L,k,j){const J=Ru(k);if(!J)throw new Error("header name must be a non-empty string");const ie=xe.findKey(v,J);(!ie||v[ie]===void 0||j===!0||j===void 0&&v[ie]!==!1)&&(v[ie||k]=Wp(L))}const M=(L,k)=>xe.forEach(L,(j,J)=>b(j,J,k));if(xe.isPlainObject(o)||o instanceof this.constructor)M(o,u);else if(xe.isString(o)&&(o=o.trim())&&!UF(o))M(kF(o),u);else if(xe.isHeaders(o))for(const[L,k]of o.entries())b(k,L,p);else o!=null&&b(u,o,p);return this}get(o,u){if(o=Ru(o),o){const p=xe.findKey(this,o);if(p){const v=this[p];if(!u)return v;if(u===!0)return FF(v);if(xe.isFunction(u))return u.call(this,v,p);if(xe.isRegExp(u))return u.exec(v);throw new TypeError("parser must be boolean|regexp|function")}}}has(o,u){if(o=Ru(o),o){const p=xe.findKey(this,o);return!!(p&&this[p]!==void 0&&(!u||wv(this,this[p],p,u)))}return!1}delete(o,u){const p=this;let v=!1;function b(M){if(M=Ru(M),M){const L=xe.findKey(p,M);L&&(!u||wv(p,p[L],L,u))&&(delete p[L],v=!0)}}return xe.isArray(o)?o.forEach(b):b(o),v}clear(o){const u=Object.keys(this);let p=u.length,v=!1;for(;p--;){const b=u[p];(!o||wv(this,this[b],b,o,!0))&&(delete this[b],v=!0)}return v}normalize(o){const u=this,p={};return xe.forEach(this,(v,b)=>{const M=xe.findKey(p,b);if(M){u[M]=Wp(v),delete u[b];return}const L=o?zF(b):String(b).trim();L!==b&&delete u[b],u[L]=Wp(v),p[L]=!0}),this}concat(...o){return this.constructor.concat(this,...o)}toJSON(o){const u=Object.create(null);return xe.forEach(this,(p,v)=>{p!=null&&p!==!1&&(u[v]=o&&xe.isArray(p)?p.join(", "):p)}),u}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([o,u])=>o+": "+u).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(o){return o instanceof this?o:new this(o)}static concat(o,...u){const p=new this(o);return u.forEach(v=>p.set(v)),p}static accessor(o){const p=(this[g2]=this[g2]={accessors:{}}).accessors,v=this.prototype;function b(M){const L=Ru(M);p[L]||(BF(v,M),p[L]=!0)}return xe.isArray(o)?o.forEach(b):b(o),this}}Yf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);xe.reduceDescriptors(Yf.prototype,({value:r},o)=>{let u=o[0].toUpperCase()+o.slice(1);return{get:()=>r,set(p){this[u]=p}}});xe.freezeMethods(Yf);const Lr=Yf;function _v(r,o){const u=this||Dy,p=o||u,v=Lr.from(p.headers);let b=p.data;return xe.forEach(r,function(L){b=L.call(u,b,v.normalize(),o?o.status:void 0)}),v.normalize(),b}function s3(r){return!!(r&&r.__CANCEL__)}function mc(r,o,u){ht.call(this,r??"canceled",ht.ERR_CANCELED,o,u),this.name="CanceledError"}xe.inherits(mc,ht,{__CANCEL__:!0});function a3(r,o,u){const p=u.config.validateStatus;!u.status||!p||p(u.status)?r(u):o(new ht("Request failed with status code "+u.status,[ht.ERR_BAD_REQUEST,ht.ERR_BAD_RESPONSE][Math.floor(u.status/100)-4],u.config,u.request,u))}function jF(r){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return o&&o[1]||""}function HF(r,o){r=r||10;const u=new Array(r),p=new Array(r);let v=0,b=0,M;return o=o!==void 0?o:1e3,function(k){const j=Date.now(),J=p[b];M||(M=j),u[v]=k,p[v]=j;let ie=b,he=0;for(;ie!==v;)he+=u[ie++],ie=ie%r;if(v=(v+1)%r,v===b&&(b=(b+1)%r),j-M<o)return;const Ee=J&&j-J;return Ee?Math.round(he*1e3/Ee):void 0}}function GF(r,o){let u=0,p=1e3/o,v,b;const M=(j,J=Date.now())=>{u=J,v=null,b&&(clearTimeout(b),b=null),r.apply(null,j)};return[(...j)=>{const J=Date.now(),ie=J-u;ie>=p?M(j,J):(v=j,b||(b=setTimeout(()=>{b=null,M(v)},p-ie)))},()=>v&&M(v)]}const wf=(r,o,u=3)=>{let p=0;const v=HF(50,250);return GF(b=>{const M=b.loaded,L=b.lengthComputable?b.total:void 0,k=M-p,j=v(k),J=M<=L;p=M;const ie={loaded:M,total:L,progress:L?M/L:void 0,bytes:k,rate:j||void 0,estimated:j&&L&&J?(L-M)/j:void 0,event:b,lengthComputable:L!=null,[o?"download":"upload"]:!0};r(ie)},u)},v2=(r,o)=>{const u=r!=null;return[p=>o[0]({lengthComputable:u,total:r,loaded:p}),o[1]]},y2=r=>(...o)=>xe.asap(()=>r(...o)),VF=ri.hasStandardBrowserEnv?((r,o)=>u=>(u=new URL(u,ri.origin),r.protocol===u.protocol&&r.host===u.host&&(o||r.port===u.port)))(new URL(ri.origin),ri.navigator&&/(msie|trident)/i.test(ri.navigator.userAgent)):()=>!0,WF=ri.hasStandardBrowserEnv?{write(r,o,u,p,v,b){const M=[r+"="+encodeURIComponent(o)];xe.isNumber(u)&&M.push("expires="+new Date(u).toGMTString()),xe.isString(p)&&M.push("path="+p),xe.isString(v)&&M.push("domain="+v),b===!0&&M.push("secure"),document.cookie=M.join("; ")},read(r){const o=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function XF(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function qF(r,o){return o?r.replace(/\/?\/$/,"")+"/"+o.replace(/^\/+/,""):r}function o3(r,o,u){let p=!XF(o);return r&&(p||u==!1)?qF(r,o):o}const x2=r=>r instanceof Lr?{...r}:r;function Oo(r,o){o=o||{};const u={};function p(j,J,ie,he){return xe.isPlainObject(j)&&xe.isPlainObject(J)?xe.merge.call({caseless:he},j,J):xe.isPlainObject(J)?xe.merge({},J):xe.isArray(J)?J.slice():J}function v(j,J,ie,he){if(xe.isUndefined(J)){if(!xe.isUndefined(j))return p(void 0,j,ie,he)}else return p(j,J,ie,he)}function b(j,J){if(!xe.isUndefined(J))return p(void 0,J)}function M(j,J){if(xe.isUndefined(J)){if(!xe.isUndefined(j))return p(void 0,j)}else return p(void 0,J)}function L(j,J,ie){if(ie in o)return p(j,J);if(ie in r)return p(void 0,j)}const k={url:b,method:b,data:b,baseURL:M,transformRequest:M,transformResponse:M,paramsSerializer:M,timeout:M,timeoutMessage:M,withCredentials:M,withXSRFToken:M,adapter:M,responseType:M,xsrfCookieName:M,xsrfHeaderName:M,onUploadProgress:M,onDownloadProgress:M,decompress:M,maxContentLength:M,maxBodyLength:M,beforeRedirect:M,transport:M,httpAgent:M,httpsAgent:M,cancelToken:M,socketPath:M,responseEncoding:M,validateStatus:L,headers:(j,J,ie)=>v(x2(j),x2(J),ie,!0)};return xe.forEach(Object.keys(Object.assign({},r,o)),function(J){const ie=k[J]||v,he=ie(r[J],o[J],J);xe.isUndefined(he)&&ie!==L||(u[J]=he)}),u}const l3=r=>{const o=Oo({},r);let{data:u,withXSRFToken:p,xsrfHeaderName:v,xsrfCookieName:b,headers:M,auth:L}=o;o.headers=M=Lr.from(M),o.url=n3(o3(o.baseURL,o.url,o.allowAbsoluteUrls),r.params,r.paramsSerializer),L&&M.set("Authorization","Basic "+btoa((L.username||"")+":"+(L.password?unescape(encodeURIComponent(L.password)):"")));let k;if(xe.isFormData(u)){if(ri.hasStandardBrowserEnv||ri.hasStandardBrowserWebWorkerEnv)M.setContentType(void 0);else if((k=M.getContentType())!==!1){const[j,...J]=k?k.split(";").map(ie=>ie.trim()).filter(Boolean):[];M.setContentType([j||"multipart/form-data",...J].join("; "))}}if(ri.hasStandardBrowserEnv&&(p&&xe.isFunction(p)&&(p=p(o)),p||p!==!1&&VF(o.url))){const j=v&&b&&WF.read(b);j&&M.set(v,j)}return o},YF=typeof XMLHttpRequest<"u",QF=YF&&function(r){return new Promise(function(u,p){const v=l3(r);let b=v.data;const M=Lr.from(v.headers).normalize();let{responseType:L,onUploadProgress:k,onDownloadProgress:j}=v,J,ie,he,Ee,me;function be(){Ee&&Ee(),me&&me(),v.cancelToken&&v.cancelToken.unsubscribe(J),v.signal&&v.signal.removeEventListener("abort",J)}let ke=new XMLHttpRequest;ke.open(v.method.toUpperCase(),v.url,!0),ke.timeout=v.timeout;function $(){if(!ke)return;const ne=Lr.from("getAllResponseHeaders"in ke&&ke.getAllResponseHeaders()),Q={data:!L||L==="text"||L==="json"?ke.responseText:ke.response,status:ke.status,statusText:ke.statusText,headers:ne,config:r,request:ke};a3(function(ye){u(ye),be()},function(ye){p(ye),be()},Q),ke=null}"onloadend"in ke?ke.onloadend=$:ke.onreadystatechange=function(){!ke||ke.readyState!==4||ke.status===0&&!(ke.responseURL&&ke.responseURL.indexOf("file:")===0)||setTimeout($)},ke.onabort=function(){ke&&(p(new ht("Request aborted",ht.ECONNABORTED,r,ke)),ke=null)},ke.onerror=function(){p(new ht("Network Error",ht.ERR_NETWORK,r,ke)),ke=null},ke.ontimeout=function(){let D=v.timeout?"timeout of "+v.timeout+"ms exceeded":"timeout exceeded";const Q=v.transitional||i3;v.timeoutErrorMessage&&(D=v.timeoutErrorMessage),p(new ht(D,Q.clarifyTimeoutError?ht.ETIMEDOUT:ht.ECONNABORTED,r,ke)),ke=null},b===void 0&&M.setContentType(null),"setRequestHeader"in ke&&xe.forEach(M.toJSON(),function(D,Q){ke.setRequestHeader(Q,D)}),xe.isUndefined(v.withCredentials)||(ke.withCredentials=!!v.withCredentials),L&&L!=="json"&&(ke.responseType=v.responseType),j&&([he,me]=wf(j,!0),ke.addEventListener("progress",he)),k&&ke.upload&&([ie,Ee]=wf(k),ke.upload.addEventListener("progress",ie),ke.upload.addEventListener("loadend",Ee)),(v.cancelToken||v.signal)&&(J=ne=>{ke&&(p(!ne||ne.type?new mc(null,r,ke):ne),ke.abort(),ke=null)},v.cancelToken&&v.cancelToken.subscribe(J),v.signal&&(v.signal.aborted?J():v.signal.addEventListener("abort",J)));const X=jF(v.url);if(X&&ri.protocols.indexOf(X)===-1){p(new ht("Unsupported protocol "+X+":",ht.ERR_BAD_REQUEST,r));return}ke.send(b||null)})},ZF=(r,o)=>{const{length:u}=r=r?r.filter(Boolean):[];if(o||u){let p=new AbortController,v;const b=function(j){if(!v){v=!0,L();const J=j instanceof Error?j:this.reason;p.abort(J instanceof ht?J:new mc(J instanceof Error?J.message:J))}};let M=o&&setTimeout(()=>{M=null,b(new ht(`timeout ${o} of ms exceeded`,ht.ETIMEDOUT))},o);const L=()=>{r&&(M&&clearTimeout(M),M=null,r.forEach(j=>{j.unsubscribe?j.unsubscribe(b):j.removeEventListener("abort",b)}),r=null)};r.forEach(j=>j.addEventListener("abort",b));const{signal:k}=p;return k.unsubscribe=()=>xe.asap(L),k}},KF=ZF,JF=function*(r,o){let u=r.byteLength;if(!o||u<o){yield r;return}let p=0,v;for(;p<u;)v=p+o,yield r.slice(p,v),p=v},$F=async function*(r,o){for await(const u of eU(r))yield*JF(u,o)},eU=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const o=r.getReader();try{for(;;){const{done:u,value:p}=await o.read();if(u)break;yield p}}finally{await o.cancel()}},b2=(r,o,u,p)=>{const v=$F(r,o);let b=0,M,L=k=>{M||(M=!0,p&&p(k))};return new ReadableStream({async pull(k){try{const{done:j,value:J}=await v.next();if(j){L(),k.close();return}let ie=J.byteLength;if(u){let he=b+=ie;u(he)}k.enqueue(new Uint8Array(J))}catch(j){throw L(j),j}},cancel(k){return L(k),v.return()}},{highWaterMark:2})},Qf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",c3=Qf&&typeof ReadableStream=="function",tU=Qf&&(typeof TextEncoder=="function"?(r=>o=>r.encode(o))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),u3=(r,...o)=>{try{return!!r(...o)}catch{return!1}},nU=c3&&u3(()=>{let r=!1;const o=new Request(ri.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!o}),S2=64*1024,_1=c3&&u3(()=>xe.isReadableStream(new Response("").body)),_f={stream:_1&&(r=>r.body)};Qf&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(o=>{!_f[o]&&(_f[o]=xe.isFunction(r[o])?u=>u[o]():(u,p)=>{throw new ht(`Response type '${o}' is not supported`,ht.ERR_NOT_SUPPORT,p)})})})(new Response);const iU=async r=>{if(r==null)return 0;if(xe.isBlob(r))return r.size;if(xe.isSpecCompliantForm(r))return(await new Request(ri.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(xe.isArrayBufferView(r)||xe.isArrayBuffer(r))return r.byteLength;if(xe.isURLSearchParams(r)&&(r=r+""),xe.isString(r))return(await tU(r)).byteLength},rU=async(r,o)=>{const u=xe.toFiniteNumber(r.getContentLength());return u??iU(o)},sU=Qf&&(async r=>{let{url:o,method:u,data:p,signal:v,cancelToken:b,timeout:M,onDownloadProgress:L,onUploadProgress:k,responseType:j,headers:J,withCredentials:ie="same-origin",fetchOptions:he}=l3(r);j=j?(j+"").toLowerCase():"text";let Ee=KF([v,b&&b.toAbortSignal()],M),me;const be=Ee&&Ee.unsubscribe&&(()=>{Ee.unsubscribe()});let ke;try{if(k&&nU&&u!=="get"&&u!=="head"&&(ke=await rU(J,p))!==0){let Q=new Request(o,{method:"POST",body:p,duplex:"half"}),se;if(xe.isFormData(p)&&(se=Q.headers.get("content-type"))&&J.setContentType(se),Q.body){const[ye,Me]=v2(ke,wf(y2(k)));p=b2(Q.body,S2,ye,Me)}}xe.isString(ie)||(ie=ie?"include":"omit");const $="credentials"in Request.prototype;me=new Request(o,{...he,signal:Ee,method:u.toUpperCase(),headers:J.normalize().toJSON(),body:p,duplex:"half",credentials:$?ie:void 0});let X=await fetch(me);const ne=_1&&(j==="stream"||j==="response");if(_1&&(L||ne&&be)){const Q={};["status","statusText","headers"].forEach(Xe=>{Q[Xe]=X[Xe]});const se=xe.toFiniteNumber(X.headers.get("content-length")),[ye,Me]=L&&v2(se,wf(y2(L),!0))||[];X=new Response(b2(X.body,S2,ye,()=>{Me&&Me(),be&&be()}),Q)}j=j||"text";let D=await _f[xe.findKey(_f,j)||"text"](X,r);return!ne&&be&&be(),await new Promise((Q,se)=>{a3(Q,se,{data:D,headers:Lr.from(X.headers),status:X.status,statusText:X.statusText,config:r,request:me})})}catch($){throw be&&be(),$&&$.name==="TypeError"&&/fetch/i.test($.message)?Object.assign(new ht("Network Error",ht.ERR_NETWORK,r,me),{cause:$.cause||$}):ht.from($,$&&$.code,r,me)}}),M1={http:yF,xhr:QF,fetch:sU};xe.forEach(M1,(r,o)=>{if(r){try{Object.defineProperty(r,"name",{value:o})}catch{}Object.defineProperty(r,"adapterName",{value:o})}});const w2=r=>`- ${r}`,aU=r=>xe.isFunction(r)||r===null||r===!1,h3={getAdapter:r=>{r=xe.isArray(r)?r:[r];const{length:o}=r;let u,p;const v={};for(let b=0;b<o;b++){u=r[b];let M;if(p=u,!aU(u)&&(p=M1[(M=String(u)).toLowerCase()],p===void 0))throw new ht(`Unknown adapter '${M}'`);if(p)break;v[M||"#"+b]=p}if(!p){const b=Object.entries(v).map(([L,k])=>`adapter ${L} `+(k===!1?"is not supported by the environment":"is not available in the build"));let M=o?b.length>1?`since :
`+b.map(w2).join(`
`):" "+w2(b[0]):"as no adapter specified";throw new ht("There is no suitable adapter to dispatch the request "+M,"ERR_NOT_SUPPORT")}return p},adapters:M1};function Mv(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new mc(null,r)}function _2(r){return Mv(r),r.headers=Lr.from(r.headers),r.data=_v.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),h3.getAdapter(r.adapter||Dy.adapter)(r).then(function(p){return Mv(r),p.data=_v.call(r,r.transformResponse,p),p.headers=Lr.from(p.headers),p},function(p){return s3(p)||(Mv(r),p&&p.response&&(p.response.data=_v.call(r,r.transformResponse,p.response),p.response.headers=Lr.from(p.response.headers))),Promise.reject(p)})}const d3="1.8.4",Zf={};["object","boolean","number","function","string","symbol"].forEach((r,o)=>{Zf[r]=function(p){return typeof p===r||"a"+(o<1?"n ":" ")+r}});const M2={};Zf.transitional=function(o,u,p){function v(b,M){return"[Axios v"+d3+"] Transitional option '"+b+"'"+M+(p?". "+p:"")}return(b,M,L)=>{if(o===!1)throw new ht(v(M," has been removed"+(u?" in "+u:"")),ht.ERR_DEPRECATED);return u&&!M2[M]&&(M2[M]=!0,console.warn(v(M," has been deprecated since v"+u+" and will be removed in the near future"))),o?o(b,M,L):!0}};Zf.spelling=function(o){return(u,p)=>(console.warn(`${p} is likely a misspelling of ${o}`),!0)};function oU(r,o,u){if(typeof r!="object")throw new ht("options must be an object",ht.ERR_BAD_OPTION_VALUE);const p=Object.keys(r);let v=p.length;for(;v-- >0;){const b=p[v],M=o[b];if(M){const L=r[b],k=L===void 0||M(L,b,r);if(k!==!0)throw new ht("option "+b+" must be "+k,ht.ERR_BAD_OPTION_VALUE);continue}if(u!==!0)throw new ht("Unknown option "+b,ht.ERR_BAD_OPTION)}}const Xp={assertOptions:oU,validators:Zf},qr=Xp.validators;class Mf{constructor(o){this.defaults=o,this.interceptors={request:new m2,response:new m2}}async request(o,u){try{return await this._request(o,u)}catch(p){if(p instanceof Error){let v={};Error.captureStackTrace?Error.captureStackTrace(v):v=new Error;const b=v.stack?v.stack.replace(/^.+\n/,""):"";try{p.stack?b&&!String(p.stack).endsWith(b.replace(/^.+\n.+\n/,""))&&(p.stack+=`
`+b):p.stack=b}catch{}}throw p}}_request(o,u){typeof o=="string"?(u=u||{},u.url=o):u=o||{},u=Oo(this.defaults,u);const{transitional:p,paramsSerializer:v,headers:b}=u;p!==void 0&&Xp.assertOptions(p,{silentJSONParsing:qr.transitional(qr.boolean),forcedJSONParsing:qr.transitional(qr.boolean),clarifyTimeoutError:qr.transitional(qr.boolean)},!1),v!=null&&(xe.isFunction(v)?u.paramsSerializer={serialize:v}:Xp.assertOptions(v,{encode:qr.function,serialize:qr.function},!0)),u.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?u.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:u.allowAbsoluteUrls=!0),Xp.assertOptions(u,{baseUrl:qr.spelling("baseURL"),withXsrfToken:qr.spelling("withXSRFToken")},!0),u.method=(u.method||this.defaults.method||"get").toLowerCase();let M=b&&xe.merge(b.common,b[u.method]);b&&xe.forEach(["delete","get","head","post","put","patch","common"],me=>{delete b[me]}),u.headers=Lr.concat(M,b);const L=[];let k=!0;this.interceptors.request.forEach(function(be){typeof be.runWhen=="function"&&be.runWhen(u)===!1||(k=k&&be.synchronous,L.unshift(be.fulfilled,be.rejected))});const j=[];this.interceptors.response.forEach(function(be){j.push(be.fulfilled,be.rejected)});let J,ie=0,he;if(!k){const me=[_2.bind(this),void 0];for(me.unshift.apply(me,L),me.push.apply(me,j),he=me.length,J=Promise.resolve(u);ie<he;)J=J.then(me[ie++],me[ie++]);return J}he=L.length;let Ee=u;for(ie=0;ie<he;){const me=L[ie++],be=L[ie++];try{Ee=me(Ee)}catch(ke){be.call(this,ke);break}}try{J=_2.call(this,Ee)}catch(me){return Promise.reject(me)}for(ie=0,he=j.length;ie<he;)J=J.then(j[ie++],j[ie++]);return J}getUri(o){o=Oo(this.defaults,o);const u=o3(o.baseURL,o.url,o.allowAbsoluteUrls);return n3(u,o.params,o.paramsSerializer)}}xe.forEach(["delete","get","head","options"],function(o){Mf.prototype[o]=function(u,p){return this.request(Oo(p||{},{method:o,url:u,data:(p||{}).data}))}});xe.forEach(["post","put","patch"],function(o){function u(p){return function(b,M,L){return this.request(Oo(L||{},{method:o,headers:p?{"Content-Type":"multipart/form-data"}:{},url:b,data:M}))}}Mf.prototype[o]=u(),Mf.prototype[o+"Form"]=u(!0)});const qp=Mf;class Oy{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let u;this.promise=new Promise(function(b){u=b});const p=this;this.promise.then(v=>{if(!p._listeners)return;let b=p._listeners.length;for(;b-- >0;)p._listeners[b](v);p._listeners=null}),this.promise.then=v=>{let b;const M=new Promise(L=>{p.subscribe(L),b=L}).then(v);return M.cancel=function(){p.unsubscribe(b)},M},o(function(b,M,L){p.reason||(p.reason=new mc(b,M,L),u(p.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const u=this._listeners.indexOf(o);u!==-1&&this._listeners.splice(u,1)}toAbortSignal(){const o=new AbortController,u=p=>{o.abort(p)};return this.subscribe(u),o.signal.unsubscribe=()=>this.unsubscribe(u),o.signal}static source(){let o;return{token:new Oy(function(v){o=v}),cancel:o}}}const lU=Oy;function cU(r){return function(u){return r.apply(null,u)}}function uU(r){return xe.isObject(r)&&r.isAxiosError===!0}const T1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(T1).forEach(([r,o])=>{T1[o]=r});const hU=T1;function p3(r){const o=new qp(r),u=WE(qp.prototype.request,o);return xe.extend(u,qp.prototype,o,{allOwnKeys:!0}),xe.extend(u,o,null,{allOwnKeys:!0}),u.create=function(v){return p3(Oo(r,v))},u}const yn=p3(Dy);yn.Axios=qp;yn.CanceledError=mc;yn.CancelToken=lU;yn.isCancel=s3;yn.VERSION=d3;yn.toFormData=qf;yn.AxiosError=ht;yn.Cancel=yn.CanceledError;yn.all=function(o){return Promise.all(o)};yn.spread=cU;yn.isAxiosError=uU;yn.mergeConfig=Oo;yn.AxiosHeaders=Lr;yn.formToJSON=r=>r3(xe.isHTMLForm(r)?new FormData(r):r);yn.getAdapter=h3.getAdapter;yn.HttpStatusCode=hU;yn.default=yn;const dU=yn,{TweenManager:pU}=ii;let fU=Hu.prototype._onResize;function f3(){var r=document.documentElement.clientWidth,o=document.documentElement.clientHeight;r>o?Hu.prototype._onResize=fU:Hu.prototype._onResize=function(){this.viewer.resize(o,r),this.viewer.emit(Hu.RESIZE,o,r)}}f3();var mU="resize";window.addEventListener(mU,f3,!1);async function gU(){try{const r=await dU.get("https://api.odin.fun/v1/tokens?sort=marketcap%3Adesc&page=1&limit=25");return r.status===200||r.status===201?r.data:null}catch{return null}}class vU{constructor(o){N(this,"viewer");N(this,"SM",new H7(this));this.viewer=new I7({canvas:o,camera:{fov:45,near:50,far:1e5,rotation:h7(5.5*Math.PI/180,0,0)},user:new j7,linear:!1,toneMapping:A7,outputEncoding:M7}),this.SM.registState(yU),this.SM.registState(xU),this.SM.setState("StatePreload"),this.SM.setState("StateGame")}destroy(){this.SM.reset(),this.viewer.destroy()}}class yU extends HE{constructor(){super(...arguments);N(this,"name","StatePreload")}onEnter(){const u=this.target.viewer.user.resources;return Promise.all([pt.task(jn.Load({url:"images/Login/DOOR.glb"}).then(p=>u.DOOR=p),{name:"DOOR"}),pt.task(jn.Load({url:"images/Login/SM_BigCloud.glb"}).then(p=>u.SM_BigCloud=p),{name:"SM_BigCloud"}),pt.task(jn.Load({url:"images/Login/SM_Light.glb"}).then(p=>u.SM_Light=p),{name:"SM_Light"}),pt.task(jn.Load({url:"images/Login/SM_Qiao01.glb"}).then(p=>u.SM_Qiao01=p),{name:"SM_Qiao01"}),pt.task(jn.Load({url:"images/Login/SM_Qiao02.glb"}).then(p=>u.SM_Qiao02=p),{name:"SM_Qiao02"}),pt.task(jn.Load({url:"images/Login/SM_Qiao03.glb"}).then(p=>u.SM_Qiao03=p),{name:"SM_Qiao03"}),pt.task(jn.Load({url:"images/Login/SM_Qiao04.glb"}).then(p=>u.SM_Qiao04=p),{name:"SM_Qiao04"}),pt.task(jn.Load({url:"images/Login/SM_Road.glb"}).then(p=>u.SM_Road=p),{name:"SM_Road"}),pt.task(jn.Load({url:"images/Login/SM_ZhuZi01.glb"}).then(p=>u.SM_ZhuZi01=p),{name:"SM_ZhuZi01"}),pt.task(jn.Load({url:"images/Login/SM_ZhuZi02.glb"}).then(p=>u.SM_ZhuZi02=p),{name:"SM_ZhuZi02"}),pt.task(jn.Load({url:"images/Login/SM_ZhuZi03.glb"}).then(p=>u.SM_ZhuZi03=p),{name:"SM_ZhuZi03"}),pt.task(jn.Load({url:"images/Login/SM_ZhuZi04.glb"}).then(p=>u.SM_ZhuZi04=p),{name:"SM_ZhuZi04"}),pt.task(jn.Load({url:"images/Login/WHITE_PLANE.glb"}).then(p=>u.WHITE_PLANE=p),{name:"WHITE_PLANE"}),pt.task(gU().then(p=>u.tokens=p),{name:"Tokens"})])}}class xU extends HE{constructor(){super(...arguments);N(this,"name","StateGame");N(this,"_road");N(this,"_text");N(this,"_BloomTransition");N(this,"_forwardCamera")}onEnter(...u){this._initScene(),this._initAudios()}_initScene(){const u=this.target.viewer;u.scene.fog=new _7(3709682,5e3,1e4),u.addNode(My),u.addNode(Ey),u.addNode(_k),u.addNode(Tk),u.addNode(Ek),u.addNode(Rk),u.addNode(Lk),this._forwardCamera=u.addNode(X7),this._road=u.addNode(fk),this._text=u.addNode(Ok),u.addPlugin(Dk),u.addPlugin(S7),u.addPlugin(f7,{mipmapBlur:!0,luminanceThreshold:2,intensity:.6}),this._BloomTransition=u.addPlugin(vk),u.addPlugin(O7,{mode:D7.ACES_FILMIC}),pt.on("start",this._startGame,this,!0)}_initAudios(){const u=this.target.viewer,p=u.addNode(n2),v=u.addNode(n2);pt.on("canvas-click",()=>{p.play({url:"/music/BGM.mp3",loop:!0})}),pt.on("button-start-click",()=>{p.play({url:"/music/BGM.mp3",loop:!0}),v.play({url:"/music/Duang.mp3",force:!0})}),pt.on("openDoor",()=>{setTimeout(()=>v.play({url:"/music/DoorThrough.mp3",force:!0}),150)}),pt.on("doorCreateBegin",()=>{setTimeout(()=>v.play({url:"/music/DoorComeout.mp3",force:!0}),150)})}_startGame(u){this._road.emit("start"),this._text.emit("start"),pt.on("showDoor",p=>{this._forwardCamera.emit("showDoor",p),pt.on("doorCreate",()=>this.target.viewer.on(Hu.POINTER_DOWN,this._jump,this,!0),this,!0)},this,!0)}_jump(){pt.emit("openDoor"),this._forwardCamera.emit("openDoor"),this._BloomTransition.playTransition(),pU.Timeline(this).delay(.1).call(()=>{this._road.openDoor()}).delay(2).call(()=>{pt.restart(),console.log("restart")}).start()}}jn.Load({url:"/music/BGM.mp3"});jn.Load({url:"/music/Duang.mp3"});jn.Load({url:"/music/DoorThrough.mp3"});jn.Load({url:"/music/DoorComeout.mp3"});document.documentElement.clientWidth;document.documentElement.clientHeight;function bU({...r}){const o=An.useRef(null);return An.useEffect(()=>{const u=new vU(o.current);return()=>u.destroy()},[pt.restartCount]),Gt.jsx("aside",{className:"webgl-wrapper",children:Gt.jsx("canvas",{onClick:()=>pt.emit("canvas-click"),ref:o,className:"webgl-canvas",width:"10px",style:{width:"10px"},...r,children:"No Canvas!"})})}function SU(){const[r,o]=An.useState(!0);return An.useEffect(()=>(pt.on("preloaded",()=>o(!1)),pt.on("restart",()=>o(!0)),()=>{pt.reset(),U7()}),[pt.restartCount]),Gt.jsxs(Gt.Fragment,{children:[Gt.jsx(bU,{}),r&&Gt.jsx(B7,{}),!r&&Gt.jsx(k7,{})]})}function m3(){var r=document.documentElement.clientWidth,o=document.documentElement.clientHeight;const u=document.getElementById("root");r>o?(u.style.transform="rotate(0deg)",u.style.width=`${r}px`,u.style.height=`${o}px`,u.style.top="0px",u.style.left="0px"):(u.style.transform="rotate(90deg)",u.style.width=`${o}px`,u.style.height=`${r}px`,u.style.top=`${(o-r)/2}px`,u.style.left=`${0-(o-r)/2}px`)}m3();var wU="resize";window.addEventListener(wU,m3,!1);Tv.createRoot(document.getElementById("root")).render(Gt.jsx(KI.StrictMode,{children:Gt.jsx(SU,{})}));
